import{m as O}from"./vue3-apexcharts-smiyFtih.js";import{f as V}from"./franchisee-dashboard-CvQqDQo9.js";import{g as W}from"./apexCharConfig-_nR_mtlN.js";import{V as b,a as p}from"./VRow-B0gP2GFy.js";import{V as _,a as P,b as w,c as C}from"./VCard-CoFtOtzl.js";import{S as H}from"./saudi-riyal-DtwTLcGW.js";import{V as g}from"./VCardText-gJE2FZ-X.js";import{d as K,ak as Q,r as u,P as N,G as X,c as m,g as c,f as e,e as o,b as t,o as i,a$ as R,t as d,v as n,a3 as Y,aa as F,F as S,i as A,x as Z}from"./main-C3-SOPYs.js";import{V as ee}from"./VAlert-DhNog1PA.js";import{V as I}from"./VAvatar-DaCLSk-0.js";import{V as M,a as B,b as J,d as q}from"./VList-aiwrjFdO.js";import{V as E}from"./VChip-B1b-jhkP.js";import"./_commonjsHelpers-CqkleIqs.js";/* empty css              */import"./VImg-DGmz0H4K.js";import"./ssrBoot-BIjc9Qlg.js";import"./VDivider-UG-1iRGQ.js";import"./VSlideGroup-DuXa1Bxs.js";const te={key:2},ae={class:"d-flex mb-6"},se={class:"d-flex justify-space-between"},le={class:"d-flex flex-column gap-y-1"},oe={class:"text-body-1 text-high-emphasis"},re={class:"d-flex gap-x-2 align-center"},ne={class:"text-h4"},ie={class:"text-sm"},de={class:"text-sm font-weight-medium"},ue={class:"text-body-2 font-weight-medium text-high-emphasis"},me={class:"text-sm font-weight-medium"},ce={class:"text-body-2 font-weight-medium text-high-emphasis"},fe={key:1,class:"text-center py-8"},ze=K({__name:"sales",setup(pe){const U=Q(),h=u(!1),y=u(null),T=u(!1),$=l=>l>0?`+${l}`:l.toString(),k=u([]),D=u([]),L=u([]),v=u([{name:"Top Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Low Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Average Performance",data:[0,0,0,0,0,0,0,0,0,0,0,0]}]),j=N(()=>W(U.current.value)),G=N(()=>!h.value&&T.value&&v.value.length>0&&v.value.every(l=>l.data&&Array.isArray(l.data)&&l.data.length>0&&l.data.every(a=>typeof a=="number"&&!isNaN(a)))),x=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"SAR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),z=async()=>{h.value=!0,y.value=null;try{const l=await V.getSalesStatistics();if(l.success&&l.data){const s=l.data;k.value=[{title:"Total Sales",value:x(s.totalSales),change:s.salesChange,desc:"This month sales",icon:H,iconColor:"primary"},{title:"Total Profit",value:x(s.totalProfit),change:s.profitChange,desc:"This month profit",icon:"tabler-trending-up",iconColor:"success"}]}const a=await V.getProductSales();a.success&&a.data&&(D.value=a.data.mostSelling,L.value=a.data.lowSelling);const f=await V.getMonthlyPerformance();if(f.success&&f.data){const s=f.data;v.value=[{name:"Top Performing Items",data:s.topPerforming},{name:"Low Performing Items",data:s.lowPerforming},{name:"Average Performance",data:s.averagePerformance}],T.value=!0}}catch(l){y.value="Failed to load dashboard data. Please try again.",console.error("Error loading dashboard data:",l)}finally{h.value=!1}};return X(()=>{z()}),(l,a)=>{const f=O;return i(),m("section",null,[h.value?(i(),c(b,{key:0,class:"mb-6"},{default:e(()=>[t(p,{cols:"12"},{default:e(()=>[t(_,null,{default:e(()=>[t(g,{class:"text-center py-8"},{default:e(()=>[t(R,{indeterminate:"",color:"primary",size:"64"}),a[0]||(a[0]=o("div",{class:"mt-4 text-body-1"}," Loading dashboard data... ",-1))]),_:1,__:[0]})]),_:1})]),_:1})]),_:1})):y.value?(i(),c(b,{key:1,class:"mb-6"},{default:e(()=>[t(p,{cols:"12"},{default:e(()=>[t(ee,{type:"error",variant:"tonal",class:"mb-0"},{prepend:e(()=>[t(F,{icon:"tabler-alert-circle"})]),append:e(()=>[t(Y,{color:"error",variant:"text",size:"small",onClick:z},{default:e(()=>a[1]||(a[1]=[d(" Retry ")])),_:1,__:[1]})]),default:e(()=>[d(" "+n(y.value)+" ",1)]),_:1})]),_:1})]),_:1})):(i(),m("div",te,[o("div",ae,[t(b,null,{default:e(()=>[(i(!0),m(S,null,A(k.value,(s,r)=>(i(),c(p,{key:r,cols:"12",md:"6",sm:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(g,null,{default:e(()=>[o("div",se,[o("div",le,[o("div",oe,n(s.title),1),o("div",re,[o("h4",ne,n(s.value),1),o("div",{class:Z(["text-base",s.change>0?"text-success":"text-error"])}," ("+n($(s.change))+"%) ",3)]),o("div",ie,n(s.desc),1)]),t(I,{color:s.iconColor,variant:"tonal",rounded:"",size:"42"},{default:e(()=>[t(F,{icon:s.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(b,{class:"mb-6"},{default:e(()=>[t(p,{cols:"12",md:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(P,null,{default:e(()=>[t(w,null,{default:e(()=>a[2]||(a[2]=[d("Most Selling Items")])),_:1,__:[2]}),t(C,null,{default:e(()=>a[3]||(a[3]=[d("Top performing products")])),_:1,__:[3]})]),_:1}),t(g,null,{default:e(()=>[t(M,{class:"py-0"},{default:e(()=>[(i(!0),m(S,null,A(D.value,(s,r)=>(i(),c(B,{key:r,class:"px-0"},{prepend:e(()=>[t(I,{color:r===0?"success":r===1?"primary":r===2?"warning":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",de,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(J,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(q,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(E,{size:"small",color:"success",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[4]||(a[4]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",ue,n(s.avgPrice?x(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[4]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(P,null,{default:e(()=>[t(w,null,{default:e(()=>a[5]||(a[5]=[d("Low Selling Items")])),_:1,__:[5]}),t(C,null,{default:e(()=>a[6]||(a[6]=[d("Underperforming products")])),_:1,__:[6]})]),_:1}),t(g,null,{default:e(()=>[t(M,{class:"py-0"},{default:e(()=>[(i(!0),m(S,null,A(L.value,(s,r)=>(i(),c(B,{key:r,class:"px-0"},{prepend:e(()=>[t(I,{color:r===0?"error":r===1?"warning":r===2?"info":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",me,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(J,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(q,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(E,{size:"small",color:"error",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[7]||(a[7]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",ce,n(s.avgPrice?x(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[7]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{class:"mb-6"},{default:e(()=>[t(P,null,{default:e(()=>[t(w,null,{default:e(()=>a[8]||(a[8]=[d("Month wise Top and Low Performing Items")])),_:1,__:[8]}),t(C,null,{default:e(()=>a[9]||(a[9]=[d("Monthly performance comparison")])),_:1,__:[9]})]),_:1}),t(g,null,{default:e(()=>[G.value?(i(),c(f,{key:0,type:"area",height:"350",options:{...j.value,xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},series:v.value},null,8,["options","series"])):(i(),m("div",fe,[t(R,{indeterminate:"",color:"primary",size:"32"}),a[10]||(a[10]=o("div",{class:"mt-4 text-body-2 text-medium-emphasis"}," Loading chart data... ",-1))]))]),_:1})]),_:1})]))])}}});export{ze as default};
