import{_ as ye}from"./AppTextarea.vue_vue_type_script_setup_true_lang-BjvS_tqQ.js";import{_ as be}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BEwM3EA5.js";import{_ as _e}from"./AppSelect.vue_vue_type_script_setup_true_lang-C9l7FSyM.js";import{_ as ge}from"./AppTextField.vue_vue_type_script_setup_true_lang-CO47FMF9.js";import{_ as ke}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-DhjnEo5U.js";import{V as we,_ as Ce}from"./ViewNoteModal-BfQQ1-1m.js";import{l as W}from"./lead-DwVeK00r.js";import{a as Ne}from"./formatters-WDr9EcLN.js";import{d as Ue,P as Y,u as xe,r as v,G,w as De,aL as Se,c as F,g as i,l as A,b as l,m as t,f as a,F as I,au as x,o as u,e as f,a$ as Ae,v as y,t as p,a3 as b,i as K,aa as R,aO as X}from"./main-CpsWdFYr.js";import{V,a as _,b as g,d as Ee}from"./VCard-D_XCsLRw.js";import{a as Le,V as Me}from"./VTabs-DHNp53I5.js";import{a as Te,V as Z}from"./VWindowItem-DFm7gYpI.js";import{V as $e}from"./VDialog-ChyOvTE6.js";import{V as c}from"./VCardText-j0JBfbAe.js";import{V as Be}from"./VAvatar-CzxzJOWa.js";import{V as Fe}from"./VChip-yrA_M1tP.js";import{V as w,a as m}from"./VRow-Bk9_G6aB.js";import{V as C}from"./VDivider-BP0aNN7O.js";import{V as Pe}from"./VSpacer-D_nZvJpN.js";import"./form-DyYLQJyt.js";import"./VTextarea-7k5OiHkd.js";/* empty css                   */import"./VCounter-CbUu5J9F.js";import"./VImg-DCJkd1LN.js";import"./VField-DDq05bP2.js";import"./easing-Bybner-F.js";import"./VInput-B4TWBtjL.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-CtqI8NsY.js";import"./VTextField-CUOQrd4S.js";import"./VList-DZrW6fib.js";import"./ssrBoot-BhGqyhmX.js";import"./dialog-transition-D456YNVX.js";import"./VMenu-PCh5aX_y.js";import"./VOverlay-BGEfXIrC.js";import"./lazy-C2iFJq6n.js";import"./scopeId-D-NoPJiR.js";import"./VCheckboxBtn-D9UFBLvW.js";import"./VSelectionControl-BJqGXIsn.js";import"./VForm-D7q8z2rE.js";import"./VFileInput-VXn92lUW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSlideGroup-93CEUUHa.js";/* empty css              */const ze={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Ie={class:"d-flex align-center gap-4"},Re={class:"text-h4"},qe={class:"text-h4 mb-1"},Je={class:"text-body-1 mb-1"},Qe={class:"d-flex gap-2"},Oe={class:"d-flex justify-space-between align-start mb-2"},je={class:"text-caption text-disabled mb-1"},He={class:"text-h6 mb-2"},We={class:"d-flex gap-2"},Ye={class:"text-body-2 mb-2"},Rl=Ue({__name:"[id]",setup(Ge){const h=xe(),k=Y(()=>Number(h.params.id)),N=v("overview"),E=v(!1),L=v(!1),D=v(!1),U=v(!1),M=v(null),T=v(null),s=v(!1),n=v(null),P=v(!1),q=async()=>{try{P.value=!0;const d=await W.getLead(k.value);d.success&&d.data&&(n.value=d.data)}catch(d){console.error("Error fetching lead data:",d)}finally{P.value=!1}};G(()=>{q()});const J=v([]),Q=v(!1),$=async()=>{if(k.value)try{Q.value=!0;const d=await X("/v1/notes",{method:"GET",query:{lead_id:k.value}});d.success&&(J.value=d.data.map(e=>{var r;return{id:e.id,title:e.title,description:e.description,createdBy:((r=e.user)==null?void 0:r.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(d){console.error("Error fetching notes:",d)}finally{Q.value=!1}};De(k,()=>{k.value&&$()},{immediate:!0});const ee=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],le=d=>new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),te=(d,e=150)=>d.length<=e?d:`${d.substring(0,e)}...`,ae=d=>{M.value=d,L.value=!0},oe=d=>{M.value={...d},D.value=!0},ne=d=>{T.value=d,U.value=!0},de=async()=>{if(T.value!==null){try{const d=await X(`/v1/notes/${T.value}`,{method:"DELETE"});d.success?(await $(),console.log("Note deleted successfully")):console.error("Failed to delete note:",d.message)}catch(d){console.error("Error deleting note:",d)}U.value=!1,T.value=null}},ue=async()=>{await $(),D.value=!1,console.log("Note updated successfully")},se=async()=>{await $(),console.log("Note added successfully")},O=()=>{s.value=!s.value},B=v(!1),ie=async()=>{if(n.value)try{B.value=!0,(await W.updateLead(k.value,n.value)).success&&(await q(),s.value=!1,console.log("Lead updated successfully"))}catch(d){console.error("Error updating lead:",d)}finally{B.value=!1}},re=Se("userData"),j=Y(()=>re.value);G(()=>{n.value&&j.value&&(!n.value.owner||n.value.owner==="Unassigned")&&(n.value.owner=j.value.name)});const me=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Syria",value:"Syria"},{title:"Palestine",value:"Palestine"},{title:"Yemen",value:"Yemen"}],pe=[{title:"Riyadh",value:"Riyadh"},{title:"Makkah",value:"Makkah"},{title:"Medina",value:"Medina"},{title:"Eastern Province",value:"Eastern Province"},{title:"Asir",value:"Asir"},{title:"Tabuk",value:"Tabuk"},{title:"Hail",value:"Hail"},{title:"Northern Borders",value:"Northern Borders"},{title:"Jazan",value:"Jazan"},{title:"Najran",value:"Najran"},{title:"Al Bahah",value:"Al Bahah"},{title:"Al Jawf",value:"Al Jawf"}],fe=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],ve=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],Ve=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];return(d,e)=>{const r=ge,S=_e,z=be,ce=ye;return u(),F("section",null,[t(P)?(u(),i(V,{key:0,class:"mb-6"},{default:a(()=>[l(c,{class:"text-center py-10"},{default:a(()=>[l(Ae,{indeterminate:"",color:"primary"}),e[35]||(e[35]=f("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[35]})]),_:1})):t(n)?(u(),i(V,{key:1,class:"mb-6"},{default:a(()=>[l(c,null,{default:a(()=>[f("div",ze,[f("div",Ie,[l(Be,{size:"80",variant:"tonal",color:"primary"},{default:a(()=>[f("span",Re,y(t(Ne)(`${t(n).firstName} ${t(n).lastName}`)),1)]),_:1}),f("div",null,[f("h4",qe,y(t(n).firstName)+" "+y(t(n).lastName),1),f("div",Je,y(t(n).company),1),l(Fe,{color:t(n).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:a(()=>[p(y(t(n).status),1)]),_:1},8,["color"])])]),f("div",Qe,[t(s)?A("",!0):(u(),i(b,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:O},{default:a(()=>e[36]||(e[36]=[p(" Edit ")])),_:1,__:[36]})),t(s)?(u(),i(b,{key:1,color:"success","prepend-icon":"tabler-check",loading:t(B),disabled:t(B),onClick:ie},{default:a(()=>e[37]||(e[37]=[p(" Save ")])),_:1,__:[37]},8,["loading","disabled"])):A("",!0),t(s)?(u(),i(b,{key:2,color:"secondary",variant:"tonal",onClick:O},{default:a(()=>e[38]||(e[38]=[p(" Cancel ")])),_:1,__:[38]})):A("",!0)])])]),_:1})]),_:1})):A("",!0),t(n)?(u(),F(I,{key:2},[l(Le,{modelValue:t(N),"onUpdate:modelValue":e[0]||(e[0]=o=>x(N)?N.value=o:null),class:"mb-6"},{default:a(()=>[(u(),F(I,null,K(ee,o=>l(Me,{key:o.value,value:o.value},{default:a(()=>[l(R,{icon:o.icon,start:""},null,8,["icon"]),p(" "+y(o.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),l(Te,{modelValue:t(N),"onUpdate:modelValue":e[29]||(e[29]=o=>x(N)?N.value=o:null),class:"disable-tab-transition"},{default:a(()=>[l(Z,{value:"overview"},{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12",lg:"8"},{default:a(()=>[l(V,{class:"mb-6"},{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[39]||(e[39]=[p("Personal & Contact Information")])),_:1,__:[39]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12",md:"6"},{default:a(()=>[l(r,{modelValue:t(n).firstName,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).firstName=o),label:"First Name",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:a(()=>[l(r,{modelValue:t(n).lastName,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).lastName=o),label:"Last Name",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:a(()=>[l(r,{modelValue:t(n).email,"onUpdate:modelValue":e[3]||(e[3]=o=>t(n).email=o),label:"Email",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:a(()=>[l(r,{modelValue:t(n).phone,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).phone=o),label:"Phone",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12"},{default:a(()=>[l(r,{modelValue:t(n).company,"onUpdate:modelValue":e[5]||(e[5]=o=>t(n).company=o),label:"Company",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,{class:"mb-6"},{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[40]||(e[40]=[p("Location")])),_:1,__:[40]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12",md:"4"},{default:a(()=>[t(s)?(u(),i(S,{key:0,modelValue:t(n).country,"onUpdate:modelValue":e[6]||(e[6]=o=>t(n).country=o),label:"Country",placeholder:"Select Country",items:me},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).country,"onUpdate:modelValue":e[7]||(e[7]=o=>t(n).country=o),label:"Country",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12",md:"4"},{default:a(()=>[t(s)?(u(),i(S,{key:0,modelValue:t(n).state,"onUpdate:modelValue":e[8]||(e[8]=o=>t(n).state=o),label:"State",placeholder:"Select State",items:pe},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).state,"onUpdate:modelValue":e[9]||(e[9]=o=>t(n).state=o),label:"State",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12",md:"4"},{default:a(()=>[l(r,{modelValue:t(n).city,"onUpdate:modelValue":e[10]||(e[10]=o=>t(n).city=o),label:"City",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,{class:"mb-6"},{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[41]||(e[41]=[p("Financial Details")])),_:1,__:[41]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12",md:"4"},{default:a(()=>[l(r,{modelValue:t(n).estimatedInvestment,"onUpdate:modelValue":e[11]||(e[11]=o=>t(n).estimatedInvestment=o),label:"Estimated Investment",type:"number",prefix:"SAR",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"4"},{default:a(()=>[l(r,{modelValue:t(n).franchiseFeeQuoted,"onUpdate:modelValue":e[12]||(e[12]=o=>t(n).franchiseFeeQuoted=o),label:"Franchise Fee Quoted",type:"number",prefix:"SAR",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"4"},{default:a(()=>[t(s)?(u(),i(z,{key:0,modelValue:t(n).expectedDecisionDate,"onUpdate:modelValue":e[13]||(e[13]=o=>t(n).expectedDecisionDate=o),label:"Expected Decision Date",placeholder:"Select Date"},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).expectedDecisionDate,"onUpdate:modelValue":e[14]||(e[14]=o=>t(n).expectedDecisionDate=o),label:"Expected Decision Date",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[42]||(e[42]=[p("Additional Notes")])),_:1,__:[42]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(ce,{modelValue:t(n).note,"onUpdate:modelValue":e[15]||(e[15]=o=>t(n).note=o),label:"Notes",placeholder:"Add any additional notes about this lead...",rows:"4",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1}),l(m,{cols:"12",lg:"4"},{default:a(()=>[l(V,{class:"mb-6"},{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[43]||(e[43]=[p("Lead Management")])),_:1,__:[43]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12"},{default:a(()=>[t(s)?(u(),i(S,{key:0,modelValue:t(n).status,"onUpdate:modelValue":e[16]||(e[16]=o=>t(n).status=o),label:"Status",placeholder:"Select Status",items:ve},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).status,"onUpdate:modelValue":e[17]||(e[17]=o=>t(n).status=o),label:"Status",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:a(()=>[t(s)?(u(),i(S,{key:0,modelValue:t(n).priority,"onUpdate:modelValue":e[18]||(e[18]=o=>t(n).priority=o),label:"Priority",placeholder:"Select Priority",items:Ve},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).priority,"onUpdate:modelValue":e[19]||(e[19]=o=>t(n).priority=o),label:"Priority",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:a(()=>[t(s)?(u(),i(S,{key:0,modelValue:t(n).source,"onUpdate:modelValue":e[20]||(e[20]=o=>t(n).source=o),label:"Source",placeholder:"Select Source",items:fe},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).source,"onUpdate:modelValue":e[21]||(e[21]=o=>t(n).source=o),label:"Source",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:a(()=>[l(r,{modelValue:t(n).owner,"onUpdate:modelValue":e[22]||(e[22]=o=>t(n).owner=o),label:"Assigned To (You)",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[44]||(e[44]=[p("Timeline & Engagement")])),_:1,__:[44]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[l(m,{cols:"12"},{default:a(()=>[t(s)?(u(),i(z,{key:0,modelValue:t(n).lastContacted,"onUpdate:modelValue":e[23]||(e[23]=o=>t(n).lastContacted=o),label:"Last Contacted",placeholder:"Select Date"},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).lastContacted,"onUpdate:modelValue":e[24]||(e[24]=o=>t(n).lastContacted=o),label:"Last Contacted",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:a(()=>[t(s)?(u(),i(z,{key:0,modelValue:t(n).scheduledMeeting,"onUpdate:modelValue":e[25]||(e[25]=o=>t(n).scheduledMeeting=o),label:"Next Follow-up",placeholder:"Select Date"},null,8,["modelValue"])):(u(),i(r,{key:1,modelValue:t(n).scheduledMeeting,"onUpdate:modelValue":e[26]||(e[26]=o=>t(n).scheduledMeeting=o),label:"Next Follow-up",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:a(()=>[l(r,{modelValue:t(n).contactAttempts,"onUpdate:modelValue":e[27]||(e[27]=o=>t(n).contactAttempts=o),label:"Contact Attempts",type:"number",readonly:!t(s)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(Z,{value:"notes"},{default:a(()=>[l(V,null,{default:a(()=>[l(_,{class:"pb-4"},{append:a(()=>[l(b,{color:"primary","prepend-icon":"tabler-plus",onClick:e[28]||(e[28]=o=>E.value=!0)},{default:a(()=>e[46]||(e[46]=[p(" Add Note ")])),_:1,__:[46]})]),default:a(()=>[l(g,null,{default:a(()=>e[45]||(e[45]=[p("Notes")])),_:1,__:[45]})]),_:1}),l(C),l(c,null,{default:a(()=>[l(w,null,{default:a(()=>[(u(!0),F(I,null,K(t(J),o=>(u(),i(m,{key:o.id,cols:"12"},{default:a(()=>[l(V,{variant:"tonal",class:"mb-4"},{default:a(()=>[l(c,null,{default:a(()=>[f("div",Oe,[f("div",null,[f("div",je," Created by "+y(o.createdBy)+" at "+y(le(o.createdAt)),1),f("h6",He,y(o.title),1)]),f("div",We,[l(b,{icon:"",size:"small",variant:"text",onClick:H=>oe(o)},{default:a(()=>[l(R,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),l(b,{icon:"",size:"small",variant:"text",color:"error",onClick:H=>ne(o.id)},{default:a(()=>[l(R,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),f("p",Ye,y(te(o.description)),1),l(b,{variant:"text",size:"small",onClick:H=>ae(o)},{default:a(()=>e[47]||(e[47]=[p(" Read More ")])),_:2,__:[47]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):A("",!0),l(ke,{"is-dialog-visible":t(E),"onUpdate:isDialogVisible":e[30]||(e[30]=o=>x(E)?E.value=o:null),"lead-id":t(k),onNoteAdded:se},null,8,["is-dialog-visible","lead-id"]),l(we,{"is-dialog-visible":t(L),"onUpdate:isDialogVisible":e[31]||(e[31]=o=>x(L)?L.value=o:null),note:t(M)},null,8,["is-dialog-visible","note"]),l(Ce,{"is-dialog-visible":t(D),"onUpdate:isDialogVisible":e[32]||(e[32]=o=>x(D)?D.value=o:null),note:t(M),onNoteUpdated:ue},null,8,["is-dialog-visible","note"]),l($e,{modelValue:t(U),"onUpdate:modelValue":e[34]||(e[34]=o=>x(U)?U.value=o:null),"max-width":"500"},{default:a(()=>[l(V,null,{default:a(()=>[l(_,null,{default:a(()=>[l(g,null,{default:a(()=>e[48]||(e[48]=[p("Confirm Delete")])),_:1,__:[48]})]),_:1}),l(c,null,{default:a(()=>e[49]||(e[49]=[p(" Are you sure you want to delete this note? This action cannot be undone. ")])),_:1,__:[49]}),l(Ee,null,{default:a(()=>[l(Pe),l(b,{color:"secondary",variant:"tonal",onClick:e[33]||(e[33]=o=>U.value=!1)},{default:a(()=>e[50]||(e[50]=[p(" Cancel ")])),_:1,__:[50]}),l(b,{color:"error",onClick:de},{default:a(()=>e[51]||(e[51]=[p(" Delete ")])),_:1,__:[51]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Rl as default};
