import{_ as S}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{d as D,r as f,j as U,bt as B,a as L,c as M,o as h,e as m,b as a,aW as x,m as e,f as r,H as k,v as C,b3 as $,g as j,l as I,t as _,a9 as E,x as F,b5 as P,b2 as p,cU as H}from"./main-B8QbR-yS.js";import{_ as O}from"./AuthProvider.vue_vue_type_script_setup_true_lang-BOHc-mmg.js";import{a as z,b as W}from"./auth-v1-top-shape-gPxasD3d.js";import{V as g}from"./VNodeRenderer-6cHaukHK.js";import{a as q,b as G,V as J}from"./VCard-D9PhtsJ0.js";import{V as T}from"./VCardText-Cbtr6Qhr.js";import{V as K}from"./VForm-C9sxpau4.js";import{V as Q,a as u}from"./VRow-LlT6Azsr.js";import{V as X}from"./VAlert-DpqH6FXl.js";import{V as Y}from"./VCheckbox-DTUcGAsm.js";import{V as Z}from"./form-Dt-W1fp6.js";import{V as A}from"./VDivider-DOfIMbJY.js";import"./VTextField-C7_y5spr.js";import"./VImg-Ceu2Mboj.js";import"./VField-Bw51LFql.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-DB3XZUVb.js";import"./VAvatar-87LH5tAk.js";/* empty css              */import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";const ee={class:"auth-wrapper d-flex align-center justify-center pa-4"},ae={class:"position-relative my-sm-16"},se={class:"app-logo"},oe={class:"app-logo-title"},re={class:"d-flex align-center my-6"},Ae=D({__name:"register",setup(le){const l=f({name:"",email:"",password:"",password_confirmation:"",role:"franchisor",privacyPolicies:!1}),y=f(!1),v=f(!1),b=f(!1),d=f(null),c=U(),{smAndUp:R}=B(),{updateAbility:w}=H(),N=async()=>{var V,s;if(!l.value.privacyPolicies){d.value={general:"Please agree to the privacy policy & terms to continue."};return}b.value=!0,d.value=null;try{const t=await P("/auth/register",{method:"POST",body:{name:l.value.name,email:l.value.email,password:l.value.password,password_confirmation:l.value.password_confirmation,role:l.value.role}});p("accessToken").value=t.data.token,p("userData").value={id:t.data.user.id,fullName:t.data.user.name,username:t.data.user.email,avatar:void 0,email:t.data.user.email,role:t.data.user.role,status:t.data.user.status};let o;try{o=await P("/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password}}),p("accessToken").value=o.accessToken,p("userData").value=o.userData,p("userAbilityRules").value=o.userAbilityRules,w(o.userAbilityRules)}catch{p("userAbilityRules").value=[],w([])}switch(((V=o==null?void 0:o.userData)==null?void 0:V.role)||"franchisor"){case"admin":c.push("/admin/dashboard");break;case"franchisor":c.push("/franchisor");break;case"franchisee":c.push("/franchisee/dashboard/sales");break;case"sales":c.push("/sales/lead-management");break;default:c.push("/")}}catch(t){const o=(t==null?void 0:t.data)||((s=t==null?void 0:t.response)==null?void 0:s._data)||null;o!=null&&o.errors?d.value={name:o.errors.name,email:o.errors.email,password:o.errors.password,password_confirmation:o.errors.password_confirmation,role:o.errors.role,general:o.message}:d.value={general:(o==null?void 0:o.message)||"Registration failed. Please check your details and try again."}}finally{b.value=!1}};return(V,s)=>{const t=L("RouterLink"),o=S;return h(),M("div",ee,[m("div",ae,[a(e(g),{nodes:x("div",{innerHTML:e(z)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),a(e(g),{nodes:x("div",{innerHTML:e(W)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),a(J,{class:F(["auth-card",e(R)?"pa-6":"pa-0"]),"max-width":"600"},{default:r(()=>[a(q,{class:"justify-center"},{default:r(()=>[a(G,null,{default:r(()=>[a(t,{to:"/"},{default:r(()=>[m("div",se,[a(e(g),{nodes:e(k).app.logo},null,8,["nodes"]),m("h1",oe,C(e(k).app.title),1)])]),_:1})]),_:1})]),_:1}),a(T,null,{default:r(()=>s[7]||(s[7]=[m("h4",{class:"text-h4 mb-1"}," Adventure starts here 🚀 ",-1),m("p",{class:"mb-0"}," Make your app management easy and fun! ",-1)])),_:1,__:[7]}),a(T,null,{default:r(()=>[a(K,{onSubmit:$(N,["prevent"])},{default:r(()=>[a(Q,null,{default:r(()=>[a(u,{cols:"12"},{default:r(()=>{var n;return[(n=e(d))!=null&&n.general?(h(),j(X,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>{var i;return[_(C((i=e(d))==null?void 0:i.general),1)]}),_:1})):I("",!0)]}),_:1}),a(u,{cols:"12"},{default:r(()=>{var n;return[a(o,{modelValue:e(l).name,"onUpdate:modelValue":s[0]||(s[0]=i=>e(l).name=i),autofocus:"",label:"Full Name",placeholder:"Name","error-messages":(n=e(d))==null?void 0:n.name},null,8,["modelValue","error-messages"])]}),_:1}),a(u,{cols:"12"},{default:r(()=>{var n;return[a(o,{modelValue:e(l).email,"onUpdate:modelValue":s[1]||(s[1]=i=>e(l).email=i),label:"Email",type:"email",placeholder:"Email","error-messages":(n=e(d))==null?void 0:n.email},null,8,["modelValue","error-messages"])]}),_:1}),a(u,{cols:"12"},{default:r(()=>{var n;return[a(o,{modelValue:e(l).password,"onUpdate:modelValue":s[2]||(s[2]=i=>e(l).password=i),label:"Password",placeholder:"············",type:e(y)?"text":"password",autocomplete:"new-password","error-messages":(n=e(d))==null?void 0:n.password,"append-inner-icon":e(y)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[3]||(s[3]=i=>y.value=!e(y))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),a(u,{cols:"12"},{default:r(()=>{var n;return[a(o,{modelValue:e(l).password_confirmation,"onUpdate:modelValue":s[4]||(s[4]=i=>e(l).password_confirmation=i),label:"Confirm Password",autocomplete:"new-password",placeholder:"············",type:e(v)?"text":"password","error-messages":(n=e(d))==null?void 0:n.password_confirmation,"append-inner-icon":e(v)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[5]||(s[5]=i=>v.value=!e(v))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),a(u,{cols:"12"},{default:r(()=>[m("div",re,[a(Y,{id:"privacy-policy",modelValue:e(l).privacyPolicies,"onUpdate:modelValue":s[6]||(s[6]=n=>e(l).privacyPolicies=n),inline:""},null,8,["modelValue"]),a(Z,{for:"privacy-policy",style:{opacity:"1"}},{default:r(()=>s[8]||(s[8]=[m("span",{class:"me-1 text-high-emphasis"},"I agree to",-1),m("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1,__:[8]})]),a(E,{block:"",type:"submit",loading:e(b),disabled:e(b)},{default:r(()=>s[9]||(s[9]=[_(" Sign up ")])),_:1,__:[9]},8,["loading","disabled"])]),_:1}),a(u,{cols:"12",class:"text-center text-base"},{default:r(()=>[s[11]||(s[11]=m("span",null,"Already have an account?",-1)),a(t,{class:"text-primary ms-1",to:{name:"login"}},{default:r(()=>s[10]||(s[10]=[_(" Sign in instead ")])),_:1,__:[10]})]),_:1,__:[11]}),a(u,{cols:"12",class:"d-flex align-center"},{default:r(()=>[a(A),s[12]||(s[12]=m("span",{class:"mx-4"},"or",-1)),a(A)]),_:1,__:[12]}),a(u,{cols:"12",class:"text-center"},{default:r(()=>[a(O)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{Ae as default};
