import{M as J,L as se,bc as Be,N as ne,b as e,az as he,a9 as A,ai as Ne,c9 as Me,P as D,J as Ee,an as We,bW as qe,ax as T,ca as Le,U as Q,aj as Oe,Q as je,q as _e,V as Ge,c8 as He,bt as Ye,cI as Qe,bZ as ke,aB as Je,bY as Ke,c7 as Ze,by as Xe,F as pe,d as De,r as I,w as et,g as w,f as t,e as o,l as oe,m as l,t as y,v as V,aR as j,b5 as le,o as b,G as tt,c as H,j as at,aF as te,i as Se,b3 as we}from"./main-ZX0RELSf.js";import{f as lt}from"./formatters--UtN2sCw.js";import{_ as st}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-D6Ud5Iei.js";import{_ as nt}from"./AppTextarea.vue_vue_type_script_setup_true_lang-nRgD-ubi.js";import{_ as it}from"./AppSelect.vue_vue_type_script_setup_true_lang-BXcpWyT4.js";import{_ as ot}from"./AppTextField.vue_vue_type_script_setup_true_lang-DNHIefB9.js";import{r as O,e as dt}from"./validators-BHkKs9Dp.js";import{V as Re}from"./VDialog-Dnb-q-MU.js";import{b as de,d as ve,V as W,a as ce,c as rt}from"./VCard-BPtOKe4P.js";import{V as B}from"./VCardText-DO_FRZge.js";import{V as fe}from"./VAlert-DtX8sKY_.js";import{c as ut,V as Z}from"./VAvatar-Dwbi0l9K.js";import{a as ye,m as ct,V as re,b as mt}from"./VWindowItem-4wdIYavk.js";import{V as Ue,m as pt}from"./VSheet-e9sYl7rU.js";import{V as ue}from"./VDivider-DRORfMXN.js";import{V as Ce}from"./VForm-CMcQHaRk.js";import{V as Y,a as h}from"./VRow-Cqbjxu10.js";import{V as ze}from"./VSpacer-DBsXqXW-.js";import{a as vt,V as Pe}from"./VTabs-sWcraisu.js";import{S as ft}from"./saudi-riyal-BIqFB-kD.js";import{V as ae}from"./VSkeletonLoader-vOLQEjeP.js";import{V as me}from"./VChip-BX1klc4g.js";import{V as yt,a as bt}from"./VDataTable-CHmbGzQf.js";import{V as Ie}from"./VSelect-CM_Ce6Fz.js";import{V as Ae}from"./VTooltip-BqTXI_Ub.js";import"./VField-D__vLB60.js";import"./form-BPJFMOHG.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-CMh6ZUdK.js";import"./VImg-BhWA0TmX.js";import"./VTextarea-KmmZ1HjF.js";import"./VTextField-vxp1RpFW.js";import"./VOverlay-B0AA_Njd.js";import"./scopeId-B6sKQhYQ.js";import"./dialog-transition-DDagBWdU.js";import"./VList-lm2yDhsx.js";/* empty css              */import"./VSlideGroup-D2CZ4fkn.js";import"./VCheckboxBtn-CZL42UAA.js";import"./VSelectionControl-6Sm4Tpt1.js";import"./VTable-BRZOEiHP.js";import"./VMenu-CFk79Z2P.js";const ge=Symbol.for("vuetify:v-stepper"),Fe=J({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),Vt=se()({name:"VStepperActions",props:Fe(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(n,R){let{emit:u,slots:m}=R;const{t:c}=Be();function p(){u("click:prev")}function v(){u("click:next")}return ne(()=>{const i={onClick:p},k={onClick:v};return e("div",{class:"v-stepper-actions"},[e(he,{defaults:{VBtn:{disabled:["prev",!0].includes(n.disabled),text:c(n.prevText),variant:"text"}}},{default:()=>{var x;return[((x=m.prev)==null?void 0:x.call(m,{props:i}))??e(A,i,null)]}}),e(he,{defaults:{VBtn:{color:n.color,disabled:["next",!0].includes(n.disabled),text:c(n.nextText),variant:"tonal"}}},{default:()=>{var x;return[((x=m.next)==null?void 0:x.call(m,{props:k}))??e(A,k,null)]}})])}),{}}}),Te=ut("v-stepper-header"),_t=J({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:Q,default:"$complete"},editable:Boolean,editIcon:{type:Q,default:"$edit"},error:Boolean,errorIcon:{type:Q,default:"$error"},icon:Q,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),gt=J({..._t(),...Le()},"VStepperItem"),be=se()({name:"VStepperItem",directives:{Ripple:Ne},props:gt(),emits:{"group:selected":n=>!0},setup(n,R){let{slots:u}=R;const m=Me(n,ge,!0),c=D(()=>(m==null?void 0:m.value.value)??n.value),p=D(()=>n.rules.every(z=>z()===!0)),v=D(()=>!n.disabled&&n.editable),i=D(()=>!n.disabled&&n.editable),k=D(()=>n.error||!p.value),x=D(()=>n.complete||n.rules.length>0&&p.value),P=D(()=>k.value?n.errorIcon:x.value?n.completeIcon:m.isSelected.value&&n.editable?n.editIcon:n.icon),S=D(()=>({canEdit:i.value,hasError:k.value,hasCompleted:x.value,title:n.title,subtitle:n.subtitle,step:c.value,value:n.value}));return ne(()=>{var U,d,C;const z=(!m||m.isSelected.value||x.value||i.value)&&!k.value&&!n.disabled,N=!!(n.title!=null||u.title),q=!!(n.subtitle!=null||u.subtitle);function L(){m==null||m.toggle()}return Ee(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":x.value,"v-stepper-item--disabled":n.disabled,"v-stepper-item--error":k.value},m==null?void 0:m.selectedClass.value],disabled:!n.editable,type:"button",onClick:L},[v.value&&qe(!0,"v-stepper-item"),e(Z,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:z?n.color:void 0,size:24},{default:()=>{var _;return[((_=u.icon)==null?void 0:_.call(u,S.value))??(P.value?e(T,{icon:P.value},null):c.value)]}}),e("div",{class:"v-stepper-item__content"},[N&&e("div",{key:"title",class:"v-stepper-item__title"},[((U=u.title)==null?void 0:U.call(u,S.value))??n.title]),q&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((d=u.subtitle)==null?void 0:d.call(u,S.value))??n.subtitle]),(C=u.default)==null?void 0:C.call(u,S.value)])]),[[We("ripple"),n.ripple&&n.editable,null]])}),{}}}),xt=J({...Ge(ct(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),$e=se()({name:"VStepperWindow",props:xt(),emits:{"update:modelValue":n=>!0},setup(n,R){let{slots:u}=R;const m=Oe(ge,null),c=je(n,"modelValue"),p=D({get(){var v;return c.value!=null||!m?c.value:(v=m.items.value.find(i=>m.selected.value.includes(i.id)))==null?void 0:v.value},set(v){c.value=v}});return ne(()=>{const v=ye.filterProps(n);return e(ye,_e({_as:"VStepperWindow"},v,{modelValue:p.value,"onUpdate:modelValue":i=>p.value=i,class:["v-stepper-window",n.class],style:n.style,mandatory:!1,touch:!1}),u)}),{}}}),ht=J({...mt()},"VStepperWindowItem"),Ve=se()({name:"VStepperWindowItem",props:ht(),setup(n,R){let{slots:u}=R;return ne(()=>{const m=re.filterProps(n);return e(re,_e({_as:"VStepperWindowItem"},m,{class:["v-stepper-window-item",n.class],style:n.style}),u)}),{}}}),kt=J({altLabels:Boolean,bgColor:String,completeIcon:Q,editIcon:Q,editable:Boolean,errorIcon:Q,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...Xe()},"Stepper"),St=J({...kt(),...Ze({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...pt(),...Ke(Fe(),["prevText","nextText"])},"VStepper"),wt=se()({name:"VStepper",props:St(),emits:{"update:modelValue":n=>!0},setup(n,R){let{slots:u}=R;const{items:m,next:c,prev:p,selected:v}=He(n,ge),{displayClasses:i,mobile:k}=Ye(n),{completeIcon:x,editIcon:P,errorIcon:S,color:z,editable:N,prevText:q,nextText:L}=Qe(n),U=D(()=>n.items.map((_,M)=>{const E=ke(_,n.itemTitle,_),r=ke(_,n.itemValue,M+1);return{title:E,value:r,raw:_}})),d=D(()=>m.value.findIndex(_=>v.value.includes(_.id))),C=D(()=>n.disabled?n.disabled:d.value===0?"prev":d.value===m.value.length-1?"next":!1);return Je({VStepperItem:{editable:N,errorIcon:S,completeIcon:x,editIcon:P,prevText:q,nextText:L},VStepperActions:{color:z,disabled:C,prevText:q,nextText:L}}),ne(()=>{const _=Ue.filterProps(n),M=!!(u.header||n.items.length),E=n.items.length>0,r=!n.hideActions&&!!(E||u.actions);return e(Ue,_e(_,{color:n.bgColor,class:["v-stepper",{"v-stepper--alt-labels":n.altLabels,"v-stepper--flat":n.flat,"v-stepper--non-linear":n.nonLinear,"v-stepper--mobile":k.value},i.value,n.class],style:n.style}),{default:()=>{var G,X;return[M&&e(Te,{key:"stepper-header"},{default:()=>[U.value.map(($,K)=>{let{raw:ee,...ie}=$;return e(pe,null,[!!K&&e(ue,null,null),e(be,ie,{default:u[`header-item.${ie.value}`]??u.header,icon:u.icon,title:u.title,subtitle:u.subtitle})])})]}),E&&e($e,{key:"stepper-window"},{default:()=>[U.value.map($=>e(Ve,{value:$.value},{default:()=>{var K,ee;return((K=u[`item.${$.value}`])==null?void 0:K.call(u,$))??((ee=u.item)==null?void 0:ee.call(u,$))}}))]}),(G=u.default)==null?void 0:G.call(u,{prev:p,next:c}),r&&(((X=u.actions)==null?void 0:X.call(u,{next:c,prev:p}))??e(Vt,{key:"stepper-actions","onClick:prev":p,"onClick:next":c},u))]}})}),{prev:p,next:c}}}),Ut={class:"d-flex gap-3"},Ct=De({__name:"AddFranchiseeModal",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchiseeAdded"],setup(n,{emit:R}){const u=n,m=R,c=I(1),p=I(!1),v=I(null),i=I({name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),k=[{title:"Saudi Arabia",value:"SA"},{title:"United Arab Emirates",value:"AE"},{title:"Qatar",value:"QA"},{title:"Kuwait",value:"KW"},{title:"Oman",value:"OM"},{title:"Bahrain",value:"BH"},{title:"Jordan",value:"JO"},{title:"Lebanon",value:"LB"},{title:"Egypt",value:"EG"},{title:"Iraq",value:"IQ"}],x=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}],P=()=>{c.value=1,v.value=null,i.value={name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},S=U=>{m("update:isDialogVisible",U)},z=()=>{c.value<2&&(c.value++,v.value=null)},N=()=>{c.value>1&&(c.value--,v.value=null)};et(()=>u.isDialogVisible,U=>{U&&P()});const q=async()=>{var U,d,C;if(!i.value.name||!i.value.email||!i.value.phone){v.value="Please fill in all required fields";return}p.value=!0,v.value=null;try{const _=await le("/v1/franchisor/franchise"),M=((U=_.data)==null?void 0:U.id)||_.id,E={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:M,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,country:i.value.country,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},r=await le("/v1/franchisor/franchisees-with-unit",{method:"POST",body:E});if(r.success){const G={id:r.data.unit.id,name:r.data.unit.unit_name,email:r.data.franchisee.email,phone:r.data.franchisee.phone,type:r.data.unit.unit_type,sizeSqft:r.data.unit.size_sqft,capacity:null,openingDate:r.data.unit.opening_date,monthlyRent:r.data.unit.monthly_rent,managerId:r.data.unit.franchisee_id,managerName:r.data.franchisee.name,country:r.data.unit.country,state:r.data.unit.state_province,city:r.data.unit.city,address:r.data.unit.address,postalCode:r.data.unit.postal_code};m("franchiseeAdded",G),S(!1),P()}}catch(_){console.error("Error creating franchisee with unit:",_),v.value=((C=(d=_.response)==null?void 0:d.data)==null?void 0:C.message)||"Failed to create franchisee and unit. Please try again."}finally{p.value=!1}},L=U=>{m("update:isDialogVisible",U),U||P()};return(U,d)=>{const C=ot,_=it,M=nt,E=st;return b(),w(Re,{"model-value":u.isDialogVisible,"max-width":"800","onUpdate:modelValue":L},{default:t(()=>[e(W,null,{default:t(()=>[e(de,{class:"text-center"},{default:t(()=>d[15]||(d[15]=[o("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[15]}),e(B,null,{default:t(()=>[l(v)?(b(),w(fe,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":d[0]||(d[0]=r=>v.value=null)},{default:t(()=>[y(V(l(v)),1)]),_:1})):oe("",!0),e(wt,{modelValue:l(c),"onUpdate:modelValue":d[13]||(d[13]=r=>j(c)?c.value=r:null),"alt-labels":""},{default:t(()=>[e(Te,null,{default:t(()=>[e(be,{complete:l(c)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(ue),e(be,{value:2,title:"Unit Details"})]),_:1}),e($e,null,{default:t(()=>[e(Ve,{value:1},{default:t(()=>[e(Ce,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[e(C,{modelValue:l(i).name,"onUpdate:modelValue":d[1]||(d[1]=r=>l(i).name=r),label:"Branch Name",placeholder:"Enter Branch name",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"6"},{default:t(()=>[e(C,{modelValue:l(i).email,"onUpdate:modelValue":d[2]||(d[2]=r=>l(i).email=r),label:"Email Address",placeholder:"Enter email address",rules:[l(O),l(dt)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"6"},{default:t(()=>[e(C,{modelValue:l(i).phone,"onUpdate:modelValue":d[3]||(d[3]=r=>l(i).phone=r),label:"Contact Number",placeholder:"Enter contact number",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(_,{modelValue:l(i).country,"onUpdate:modelValue":d[4]||(d[4]=r=>l(i).country=r),items:k,label:"Country",placeholder:"Select country",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).state,"onUpdate:modelValue":d[5]||(d[5]=r=>l(i).state=r),label:"State",placeholder:"Enter state",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).city,"onUpdate:modelValue":d[6]||(d[6]=r=>l(i).city=r),label:"City",placeholder:"Enter city",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:t(()=>[e(M,{modelValue:l(i).address,"onUpdate:modelValue":d[7]||(d[7]=r=>l(i).address=r),label:"Address",placeholder:"Enter full address",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:t(()=>[e(fe,{type:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[o("strong",null,V(l(i).name||"New franchisee"),1),d[16]||(d[16]=y(" will be automatically assigned as the unit manager. "))]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1}),e(Ve,{value:2},{default:t(()=>[e(Ce,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(h,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:l(i).type,"onUpdate:modelValue":d[8]||(d[8]=r=>l(i).type=r),items:x,label:"Unit Type",placeholder:"Select unit type",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12",md:"6"},{default:t(()=>[e(E,{modelValue:l(i).openingDate,"onUpdate:modelValue":d[9]||(d[9]=r=>l(i).openingDate=r),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":d[10]||(d[10]=r=>l(i).sizeSqft=r),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).capacity,"onUpdate:modelValue":d[11]||(d[11]=r=>l(i).capacity=r),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":d[12]||(d[12]=r=>l(i).monthlyRent=r),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"SAR"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ve,{class:"justify-space-between pa-6"},{default:t(()=>[l(c)>1?(b(),w(A,{key:0,variant:"outlined",disabled:l(p),onClick:N},{default:t(()=>d[17]||(d[17]=[y(" Previous ")])),_:1,__:[17]},8,["disabled"])):(b(),w(ze,{key:1})),o("div",Ut,[e(A,{variant:"outlined",disabled:l(p),onClick:d[14]||(d[14]=r=>S(!1))},{default:t(()=>d[18]||(d[18]=[y(" Cancel ")])),_:1,__:[18]},8,["disabled"]),l(c)<2?(b(),w(A,{key:0,color:"primary",disabled:l(p),onClick:z},{default:t(()=>d[19]||(d[19]=[y(" Next ")])),_:1,__:[19]},8,["disabled"])):(b(),w(A,{key:1,color:"primary",loading:l(p),disabled:l(p),onClick:q},{default:t(()=>d[20]||(d[20]=[y(" Create Unit ")])),_:1,__:[20]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Pt={class:"d-flex align-center justify-space-between"},It={class:"ms-4"},At={class:"text-h4"},Dt={key:1},Rt={class:"ms-4"},zt={class:"text-h4"},Ft={key:1},Tt={class:"ms-4"},$t={class:"text-h4"},Bt={key:1},Nt={class:"ms-4"},Mt={class:"text-h4"},Et={key:1},Wt={class:"text-center py-8"},qt={class:"d-flex align-center justify-space-between mb-3"},Lt={class:"text-h6"},Ot={class:"mb-2"},jt={class:"text-body-1"},Gt={class:"mb-2"},Ht={class:"text-body-2"},Yt={class:"mb-3"},Qt={class:"text-body-1 font-weight-medium"},Jt={class:"text-center"},Kt={class:"text-center"},Zt={class:"d-flex align-center gap-x-3"},Xt={class:"text-base font-weight-medium"},ea={class:"text-body-2 text-disabled"},ta={class:"text-body-1 font-weight-medium"},aa={class:"text-body-2 text-disabled"},la={class:"text-body-1"},sa={class:"text-body-2 text-disabled"},na={class:"text-body-2 text-disabled"},ia={class:"text-body-2 text-disabled"},oa={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},da={class:"text-sm text-disabled mb-0"},ra={class:"d-flex align-center",style:{"inline-size":"8rem"}},Za=De({__name:"my-units",setup(n){const R=(f,a,s)=>{const F=(f-1)*a+1,g=Math.min(f*a,s);return`Showing ${F} to ${g} of ${s} entries`},u=at(),m=I("overview"),c=I([]),p=I(!1),v=I(null),i=I(1),k=I(10);I(0);const x=I(!1),P=I(null),S=I(""),z=I({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),N=I(!1),q=D(()=>z.value.totalUnits||c.value.length),L=D(()=>z.value.activeUnits||c.value.filter(f=>f.status==="active").length),U=D(()=>z.value.pendingUnits||c.value.filter(f=>f.status==="pending").length),d=D(()=>z.value.monthlyRoyalty),C=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],_=[{title:"Planning",value:"planning"},{title:"Construction",value:"construction"},{title:"Training",value:"training"},{title:"Active",value:"active"},{title:"Pending",value:"pending"},{title:"Temporarily Closed",value:"temporarily_closed"},{title:"Permanently Closed",value:"permanently_closed"}],M=f=>f==="active"?"success":f==="pending"?"warning":f==="inactive"?"error":"secondary",E=async()=>{var f;p.value=!0,v.value=null;try{const a=await le("/v1/franchisor/units");a.success&&a.data.data?c.value=a.data.data.map(s=>{var F,g,xe;return{id:s.id,branchName:s.unit_name||"Unnamed Unit",franchiseeName:((F=s.franchisee)==null?void 0:F.name)||"Unassigned",email:((g=s.franchisee)==null?void 0:g.email)||s.email||"unassigned@example.com",contactNumber:((xe=s.franchisee)==null?void 0:xe.phone)||s.phone||"Not available",address:s.address||"Address not available",city:s.city||"Unknown",state:s.state_province||"Unknown",country:s.country||"Unknown",royaltyPercentage:8.5,contractStartDate:s.lease_start_date||"2024-01-01",renewalDate:s.lease_end_date||"2027-01-01",status:s.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:s.employee_count||0,totalProducts:0,avgRating:0}}):c.value=[]}catch(a){console.error("Failed to load units data:",a),v.value=((f=a==null?void 0:a.data)==null?void 0:f.message)||"Failed to load units data",c.value=[]}finally{p.value=!1}},r=async()=>{var f,a,s,F;try{const g=await le("/v1/franchisor/units/statistics");g.success&&g.data&&(z.value={totalUnits:g.data.totalUnits||0,activeUnits:g.data.activeUnits||0,pendingUnits:g.data.pendingUnits||0,inactiveUnits:g.data.inactiveUnits||0,totalRevenue:g.data.totalRevenue||0,monthlyRoyalty:g.data.monthlyRoyalty||0,avgRevenuePerUnit:g.data.avgRevenuePerUnit||0,revenueChange:g.data.revenueChange||0,royaltyRate:g.data.royaltyRate||8.5,taskStats:{total:((f=g.data.taskStats)==null?void 0:f.total)||0,completed:((a=g.data.taskStats)==null?void 0:a.completed)||0,pending:((s=g.data.taskStats)==null?void 0:s.pending)||0,completionRate:((F=g.data.taskStats)==null?void 0:F.completionRate)||0}})}catch(g){console.error("Failed to load statistics data:",g)}},G=async()=>{await Promise.all([E(),r()])},X=f=>{u.push(`/franchisor/units/${f}`)},$=()=>{N.value=!0},K=f=>{G()};tt(()=>{G()});const ee=f=>{P.value=f,S.value=f.status,x.value=!0},ie=async()=>{var f;if(!(!P.value||!S.value))try{if((await le(`/v1/units/${P.value.id}/status`,{method:"PATCH",body:{status:S.value}})).success){const s=c.value.findIndex(F=>F.id===P.value.id);s!==-1&&(c.value[s].status=S.value),x.value=!1,P.value=null,S.value="",await r()}}catch(a){console.error("Failed to change unit status:",a),v.value=((f=a==null?void 0:a.data)==null?void 0:f.message)||"Failed to change unit status"}};return(f,a)=>(b(),H("section",null,[e(Y,{class:"mb-6"},{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[o("div",Pt,[a[13]||(a[13]=o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Units "),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[12]||(a[12]=[y(" Add Franchisee ")])),_:1,__:[12]},8,["loading"])])]),_:1})]),_:1}),l(v)?(b(),w(fe,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":a[0]||(a[0]=s=>v.value=null)},{default:t(()=>[y(V(l(v)),1)]),_:1})):oe("",!0),e(vt,{modelValue:l(m),"onUpdate:modelValue":a[1]||(a[1]=s=>j(m)?m.value=s:null),class:"mb-6"},{default:t(()=>[e(Pe,{value:"overview"},{default:t(()=>[e(T,{icon:"tabler-dashboard",start:""}),a[14]||(a[14]=y(" Overview "))]),_:1,__:[14]}),e(Pe,{value:"units"},{default:t(()=>[e(T,{icon:"tabler-building-store",start:""}),a[15]||(a[15]=y(" All Units "))]),_:1,__:[15]})]),_:1},8,["modelValue"]),e(ye,{modelValue:l(m),"onUpdate:modelValue":a[7]||(a[7]=s=>j(m)?m.value=s:null),class:"disable-tab-transition"},{default:t(()=>[e(re,{value:"overview"},{default:t(()=>[e(Y,{class:"mb-6"},{default:t(()=>[e(h,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-building-store",size:"26"})]),_:1}),o("div",It,[a[16]||(a[16]=o("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),o("h4",At,[l(p)?(b(),w(te,{key:0,indeterminate:"",size:"20"})):(b(),H("span",Dt,V(l(q)),1))])])]),_:1})]),_:1})]),_:1}),e(h,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-check",size:"26"})]),_:1}),o("div",Rt,[a[17]||(a[17]=o("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),o("h4",zt,[l(p)?(b(),w(te,{key:0,indeterminate:"",size:"20"})):(b(),H("span",Ft,V(l(L)),1))])])]),_:1})]),_:1})]),_:1}),e(h,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",Tt,[a[18]||(a[18]=o("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),o("h4",$t,[l(p)?(b(),w(te,{key:0,indeterminate:"",size:"20"})):(b(),H("span",Bt,V(l(U)),1))])])]),_:1})]),_:1})]),_:1}),e(h,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:t(()=>[e(l(ft),{size:"26"})]),_:1}),o("div",Nt,[a[19]||(a[19]=o("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),o("h4",Mt,[l(p)?(b(),w(te,{key:0,indeterminate:"",size:"20"})):(b(),H("span",Et,V(l(lt)(l(d))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(ce,{class:"pb-4"},{append:t(()=>[e(A,{variant:"text",color:"primary",onClick:a[2]||(a[2]=s=>m.value="units")},{default:t(()=>a[21]||(a[21]=[y(" View All ")])),_:1,__:[21]})]),default:t(()=>[e(de,null,{default:t(()=>a[20]||(a[20]=[y("Recent Units")])),_:1,__:[20]})]),_:1}),e(B,null,{default:t(()=>[l(p)?(b(),w(Y,{key:0},{default:t(()=>[(b(),H(pe,null,Se(3,s=>e(h,{key:s,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e(B,null,{default:t(()=>[e(ae,{type:"text",class:"mb-3"}),e(ae,{type:"text",class:"mb-2"}),e(ae,{type:"text",class:"mb-2"}),e(ae,{type:"text",class:"mb-3"}),e(ae,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(c).length===0?(b(),w(Y,{key:1},{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[o("div",Wt,[e(T,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),a[23]||(a[23]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[24]||(a[24]=o("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",onClick:$},{default:t(()=>a[22]||(a[22]=[y(" Add Your First Unit ")])),_:1,__:[22]})])]),_:1})]),_:1})):(b(),w(Y,{key:2},{default:t(()=>[(b(!0),H(pe,null,Se(l(c).slice(0,3),s=>(b(),w(h,{key:s.id,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e(B,null,{default:t(()=>[o("div",qt,[o("h6",Lt,V(s.branchName),1),e(me,{color:M(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[y(V(s.status),1)]),_:2},1032,["color"])]),o("div",Ot,[a[25]||(a[25]=o("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),o("div",jt,V(s.franchiseeName),1)]),o("div",Gt,[a[26]||(a[26]=o("div",{class:"text-body-2 text-disabled"}," Location ",-1)),o("div",Ht,V(s.city)+", "+V(s.state),1)]),o("div",Yt,[a[27]||(a[27]=o("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),o("div",Qt,V(s.royaltyPercentage)+"% ",1)])]),_:2},1024),e(ve,null,{default:t(()=>[e(A,{variant:"text",color:"primary",onClick:F=>X(s.id)},{default:t(()=>a[28]||(a[28]=[y(" View Details ")])),_:2,__:[28]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(re,{value:"units"},{default:t(()=>[e(W,null,{default:t(()=>[e(ce,{class:"pb-4"},{append:t(()=>[e(A,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[30]||(a[30]=[y(" Add Franchisee ")])),_:1,__:[30]},8,["loading"])]),default:t(()=>[e(de,null,{default:t(()=>a[29]||(a[29]=[y("All Franchise Units")])),_:1,__:[29]})]),_:1}),e(ue),l(p)?(b(),w(B,{key:0,class:"py-8"},{default:t(()=>[o("div",Jt,[e(te,{indeterminate:"",size:"48",class:"mb-4"}),a[31]||(a[31]=o("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),a[32]||(a[32]=o("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(c).length===0?(b(),w(B,{key:1,class:"py-8"},{default:t(()=>[o("div",Kt,[e(T,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),a[34]||(a[34]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[35]||(a[35]=o("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:$},{default:t(()=>a[33]||(a[33]=[y(" Add Your First Franchisee & Unit ")])),_:1,__:[33]})])]),_:1})):(b(),w(yt,{key:2,items:l(c),headers:C,class:"text-no-wrap","item-value":"id","items-per-page":l(k),page:l(i),"onUpdate:itemsPerPage":a[5]||(a[5]=s=>k.value=s),"onUpdate:page":a[6]||(a[6]=s=>i.value=s)},{"item.branchInfo":t(({item:s})=>[o("div",Zt,[e(Z,{size:"34",color:"primary",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-building-store",size:"20"})]),_:1}),o("div",null,[o("h6",Xt,V(s.branchName),1),o("div",ea,V(s.email),1)])])]),"item.franchisee":t(({item:s})=>[o("div",null,[o("div",ta,V(s.franchiseeName),1),o("div",aa,[e(T,{icon:"tabler-user-check",size:"14",class:"me-1"}),y(" Unit Manager • "+V(s.contactNumber),1)])])]),"item.location":t(({item:s})=>[o("div",null,[o("div",la,V(s.city)+", "+V(s.state),1),o("div",sa,V(s.country),1)])]),"item.royaltyPercentage":t(({item:s})=>[s.royaltyPercentage>0?(b(),w(me,{key:0,color:"primary",size:"small",class:"mt-1"},{default:t(()=>[y(V(s.royaltyPercentage)+"% Royalty ",1)]),_:2},1024)):oe("",!0)]),"item.contractPeriod":t(({item:s})=>[o("div",null,[o("div",na," Start: "+V(s.contractStartDate),1),o("div",ia," Renewal: "+V(s.renewalDate),1)])]),"item.status":t(({item:s})=>[e(me,{color:M(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[y(V(s.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:s})=>[e(A,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(F=>X(s.id),["stop"])},{default:t(()=>[e(T,{icon:"tabler-eye"}),e(Ae,{activator:"parent"},{default:t(()=>a[36]||(a[36]=[y(" View Unit Details ")])),_:1,__:[36]})]),_:2},1032,["onClick"]),e(A,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(F=>ee(s),["stop"])},{default:t(()=>[e(T,{icon:"tabler-edit"}),e(Ae,{activator:"parent"},{default:t(()=>a[37]||(a[37]=[y(" Change Status ")])),_:1,__:[37]})]),_:2},1032,["onClick"])]),bottom:t(()=>[e(ue),o("div",oa,[o("p",da,V(R(l(i),l(k),l(c).length)),1),e(bt,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=s=>j(i)?i.value=s:null),length:Math.ceil(l(c).length/l(k)),"total-visible":f.$vuetify.display.xs?1:Math.min(Math.ceil(l(c).length/l(k)),5)},null,8,["modelValue","length","total-visible"]),o("div",ra,[a[38]||(a[38]=o("span",{class:"text-no-wrap me-3"},"Rows per page:",-1)),e(Ie,{modelValue:l(k),"onUpdate:modelValue":a[4]||(a[4]=s=>j(k)?k.value=s:null),density:"compact",variant:"outlined",items:[5,10,25,50,100]},null,8,["modelValue"])])])]),_:1},8,["items","items-per-page","page"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ct,{"is-dialog-visible":l(N),"onUpdate:isDialogVisible":a[8]||(a[8]=s=>j(N)?N.value=s:null),onFranchiseeAdded:K},null,8,["is-dialog-visible"]),e(Re,{modelValue:l(x),"onUpdate:modelValue":a[11]||(a[11]=s=>j(x)?x.value=s:null),"max-width":"500"},{default:t(()=>[e(W,null,{default:t(()=>[e(ce,null,{default:t(()=>[e(de,null,{default:t(()=>a[39]||(a[39]=[y("Change Unit Status")])),_:1,__:[39]}),l(P)?(b(),w(rt,{key:0},{default:t(()=>[y(V(l(P).branchName),1)]),_:1})):oe("",!0)]),_:1}),e(B,null,{default:t(()=>[e(Ie,{modelValue:l(S),"onUpdate:modelValue":a[9]||(a[9]=s=>j(S)?S.value=s:null),label:"Status",items:_,placeholder:"Select Status"},null,8,["modelValue"])]),_:1}),e(ve,null,{default:t(()=>{var s;return[e(ze),e(A,{color:"secondary",variant:"tonal",onClick:a[10]||(a[10]=F=>x.value=!1)},{default:t(()=>a[40]||(a[40]=[y(" Cancel ")])),_:1,__:[40]}),e(A,{color:"primary",disabled:!l(S)||l(S)===((s=l(P))==null?void 0:s.status),onClick:ie},{default:t(()=>a[41]||(a[41]=[y(" Update Status ")])),_:1,__:[41]},8,["disabled"])]}),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});export{Za as default};
