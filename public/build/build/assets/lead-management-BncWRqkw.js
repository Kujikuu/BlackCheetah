import{V as ge,_ as ye}from"./VDataTableServer-CCw8wB-D.js";import{_ as be}from"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import{_ as Ve}from"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import{_ as xe}from"./AddNoteDialog.vue_vue_type_script_setup_true_lang-C9gcIppj.js";import{_ as he}from"./ImportLeadsDialog.vue_vue_type_script_setup_true_lang-Zm-Plg8H.js";import{_ as Ce}from"./DeleteLeadDialog.vue_vue_type_script_setup_true_lang-ixBhJX-s.js";import{l as w}from"./lead-DnsW79oj.js";import{d as we,r as n,P as ke,w as Se,G as De,c as j,e as i,b as l,f as a,aR as c,m as o,j as Le,a as Ue,o as N,F as Ne,i as $e,g as q,v as r,x as Ae,ax as k,t as v,l as Be,a9 as S}from"./main-gemCwVks.js";import{V as O,a as $}from"./VRow-DiX7eN30.js";import{V as M,a as Ie,b as Pe}from"./VCard-DJ82mpnW.js";import{V as P}from"./VCardText-BD5AHO-w.js";import{V as J}from"./VAvatar-12xz6mHy.js";import{V as Q}from"./VDivider-B4ry9pxl.js";import{V as Te}from"./VSpacer-Cpeayo2U.js";import{V as ze}from"./VMenu-CeaiRCNz.js";import{V as Ee,a as W,b as G}from"./VList-MyW-iB3v.js";import{V as Fe}from"./VChip-DlNApjyg.js";import"./VDataTable-C-SlKz4P.js";import"./VSelect-C9dxRhag.js";import"./VTextField-BhxF6EAD.js";import"./VImg-DSB6m92Q.js";import"./VField-CsHfcJSz.js";import"./form-DjHlhIbZ.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-B3GinL-f.js";import"./dialog-transition-C9rYmnXC.js";import"./VOverlay-p8m6-W96.js";import"./scopeId-BgtgI3QF.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";import"./VTable-0Z68chLt.js";import"./AppTextarea.vue_vue_type_script_setup_true_lang-DJuxuOVb.js";import"./VTextarea-OEcL0zKK.js";import"./VDialog-6C-NQXCx.js";import"./VForm-FUZpY-zG.js";import"./VFileInput-CB0ItP4X.js";/* empty css              */import"./VSlideGroup-CEWgOBQJ.js";const Re={class:"d-flex mb-6"},je={class:"d-flex justify-space-between"},qe={class:"d-flex flex-column gap-y-1"},Oe={class:"text-body-1 text-high-emphasis"},Me={class:"d-flex gap-x-2 align-center"},Je={class:"text-h4"},Qe={class:"me-3 d-flex gap-3"},We={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ge={style:{"inline-size":"15.625rem"}},He={class:"text-body-1 font-weight-medium"},Ke={class:"d-flex align-center gap-x-4"},Xe={class:"d-flex flex-column"},Ye={class:"text-body-1"},Ze={class:"text-body-1"},et={class:"text-body-1"},tt={class:"text-body-1"},lt={class:"text-body-1 text-capitalize"},at={class:"text-body-1"},st={class:"text-body-1"},Mt=we({__name:"lead-management",setup(ot){const g=n(""),y=n(),b=n(),V=n(),D=n(!1),T=n(null),x=n(!1),h=n(!1),A=n(null),f=n(!1),C=n(null),m=n(10),p=n(1),z=n(),E=n(),d=n([]),H=s=>{var t,u;z.value=(t=s.sortBy[0])==null?void 0:t.key,E.value=(u=s.sortBy[0])==null?void 0:u.order,_()},K=s=>s>0?`+${s}`:s,X=s=>s.split(" ").map(t=>t[0]).join("").toUpperCase(),Y=[{title:"#",key:"index",sortable:!1},{title:"Lead Name",key:"name"},{title:"Company",key:"company"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Location",key:"location"},{title:"Source",key:"source"},{title:"Status",key:"status"},{title:"Owner",key:"owner"},{title:"Last Contacted",key:"lastContacted"},{title:"Actions",key:"actions",sortable:!1}],F=n([]),B=n(0),R=n([]),Z=ke(()=>F.value),_=async()=>{try{f.value=!0,C.value=null;const s=await w.getLeads({status:y.value,source:b.value,owner:V.value,search:g.value,itemsPerPage:m.value,page:p.value,sortBy:z.value,orderBy:E.value});s.success&&(F.value=s.leads,B.value=s.total)}catch(s){C.value=s.message||"Failed to fetch leads",console.error("Error fetching leads:",s)}finally{f.value=!1}},L=async()=>{try{const s=await w.getStatistics();s.success&&(R.value=s.data)}catch(s){console.error("Error fetching statistics:",s)}};Se([g,y,b,V,p,m],()=>{_()}),De(()=>{_(),L()});const ee=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Email Campaign",value:"email"}],te=[{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"}],le=[{title:"Sarah Johnson",value:"sarah_johnson"},{title:"John Smith",value:"john_smith"},{title:"Michael Brown",value:"michael_brown"}],ae=s=>{const t=s.toLowerCase();return t==="qualified"?"success":t==="unqualified"?"error":"primary"},se=s=>{A.value=s,h.value=!0},oe=async()=>{if(d.value.length!==0)try{f.value=!0,(await w.bulkDelete(d.value)).success&&(await _(),await L(),d.value=[])}catch(s){console.error("Error bulk deleting leads:",s),C.value=s.message||"Failed to delete leads"}finally{f.value=!1}},U=n(null),ie=async()=>{if(!U.value){C.value="Please select a CSV file";return}try{f.value=!0,(await w.importCsv(U.value)).success&&(await _(),await L(),x.value=!1,U.value=null)}catch(s){console.error("Error importing CSV:",s),C.value=s.message||"Failed to import CSV"}finally{f.value=!1}},ne=()=>{const s=d.value.length>0?d.value:void 0,t=w.exportCsv(s),u=document.createElement("a");u.href=t,u.download=`leads_${d.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u)},re=s=>{T.value=s,D.value=!0},de=()=>{console.log("Note added successfully")},ue=async()=>{await _(),await L(),h.value=!1,A.value=null},ce=s=>{s&&(U.value=s,ie())},me=Le(),pe=()=>{me.push({name:"sales-add-lead"})};return(s,t)=>{const u=Ve,ve=be,fe=Ue("RouterLink"),_e=ye;return N(),j("section",null,[i("div",Re,[l(O,null,{default:a(()=>[(N(!0),j(Ne,null,$e(o(R),(e,I)=>(N(),q($,{key:I,cols:"12",md:"4",sm:"6"},{default:a(()=>[l(M,null,{default:a(()=>[l(P,null,{default:a(()=>[i("div",je,[i("div",qe,[i("div",Oe,r(e.title),1),i("div",Me,[i("h4",Je,r(e.value),1),i("div",{class:Ae(["text-base",e.change>0?"text-success":"text-error"])}," ("+r(K(e.change))+"%) ",3)])]),l(J,{color:e.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[l(k,{icon:e.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l(M,{class:"mb-6"},{default:a(()=>[l(Ie,{class:"pb-4"},{default:a(()=>[l(Pe,null,{default:a(()=>t[13]||(t[13]=[v("Filters")])),_:1,__:[13]})]),_:1}),l(P,null,{default:a(()=>[l(O,null,{default:a(()=>[l($,{cols:"12",sm:"4"},{default:a(()=>[l(u,{modelValue:o(b),"onUpdate:modelValue":t[0]||(t[0]=e=>c(b)?b.value=e:null),placeholder:"Select Source",items:ee,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l($,{cols:"12",sm:"4"},{default:a(()=>[l(u,{modelValue:o(y),"onUpdate:modelValue":t[1]||(t[1]=e=>c(y)?y.value=e:null),placeholder:"Select Status",items:te,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l($,{cols:"12",sm:"4"},{default:a(()=>[l(u,{modelValue:o(V),"onUpdate:modelValue":t[2]||(t[2]=e=>c(V)?V.value=e:null),placeholder:"Select Owner",items:le,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(Q),l(P,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[i("div",Qe,[l(u,{"model-value":o(m),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":t[3]||(t[3]=e=>m.value=parseInt(e,10))},null,8,["model-value"]),o(d).length>0?(N(),q(S,{key:0,variant:"tonal",color:"error",onClick:oe},{default:a(()=>[l(k,{icon:"tabler-trash",class:"me-2"}),v(" Delete Selected ("+r(o(d).length)+") ",1)]),_:1})):Be("",!0)]),l(Te),i("div",We,[i("div",Ge,[l(ve,{modelValue:o(g),"onUpdate:modelValue":t[4]||(t[4]=e=>c(g)?g.value=e:null),placeholder:"Search Lead"},null,8,["modelValue"])]),l(S,{variant:"tonal",color:"secondary","prepend-icon":"tabler-file-import",onClick:t[5]||(t[5]=e=>x.value=!0)},{default:a(()=>t[14]||(t[14]=[v(" Import ")])),_:1,__:[14]}),l(S,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:ne},{default:a(()=>[v(" Export "+r(o(d).length>0?`(${o(d).length})`:"All"),1)]),_:1}),l(S,{"prepend-icon":"tabler-plus",onClick:pe},{default:a(()=>t[15]||(t[15]=[v(" Add Lead ")])),_:1,__:[15]})])]),_:1}),l(Q),l(ge,{"items-per-page":o(m),"onUpdate:itemsPerPage":t[7]||(t[7]=e=>c(m)?m.value=e:null),"model-value":o(d),"onUpdate:modelValue":t[8]||(t[8]=e=>c(d)?d.value=e:null),page:o(p),"onUpdate:page":t[9]||(t[9]=e=>c(p)?p.value=e:null),items:o(Z),"item-value":"id","items-length":o(B),headers:Y,class:"text-no-wrap","show-select":"","onUpdate:options":H},{"item.index":a(({index:e})=>[i("div",He,r((o(p)-1)*o(m)+e+1),1)]),"item.name":a(({item:e})=>[i("div",Ke,[l(J,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[i("span",null,r(X(`${e.firstName} ${e.lastName}`)),1)]),_:2},1024),i("div",Xe,[l(fe,{to:{name:"sales-leads-id",params:{id:e.id}},class:"text-link"},{default:a(()=>[v(r(e.firstName)+" "+r(e.lastName),1)]),_:2},1032,["to"])])])]),"item.company":a(({item:e})=>[i("div",Ye,r(e.company),1)]),"item.email":a(({item:e})=>[i("div",Ze,r(e.email),1)]),"item.phone":a(({item:e})=>[i("div",et,r(e.phone),1)]),"item.location":a(({item:e})=>[i("div",tt,r(e.city)+", "+r(e.state),1)]),"item.source":a(({item:e})=>[i("div",lt,r(e.source),1)]),"item.status":a(({item:e})=>[l(Fe,{color:ae(e.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[v(r(e.status),1)]),_:2},1032,["color"])]),"item.owner":a(({item:e})=>[i("div",at,r(e.owner),1)]),"item.lastContacted":a(({item:e})=>[i("div",st,r(e.lastContacted),1)]),"item.actions":a(({item:e})=>[l(S,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[l(k,{icon:"tabler-dots-vertical"}),l(ze,{activator:"parent"},{default:a(()=>[l(Ee,null,{default:a(()=>[l(W,{onClick:I=>re(e.id)},{prepend:a(()=>[l(k,{icon:"tabler-note"})]),default:a(()=>[l(G,null,{default:a(()=>t[16]||(t[16]=[v("Add Note")])),_:1,__:[16]})]),_:2},1032,["onClick"]),l(W,{onClick:I=>se(e.id)},{prepend:a(()=>[l(k,{icon:"tabler-trash"})]),default:a(()=>[l(G,null,{default:a(()=>t[17]||(t[17]=[v("Delete")])),_:1,__:[17]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[l(_e,{page:o(p),"onUpdate:page":t[6]||(t[6]=e=>c(p)?p.value=e:null),"items-per-page":o(m),"total-items":o(B)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),l(he,{"is-dialog-visible":o(x),"onUpdate:isDialogVisible":t[10]||(t[10]=e=>c(x)?x.value=e:null),onImport:ce},null,8,["is-dialog-visible"]),l(Ce,{"is-dialog-visible":o(h),"onUpdate:isDialogVisible":t[11]||(t[11]=e=>c(h)?h.value=e:null),"lead-id":o(A),onLeadDeleted:ue},null,8,["is-dialog-visible","lead-id"]),l(xe,{"is-dialog-visible":o(D),"onUpdate:isDialogVisible":t[12]||(t[12]=e=>c(D)?D.value=e:null),"lead-id":o(T)||0,onNoteAdded:de},null,8,["is-dialog-visible","lead-id"])])}}});export{Mt as default};
