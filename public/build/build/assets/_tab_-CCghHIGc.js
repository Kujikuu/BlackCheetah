import{_ as se}from"./AppSelect.vue_vue_type_script_setup_true_lang-Bopsg3-Z.js";import{_ as ee}from"./AppTextField.vue_vue_type_script_setup_true_lang-DhKHFfLG.js";import{aO as M,d as B,r as f,G as ae,g as U,o as x,f as l,b as e,m as t,e as d,l as $,c as S,v as k,a$ as oe,a3 as A,aa as H,t as V,aM as te,aL as O,F as Q,i as X,au as G,u as re,P as ne}from"./main-B7VC7nGg.js";import{a as w,V as I}from"./VRow-MKCJGy0b.js";import{V as Y,a as ue,b as ie}from"./VCard-K7PtDEgU.js";import{V as E}from"./VCardText-HxJsBLuU.js";import{V as de}from"./VAvatar-CzzIEzv4.js";import{V as D,a as me}from"./VAlert-DYm-Op2t.js";import{V as K}from"./VDivider-B1_9QpCE.js";import{V as le}from"./VForm-l3pGfDRl.js";import{V as pe}from"./VTable-BMz0nJLp.js";import{V as W}from"./VCheckbox-CZQRm0ub.js";import{V as ce,a as fe}from"./VTabs-DlcGXalp.js";import{V as J,a as ve}from"./VWindowItem-EZl-FD5_.js";import"./form-BaJ0G7mb.js";import"./VSelect-BpHL1Uj6.js";import"./VTextField-9u7WM2bG.js";/* empty css                   */import"./VCounter-D47buQPS.js";import"./VImg-x37b4dxK.js";import"./VField-CKsqcJ7I.js";import"./easing-Bybner-F.js";import"./VInput-KWRFsiTr.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-Bd7WUxx1.js";import"./ssrBoot-BsNZfR2w.js";import"./dialog-transition-w0331LMc.js";import"./VMenu-DZWhPhiK.js";import"./VOverlay-B389Zf8M.js";import"./lazy-CsDJnHKD.js";import"./scopeId-HadF4ZZN.js";import"./VCheckboxBtn-CpKP5ghU.js";import"./VSelectionControl-BiqwnfVW.js";import"./VChip-elzi0Np-.js";import"./VSlideGroup-CEjzIsTl.js";/* empty css              */const N="/v1/account",C={async getProfile(){return await M(`${N}/profile`,{method:"GET"})},async updateProfile(h){return await M(`${N}/profile`,{method:"PUT",body:h})},async updatePassword(h){return await M(`${N}/password`,{method:"PUT",body:h})},async uploadAvatar(h){const v=new FormData;return v.append("avatar",h),await M(`${N}/avatar`,{method:"POST",body:v})},async deleteAvatar(){return await M(`${N}/avatar`,{method:"DELETE"})},async updateNotificationPreferences(h){return await M(`${N}/notifications`,{method:"PUT",body:{notifications:h}})}},ye={class:"d-flex align-center"},ge={class:"position-relative me-6"},be={key:0,class:"text-5xl font-weight-medium"},_e={key:0,class:"position-absolute top-0 start-0 w-100 h-100 d-flex align-center justify-center",style:{background:"rgba(0,0,0,0.5)","border-radius":"8px"}},we={class:"d-flex flex-column justify-center gap-4"},Ve={class:"d-flex flex-wrap gap-2"},xe=B({__name:"AccountSettingsAccount",setup(h){const v=f(),p=f(!1),y=f(!1),c=f(!1),o=f(null),s=f({avatarImg:"",name:"",email:"",role:"",phone:"",timezone:"(GMT+03:00) Riyadh"}),n=f({type:null,message:""}),r=["(GMT+03:00) Riyadh","(GMT+03:00) Kuwait","(GMT+03:00) Baghdad","(GMT+02:00) Cairo","(GMT+01:00) Amsterdam","(GMT+00:00) London","(GMT-05:00) Eastern Time (US & Canada)","(GMT-08:00) Pacific Time (US & Canada)"],m=async()=>{var i;try{p.value=!0;const a=await C.getProfile();a.success&&(o.value=a.data,s.value={avatarImg:a.data.avatar||"",name:a.data.name,email:a.data.email,role:g(a.data.role),phone:a.data.phone||"",timezone:((i=a.data.preferences)==null?void 0:i.timezone)||"(GMT+03:00) Riyadh"})}catch(a){console.error("Error loading profile:",a)}finally{p.value=!1}},g=i=>({admin:"Administrator",franchisor:"Franchisor",franchisee:"Franchisee",unit_manager:"Unit Manager",sales_associate:"Sales Associate",employee:"Employee"})[i]||i,P=()=>{var i;o.value&&(s.value={avatarImg:o.value.avatar||"",name:o.value.name,email:o.value.email,role:g(o.value.role),phone:o.value.phone||"",timezone:((i=o.value.preferences)==null?void 0:i.timezone)||"(GMT+03:00) Riyadh"})},j=async i=>{var b,L,_;const{files:a}=i.target;if(a&&a.length){const T=a[0];if(T.size>800*1024){n.value={type:"error",message:"File size must be less than 800KB"},setTimeout(()=>n.value={type:null,message:""},5e3);return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(T.type)){n.value={type:"error",message:"Only JPG, PNG, and GIF files are allowed"},setTimeout(()=>n.value={type:null,message:""},5e3);return}try{const R=new FileReader;R.onload=z=>{var Z;s.value.avatarImg=(Z=z.target)==null?void 0:Z.result},R.readAsDataURL(T),c.value=!0,n.value={type:null,message:"Uploading..."};const q=await C.uploadAvatar(T);if(q.success){s.value.avatarImg=q.data.avatar,o.value&&(o.value.avatar=q.data.avatar);const z=O("userData");z.value&&(z.value={...z.value,avatar:q.data.avatar}),n.value={type:"success",message:"Avatar uploaded successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}}catch(R){console.error("Error uploading avatar:",R),n.value={type:"error",message:((L=(b=R.response)==null?void 0:b.data)==null?void 0:L.message)||"Failed to upload avatar"},(_=o.value)!=null&&_.avatar&&(s.value.avatarImg=o.value.avatar),setTimeout(()=>n.value={type:null,message:""},5e3)}finally{c.value=!1}}},F=async()=>{var i,a;try{c.value=!0,n.value={type:null,message:"Removing avatar..."},await C.deleteAvatar(),s.value.avatarImg="",o.value&&(o.value.avatar=null);const b=O("userData");b.value&&(b.value={...b.value,avatar:null}),n.value={type:"success",message:"Avatar removed successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}catch(b){console.error("Error deleting avatar:",b),n.value={type:"error",message:((a=(i=b.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to remove avatar"},setTimeout(()=>n.value={type:null,message:""},5e3)}finally{c.value=!1}},u=async()=>{try{y.value=!0;const i=await C.updateProfile({name:s.value.name,phone:s.value.phone,preferences:{timezone:s.value.timezone}});if(i.success){o.value=i.data;const a=O("userData");a.value&&(a.value={...a.value,name:i.data.name,fullName:i.data.name})}}catch(i){console.error("Error updating profile:",i)}finally{y.value=!1}};return ae(()=>{m()}),(i,a)=>{const b=ee,L=se;return x(),U(I,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(Y,{title:"Profile Details",loading:t(p)},{default:l(()=>[e(E,{class:"d-flex flex-column gap-4"},{default:l(()=>[d("div",ye,[d("div",ge,[e(de,{rounded:"",size:"100",image:t(s).avatarImg},{default:l(()=>[t(s).avatarImg?$("",!0):(x(),S("span",be,k(t(s).name.charAt(0).toUpperCase()),1))]),_:1},8,["image"]),t(c)?(x(),S("div",_e,[e(oe,{indeterminate:"",color:"white",size:"32"})])):$("",!0)]),d("div",we,[d("div",Ve,[e(A,{color:"primary",loading:t(c),disabled:t(p)||t(c),onClick:a[0]||(a[0]=_=>{var T;return(T=t(v))==null?void 0:T.click()})},{default:l(()=>[e(H,{icon:"tabler-cloud-upload",class:"d-sm-none"}),a[7]||(a[7]=d("span",{class:"d-none d-sm-block"},"Upload new photo",-1))]),_:1,__:[7]},8,["loading","disabled"]),d("input",{ref_key:"refInputEl",ref:v,type:"file",name:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:j},null,544),e(A,{type:"reset",color:"secondary",variant:"outlined",loading:t(c),disabled:t(p)||t(c)||!t(s).avatarImg,onClick:F},{default:l(()=>a[8]||(a[8]=[V(" Reset ")])),_:1,__:[8]},8,["loading","disabled"])]),a[9]||(a[9]=d("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1))])]),t(n).message?(x(),U(D,{key:0,type:t(n).type||"info",variant:"tonal",closable:"","onClick:close":a[1]||(a[1]=_=>n.value={type:null,message:""})},{default:l(()=>[V(k(t(n).message),1)]),_:1},8,["type"])):$("",!0)]),_:1}),e(K),e(E,null,{default:l(()=>[e(le,{class:"mt-6"},{default:l(()=>[e(I,null,{default:l(()=>[e(w,{cols:"12",md:"12"},{default:l(()=>[e(b,{modelValue:t(s).name,"onUpdate:modelValue":a[2]||(a[2]=_=>t(s).name=_),label:"Full Name",placeholder:"John Doe"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).email,"onUpdate:modelValue":a[3]||(a[3]=_=>t(s).email=_),label:"Email",type:"email",placeholder:"admin@example.com",readonly:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).role,"onUpdate:modelValue":a[4]||(a[4]=_=>t(s).role=_),label:"Role",placeholder:"Administrator",readonly:""},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).phone,"onUpdate:modelValue":a[5]||(a[5]=_=>t(s).phone=_),label:"Phone Number",placeholder:"+966 50 123 4567"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(L,{modelValue:t(s).timezone,"onUpdate:modelValue":a[6]||(a[6]=_=>t(s).timezone=_),label:"Timezone",items:r,placeholder:"Select Timezone"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[e(A,{loading:t(y),disabled:t(p),onClick:u},{default:l(()=>a[10]||(a[10]=[V(" Save changes ")])),_:1,__:[10]},8,["loading","disabled"]),e(A,{color:"secondary",variant:"outlined",type:"reset",disabled:t(p)||t(y),onClick:te(P,["prevent"])},{default:l(()=>a[11]||(a[11]=[V(" Reset ")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}}),he={class:"text-body-1 text-high-emphasis"},Pe=B({__name:"AccountSettingsNotification",setup(h){const v=f(!1),p=f(!1),y=f(""),c=f([{key:"new_user_registration",type:"New user registration",email:!0,browser:!0,app:!0},{key:"new_technical_request",type:"New technical request",email:!0,browser:!0,app:!0},{key:"technical_request_status_change",type:"Technical request status change",email:!0,browser:!1,app:!0},{key:"new_franchisor_application",type:"New franchisor application",email:!0,browser:!0,app:!1},{key:"payment_received",type:"Payment received",email:!0,browser:!1,app:!1},{key:"system_alerts",type:"System alerts",email:!0,browser:!0,app:!0}]),o=async()=>{var n;try{v.value=!0;const r=await C.getProfile();if(r.success&&((n=r.data.preferences)!=null&&n.notifications)){const m=r.data.preferences.notifications;c.value.forEach(g=>{const P=g.key;m[P]&&(g.email=m[P].email,g.browser=m[P].browser,g.app=m[P].app)})}}catch(r){console.error("Error loading notifications:",r)}finally{v.value=!1}},s=async()=>{try{p.value=!0,y.value="";const n={};c.value.forEach(r=>{const m=r.key;n[m]={email:r.email,browser:r.browser,app:r.app}}),await C.updateNotificationPreferences(n),y.value="Notification preferences saved successfully",setTimeout(()=>{y.value=""},3e3)}catch(n){console.error("Error saving notifications:",n)}finally{p.value=!1}};return ae(()=>{o()}),(n,r)=>(x(),U(I,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(Y,{loading:t(v)},{default:l(()=>[e(ue,null,{default:l(()=>[e(ie,null,{default:l(()=>r[1]||(r[1]=[V("Notification Preferences")])),_:1,__:[1]}),r[2]||(r[2]=d("p",{class:"text-body-1 mb-0"},[V(" Choose how you want to receive notifications. We need permission from your browser to show notifications. "),d("span",{class:"text-primary cursor-pointer"},"Request Permission")],-1))]),_:1,__:[2]}),t(y)?(x(),U(E,{key:0},{default:l(()=>[e(D,{variant:"tonal",color:"success",closable:"","onClick:close":r[0]||(r[0]=m=>y.value="")},{default:l(()=>[V(k(t(y)),1)]),_:1})]),_:1})):$("",!0),e(E,{class:"px-0"},{default:l(()=>[e(K),e(pe,{class:"text-no-wrap rounded"},{default:l(()=>[r[3]||(r[3]=d("thead",null,[d("tr",null,[d("th",{scope:"col"}," Type "),d("th",{scope:"col"}," EMAIL "),d("th",{scope:"col"}," BROWSER "),d("th",{scope:"col"}," APP ")])],-1)),d("tbody",null,[(x(!0),S(Q,null,X(t(c),m=>(x(),S("tr",{key:m.type},[d("td",he,k(m.type),1),d("td",null,[e(W,{modelValue:m.email,"onUpdate:modelValue":g=>m.email=g},null,8,["modelValue","onUpdate:modelValue"])]),d("td",null,[e(W,{modelValue:m.browser,"onUpdate:modelValue":g=>m.browser=g},null,8,["modelValue","onUpdate:modelValue"])]),d("td",null,[e(W,{modelValue:m.app,"onUpdate:modelValue":g=>m.app=g},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1,__:[3]})]),_:1}),e(K),e(E,null,{default:l(()=>[e(A,{loading:t(p),disabled:t(v),onClick:s},{default:l(()=>r[4]||(r[4]=[V(" Save Changes ")])),_:1,__:[4]},8,["loading","disabled"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}}),ke={class:"d-flex flex-column gap-y-2"},Te={class:"text-base"},Ae=B({__name:"AccountSettingsSecurity",setup(h){const v=f(!1),p=f(!1),y=f(!1),c=f(""),o=f(""),s=f(""),n=f(!1),r=f(""),m=f(""),g=["Minimum 8 characters long - the more, the better","At least one lowercase character","At least one uppercase character","At least one number, symbol, or whitespace character"],P=async()=>{var F,u;if(r.value="",m.value="",o.value!==s.value){r.value="New passwords do not match";return}if(o.value.length<8){r.value="Password must be at least 8 characters long";return}try{n.value=!0,await C.updatePassword({current_password:c.value,password:o.value,password_confirmation:s.value}),m.value="Password updated successfully",c.value="",o.value="",s.value=""}catch(i){(u=(F=i.response)==null?void 0:F.data)!=null&&u.message?r.value=i.response.data.message:r.value="Failed to update password. Please try again.",console.error("Error updating password:",i)}finally{n.value=!1}},j=()=>{c.value="",o.value="",s.value="",r.value="",m.value=""};return(F,u)=>{const i=ee;return x(),U(I,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(Y,{title:"Change Password"},{default:l(()=>[e(E,null,{default:l(()=>[t(m)?(x(),U(D,{key:0,variant:"tonal",color:"success",class:"mb-6",closable:"","onClick:close":u[0]||(u[0]=a=>m.value="")},{default:l(()=>[V(k(t(m)),1)]),_:1})):$("",!0),t(r)?(x(),U(D,{key:1,variant:"tonal",color:"error",class:"mb-6",closable:"","onClick:close":u[1]||(u[1]=a=>r.value="")},{default:l(()=>[V(k(t(r)),1)]),_:1})):$("",!0),e(D,{variant:"tonal",color:"warning",class:"mb-6"},{default:l(()=>[e(me,{class:"mb-1"},{default:l(()=>u[8]||(u[8]=[V(" Ensure that these requirements are met ")])),_:1,__:[8]}),u[9]||(u[9]=d("span",null,"Minimum 8 characters long, uppercase & symbol",-1))]),_:1,__:[9]}),e(le,{onSubmit:te(P,["prevent"])},{default:l(()=>[e(I,null,{default:l(()=>[e(w,{cols:"12",md:"6"},{default:l(()=>[e(i,{modelValue:t(c),"onUpdate:modelValue":u[2]||(u[2]=a=>G(c)?c.value=a:null),type:t(v)?"text":"password","append-inner-icon":t(v)?"tabler-eye-off":"tabler-eye",label:"Current Password",placeholder:"············","onClick:appendInner":u[3]||(u[3]=a=>v.value=!t(v))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),e(I,null,{default:l(()=>[e(w,{cols:"12",md:"6"},{default:l(()=>[e(i,{modelValue:t(o),"onUpdate:modelValue":u[4]||(u[4]=a=>G(o)?o.value=a:null),type:t(p)?"text":"password","append-inner-icon":t(p)?"tabler-eye-off":"tabler-eye",label:"New Password",placeholder:"············","onClick:appendInner":u[5]||(u[5]=a=>p.value=!t(p))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(i,{modelValue:t(s),"onUpdate:modelValue":u[6]||(u[6]=a=>G(s)?s.value=a:null),type:t(y)?"text":"password","append-inner-icon":t(y)?"tabler-eye-off":"tabler-eye",label:"Confirm New Password",placeholder:"············","onClick:appendInner":u[7]||(u[7]=a=>y.value=!t(y))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(w,{cols:"12"},{default:l(()=>[u[10]||(u[10]=d("h6",{class:"text-h6 text-medium-emphasis mb-4"}," Password Requirements: ",-1)),d("ul",ke,[(x(),S(Q,null,X(g,a=>d("li",{key:a,class:"d-flex align-center"},[d("div",null,[e(H,{size:"8",icon:"tabler-circle",class:"me-2"}),d("span",Te,k(a),1)])])),64))])]),_:1,__:[10]}),e(w,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[e(A,{type:"submit",loading:t(n)},{default:l(()=>u[11]||(u[11]=[V(" Save changes ")])),_:1,__:[11]},8,["loading"]),e(A,{type:"reset",color:"secondary",variant:"outlined",disabled:t(n),onClick:j},{default:l(()=>u[12]||(u[12]=[V(" Reset ")])),_:1,__:[12]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ma=B({__name:"[tab]",setup(h){const v=re(),p=ne({get:()=>v.params.tab,set:()=>v.params.tab}),y=[{title:"Account",icon:"tabler-user",tab:"account"},{title:"Security",icon:"tabler-lock",tab:"security"},{title:"Notifications",icon:"tabler-bell",tab:"notifications"}];return(c,o)=>(x(),S("div",null,[o[2]||(o[2]=d("div",{class:"mb-6"},[d("h2",{class:"text-h2 mb-1"}," Account Settings "),d("p",{class:"text-body-1 text-medium-emphasis"}," Manage your account preferences and settings ")],-1)),e(fe,{modelValue:t(p),"onUpdate:modelValue":o[0]||(o[0]=s=>G(p)?p.value=s:null),class:"v-tabs-pill"},{default:l(()=>[(x(),S(Q,null,X(y,s=>e(ce,{key:s.icon,value:s.tab,to:{name:"account-settings-tab",params:{tab:s.tab}}},{default:l(()=>[e(H,{size:"20",start:"",icon:s.icon},null,8,["icon"]),V(" "+k(s.title),1)]),_:2},1032,["value","to"])),64))]),_:1},8,["modelValue"]),e(ve,{modelValue:t(p),"onUpdate:modelValue":o[1]||(o[1]=s=>G(p)?p.value=s:null),class:"mt-6 disable-tab-transition",touch:!1},{default:l(()=>[e(J,{value:"account"},{default:l(()=>[e(xe)]),_:1}),e(J,{value:"security"},{default:l(()=>[e(Ae)]),_:1}),e(J,{value:"notifications"},{default:l(()=>[e(Pe)]),_:1})]),_:1},8,["modelValue"])]))}});export{ma as default};
