import{V as De,_ as Be}from"./VDialog-CEq2jzbd.js";import{M as J,L as se,bc as Ne,N as ne,b as e,az as xe,a9 as A,ai as Me,c9 as Ee,P as D,J as We,an as qe,bW as Le,ax as T,ca as Oe,U as Q,aj as je,Q as Ge,q as Ve,V as He,c8 as Ye,bt as Qe,cI as Je,bZ as he,aB as Ke,bY as Ze,c7 as Xe,by as et,F as ue,d as Re,r as I,w as tt,g as U,f as t,e as o,l as ce,m as l,t as g,v as _,aR as j,b5 as le,o as V,G as at,c as H,j as lt,aF as te,i as ke,b3 as Se}from"./main-B8QbR-yS.js";import{f as st}from"./formatters--UtN2sCw.js";import{_ as nt}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-CaQex1Dk.js";import{_ as it}from"./AppTextarea.vue_vue_type_script_setup_true_lang-yoNOmpMf.js";import{_ as ot}from"./AppSelect.vue_vue_type_script_setup_true_lang-DOrgpFkU.js";import{_ as dt}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{r as O,e as rt}from"./validators-BHkKs9Dp.js";import{b as me,d as pe,V as W,a as we}from"./VCard-D9PhtsJ0.js";import{V as B}from"./VCardText-Cbtr6Qhr.js";import{V as ve}from"./VAlert-DpqH6FXl.js";import{c as ut,V as Z}from"./VAvatar-87LH5tAk.js";import{a as fe,m as ct,V as oe,b as mt}from"./VWindowItem-CHtlO5gs.js";import{V as Ue,m as pt}from"./VSheet-DewI9Ub-.js";import{V as de}from"./VDivider-DOfIMbJY.js";import{V as Ce}from"./VForm-C9sxpau4.js";import{V as Y,a as k}from"./VRow-LlT6Azsr.js";import{V as ze}from"./VSpacer-BSXBFFTK.js";import{a as vt,V as Pe}from"./VTabs-DXRKnteB.js";import{S as ft}from"./saudi-riyal-DBg1zXmT.js";import{V as ae}from"./VSkeletonLoader-B4kGuIwi.js";import{V as re}from"./VChip-CgHwmC-k.js";import{V as yt,a as bt}from"./VDataTable-FYAU2aQJ.js";import{V as Ie}from"./VSelect-GSzN3Qps.js";import{V as Ae}from"./VTooltip-D-apmXOm.js";import"./VOverlay-B3La6Ajr.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-DyQ6a1uN.js";import"./VImg-Ceu2Mboj.js";import"./dialog-transition-Dy2Gj1XO.js";import"./VField-Bw51LFql.js";import"./form-Dt-W1fp6.js";import"./VInput-DB3XZUVb.js";import"./VTextarea-1ursQqQ2.js";import"./VTextField-C7_y5spr.js";import"./VList-BJCgULVd.js";/* empty css              */import"./VSlideGroup-BuNiGLv2.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VTable-CgkStP3y.js";import"./VMenu-TQcmpCCv.js";const _e=Symbol.for("vuetify:v-stepper"),Fe=J({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),Vt=se()({name:"VStepperActions",props:Fe(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(s,z){let{emit:u,slots:m}=z;const{t:c}=Ne();function p(){u("click:prev")}function v(){u("click:next")}return ne(()=>{const i={onClick:p},S={onClick:v};return e("div",{class:"v-stepper-actions"},[e(xe,{defaults:{VBtn:{disabled:["prev",!0].includes(s.disabled),text:c(s.prevText),variant:"text"}}},{default:()=>{var x;return[((x=m.prev)==null?void 0:x.call(m,{props:i}))??e(A,i,null)]}}),e(xe,{defaults:{VBtn:{color:s.color,disabled:["next",!0].includes(s.disabled),text:c(s.nextText),variant:"tonal"}}},{default:()=>{var x;return[((x=m.next)==null?void 0:x.call(m,{props:S}))??e(A,S,null)]}})])}),{}}}),Te=ut("v-stepper-header"),_t=J({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:Q,default:"$complete"},editable:Boolean,editIcon:{type:Q,default:"$edit"},error:Boolean,errorIcon:{type:Q,default:"$error"},icon:Q,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),gt=J({..._t(),...Oe()},"VStepperItem"),ye=se()({name:"VStepperItem",directives:{Ripple:Me},props:gt(),emits:{"group:selected":s=>!0},setup(s,z){let{slots:u}=z;const m=Ee(s,_e,!0),c=D(()=>(m==null?void 0:m.value.value)??s.value),p=D(()=>s.rules.every(F=>F()===!0)),v=D(()=>!s.disabled&&s.editable),i=D(()=>!s.disabled&&s.editable),S=D(()=>s.error||!p.value),x=D(()=>s.complete||s.rules.length>0&&p.value),R=D(()=>S.value?s.errorIcon:x.value?s.completeIcon:m.isSelected.value&&s.editable?s.editIcon:s.icon),w=D(()=>({canEdit:i.value,hasError:S.value,hasCompleted:x.value,title:s.title,subtitle:s.subtitle,step:c.value,value:s.value}));return ne(()=>{var C,d,P;const F=(!m||m.isSelected.value||x.value||i.value)&&!S.value&&!s.disabled,N=!!(s.title!=null||u.title),q=!!(s.subtitle!=null||u.subtitle);function L(){m==null||m.toggle()}return We(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":x.value,"v-stepper-item--disabled":s.disabled,"v-stepper-item--error":S.value},m==null?void 0:m.selectedClass.value],disabled:!s.editable,type:"button",onClick:L},[v.value&&Le(!0,"v-stepper-item"),e(Z,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:F?s.color:void 0,size:24},{default:()=>{var h;return[((h=u.icon)==null?void 0:h.call(u,w.value))??(R.value?e(T,{icon:R.value},null):c.value)]}}),e("div",{class:"v-stepper-item__content"},[N&&e("div",{key:"title",class:"v-stepper-item__title"},[((C=u.title)==null?void 0:C.call(u,w.value))??s.title]),q&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((d=u.subtitle)==null?void 0:d.call(u,w.value))??s.subtitle]),(P=u.default)==null?void 0:P.call(u,w.value)])]),[[qe("ripple"),s.ripple&&s.editable,null]])}),{}}}),xt=J({...He(ct(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),$e=se()({name:"VStepperWindow",props:xt(),emits:{"update:modelValue":s=>!0},setup(s,z){let{slots:u}=z;const m=je(_e,null),c=Ge(s,"modelValue"),p=D({get(){var v;return c.value!=null||!m?c.value:(v=m.items.value.find(i=>m.selected.value.includes(i.id)))==null?void 0:v.value},set(v){c.value=v}});return ne(()=>{const v=fe.filterProps(s);return e(fe,Ve({_as:"VStepperWindow"},v,{modelValue:p.value,"onUpdate:modelValue":i=>p.value=i,class:["v-stepper-window",s.class],style:s.style,mandatory:!1,touch:!1}),u)}),{}}}),ht=J({...mt()},"VStepperWindowItem"),be=se()({name:"VStepperWindowItem",props:ht(),setup(s,z){let{slots:u}=z;return ne(()=>{const m=oe.filterProps(s);return e(oe,Ve({_as:"VStepperWindowItem"},m,{class:["v-stepper-window-item",s.class],style:s.style}),u)}),{}}}),kt=J({altLabels:Boolean,bgColor:String,completeIcon:Q,editIcon:Q,editable:Boolean,errorIcon:Q,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...et()},"Stepper"),St=J({...kt(),...Xe({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...pt(),...Ze(Fe(),["prevText","nextText"])},"VStepper"),wt=se()({name:"VStepper",props:St(),emits:{"update:modelValue":s=>!0},setup(s,z){let{slots:u}=z;const{items:m,next:c,prev:p,selected:v}=Ye(s,_e),{displayClasses:i,mobile:S}=Qe(s),{completeIcon:x,editIcon:R,errorIcon:w,color:F,editable:N,prevText:q,nextText:L}=Je(s),C=D(()=>s.items.map((h,M)=>{const E=he(h,s.itemTitle,h),r=he(h,s.itemValue,M+1);return{title:E,value:r,raw:h}})),d=D(()=>m.value.findIndex(h=>v.value.includes(h.id))),P=D(()=>s.disabled?s.disabled:d.value===0?"prev":d.value===m.value.length-1?"next":!1);return Ke({VStepperItem:{editable:N,errorIcon:w,completeIcon:x,editIcon:R,prevText:q,nextText:L},VStepperActions:{color:F,disabled:P,prevText:q,nextText:L}}),ne(()=>{const h=Ue.filterProps(s),M=!!(u.header||s.items.length),E=s.items.length>0,r=!s.hideActions&&!!(E||u.actions);return e(Ue,Ve(h,{color:s.bgColor,class:["v-stepper",{"v-stepper--alt-labels":s.altLabels,"v-stepper--flat":s.flat,"v-stepper--non-linear":s.nonLinear,"v-stepper--mobile":S.value},i.value,s.class],style:s.style}),{default:()=>{var G,X;return[M&&e(Te,{key:"stepper-header"},{default:()=>[C.value.map(($,K)=>{let{raw:ee,...ie}=$;return e(ue,null,[!!K&&e(de,null,null),e(ye,ie,{default:u[`header-item.${ie.value}`]??u.header,icon:u.icon,title:u.title,subtitle:u.subtitle})])})]}),E&&e($e,{key:"stepper-window"},{default:()=>[C.value.map($=>e(be,{value:$.value},{default:()=>{var K,ee;return((K=u[`item.${$.value}`])==null?void 0:K.call(u,$))??((ee=u.item)==null?void 0:ee.call(u,$))}}))]}),(G=u.default)==null?void 0:G.call(u,{prev:p,next:c}),r&&(((X=u.actions)==null?void 0:X.call(u,{next:c,prev:p}))??e(Vt,{key:"stepper-actions","onClick:prev":p,"onClick:next":c},u))]}})}),{prev:p,next:c}}}),Ut={class:"d-flex gap-3"},Ct=Re({__name:"AddFranchiseeModal",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchiseeAdded"],setup(s,{emit:z}){const u=s,m=z,c=I(1),p=I(!1),v=I(null),i=I({name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),S=[{title:"Saudi Arabia",value:"SA"},{title:"United Arab Emirates",value:"AE"},{title:"Qatar",value:"QA"},{title:"Kuwait",value:"KW"},{title:"Oman",value:"OM"},{title:"Bahrain",value:"BH"},{title:"Jordan",value:"JO"},{title:"Lebanon",value:"LB"},{title:"Egypt",value:"EG"},{title:"Iraq",value:"IQ"}],x=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}],R=()=>{c.value=1,v.value=null,i.value={name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},w=C=>{m("update:isDialogVisible",C)},F=()=>{c.value<2&&(c.value++,v.value=null)},N=()=>{c.value>1&&(c.value--,v.value=null)};tt(()=>u.isDialogVisible,C=>{C&&R()});const q=async()=>{var C,d,P;if(!i.value.name||!i.value.email||!i.value.phone){v.value="Please fill in all required fields";return}p.value=!0,v.value=null;try{const h=await le("/v1/franchisor/franchise"),M=((C=h.data)==null?void 0:C.id)||h.id,E={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:M,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,country:i.value.country,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},r=await le("/v1/franchisor/franchisees-with-unit",{method:"POST",body:E});if(r.success){const G={id:r.data.unit.id,name:r.data.unit.unit_name,email:r.data.franchisee.email,phone:r.data.franchisee.phone,type:r.data.unit.unit_type,sizeSqft:r.data.unit.size_sqft,capacity:null,openingDate:r.data.unit.opening_date,monthlyRent:r.data.unit.monthly_rent,managerId:r.data.unit.franchisee_id,managerName:r.data.franchisee.name,country:r.data.unit.country,state:r.data.unit.state_province,city:r.data.unit.city,address:r.data.unit.address,postalCode:r.data.unit.postal_code};m("franchiseeAdded",G),w(!1),R()}}catch(h){console.error("Error creating franchisee with unit:",h),v.value=((P=(d=h.response)==null?void 0:d.data)==null?void 0:P.message)||"Failed to create franchisee and unit. Please try again."}finally{p.value=!1}},L=C=>{m("update:isDialogVisible",C),C||R()};return(C,d)=>{const P=dt,h=ot,M=it,E=nt;return V(),U(De,{"model-value":u.isDialogVisible,"max-width":"800","onUpdate:modelValue":L},{default:t(()=>[e(W,null,{default:t(()=>[e(me,{class:"text-center"},{default:t(()=>d[15]||(d[15]=[o("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[15]}),e(B,null,{default:t(()=>[l(v)?(V(),U(ve,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":d[0]||(d[0]=r=>v.value=null)},{default:t(()=>[g(_(l(v)),1)]),_:1})):ce("",!0),e(wt,{modelValue:l(c),"onUpdate:modelValue":d[13]||(d[13]=r=>j(c)?c.value=r:null),"alt-labels":""},{default:t(()=>[e(Te,null,{default:t(()=>[e(ye,{complete:l(c)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(de),e(ye,{value:2,title:"Unit Details"})]),_:1}),e($e,null,{default:t(()=>[e(be,{value:1},{default:t(()=>[e(Ce,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(P,{modelValue:l(i).name,"onUpdate:modelValue":d[1]||(d[1]=r=>l(i).name=r),label:"Branch Name",placeholder:"Enter Branch name",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(P,{modelValue:l(i).email,"onUpdate:modelValue":d[2]||(d[2]=r=>l(i).email=r),label:"Email Address",placeholder:"Enter email address",rules:[l(O),l(rt)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(P,{modelValue:l(i).phone,"onUpdate:modelValue":d[3]||(d[3]=r=>l(i).phone=r),label:"Contact Number",placeholder:"Enter contact number",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(h,{modelValue:l(i).country,"onUpdate:modelValue":d[4]||(d[4]=r=>l(i).country=r),items:S,label:"Country",placeholder:"Select country",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(P,{modelValue:l(i).state,"onUpdate:modelValue":d[5]||(d[5]=r=>l(i).state=r),label:"State",placeholder:"Enter state",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(P,{modelValue:l(i).city,"onUpdate:modelValue":d[6]||(d[6]=r=>l(i).city=r),label:"City",placeholder:"Enter city",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12"},{default:t(()=>[e(M,{modelValue:l(i).address,"onUpdate:modelValue":d[7]||(d[7]=r=>l(i).address=r),label:"Address",placeholder:"Enter full address",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12"},{default:t(()=>[e(ve,{type:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[o("strong",null,_(l(i).name||"New franchisee"),1),d[16]||(d[16]=g(" will be automatically assigned as the unit manager. "))]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{value:2},{default:t(()=>[e(Ce,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(k,{cols:"12",md:"6"},{default:t(()=>[e(h,{modelValue:l(i).type,"onUpdate:modelValue":d[8]||(d[8]=r=>l(i).type=r),items:x,label:"Unit Type",placeholder:"Select unit type",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(E,{modelValue:l(i).openingDate,"onUpdate:modelValue":d[9]||(d[9]=r=>l(i).openingDate=r),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(P,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":d[10]||(d[10]=r=>l(i).sizeSqft=r),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(P,{modelValue:l(i).capacity,"onUpdate:modelValue":d[11]||(d[11]=r=>l(i).capacity=r),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(P,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":d[12]||(d[12]=r=>l(i).monthlyRent=r),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"SAR"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(pe,{class:"justify-space-between pa-6"},{default:t(()=>[l(c)>1?(V(),U(A,{key:0,variant:"outlined",disabled:l(p),onClick:N},{default:t(()=>d[17]||(d[17]=[g(" Previous ")])),_:1,__:[17]},8,["disabled"])):(V(),U(ze,{key:1})),o("div",Ut,[e(A,{variant:"outlined",disabled:l(p),onClick:d[14]||(d[14]=r=>w(!1))},{default:t(()=>d[18]||(d[18]=[g(" Cancel ")])),_:1,__:[18]},8,["disabled"]),l(c)<2?(V(),U(A,{key:0,color:"primary",disabled:l(p),onClick:F},{default:t(()=>d[19]||(d[19]=[g(" Next ")])),_:1,__:[19]},8,["disabled"])):(V(),U(A,{key:1,color:"primary",loading:l(p),disabled:l(p),onClick:q},{default:t(()=>d[20]||(d[20]=[g(" Create Unit ")])),_:1,__:[20]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Pt={class:"d-flex align-center justify-space-between"},It={class:"ms-4"},At={class:"text-h4"},Dt={key:1},Rt={class:"ms-4"},zt={class:"text-h4"},Ft={key:1},Tt={class:"ms-4"},$t={class:"text-h4"},Bt={key:1},Nt={class:"ms-4"},Mt={class:"text-h4"},Et={key:1},Wt={class:"text-center py-8"},qt={class:"d-flex align-center justify-space-between mb-3"},Lt={class:"text-h6"},Ot={class:"mb-2"},jt={class:"text-body-1"},Gt={class:"mb-2"},Ht={class:"text-body-2"},Yt={class:"mb-3"},Qt={class:"text-body-1 font-weight-medium"},Jt={class:"text-center"},Kt={class:"text-center"},Zt={class:"d-flex align-center gap-x-3"},Xt={class:"text-base font-weight-medium"},ea={class:"text-body-2 text-disabled"},ta={class:"text-body-1 font-weight-medium"},aa={class:"text-body-2 text-disabled"},la={class:"text-body-1"},sa={class:"text-body-2 text-disabled"},na={class:"text-body-2 text-disabled"},ia={class:"text-body-2 text-disabled"},oa={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},da={class:"text-sm text-disabled mb-0"},ra={class:"d-flex align-center",style:{"inline-size":"8rem"}},Za=Re({__name:"my-units",setup(s){const z=(f,a,y)=>{const n=(f-1)*a+1,b=Math.min(f*a,y);return`Showing ${n} to ${b} of ${y} entries`},u=lt(),m=I("overview"),c=I([]),p=I(!1),v=I(null),i=I(1),S=I(10);I(0);const x=I(!1),R=I(null),w=I(""),F=I({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),N=I(!1),q=D(()=>F.value.totalUnits||c.value.length),L=D(()=>F.value.activeUnits||c.value.filter(f=>f.status==="active").length),C=D(()=>F.value.pendingUnits||c.value.filter(f=>f.status==="pending").length),d=D(()=>F.value.monthlyRoyalty),P=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],h=[{title:"Planning",value:"planning"},{title:"Construction",value:"construction"},{title:"Training",value:"training"},{title:"Active",value:"active"},{title:"Pending",value:"pending"},{title:"Temporarily Closed",value:"temporarily_closed"},{title:"Permanently Closed",value:"permanently_closed"}],M=f=>f==="active"?"success":f==="pending"?"warning":f==="inactive"?"error":"secondary",E=async()=>{var f;p.value=!0,v.value=null;try{const a=await le("/v1/franchisor/units");a.success&&a.data.data?c.value=a.data.data.map(y=>{var n,b,ge;return{id:y.id,branchName:y.unit_name||"Unnamed Unit",franchiseeName:((n=y.franchisee)==null?void 0:n.name)||"Unassigned",email:((b=y.franchisee)==null?void 0:b.email)||y.email||"unassigned@example.com",contactNumber:((ge=y.franchisee)==null?void 0:ge.phone)||y.phone||"Not available",address:y.address||"Address not available",city:y.city||"Unknown",state:y.state_province||"Unknown",country:y.country||"Unknown",royaltyPercentage:8.5,contractStartDate:y.lease_start_date||"2024-01-01",renewalDate:y.lease_end_date||"2027-01-01",status:y.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:y.employee_count||0,totalProducts:0,avgRating:0}}):c.value=[]}catch(a){console.error("Failed to load units data:",a),v.value=((f=a==null?void 0:a.data)==null?void 0:f.message)||"Failed to load units data",c.value=[]}finally{p.value=!1}},r=async()=>{var f,a,y,n;try{const b=await le("/v1/franchisor/units/statistics");b.success&&b.data&&(F.value={totalUnits:b.data.totalUnits||0,activeUnits:b.data.activeUnits||0,pendingUnits:b.data.pendingUnits||0,inactiveUnits:b.data.inactiveUnits||0,totalRevenue:b.data.totalRevenue||0,monthlyRoyalty:b.data.monthlyRoyalty||0,avgRevenuePerUnit:b.data.avgRevenuePerUnit||0,revenueChange:b.data.revenueChange||0,royaltyRate:b.data.royaltyRate||8.5,taskStats:{total:((f=b.data.taskStats)==null?void 0:f.total)||0,completed:((a=b.data.taskStats)==null?void 0:a.completed)||0,pending:((y=b.data.taskStats)==null?void 0:y.pending)||0,completionRate:((n=b.data.taskStats)==null?void 0:n.completionRate)||0}})}catch(b){console.error("Failed to load statistics data:",b)}},G=async()=>{await Promise.all([E(),r()])},X=f=>{u.push(`/franchisor/units/${f}`)},$=()=>{N.value=!0},K=f=>{G()};at(()=>{G()});const ee=f=>{R.value=f,w.value=f.status,x.value=!0},ie=async()=>{var f;if(!(!R.value||!w.value))try{if((await le(`/v1/units/${R.value.id}/status`,{method:"PATCH",body:{status:w.value}})).success){const y=c.value.findIndex(n=>n.id===R.value.id);y!==-1&&(c.value[y].status=w.value),x.value=!1,R.value=null,w.value="",await r()}}catch(a){console.error("Failed to change unit status:",a),v.value=((f=a==null?void 0:a.data)==null?void 0:f.message)||"Failed to change unit status"}};return(f,a)=>{const y=Be;return V(),H("section",null,[e(Y,{class:"mb-6"},{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[o("div",Pt,[a[14]||(a[14]=o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Units "),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[13]||(a[13]=[g(" Add Franchisee ")])),_:1,__:[13]},8,["loading"])])]),_:1})]),_:1}),l(v)?(V(),U(ve,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":a[0]||(a[0]=n=>v.value=null)},{default:t(()=>[g(_(l(v)),1)]),_:1})):ce("",!0),e(vt,{modelValue:l(m),"onUpdate:modelValue":a[1]||(a[1]=n=>j(m)?m.value=n:null),class:"mb-6"},{default:t(()=>[e(Pe,{value:"overview"},{default:t(()=>[e(T,{icon:"tabler-dashboard",start:""}),a[15]||(a[15]=g(" Overview "))]),_:1,__:[15]}),e(Pe,{value:"units"},{default:t(()=>[e(T,{icon:"tabler-building-store",start:""}),a[16]||(a[16]=g(" All Units "))]),_:1,__:[16]})]),_:1},8,["modelValue"]),e(fe,{modelValue:l(m),"onUpdate:modelValue":a[7]||(a[7]=n=>j(m)?m.value=n:null),class:"disable-tab-transition"},{default:t(()=>[e(oe,{value:"overview"},{default:t(()=>[e(Y,{class:"mb-6"},{default:t(()=>[e(k,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-building-store",size:"26"})]),_:1}),o("div",It,[a[17]||(a[17]=o("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),o("h4",At,[l(p)?(V(),U(te,{key:0,indeterminate:"",size:"20"})):(V(),H("span",Dt,_(l(q)),1))])])]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-check",size:"26"})]),_:1}),o("div",Rt,[a[18]||(a[18]=o("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),o("h4",zt,[l(p)?(V(),U(te,{key:0,indeterminate:"",size:"20"})):(V(),H("span",Ft,_(l(L)),1))])])]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",Tt,[a[19]||(a[19]=o("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),o("h4",$t,[l(p)?(V(),U(te,{key:0,indeterminate:"",size:"20"})):(V(),H("span",Bt,_(l(C)),1))])])]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:t(()=>[e(l(ft),{size:"26"})]),_:1}),o("div",Nt,[a[20]||(a[20]=o("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),o("h4",Mt,[l(p)?(V(),U(te,{key:0,indeterminate:"",size:"20"})):(V(),H("span",Et,_(l(st)(l(d))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(we,{class:"pb-4"},{append:t(()=>[e(A,{variant:"text",color:"primary",onClick:a[2]||(a[2]=n=>m.value="units")},{default:t(()=>a[22]||(a[22]=[g(" View All ")])),_:1,__:[22]})]),default:t(()=>[e(me,null,{default:t(()=>a[21]||(a[21]=[g("Recent Units")])),_:1,__:[21]})]),_:1}),e(B,null,{default:t(()=>[l(p)?(V(),U(Y,{key:0},{default:t(()=>[(V(),H(ue,null,ke(3,n=>e(k,{key:n,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e(B,null,{default:t(()=>[e(ae,{type:"text",class:"mb-3"}),e(ae,{type:"text",class:"mb-2"}),e(ae,{type:"text",class:"mb-2"}),e(ae,{type:"text",class:"mb-3"}),e(ae,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(c).length===0?(V(),U(Y,{key:1},{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[o("div",Wt,[e(T,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),a[24]||(a[24]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[25]||(a[25]=o("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",onClick:$},{default:t(()=>a[23]||(a[23]=[g(" Add Your First Unit ")])),_:1,__:[23]})])]),_:1})]),_:1})):(V(),U(Y,{key:2},{default:t(()=>[(V(!0),H(ue,null,ke(l(c).slice(0,3),n=>(V(),U(k,{key:n.id,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e(B,null,{default:t(()=>[o("div",qt,[o("h6",Lt,_(n.branchName),1),e(re,{color:M(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[g(_(n.status),1)]),_:2},1032,["color"])]),o("div",Ot,[a[26]||(a[26]=o("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),o("div",jt,_(n.franchiseeName),1)]),o("div",Gt,[a[27]||(a[27]=o("div",{class:"text-body-2 text-disabled"}," Location ",-1)),o("div",Ht,_(n.city)+", "+_(n.state),1)]),o("div",Yt,[a[28]||(a[28]=o("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),o("div",Qt,_(n.royaltyPercentage)+"% ",1)])]),_:2},1024),e(pe,null,{default:t(()=>[e(A,{variant:"text",color:"primary",onClick:b=>X(n.id)},{default:t(()=>a[29]||(a[29]=[g(" View Details ")])),_:2,__:[29]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(oe,{value:"units"},{default:t(()=>[e(W,null,{default:t(()=>[e(we,{class:"pb-4"},{append:t(()=>[e(A,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[31]||(a[31]=[g(" Add Franchisee ")])),_:1,__:[31]},8,["loading"])]),default:t(()=>[e(me,null,{default:t(()=>a[30]||(a[30]=[g("All Franchise Units")])),_:1,__:[30]})]),_:1}),e(de),l(p)?(V(),U(B,{key:0,class:"py-8"},{default:t(()=>[o("div",Jt,[e(te,{indeterminate:"",size:"48",class:"mb-4"}),a[32]||(a[32]=o("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),a[33]||(a[33]=o("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(c).length===0?(V(),U(B,{key:1,class:"py-8"},{default:t(()=>[o("div",Kt,[e(T,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),a[35]||(a[35]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[36]||(a[36]=o("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(A,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:$},{default:t(()=>a[34]||(a[34]=[g(" Add Your First Franchisee & Unit ")])),_:1,__:[34]})])]),_:1})):(V(),U(yt,{key:2,items:l(c),headers:P,class:"text-no-wrap","item-value":"id","items-per-page":l(S),page:l(i),"onUpdate:itemsPerPage":a[5]||(a[5]=n=>S.value=n),"onUpdate:page":a[6]||(a[6]=n=>i.value=n)},{"item.branchInfo":t(({item:n})=>[o("div",Zt,[e(Z,{size:"34",color:"primary",variant:"tonal"},{default:t(()=>[e(T,{icon:"tabler-building-store",size:"20"})]),_:1}),o("div",null,[o("h6",Xt,_(n.branchName),1),o("div",ea,_(n.email),1)])])]),"item.franchisee":t(({item:n})=>[o("div",null,[o("div",ta,_(n.franchiseeName),1),o("div",aa,[e(T,{icon:"tabler-user-check",size:"14",class:"me-1"}),g(" Unit Manager • "+_(n.contactNumber),1)])])]),"item.location":t(({item:n})=>[o("div",null,[o("div",la,_(n.city)+", "+_(n.state),1),o("div",sa,_(n.country),1)])]),"item.royaltyPercentage":t(({item:n})=>[n.royaltyPercentage>0?(V(),U(re,{key:0,color:"primary",size:"small",class:"mt-1"},{default:t(()=>[g(_(n.royaltyPercentage)+"% Royalty ",1)]),_:2},1024)):ce("",!0)]),"item.contractPeriod":t(({item:n})=>[o("div",null,[o("div",na," Start: "+_(n.contractStartDate),1),o("div",ia," Renewal: "+_(n.renewalDate),1)])]),"item.status":t(({item:n})=>[e(re,{color:M(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[g(_(n.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:n})=>[e(A,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:Se(b=>X(n.id),["stop"])},{default:t(()=>[e(T,{icon:"tabler-eye"}),e(Ae,{activator:"parent"},{default:t(()=>a[37]||(a[37]=[g(" View Unit Details ")])),_:1,__:[37]})]),_:2},1032,["onClick"]),e(A,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:Se(b=>ee(n),["stop"])},{default:t(()=>[e(T,{icon:"tabler-edit"}),e(Ae,{activator:"parent"},{default:t(()=>a[38]||(a[38]=[g(" Change Status ")])),_:1,__:[38]})]),_:2},1032,["onClick"])]),bottom:t(()=>[e(de),o("div",oa,[o("p",da,_(z(l(i),l(S),l(c).length)),1),e(bt,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=n=>j(i)?i.value=n:null),length:Math.ceil(l(c).length/l(S)),"total-visible":f.$vuetify.display.xs?1:Math.min(Math.ceil(l(c).length/l(S)),5)},null,8,["modelValue","length","total-visible"]),o("div",ra,[a[39]||(a[39]=o("span",{class:"text-no-wrap me-3"},"Rows per page:",-1)),e(Ie,{modelValue:l(S),"onUpdate:modelValue":a[4]||(a[4]=n=>j(S)?S.value=n:null),density:"compact",variant:"outlined",items:[5,10,25,50,100]},null,8,["modelValue"])])])]),_:1},8,["items","items-per-page","page"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ct,{"is-dialog-visible":l(N),"onUpdate:isDialogVisible":a[8]||(a[8]=n=>j(N)?N.value=n:null),onFranchiseeAdded:K},null,8,["is-dialog-visible"]),e(De,{modelValue:l(x),"onUpdate:modelValue":a[12]||(a[12]=n=>j(x)?x.value=n:null),"max-width":"600"},{default:t(()=>[e(y,{onClick:a[9]||(a[9]=n=>x.value=!1)}),e(W,{title:"Change Unit Status"},{default:t(()=>[e(B,null,{default:t(()=>[e(Ie,{modelValue:l(w),"onUpdate:modelValue":a[10]||(a[10]=n=>j(w)?w.value=n:null),label:"Status",items:h,placeholder:"Select Status"},null,8,["modelValue"])]),_:1}),e(pe,null,{default:t(()=>{var n;return[e(ze),e(A,{color:"secondary",variant:"tonal",onClick:a[11]||(a[11]=b=>x.value=!1)},{default:t(()=>a[40]||(a[40]=[g(" Cancel ")])),_:1,__:[40]}),e(A,{color:"primary",disabled:!l(w)||l(w)===((n=l(R))==null?void 0:n.status),onClick:ie},{default:t(()=>a[41]||(a[41]=[g(" Update Status ")])),_:1,__:[41]},8,["disabled"])]}),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Za as default};
