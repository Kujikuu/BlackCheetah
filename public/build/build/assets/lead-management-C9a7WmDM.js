import{V as J,_ as Ce}from"./VDialog-CEq2jzbd.js";import{V as we,_ as ke}from"./VDataTableServer-2Q8oqYfo.js";import{_ as he}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{_ as Se}from"./AppSelect.vue_vue_type_script_setup_true_lang-DOrgpFkU.js";import{_ as Le}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-yqeAcrUb.js";import{l as w}from"./lead-6Frh_D17.js";import{d as Ue,r as i,P as De,w as $e,G as Ae,c as W,e as n,b as l,f as a,aR as m,m as s,j as Ne,a as Ee,o as I,F as Ie,i as Be,g as Q,v as d,x as Fe,ax as D,t as c,l as Pe,a9 as p}from"./main-B8QbR-yS.js";import{V as G,a as B}from"./VRow-LlT6Azsr.js";import{V as F,a as Re,b as Te,d as H}from"./VCard-D9PhtsJ0.js";import{V as $}from"./VCardText-Cbtr6Qhr.js";import{V as K}from"./VAvatar-87LH5tAk.js";import{V as X}from"./VDivider-DOfIMbJY.js";import{V as T}from"./VSpacer-BSXBFFTK.js";import{V as ze}from"./VMenu-TQcmpCCv.js";import{V as je,a as Y,b as Z}from"./VList-BJCgULVd.js";import{V as Oe}from"./VChip-CgHwmC-k.js";import{V as qe}from"./VFileInput-Ip2n4ssl.js";import"./VOverlay-B3La6Ajr.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-DyQ6a1uN.js";import"./VImg-Ceu2Mboj.js";import"./dialog-transition-Dy2Gj1XO.js";import"./VDataTable-FYAU2aQJ.js";import"./VSelect-GSzN3Qps.js";import"./VTextField-C7_y5spr.js";import"./VField-Bw51LFql.js";import"./form-Dt-W1fp6.js";import"./VInput-DB3XZUVb.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VTable-CgkStP3y.js";import"./AppTextarea.vue_vue_type_script_setup_true_lang-yoNOmpMf.js";import"./VTextarea-1ursQqQ2.js";import"./VForm-C9sxpau4.js";/* empty css              */import"./VSlideGroup-BuNiGLv2.js";const Me={class:"d-flex mb-6"},Je={class:"d-flex justify-space-between"},We={class:"d-flex flex-column gap-y-1"},Qe={class:"text-body-1 text-high-emphasis"},Ge={class:"d-flex gap-x-2 align-center"},He={class:"text-h4"},Ke={class:"me-3 d-flex gap-3"},Xe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ye={style:{"inline-size":"15.625rem"}},Ze={class:"text-body-1 font-weight-medium"},et={class:"d-flex align-center gap-x-4"},tt={class:"d-flex flex-column"},lt={class:"text-body-1"},at={class:"text-body-1"},ot={class:"text-body-1"},st={class:"text-body-1"},nt={class:"text-body-1 text-capitalize"},it={class:"text-body-1"},rt={class:"text-body-1"},dt={class:"mb-4"},Qt=Ue({__name:"lead-management",setup(ut){const k=i(""),h=i(),S=i(),L=i(),A=i(!1),z=i(null),y=i(!1),g=i(!1),b=i(null),V=i(!1),C=i(null),f=i(10),v=i(1),j=i(),O=i(),u=i([]),ee=o=>{var e,r;j.value=(e=o.sortBy[0])==null?void 0:e.key,O.value=(r=o.sortBy[0])==null?void 0:r.order,U()},te=o=>o>0?`+${o}`:o,le=o=>o.split(" ").map(e=>e[0]).join("").toUpperCase(),ae=[{title:"#",key:"index",sortable:!1},{title:"Lead Name",key:"name"},{title:"Company",key:"company"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Location",key:"location"},{title:"Source",key:"source"},{title:"Status",key:"status"},{title:"Owner",key:"owner"},{title:"Last Contacted",key:"lastContacted"},{title:"Actions",key:"actions",sortable:!1}],N=i([]),E=i(0),q=i([]),oe=De(()=>N.value),U=async()=>{try{V.value=!0,C.value=null;const o=await w.getLeads({status:h.value,source:S.value,owner:L.value,search:k.value,itemsPerPage:f.value,page:v.value,sortBy:j.value,orderBy:O.value});o.success&&(N.value=o.leads,E.value=o.total)}catch(o){C.value=o.message||"Failed to fetch leads",console.error("Error fetching leads:",o)}finally{V.value=!1}},P=async()=>{try{const o=await w.getStatistics();o.success&&(q.value=o.data)}catch(o){console.error("Error fetching statistics:",o)}};$e([k,h,S,L,v,f],()=>{U()}),Ae(()=>{U(),P()});const se=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Email Campaign",value:"email"}],ne=[{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"}],ie=[{title:"Sarah Johnson",value:"sarah_johnson"},{title:"John Smith",value:"john_smith"},{title:"Michael Brown",value:"michael_brown"}],re=o=>{const e=o.toLowerCase();return e==="qualified"?"success":e==="unqualified"?"error":"primary"},de=o=>{b.value=o,g.value=!0},ue=async()=>{if(b.value!==null)try{if(V.value=!0,(await w.deleteLead(b.value)).success){const e=N.value.findIndex(_=>_.id===b.value);e!==-1&&N.value.splice(e,1);const r=u.value.findIndex(_=>_===b.value);r!==-1&&u.value.splice(r,1),E.value--}}catch(o){console.error("Error deleting lead:",o),C.value=o.message||"Failed to delete lead"}finally{V.value=!1,g.value=!1,b.value=null}},ce=async()=>{if(u.value.length!==0)try{V.value=!0,(await w.bulkDelete(u.value)).success&&(await U(),await P(),u.value=[])}catch(o){console.error("Error bulk deleting leads:",o),C.value=o.message||"Failed to delete leads"}finally{V.value=!1}},x=i(null),me=o=>{const e=o.target;e.files&&e.files[0]&&(x.value=e.files[0])},pe=()=>{const o=`First Name,Last Name,Email,Phone,Company,Country,State,City,Lead Source,Lead Status,Lead Owner
John,Doe,john.doe@example.com,+1234567890,Example Corp,USA,California,Los Angeles,Website,qualified,Sarah Johnson`,e=new Blob([o],{type:"text/csv"}),r=window.URL.createObjectURL(e),_=document.createElement("a");_.href=r,_.download="leads_example.csv",_.click(),window.URL.revokeObjectURL(r)},fe=async()=>{if(!x.value){C.value="Please select a CSV file";return}try{V.value=!0,(await w.importCsv(x.value)).success&&(await U(),await P(),y.value=!1,x.value=null)}catch(o){console.error("Error importing CSV:",o),C.value=o.message||"Failed to import CSV"}finally{V.value=!1}},ve=()=>{const o=u.value.length>0?u.value:void 0,e=w.exportCsv(o),r=document.createElement("a");r.href=e,r.download=`leads_${u.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},_e=o=>{z.value=o,A.value=!0},Ve=()=>{console.log("Note added successfully")},ye=Ne(),ge=()=>{ye.push({name:"sales-add-lead"})};return(o,e)=>{const r=Se,_=he,xe=Ee("RouterLink"),be=ke,M=Ce;return I(),W("section",null,[n("div",Me,[l(G,null,{default:a(()=>[(I(!0),W(Ie,null,Be(s(q),(t,R)=>(I(),Q(B,{key:R,cols:"12",md:"4",sm:"6"},{default:a(()=>[l(F,null,{default:a(()=>[l($,null,{default:a(()=>[n("div",Je,[n("div",We,[n("div",Qe,d(t.title),1),n("div",Ge,[n("h4",He,d(t.value),1),n("div",{class:Fe(["text-base",t.change>0?"text-success":"text-error"])}," ("+d(te(t.change))+"%) ",3)])]),l(K,{color:t.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[l(D,{icon:t.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l(F,{class:"mb-6"},{default:a(()=>[l(Re,{class:"pb-4"},{default:a(()=>[l(Te,null,{default:a(()=>e[18]||(e[18]=[c("Filters")])),_:1,__:[18]})]),_:1}),l($,null,{default:a(()=>[l(G,null,{default:a(()=>[l(B,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(S),"onUpdate:modelValue":e[0]||(e[0]=t=>m(S)?S.value=t:null),placeholder:"Select Source",items:se,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(B,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(h),"onUpdate:modelValue":e[1]||(e[1]=t=>m(h)?h.value=t:null),placeholder:"Select Status",items:ne,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(B,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(L),"onUpdate:modelValue":e[2]||(e[2]=t=>m(L)?L.value=t:null),placeholder:"Select Owner",items:ie,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(X),l($,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[n("div",Ke,[l(r,{"model-value":s(f),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=parseInt(t,10))},null,8,["model-value"]),s(u).length>0?(I(),Q(p,{key:0,variant:"tonal",color:"error",onClick:ce},{default:a(()=>[l(D,{icon:"tabler-trash",class:"me-2"}),c(" Delete Selected ("+d(s(u).length)+") ",1)]),_:1})):Pe("",!0)]),l(T),n("div",Xe,[n("div",Ye,[l(_,{modelValue:s(k),"onUpdate:modelValue":e[4]||(e[4]=t=>m(k)?k.value=t:null),placeholder:"Search Lead"},null,8,["modelValue"])]),l(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-file-import",onClick:e[5]||(e[5]=t=>y.value=!0)},{default:a(()=>e[19]||(e[19]=[c(" Import ")])),_:1,__:[19]}),l(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:ve},{default:a(()=>[c(" Export "+d(s(u).length>0?`(${s(u).length})`:"All"),1)]),_:1}),l(p,{"prepend-icon":"tabler-plus",onClick:ge},{default:a(()=>e[20]||(e[20]=[c(" Add Lead ")])),_:1,__:[20]})])]),_:1}),l(X),l(we,{"items-per-page":s(f),"onUpdate:itemsPerPage":e[7]||(e[7]=t=>m(f)?f.value=t:null),"model-value":s(u),"onUpdate:modelValue":e[8]||(e[8]=t=>m(u)?u.value=t:null),page:s(v),"onUpdate:page":e[9]||(e[9]=t=>m(v)?v.value=t:null),items:s(oe),"item-value":"id","items-length":s(E),headers:ae,class:"text-no-wrap","show-select":"","onUpdate:options":ee},{"item.index":a(({index:t})=>[n("div",Ze,d((s(v)-1)*s(f)+t+1),1)]),"item.name":a(({item:t})=>[n("div",et,[l(K,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[n("span",null,d(le(`${t.firstName} ${t.lastName}`)),1)]),_:2},1024),n("div",tt,[l(xe,{to:{name:"sales-leads-id",params:{id:t.id}},class:"text-link"},{default:a(()=>[c(d(t.firstName)+" "+d(t.lastName),1)]),_:2},1032,["to"])])])]),"item.company":a(({item:t})=>[n("div",lt,d(t.company),1)]),"item.email":a(({item:t})=>[n("div",at,d(t.email),1)]),"item.phone":a(({item:t})=>[n("div",ot,d(t.phone),1)]),"item.location":a(({item:t})=>[n("div",st,d(t.city)+", "+d(t.state),1)]),"item.source":a(({item:t})=>[n("div",nt,d(t.source),1)]),"item.status":a(({item:t})=>[l(Oe,{color:re(t.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[c(d(t.status),1)]),_:2},1032,["color"])]),"item.owner":a(({item:t})=>[n("div",it,d(t.owner),1)]),"item.lastContacted":a(({item:t})=>[n("div",rt,d(t.lastContacted),1)]),"item.actions":a(({item:t})=>[l(p,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[l(D,{icon:"tabler-dots-vertical"}),l(ze,{activator:"parent"},{default:a(()=>[l(je,null,{default:a(()=>[l(Y,{onClick:R=>_e(t.id)},{prepend:a(()=>[l(D,{icon:"tabler-note"})]),default:a(()=>[l(Z,null,{default:a(()=>e[21]||(e[21]=[c("Add Note")])),_:1,__:[21]})]),_:2},1032,["onClick"]),l(Y,{onClick:R=>de(t.id)},{prepend:a(()=>[l(D,{icon:"tabler-trash"})]),default:a(()=>[l(Z,null,{default:a(()=>e[22]||(e[22]=[c("Delete")])),_:1,__:[22]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[l(be,{page:s(v),"onUpdate:page":e[6]||(e[6]=t=>m(v)?v.value=t:null),"items-per-page":s(f),"total-items":s(E)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),l(J,{modelValue:s(y),"onUpdate:modelValue":e[13]||(e[13]=t=>m(y)?y.value=t:null),"max-width":"600"},{default:a(()=>[l(M,{onClick:e[10]||(e[10]=t=>y.value=!1)}),l(F,{title:"Import Leads from CSV"},{default:a(()=>[l($,null,{default:a(()=>[n("div",dt,[l(p,{variant:"tonal",color:"secondary",size:"small","prepend-icon":"tabler-download",onClick:pe},{default:a(()=>e[23]||(e[23]=[c(" Download Example CSV ")])),_:1,__:[23]})]),l(qe,{modelValue:s(x),"onUpdate:modelValue":e[11]||(e[11]=t=>m(x)?x.value=t:null),label:"Select CSV File",accept:".csv","prepend-icon":"tabler-file-upload","show-size":"",onChange:me},null,8,["modelValue"])]),_:1}),l(H,null,{default:a(()=>[l(T),l(p,{color:"secondary",variant:"tonal",onClick:e[12]||(e[12]=t=>y.value=!1)},{default:a(()=>e[24]||(e[24]=[c(" Cancel ")])),_:1,__:[24]}),l(p,{color:"primary",onClick:fe},{default:a(()=>e[25]||(e[25]=[c(" Import ")])),_:1,__:[25]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:s(g),"onUpdate:modelValue":e[16]||(e[16]=t=>m(g)?g.value=t:null),"max-width":"600"},{default:a(()=>[l(M,{onClick:e[14]||(e[14]=t=>g.value=!1)}),l(F,{title:"Confirm Delete"},{default:a(()=>[l($,null,{default:a(()=>e[26]||(e[26]=[c(" Are you sure you want to delete this lead? This action cannot be undone. ")])),_:1,__:[26]}),l(H,null,{default:a(()=>[l(T),l(p,{color:"secondary",variant:"tonal",onClick:e[15]||(e[15]=t=>g.value=!1)},{default:a(()=>e[27]||(e[27]=[c(" Cancel ")])),_:1,__:[27]}),l(p,{color:"error",onClick:ue},{default:a(()=>e[28]||(e[28]=[c(" Delete ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Le,{"is-dialog-visible":s(A),"onUpdate:isDialogVisible":e[17]||(e[17]=t=>m(A)?A.value=t:null),"lead-id":s(z)||0,onNoteAdded:Ve},null,8,["is-dialog-visible","lead-id"])])}}});export{Qt as default};
