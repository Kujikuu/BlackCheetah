import{m as H}from"./vue3-apexcharts-CSKOBfL2.js";import{d as q,r as c,G as B,P as ee,g as U,o as d,f as t,b as e,t as w,c as _,m as a,v as p,e as s,x as P,aO as L,ak as te,b0 as X,a$ as le,aa as R,a as ne,l as ie,F as W,i as N,a3 as ce,au as A}from"./main-D1fyEajF.js";import{a as J,b as K,c as Q,V as D}from"./VCard-1LLKrENU.js";import{V as E}from"./VCardText-CBbEpO-S.js";import{V as C}from"./VSkeletonLoader-CiOzjFWq.js";import{V as G}from"./VChip-BTX0QEl9.js";import{_ as de}from"./AddEditFranchiseeDrawer.vue_vue_type_script_setup_true_lang-CwWjzz_6.js";import{_ as ue}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-WisB1wHx.js";import{_ as pe}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-IW6HXzwy.js";import{_ as fe}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-CS2jRzat.js";import{a as T,V as F}from"./VRow-Bcs3kVTZ.js";import{V as he}from"./VAlert-BUgeqFNX.js";import{V as Y}from"./VAvatar-ecTgImbX.js";import{V as me}from"./VDivider-DdY94hA9.js";import{V as ve}from"./VTable-CTjtGCXA.js";import{V as _e}from"./VImg-CX1yCZ5B.js";import{V as Z}from"./VTooltip-bxdoIPFa.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VSlideGroup-CrEtt6po.js";import"./validators-BYiRrju8.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-vJo1r0SK.js";import"./form-DL6xjoYm.js";import"./VSelect-Ds26Pc33.js";import"./VTextField-BLAytSxV.js";/* empty css                   */import"./VCounter-QrdsizNe.js";import"./VField-CeM4dkxm.js";import"./easing-Bybner-F.js";import"./VInput-D8aen6Ef.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-CsUSD2is.js";import"./ssrBoot-B1nVHPGZ.js";import"./dialog-transition-DGEZA_Vw.js";import"./VMenu-TAYxhMnW.js";import"./VOverlay-Df-Y_mZo.js";import"./lazy-xg_CVELJ.js";import"./scopeId-BxkdZ-Wh.js";import"./VCheckboxBtn-D82KFSVD.js";import"./VSelectionControl-BFoKADBy.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-BYGgd-Os.js";import"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-DbDkiJfO.js";import"./VSpacer-hubulHsa.js";/* empty css              */import"./VNavigationDrawer-CBgsOXee.js";import"./VForm-CzN_GV3t.js";import"./formatters-WDr9EcLN.js";import"./VDialog-bW95kt9i.js";const xe={key:0,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},be={key:1,class:"text-center text-error text-sm mt-3"},ge={key:2,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},ye={class:"text-h4 text-center"},we=q({__name:"AdminRequestsChart",setup(j){const V=c(!0),v=c(""),b=c(0),m=c(0),y=c([{name:"Requests",data:[0,0,0,0,0,0,0]}]),k=async()=>{try{V.value=!0;const g=await L("/v1/admin/dashboard/chart-data");if(g.success&&g.data.requests){const u=g.data.requests.slice(-7),n=u.map(x=>x.requests);y.value=[{name:"Requests",data:n}];const i=n[n.length-1]||0,f=n[n.length-2]||0;b.value=u.reduce((x,h)=>x+h.requests,0),f>0?m.value=(i-f)/f*100:m.value=i>0?100:0}}catch(g){console.error("Error fetching requests chart data:",g),v.value="Failed to load chart data"}finally{V.value=!1}};B(()=>{k()});const $=ee(()=>({chart:{height:90,parentHeightOffset:0,type:"bar",toolbar:{show:!1}},tooltip:{enabled:!1},plotOptions:{bar:{barHeight:"100%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4,colors:{backgroundBarColors:["rgba(var(--v-track-bg))","rgba(var(--v-track-bg))","rgba(var(--v-track-bg))","rgba(var(--v-track-bg))","rgba(var(--v-track-bg))","rgba(var(--v-track-bg))","rgba(var(--v-track-bg))"],backgroundBarRadius:4}}},colors:["rgba(var(--v-theme-warning),1)"],grid:{show:!1,padding:{top:-30,left:-16,bottom:0,right:-6}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},yaxis:{labels:{show:!1}},responsive:[{breakpoint:1264,options:{plotOptions:{bar:{borderRadius:6,columnWidth:"30%",colors:{backgroundBarRadius:6}}}}}]}));return(g,u)=>{const n=H;return d(),U(D,null,{default:t(()=>[e(J,{class:"pb-3"},{default:t(()=>[e(K,null,{default:t(()=>u[0]||(u[0]=[w("Technical Requests")])),_:1,__:[0]}),e(Q,null,{default:t(()=>u[1]||(u[1]=[w("Last Week")])),_:1,__:[1]})]),_:1}),e(E,null,{default:t(()=>[e(n,{options:a($),series:a(y),height:62},null,8,["options","series"]),a(V)?(d(),_("div",xe,[e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"40px"})])):a(v)?(d(),_("div",be,p(a(v)),1)):(d(),_("div",ge,[s("h4",ye,p(a(b).toLocaleString()),1),s("div",{class:P(["text-sm",a(m)>=0?"text-success":"text-error"])},p(a(m)>=0?"+":"")+p(a(m).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),ke={class:"d-flex flex-column"},Ve={key:0},Ce={key:1},$e={key:2},Te={class:"text-h3 mb-2"},Se={key:1,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Ue={key:2,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},De=q({__name:"AdminRevenueGrowth",setup(j){const V=te(),v=c(!0),b=c(""),m=c(0),y=c(0),k=c([{data:[0,0,0,0,0,0,0]}]),$=async()=>{try{v.value=!0;const u=await L("/v1/admin/dashboard/chart-data");if(u.success&&u.data.revenue){const n=u.data.revenue.slice(-7),i=n.map(h=>h.revenue);k.value=[{data:i}];const f=i[i.length-1]||0,x=i[i.length-2]||0;m.value=n.reduce((h,S)=>h+S.revenue,0),x>0?y.value=(f-x)/x*100:y.value=f>0?100:0}}catch(u){console.error("Error fetching revenue chart data:",u),b.value="Failed to load chart data"}finally{v.value=!1}};B(()=>{$()});const g=ee(()=>{const u=V.current.value.colors,n=V.current.value.variables,i=`rgba(${X(u.success)},0.2)`,f=`rgba(${X(u["on-surface"])},${n["disabled-opacity"]})`;return{chart:{height:162,type:"bar",parentHeightOffset:0,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"80%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:6,distributed:!0}},tooltip:{enabled:!1},grid:{show:!1,padding:{top:-20,bottom:-12,left:-10,right:0}},colors:[i,i,i,i,u.success,i,i],dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:f,fontSize:"13px",fontFamily:"Public sans"}}},yaxis:{labels:{show:!1}},states:{hover:{filter:{type:"none"}}},responsive:[{breakpoint:1640,options:{plotOptions:{bar:{columnWidth:"40%",borderRadius:6}}}}]}});return(u,n)=>{const i=H;return d(),U(D,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between"},{default:t(()=>[s("div",ke,[n[2]||(n[2]=s("div",{class:"mb-auto"},[s("h5",{class:"text-h5 text-no-wrap mb-2"}," Revenue Growth "),s("div",{class:"text-body-1"}," Last 7 Months ")],-1)),a(v)?(d(),_("div",Ve,[e(C,{type:"text",width:"100px",height:"32px",class:"mb-2"}),e(C,{type:"chip",width:"60px",height:"24px"})])):a(b)?(d(),_("div",Ce,[n[1]||(n[1]=s("h5",{class:"text-h3 mb-2 text-error"}," Error ",-1)),e(G,{label:"",color:"error",size:"small"},{default:t(()=>n[0]||(n[0]=[w(" Failed to load ")])),_:1,__:[0]})])):(d(),_("div",$e,[s("h5",Te," SAR "+p(a(m).toLocaleString()),1),e(G,{label:"",color:a(y)>=0?"success":"error",size:"small"},{default:t(()=>[w(p(a(y)>=0?"+":"")+p(a(y).toFixed(1))+"% ",1)]),_:1},8,["color"])]))]),s("div",null,[!a(v)&&!a(b)?(d(),U(i,{key:0,options:a(g),series:a(k),height:162},null,8,["options","series"])):a(v)?(d(),_("div",Se,[e(le,{indeterminate:"",color:"primary",size:"40"})])):(d(),_("div",Ue,[e(R,{icon:"tabler-alert-circle",color:"error",size:"40"})]))])]),_:1})]),_:1})}}}),Fe={key:0,class:"d-flex align-center justify-space-between gap-x-2"},Re={key:1,class:"text-center text-error text-sm"},Le={key:2,class:"d-flex align-center justify-space-between gap-x-2"},Ee={class:"text-h4 text-center"},Oe=q({__name:"AdminUsersChart",setup(j){const v=te().current.value.colors,b=c(!0),m=c(""),y=c(0),k=c(0),$=c([{name:"Users",data:[0,0,0,0,0,0,0]}]),g=async()=>{try{b.value=!0;const n=await L("/v1/admin/dashboard/chart-data");if(n.success&&n.data.users){const i=n.data.users.slice(-7),f=i.map(S=>S.users);$.value=[{name:"Users",data:f}];const x=f[f.length-1]||0,h=f[f.length-2]||0;y.value=i.reduce((S,O)=>S+O.users,0),h>0?k.value=(x-h)/h*100:k.value=x>0?100:0}}catch(n){console.error("Error fetching chart data:",n),m.value="Failed to load chart data"}finally{b.value=!1}};B(()=>{g()});const u={chart:{type:"area",parentHeightOffset:0,toolbar:{show:!1},sparkline:{enabled:!0}},markers:{colors:"transparent",strokeColors:"transparent"},grid:{show:!1},colors:[v.primary],fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.5,opacityTo:.07,stops:[0,80,100]}},dataLabels:{enabled:!1},stroke:{width:2,curve:"smooth"},xaxis:{show:!0,lines:{show:!1},labels:{show:!1},stroke:{width:0},axisBorder:{show:!1}},yaxis:{stroke:{width:0},show:!1},tooltip:{enabled:!1}};return(n,i)=>{const f=H;return d(),U(D,null,{default:t(()=>[e(J,{class:"pb-3"},{default:t(()=>[e(K,null,{default:t(()=>i[0]||(i[0]=[w(" Total Users ")])),_:1,__:[0]}),e(Q,null,{default:t(()=>i[1]||(i[1]=[w(" Last 7 Days ")])),_:1,__:[1]})]),_:1}),e(f,{options:u,series:a($),height:68},null,8,["series"]),e(E,{class:"pt-1"},{default:t(()=>[a(b)?(d(),_("div",Fe,[e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"40px"})])):a(m)?(d(),_("div",Re,p(a(m)),1)):(d(),_("div",Le,[s("h4",Ee,p(a(y).toLocaleString()),1),s("span",{class:P(["text-sm",a(k)>=0?"text-success":"text-error"])},p(a(k)>=0?"+":"")+p(a(k).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),ze={class:"d-flex justify-space-between"},Ae={class:"d-flex flex-column gap-y-1"},qe={class:"d-flex justify-space-between"},Be={class:"d-flex flex-column gap-y-1"},je={class:"text-body-1 text-high-emphasis"},Me={class:"d-flex gap-x-2 align-center"},Ie={class:"text-h4"},We={class:"text-sm"},Ne={class:"d-flex align-center gap-x-4"},Ge={key:1},He={class:"d-flex flex-column"},Pe={class:"text-base font-weight-medium"},Je={class:"text-sm text-medium-emphasis"},Ke={class:"d-flex align-center gap-x-2"},Qe={class:"text-capitalize text-high-emphasis text-body-1"},Xe={class:"text-body-1"},Ye={class:"d-flex gap-1"},Ht=q({__name:"dashboard",setup(j){const V=c([]),v=c([]),b=c(!0),m=c(""),y=async()=>{try{const r=await L("/v1/admin/dashboard/stats");r.success&&(V.value=r.data)}catch(r){console.error("Error fetching stats:",r),m.value="Failed to load dashboard statistics"}},k=async()=>{try{const r=await L("/v1/admin/dashboard/recent-users");r.success&&(v.value=r.data)}catch(r){console.error("Error fetching recent users:",r),m.value="Failed to load recent users"}},$=async()=>{b.value=!0,m.value="";try{await Promise.all([y(),k()])}catch(r){console.error("Error loading dashboard data:",r),m.value="Failed to load dashboard data"}finally{b.value=!1}};B(()=>{$()});const g=r=>{const o=r.toLowerCase();return o==="franchisor"?{color:"success",icon:"tabler-building-store"}:o==="franchisee"?{color:"info",icon:"tabler-user-check"}:o==="sales"?{color:"warning",icon:"tabler-chart-line"}:{color:"primary",icon:"tabler-user"}},u=r=>{const o=r.toLowerCase();return o==="pending"?"warning":o==="active"?"success":o==="inactive"?"secondary":"primary"},n=c(!1),i=c(!1),f=c(!1),x=c(!1),h=c(null),S=r=>{h.value=r,n.value=!0},O=r=>{h.value={...r},r.role==="franchisor"?i.value=!0:r.role==="franchisee"?f.value=!0:r.role==="sales"&&(x.value=!0)},se=()=>{h.value&&O(h.value)},M=r=>{const o=v.value.findIndex(z=>z.id===r.id);o!==-1&&(v.value[o]={...v.value[o],...r}),h.value=null},ae=r=>r==="franchisor"?"Franchisor":r==="franchisee"?"Franchisee":r==="sales"?"Sales User":"User",re=r=>r>0?`+${r}`:r.toString(),oe=r=>!r||typeof r!="string"?"U":r.split(" ").map(o=>o.charAt(0)).join("").toUpperCase();return(r,o)=>{const z=ne("IconBtn");return d(),_("section",null,[e(F,{class:"mb-6"},{default:t(()=>[e(T,{cols:"12"},{default:t(()=>o[5]||(o[5]=[s("div",{class:"d-flex align-center justify-space-between"},[s("div",null,[s("h2",{class:"text-h2 mb-1"}," Admin Dashboard "),s("p",{class:"text-body-1 text-medium-emphasis"}," Welcome back! Here's what's happening with your platform today. ")])],-1)])),_:1,__:[5]})]),_:1}),a(m)?(d(),U(F,{key:0,class:"mb-6"},{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(he,{type:"error",variant:"tonal",closable:"","onClick:close":o[0]||(o[0]=l=>m.value="")},{default:t(()=>[w(p(a(m)),1)]),_:1})]),_:1})]),_:1})):ie("",!0),e(F,{class:"mb-6"},{default:t(()=>[a(b)?(d(),_(W,{key:0},N(4,l=>e(T,{key:l,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(D,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",ze,[s("div",Ae,[e(C,{type:"text",width:"80px"}),e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"120px"})]),e(C,{type:"avatar",size:"42"})])]),_:1})]),_:1})]),_:2},1024)),64)):(d(!0),_(W,{key:1},N(a(V),(l,I)=>(d(),U(T,{key:I,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(D,null,{default:t(()=>[e(E,null,{default:t(()=>[s("div",qe,[s("div",Be,[s("div",je,p(l.title),1),s("div",Me,[s("h4",Ie,p(l.value),1),s("div",{class:P(["text-base",l.change>0?"text-success":"text-error"])}," ("+p(re(l.change))+"%) ",3)]),s("div",We,p(l.desc),1)]),e(Y,{color:l.iconColor,variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(R,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(F,{class:"mb-6"},{default:t(()=>[e(T,{cols:"12",md:"4"},{default:t(()=>[e(Oe)]),_:1}),e(T,{cols:"12",md:"4"},{default:t(()=>[e(De)]),_:1}),e(T,{cols:"12",md:"4"},{default:t(()=>[e(we)]),_:1})]),_:1}),e(F,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(D,null,{default:t(()=>[e(J,{class:"pb-4"},{append:t(()=>[e(ce,{variant:"outlined",color:"primary",size:"small",to:{name:"admin-users-franchisors"}},{default:t(()=>o[8]||(o[8]=[w(" View All ")])),_:1,__:[8]})]),default:t(()=>[e(K,null,{default:t(()=>o[6]||(o[6]=[w("Recent Users")])),_:1,__:[6]}),e(Q,null,{default:t(()=>o[7]||(o[7]=[w("Latest registered users")])),_:1,__:[7]})]),_:1}),e(me),e(ve,{class:"text-no-wrap"},{default:t(()=>[o[11]||(o[11]=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," USER "),s("th",{scope:"col"}," ROLE "),s("th",{scope:"col"}," STATUS "),s("th",{scope:"col"}," JOINED DATE "),s("th",{scope:"col"}," ACTIONS ")])],-1)),s("tbody",null,[(d(!0),_(W,null,N(a(v),l=>(d(),_("tr",{key:l.id},[s("td",null,[s("div",Ne,[e(Y,{size:"34",variant:l.avatar?void 0:"tonal",color:l.avatar?void 0:g(l.role).color},{default:t(()=>[l.avatar?(d(),U(_e,{key:0,src:l.avatar},null,8,["src"])):(d(),_("span",Ge,p(oe(l.fullName)),1))]),_:2},1032,["variant","color"]),s("div",He,[s("h6",Pe,p(l.fullName),1),s("div",Je,p(l.email),1)])])]),s("td",null,[s("div",Ke,[e(R,{size:22,icon:g(l.role).icon,color:g(l.role).color},null,8,["icon","color"]),s("div",Qe,p(l.role),1)])]),s("td",null,[e(G,{color:u(l.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[w(p(l.status),1)]),_:2},1032,["color"])]),s("td",null,[s("div",Xe,p(l.joinedDate),1)]),s("td",null,[s("div",Ye,[e(z,{size:"small",onClick:I=>S(l)},{default:t(()=>[e(R,{icon:"tabler-eye"}),e(Z,{activator:"parent",location:"top"},{default:t(()=>o[9]||(o[9]=[w(" View ")])),_:1,__:[9]})]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:I=>O(l)},{default:t(()=>[e(R,{icon:"tabler-edit"}),e(Z,{activator:"parent",location:"top"},{default:t(()=>o[10]||(o[10]=[w(" Edit ")])),_:1,__:[10]})]),_:2},1032,["onClick"])])])]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),e(fe,{"is-dialog-open":a(n),"onUpdate:isDialogOpen":o[1]||(o[1]=l=>A(n)?n.value=l:null),user:a(h),"user-type":a(h)?ae(a(h).role):"User",onEdit:se},null,8,["is-dialog-open","user","user-type"]),e(ue,{"is-drawer-open":a(i),"onUpdate:isDrawerOpen":o[2]||(o[2]=l=>A(i)?i.value=l:null),franchisor:a(h),onFranchisorData:M},null,8,["is-drawer-open","franchisor"]),e(de,{"is-drawer-open":a(f),"onUpdate:isDrawerOpen":o[3]||(o[3]=l=>A(f)?f.value=l:null),franchisee:a(h),onFranchiseeData:M},null,8,["is-drawer-open","franchisee"]),e(pe,{"is-drawer-open":a(x),"onUpdate:isDrawerOpen":o[4]||(o[4]=l=>A(x)?x.value=l:null),"sales-user":a(h),onSalesUserData:M},null,8,["is-drawer-open","sales-user"])])}}});export{Ht as default};
