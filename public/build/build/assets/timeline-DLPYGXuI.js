import{_ as O}from"./AppSelect.vue_vue_type_script_setup_true_lang-1-XeJTow.js";import{d as E,c2 as G,r as v,w as P,P as U,G as q,c as b,b as s,f as t,j as H,o as c,F as w,i as C,m,g as h,e as r,v as d,aa as x,t as p,au as J,l as T,a3 as V}from"./main-BrAmouoN.js";import{u as K}from"./useApi-CR1oawAM.js";import{V as Q,a as W}from"./VRow-DyPI-5aI.js";import{V as k,a as z,b as A,d as X}from"./VCard-DApPZHvP.js";import{V as y}from"./VCardText-CsVBN6BO.js";import{V as D}from"./VAvatar-DNG0Nmgh.js";import{a as Y,V as Z}from"./VTimeline-Dvtl1bEI.js";import{V as ee}from"./VChip-CbwyjT0Z.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-DFcoaDo4.js";import"./VSelect-ClEfwI_Z.js";import"./VTextField-BffrunyH.js";/* empty css                   */import"./VCounter-B_nFJ4I0.js";import"./VImg-BoI76u4Q.js";import"./VField-BbFAIRsh.js";import"./easing-Bybner-F.js";import"./VInput-hEwS4-6z.js";import"./forwardRefs-C-GTDzx5.js";import"./VList--MpM1GQQ.js";import"./ssrBoot-C2dwFu6i.js";import"./VDivider-Ch4oqZye.js";import"./dialog-transition-D-Y8H8fK.js";import"./VMenu-CMwE0TEA.js";import"./VOverlay-CBfywqly.js";import"./lazy-BhQbIKcy.js";import"./scopeId-CW1dFU5W.js";import"./VCheckboxBtn-0WdjC8uR.js";import"./VSelectionControl-GPFg-qJH.js";/* empty css              */import"./VSlideGroup-Bo31GoEE.js";const ae={class:"d-flex justify-space-between align-center"},se={class:"text-body-1 text-high-emphasis mb-1"},le={class:"text-h4"},oe={style:{"inline-size":"10rem"}},re={class:"d-flex flex-column"},ie={class:"app-timeline-meta text-sm font-weight-medium"},ne={class:"app-timeline-meta text-xs"},ce={class:"v-timeline-avatar-wrapper rounded-circle"},de={class:"app-timeline-text mb-0"},ue=E({__name:"timeline",setup(pe){const n=H(),{data:L,execute:I,isFetching:fe}=K("/v1/franchisor/dashboard/timeline"),{smAndDown:S}=G(),u=v("all"),$=[{title:"All",value:"all"},{title:"Completed",value:"completed"},{title:"Scheduled",value:"scheduled"},{title:"Overdue",value:"overdue"}],_=v([]),g=v([{title:"Total Milestones",value:"0",icon:"tabler-flag",color:"primary"},{title:"Completed",value:"0",icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:"0",icon:"tabler-calendar",color:"info"},{title:"Overdue",value:"0",icon:"tabler-alert-triangle",color:"error"}]),M=l=>{switch(l.toLowerCase()){case"completed":return"success";case"scheduled":return"info";case"overdue":return"error";default:return"primary"}},B=l=>{const a=new Date(l),e=new Date().getTime()-a.getTime(),o=Math.ceil(e/(1e3*60*60*24));if(o===0)return"Today";if(o===1)return"1 day ago";if(o>1&&o<=7)return`${o} days ago`;if(o>7&&o<=14)return`${Math.ceil(o/7)} week ago`;if(o>14)return`${Math.ceil(o/7)} weeks ago`;if(o<0){const f=Math.abs(o);return f===1?"In 1 day":f<=7?`In ${f} days`:`In ${Math.ceil(f/7)} weeks`}return l};P(L,l=>{const a=l;if(a!=null&&a.success&&(a!=null&&a.data)){const i=a.data;_.value=Array.isArray(i.timeline)?i.timeline.map(e=>({id:e.id,title:e.title,description:e.description,week:e.week,date:e.date||B(e.created_at),status:e.status,icon:e.icon||"tabler-calendar",color:M(e.status)})):[],i.stats&&(g.value=[{title:"Total Milestones",value:(i.stats.total_milestones||0).toLocaleString(),icon:"tabler-flag",color:"primary"},{title:"Completed",value:(i.stats.completed||0).toLocaleString(),icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:(i.stats.scheduled||0).toLocaleString(),icon:"tabler-calendar",color:"info"},{title:"Overdue",value:(i.stats.overdue||0).toLocaleString(),icon:"tabler-alert-triangle",color:"error"}])}},{immediate:!0});const F=U(()=>u.value==="all"?_.value:_.value.filter(l=>l.status===u.value)),j=l=>{l.description.includes("Lead")?n.push("/franchisor/dashboard/leads"):(l.description.includes("Task")||l.description.includes("Technical"))&&n.push("/franchisor/dashboard/operations")},N=l=>{l.description.includes("Lead")?n.push("/franchisor/dashboard/leads"):(l.description.includes("Task"),n.push("/franchisor/dashboard/operations"))},R=l=>{l.description.includes("Lead")?n.push("/franchisor/dashboard/leads"):(l.description.includes("Task"),n.push("/franchisor/dashboard/operations"))};return q(()=>{I()}),(l,a)=>{const i=O;return c(),b("section",null,[s(Q,{class:"mb-6"},{default:t(()=>[(c(!0),b(w,null,C(m(g),e=>(c(),h(W,{key:e.title,cols:"12",sm:"6",md:"3"},{default:t(()=>[s(k,null,{default:t(()=>[s(y,null,{default:t(()=>[r("div",ae,[r("div",null,[r("div",se,d(e.title),1),r("h4",le,d(e.value),1)]),s(D,{color:e.color,variant:"tonal",rounded:"",size:"42"},{default:t(()=>[s(x,{icon:e.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(k,null,{default:t(()=>[s(z,null,{append:t(()=>[r("div",oe,[s(i,{modelValue:m(u),"onUpdate:modelValue":a[0]||(a[0]=e=>J(u)?u.value=e:null),items:$,placeholder:"Filter"},null,8,["modelValue"])])]),default:t(()=>[s(A,null,{default:t(()=>a[1]||(a[1]=[p("Development Timeline")])),_:1,__:[1]})]),_:1}),s(y,null,{default:t(()=>[s(Y,{align:"start","line-inset":"19","truncate-line":"start",justify:"center",density:m(S)?"compact":"default",class:"mt-4"},{default:t(()=>[(c(!0),b(w,null,C(m(F),e=>(c(),h(Z,{key:e.id,"fill-dot":"",size:"small"},{opposite:t(()=>[r("div",re,[r("span",ie,d(e.week),1),r("span",ne,d(e.date),1)])]),icon:t(()=>[r("div",ce,[s(D,{size:"32",color:e.color,variant:"tonal"},{default:t(()=>[s(x,{icon:e.icon,size:"20"},null,8,["icon"])]),_:2},1032,["color"])])]),default:t(()=>[s(k,{class:"mb-6 mt-n4"},{default:t(()=>[s(z,{class:"pb-4"},{default:t(()=>[s(A,{class:"d-flex align-center justify-space-between"},{default:t(()=>[r("span",null,d(e.title),1),s(ee,{color:e.color,size:"small",label:"",class:"text-capitalize"},{default:t(()=>[p(d(e.status),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024),s(y,null,{default:t(()=>[r("p",de,d(e.description),1)]),_:2},1024),s(X,null,{default:t(()=>[s(V,{variant:"tonal",size:"small",onClick:o=>j(e)},{default:t(()=>a[2]||(a[2]=[p(" View Details ")])),_:2,__:[2]},1032,["onClick"]),e.status==="overdue"?(c(),h(V,{key:0,variant:"tonal",color:"error",size:"small",onClick:o=>N(e)},{default:t(()=>a[3]||(a[3]=[p(" Take Action ")])),_:2,__:[3]},1032,["onClick"])):T("",!0),e.status==="scheduled"?(c(),h(V,{key:1,variant:"tonal",color:"info",size:"small",onClick:o=>R(e)},{default:t(()=>a[4]||(a[4]=[p(" Reschedule ")])),_:2,__:[4]},1032,["onClick"])):T("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["density"])]),_:1})]),_:1})])}}}),He=te(ue,[["__scopeId","data-v-5b0ddc98"]]);export{He as default};
