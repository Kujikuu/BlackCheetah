import{V as ye,_ as be}from"./VDialog-CEq2jzbd.js";import{_ as _e}from"./AppTextarea.vue_vue_type_script_setup_true_lang-yoNOmpMf.js";import{_ as ge}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-CaQex1Dk.js";import{_ as ke}from"./AppSelect.vue_vue_type_script_setup_true_lang-DOrgpFkU.js";import{_ as we}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{_ as Ce}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-yqeAcrUb.js";import{V as Ne,_ as Ue}from"./ViewNoteModal-DafqEFq7.js";import{l as W}from"./lead-6Frh_D17.js";import{a as xe}from"./formatters--UtN2sCw.js";import{d as De,P as Se,u as Ae,r as p,G as K,w as Ee,c as F,g as i,l as A,b as l,m as t,f as o,F as I,aR as D,b5 as R,o as d,e as v,aF as Le,v as y,t as f,a9 as b,i as Y,ax as q}from"./main-B8QbR-yS.js";import{V as c,a as k,b as w,d as Te}from"./VCard-D9PhtsJ0.js";import{a as Me,V as $e}from"./VTabs-DXRKnteB.js";import{a as Be,V as X}from"./VWindowItem-CHtlO5gs.js";import{V}from"./VCardText-Cbtr6Qhr.js";import{V as Fe}from"./VAvatar-87LH5tAk.js";import{V as Pe}from"./VChip-CgHwmC-k.js";import{V as C,a as m}from"./VRow-LlT6Azsr.js";import{V as N}from"./VDivider-DOfIMbJY.js";import{V as ze}from"./VSpacer-BSXBFFTK.js";import"./VOverlay-B3La6Ajr.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-DyQ6a1uN.js";import"./VImg-Ceu2Mboj.js";import"./dialog-transition-Dy2Gj1XO.js";import"./form-Dt-W1fp6.js";import"./VTextarea-1ursQqQ2.js";import"./VTextField-C7_y5spr.js";import"./VField-Bw51LFql.js";import"./VInput-DB3XZUVb.js";import"./VSelect-GSzN3Qps.js";import"./VList-BJCgULVd.js";import"./VMenu-TQcmpCCv.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VForm-C9sxpau4.js";import"./VFileInput-Ip2n4ssl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSlideGroup-BuNiGLv2.js";/* empty css              */const Ie={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Re={class:"d-flex align-center gap-4"},qe={class:"text-h4"},Je={class:"text-h4 mb-1"},Qe={class:"text-body-1 mb-1"},Oe={class:"d-flex gap-2"},je={class:"d-flex justify-space-between align-start mb-2"},Ge={class:"text-caption text-disabled mb-1"},He={class:"text-h6 mb-2"},We={class:"d-flex gap-2"},Ke={class:"text-body-2 mb-2"},Fl=De({__name:"[id]",setup(Ye){const Z=Ae(),_=Se(()=>Number(Z.params.id)),U=p("overview"),E=p(!1),L=p(!1),S=p(!1),g=p(!1),T=p(null),M=p(null),u=p(!1),n=p(null),P=p(!1),J=async()=>{try{P.value=!0;const s=await W.getLead(_.value);s.success&&s.data&&(n.value=s.data)}catch(s){console.error("Error fetching lead data:",s)}finally{P.value=!1}};K(()=>{J()});const Q=p([]),O=p(!1),$=async()=>{if(_.value)try{O.value=!0;const s=await R("/v1/notes",{method:"GET",query:{lead_id:_.value}});s.success&&(Q.value=s.data.map(e=>{var r;return{id:e.id,title:e.title,description:e.description,createdBy:((r=e.user)==null?void 0:r.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(s){console.error("Error fetching notes:",s)}finally{O.value=!1}};Ee(_,()=>{_.value&&$()},{immediate:!0});const h=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],ee=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),le=(s,e=150)=>s.length<=e?s:`${s.substring(0,e)}...`,te=s=>{T.value=s,L.value=!0},ae=s=>{T.value={...s},S.value=!0},oe=s=>{M.value=s,g.value=!0},ne=async()=>{if(M.value!==null){try{const s=await R(`/v1/notes/${M.value}`,{method:"DELETE"});s.success?(await $(),console.log("Note deleted successfully")):console.error("Failed to delete note:",s.message)}catch(s){console.error("Error deleting note:",s)}g.value=!1,M.value=null}},se=async()=>{await $(),S.value=!1,console.log("Note updated successfully")},de=async()=>{await $(),console.log("Note added successfully")},j=()=>{u.value=!u.value},B=p(!1),ue=async()=>{if(n.value)try{B.value=!0,(await W.updateLead(_.value,n.value)).success&&(await J(),u.value=!1,console.log("Lead updated successfully"))}catch(s){console.error("Error updating lead:",s)}finally{B.value=!1}},G=p([]),ie=async()=>{try{const s=await R("/v1/franchisor/sales-associates",{method:"GET"});s.success&&(G.value=s.data.map(e=>({title:e.name,value:e.name})))}catch(s){console.error("Error fetching sales associates:",s)}};K(()=>{ie()});const re=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Syria",value:"Syria"},{title:"Palestine",value:"Palestine"},{title:"Yemen",value:"Yemen"}],me=[{title:"Riyadh",value:"Riyadh"},{title:"Makkah",value:"Makkah"},{title:"Medina",value:"Medina"},{title:"Eastern Province",value:"Eastern Province"},{title:"Asir",value:"Asir"},{title:"Tabuk",value:"Tabuk"},{title:"Hail",value:"Hail"},{title:"Northern Borders",value:"Northern Borders"},{title:"Jazan",value:"Jazan"},{title:"Najran",value:"Najran"},{title:"Al Bahah",value:"Al Bahah"},{title:"Al Jawf",value:"Al Jawf"}],fe=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],pe=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],ve=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];return(s,e)=>{const r=we,x=ke,z=ge,ce=_e,Ve=be;return d(),F("section",null,[t(P)?(d(),i(c,{key:0,class:"mb-6"},{default:o(()=>[l(V,{class:"text-center py-10"},{default:o(()=>[l(Le,{indeterminate:"",color:"primary"}),e[37]||(e[37]=v("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[37]})]),_:1})):t(n)?(d(),i(c,{key:1,class:"mb-6"},{default:o(()=>[l(V,null,{default:o(()=>[v("div",Ie,[v("div",Re,[l(Fe,{size:"80",variant:"tonal",color:"primary"},{default:o(()=>[v("span",qe,y(t(xe)(`${t(n).firstName} ${t(n).lastName}`)),1)]),_:1}),v("div",null,[v("h4",Je,y(t(n).firstName)+" "+y(t(n).lastName),1),v("div",Qe,y(t(n).company),1),l(Pe,{color:t(n).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:o(()=>[f(y(t(n).status),1)]),_:1},8,["color"])])]),v("div",Oe,[t(u)?A("",!0):(d(),i(b,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:j},{default:o(()=>e[38]||(e[38]=[f(" Edit ")])),_:1,__:[38]})),t(u)?(d(),i(b,{key:1,color:"success","prepend-icon":"tabler-check",loading:t(B),disabled:t(B),onClick:ue},{default:o(()=>e[39]||(e[39]=[f(" Save ")])),_:1,__:[39]},8,["loading","disabled"])):A("",!0),t(u)?(d(),i(b,{key:2,color:"secondary",variant:"tonal",onClick:j},{default:o(()=>e[40]||(e[40]=[f(" Cancel ")])),_:1,__:[40]})):A("",!0)])])]),_:1})]),_:1})):A("",!0),t(n)?(d(),F(I,{key:2},[l(Me,{modelValue:t(U),"onUpdate:modelValue":e[0]||(e[0]=a=>D(U)?U.value=a:null),class:"mb-6"},{default:o(()=>[(d(),F(I,null,Y(h,a=>l($e,{key:a.value,value:a.value},{default:o(()=>[l(q,{icon:a.icon,start:""},null,8,["icon"]),f(" "+y(a.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),l(Be,{modelValue:t(U),"onUpdate:modelValue":e[30]||(e[30]=a=>D(U)?U.value=a:null),class:"disable-tab-transition"},{default:o(()=>[l(X,{value:"overview"},{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12",lg:"8"},{default:o(()=>[l(c,{class:"mb-6"},{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[41]||(e[41]=[f("Personal & Contact Information")])),_:1,__:[41]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12",md:"6"},{default:o(()=>[l(r,{modelValue:t(n).firstName,"onUpdate:modelValue":e[1]||(e[1]=a=>t(n).firstName=a),label:"First Name",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(r,{modelValue:t(n).lastName,"onUpdate:modelValue":e[2]||(e[2]=a=>t(n).lastName=a),label:"Last Name",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(r,{modelValue:t(n).email,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).email=a),label:"Email",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(r,{modelValue:t(n).phone,"onUpdate:modelValue":e[4]||(e[4]=a=>t(n).phone=a),label:"Phone",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12"},{default:o(()=>[l(r,{modelValue:t(n).company,"onUpdate:modelValue":e[5]||(e[5]=a=>t(n).company=a),label:"Company",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),l(c,{class:"mb-6"},{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[42]||(e[42]=[f("Location")])),_:1,__:[42]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12",md:"4"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).country,"onUpdate:modelValue":e[6]||(e[6]=a=>t(n).country=a),label:"Country",placeholder:"Select Country",items:re},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).country,"onUpdate:modelValue":e[7]||(e[7]=a=>t(n).country=a),label:"Country",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).state,"onUpdate:modelValue":e[8]||(e[8]=a=>t(n).state=a),label:"State",placeholder:"Select State",items:me},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).state,"onUpdate:modelValue":e[9]||(e[9]=a=>t(n).state=a),label:"State",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(r,{modelValue:t(n).city,"onUpdate:modelValue":e[10]||(e[10]=a=>t(n).city=a),label:"City",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),l(c,{class:"mb-6"},{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[43]||(e[43]=[f("Financial Details")])),_:1,__:[43]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12",md:"4"},{default:o(()=>[l(r,{modelValue:t(n).estimatedInvestment,"onUpdate:modelValue":e[11]||(e[11]=a=>t(n).estimatedInvestment=a),label:"Estimated Investment",type:"number",prefix:"SAR",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(r,{modelValue:t(n).franchiseFeeQuoted,"onUpdate:modelValue":e[12]||(e[12]=a=>t(n).franchiseFeeQuoted=a),label:"Franchise Fee Quoted",type:"number",prefix:"SAR",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[t(u)?(d(),i(z,{key:0,modelValue:t(n).expectedDecisionDate,"onUpdate:modelValue":e[13]||(e[13]=a=>t(n).expectedDecisionDate=a),label:"Expected Decision Date",placeholder:"Select Date"},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).expectedDecisionDate,"onUpdate:modelValue":e[14]||(e[14]=a=>t(n).expectedDecisionDate=a),label:"Expected Decision Date",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),l(c,null,{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[44]||(e[44]=[f("Additional Notes")])),_:1,__:[44]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(ce,{modelValue:t(n).note,"onUpdate:modelValue":e[15]||(e[15]=a=>t(n).note=a),label:"Notes",placeholder:"Add any additional notes about this lead...",rows:"4",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1}),l(m,{cols:"12",lg:"4"},{default:o(()=>[l(c,{class:"mb-6"},{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[45]||(e[45]=[f("Lead Management")])),_:1,__:[45]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).status,"onUpdate:modelValue":e[16]||(e[16]=a=>t(n).status=a),label:"Status",placeholder:"Select Status",items:pe},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).status,"onUpdate:modelValue":e[17]||(e[17]=a=>t(n).status=a),label:"Status",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).priority,"onUpdate:modelValue":e[18]||(e[18]=a=>t(n).priority=a),label:"Priority",placeholder:"Select Priority",items:ve},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).priority,"onUpdate:modelValue":e[19]||(e[19]=a=>t(n).priority=a),label:"Priority",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).source,"onUpdate:modelValue":e[20]||(e[20]=a=>t(n).source=a),label:"Source",placeholder:"Select Source",items:fe},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).source,"onUpdate:modelValue":e[21]||(e[21]=a=>t(n).source=a),label:"Source",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(x,{key:0,modelValue:t(n).owner,"onUpdate:modelValue":e[22]||(e[22]=a=>t(n).owner=a),label:"Assigned To",placeholder:"Select Owner",items:t(G)},null,8,["modelValue","items"])):(d(),i(r,{key:1,modelValue:t(n).owner,"onUpdate:modelValue":e[23]||(e[23]=a=>t(n).owner=a),label:"Assigned To",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),l(c,null,{default:o(()=>[l(k,null,{default:o(()=>[l(w,null,{default:o(()=>e[46]||(e[46]=[f("Timeline & Engagement")])),_:1,__:[46]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(z,{key:0,modelValue:t(n).lastContacted,"onUpdate:modelValue":e[24]||(e[24]=a=>t(n).lastContacted=a),label:"Last Contacted",placeholder:"Select Date"},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).lastContacted,"onUpdate:modelValue":e[25]||(e[25]=a=>t(n).lastContacted=a),label:"Last Contacted",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:o(()=>[t(u)?(d(),i(z,{key:0,modelValue:t(n).scheduledMeeting,"onUpdate:modelValue":e[26]||(e[26]=a=>t(n).scheduledMeeting=a),label:"Next Follow-up",placeholder:"Select Date"},null,8,["modelValue"])):(d(),i(r,{key:1,modelValue:t(n).scheduledMeeting,"onUpdate:modelValue":e[27]||(e[27]=a=>t(n).scheduledMeeting=a),label:"Next Follow-up",readonly:""},null,8,["modelValue"]))]),_:1}),l(m,{cols:"12"},{default:o(()=>[l(r,{modelValue:t(n).contactAttempts,"onUpdate:modelValue":e[28]||(e[28]=a=>t(n).contactAttempts=a),label:"Contact Attempts",type:"number",readonly:!t(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(X,{value:"notes"},{default:o(()=>[l(c,null,{default:o(()=>[l(k,{class:"pb-4"},{append:o(()=>[l(b,{color:"primary","prepend-icon":"tabler-plus",onClick:e[29]||(e[29]=a=>E.value=!0)},{default:o(()=>e[48]||(e[48]=[f(" Add Note ")])),_:1,__:[48]})]),default:o(()=>[l(w,null,{default:o(()=>e[47]||(e[47]=[f("Notes")])),_:1,__:[47]})]),_:1}),l(N),l(V,null,{default:o(()=>[l(C,null,{default:o(()=>[(d(!0),F(I,null,Y(t(Q),a=>(d(),i(m,{key:a.id,cols:"12"},{default:o(()=>[l(c,{variant:"tonal",class:"mb-4"},{default:o(()=>[l(V,null,{default:o(()=>[v("div",je,[v("div",null,[v("div",Ge," Created by "+y(a.createdBy)+" at "+y(ee(a.createdAt)),1),v("h6",He,y(a.title),1)]),v("div",We,[l(b,{icon:"",size:"small",variant:"text",onClick:H=>ae(a)},{default:o(()=>[l(q,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),l(b,{icon:"",size:"small",variant:"text",color:"error",onClick:H=>oe(a.id)},{default:o(()=>[l(q,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),v("p",Ke,y(le(a.description)),1),l(b,{variant:"text",size:"small",onClick:H=>te(a)},{default:o(()=>e[49]||(e[49]=[f(" Read More ")])),_:2,__:[49]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):A("",!0),l(Ce,{"is-dialog-visible":t(E),"onUpdate:isDialogVisible":e[31]||(e[31]=a=>D(E)?E.value=a:null),"lead-id":t(_),onNoteAdded:de},null,8,["is-dialog-visible","lead-id"]),l(Ne,{"is-dialog-visible":t(L),"onUpdate:isDialogVisible":e[32]||(e[32]=a=>D(L)?L.value=a:null),note:t(T)},null,8,["is-dialog-visible","note"]),l(Ue,{"is-dialog-visible":t(S),"onUpdate:isDialogVisible":e[33]||(e[33]=a=>D(S)?S.value=a:null),note:t(T),onNoteUpdated:se},null,8,["is-dialog-visible","note"]),l(ye,{modelValue:t(g),"onUpdate:modelValue":e[36]||(e[36]=a=>D(g)?g.value=a:null),"max-width":"600"},{default:o(()=>[l(Ve,{onClick:e[34]||(e[34]=a=>g.value=!1)}),l(c,{title:"Confirm Delete"},{default:o(()=>[l(V,null,{default:o(()=>e[50]||(e[50]=[f(" Are you sure you want to delete this note? This action cannot be undone. ")])),_:1,__:[50]}),l(Te,null,{default:o(()=>[l(ze),l(b,{color:"secondary",variant:"tonal",onClick:e[35]||(e[35]=a=>g.value=!1)},{default:o(()=>e[51]||(e[51]=[f(" Cancel ")])),_:1,__:[51]}),l(b,{color:"error",onClick:ne},{default:o(()=>e[52]||(e[52]=[f(" Delete ")])),_:1,__:[52]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Fl as default};
