import{_ as le}from"./AppSelect.vue_vue_type_script_setup_true_lang-BPi_8I55.js";import{K as B,L as P,c7 as se,ao as O,an as ae,ai as ne,M as A,y as i,av as L,ax as oe,ac as K,c8 as W,ad as Y,$ as M,R as Z,bh as re,W as de,g as b,w as G,Y as z,b9 as H,bj as ce,br as ue,bV as me,a9 as fe,az as ve,aa as v,O as R,b8 as he,bZ as _e,bi as ye,d as Ce,e as ge,bf as be,E as ke,c as w,o as C,k as l,F as j,r as N,i as D,a as S,l as m,t as g,q as p,aM as pe,h as E,a7 as I}from"./main-CJoUlw71.js";import{f as Ve}from"./franchise-CaBrEO2E.js";import{a as Te,V as De}from"./VRow-I0aFN3ft.js";import{V as x,f as $,b as F,a as q,d as U,h as Se}from"./VCard-D0Kr6jJ3.js";import{V as ze}from"./VChip-B4nRRsDL.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-TZVfOcgQ.js";import"./VSelect-DrBKrWpC.js";import"./VTextField-D8E1qX-C.js";import"./VField-BK8GYuQp.js";import"./forwardRefs-B931MWyl.js";import"./VInput-ljW8JGQT.js";import"./VList-dBGtPQa1.js";import"./VDivider-BaGqyL8B.js";import"./VMenu-ChdF8Fzb.js";import"./VOverlay-DNweL6TL.js";import"./scopeId-BW4ci1pC.js";import"./VCheckboxBtn-ClRj4-k1.js";import"./VSelectionControl-DPYfPVD0.js";import"./api-router-CWf8jKcZ.js";/* empty css              */import"./VSlideGroup-CFd1UCPD.js";const Ie=P({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Z,iconColor:String,lineColor:String,...M(),...Y(),...W(),...K()},"VTimelineDivider"),xe=B()({name:"VTimelineDivider",props:Ie(),setup(e,o){let{slots:n}=o;const{sizeClasses:h,sizeStyles:_}=se(e,"v-timeline-divider__dot"),{backgroundColorStyles:y,backgroundColorClasses:r}=O(()=>e.dotColor),{roundedClasses:c}=ae(e,"v-timeline-divider__dot"),{elevationClasses:u}=ne(e),{backgroundColorClasses:k,backgroundColorStyles:V}=O(()=>e.lineColor);return A(()=>i("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class],style:e.style},[i("div",{class:["v-timeline-divider__before",k.value],style:V.value},null),!e.hideDot&&i("div",{key:"dot",class:["v-timeline-divider__dot",u.value,c.value,h.value],style:_.value},[i("div",{class:["v-timeline-divider__inner-dot",r.value,c.value],style:y.value},[n.default?i(oe,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},n.default):i(L,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),i("div",{class:["v-timeline-divider__after",k.value],style:V.value},null)])),{}}}),J=P({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Z,iconColor:String,lineInset:[Number,String],side:{type:String,validator:e=>e==null||["start","end"].includes(e)},...M(),...ce(),...K(),...Y(),...W(),...H()},"VTimelineItem"),$e=B()({name:"VTimelineItem",props:J(),setup(e,o){let{slots:n}=o;const{dimensionStyles:h}=re(e),_=de(0),y=b();return G(y,r=>{var c;r&&(_.value=((c=r.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:c.getBoundingClientRect().width)??0)},{flush:"post"}),A(()=>{var r,c;return i("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot,"v-timeline-item--side-start":e.side==="start","v-timeline-item--side-end":e.side==="end"},e.class],style:[{"--v-timeline-dot-size":z(_.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${z(e.lineInset)})`:z(0)},e.style]},[i("div",{class:"v-timeline-item__body",style:h.value},[(r=n.default)==null?void 0:r.call(n)]),i(xe,{ref:y,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:n.icon}),e.density!=="compact"&&i("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((c=n.opposite)==null?void 0:c.call(n))])])}),{}}}),Le=P({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...ye(J({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...M(),..._e(),...H(),...he()},"VTimeline"),Re=B()({name:"VTimeline",props:Le(),setup(e,o){let{slots:n}=o;const{themeClasses:h}=ue(e),{densityClasses:_}=me(e),{rtlClasses:y}=fe();ve({VTimelineDivider:{lineColor:v(()=>e.lineColor)},VTimelineItem:{density:v(()=>e.density),dotColor:v(()=>e.dotColor),fillDot:v(()=>e.fillDot),hideOpposite:v(()=>e.hideOpposite),iconColor:v(()=>e.iconColor),lineColor:v(()=>e.lineColor),lineInset:v(()=>e.lineInset),size:v(()=>e.size)}});const r=R(()=>{const u=e.side?e.side:e.density!=="default"?"end":null;return u&&`v-timeline--side-${u}`}),c=R(()=>{const u=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return u;case"start":return u[0];case"end":return u[1];default:return null}});return A(()=>i(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,c.value,{"v-timeline--inset-line":!!e.lineInset},h.value,_.value,r.value,y.value,e.class],style:[{"--v-timeline-line-thickness":z(e.lineThickness)},e.style]},n)),{}}}),Be={class:"d-flex justify-space-between align-center"},Pe={class:"text-body-1 text-high-emphasis mb-1"},Ae={class:"text-h4"},Me={style:{"inline-size":"10rem"}},Oe={class:"d-flex flex-column"},je={class:"app-timeline-meta text-sm font-weight-medium"},Ne={class:"app-timeline-meta text-xs"},Ee={class:"v-timeline-avatar-wrapper rounded-circle"},Fe={class:"app-timeline-text mb-0"},qe=Ce({__name:"timeline",setup(e){const o=ge(),n=b(null),h=b(!1),_=async()=>{h.value=!0;try{const s=await Ve.getDashboardTimeline();n.value=s}catch(s){console.error("Error fetching timeline data:",s),n.value=null}finally{h.value=!1}},{smAndDown:y}=be(),r=b("all"),c=[{title:"All",value:"all"},{title:"Completed",value:"completed"},{title:"Scheduled",value:"scheduled"},{title:"Overdue",value:"overdue"}],u=b([]),k=b([{title:"Total Milestones",value:"0",icon:"tabler-flag",color:"primary"},{title:"Completed",value:"0",icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:"0",icon:"tabler-calendar",color:"info"},{title:"Overdue",value:"0",icon:"tabler-alert-triangle",color:"error"}]),V=s=>{switch(s.toLowerCase()){case"completed":return"success";case"scheduled":return"info";case"overdue":return"error";default:return"primary"}},Q=s=>{const a=new Date(s),t=new Date().getTime()-a.getTime(),d=Math.ceil(t/(1e3*60*60*24));if(d===0)return"Today";if(d===1)return"1 day ago";if(d>1&&d<=7)return`${d} days ago`;if(d>7&&d<=14)return`${Math.ceil(d/7)} week ago`;if(d>14)return`${Math.ceil(d/7)} weeks ago`;if(d<0){const T=Math.abs(d);return T===1?"In 1 day":T<=7?`In ${T} days`:`In ${Math.ceil(T/7)} weeks`}return s};G(n,s=>{const a=s;if(a!=null&&a.success&&(a!=null&&a.data)){const f=a.data;u.value=Array.isArray(f.timeline)?f.timeline.map(t=>({id:t.id,title:t.title,description:t.description,week:t.week,date:t.date||Q(t.created_at),status:t.status,icon:t.icon||"tabler-calendar",color:V(t.status)})):[],f.stats&&(k.value=[{title:"Total Milestones",value:(f.stats.total_milestones||0).toLocaleString(),icon:"tabler-flag",color:"primary"},{title:"Completed",value:(f.stats.completed||0).toLocaleString(),icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:(f.stats.scheduled||0).toLocaleString(),icon:"tabler-calendar",color:"info"},{title:"Overdue",value:(f.stats.overdue||0).toLocaleString(),icon:"tabler-alert-triangle",color:"error"}])}},{immediate:!0});const X=R(()=>r.value==="all"?u.value:u.value.filter(s=>s.status===r.value)),ee=s=>{s.description.includes("Lead")?o.push("/franchisor/dashboard/leads"):(s.description.includes("Task")||s.description.includes("Technical"))&&o.push("/franchisor/dashboard/operations")},te=s=>{s.description.includes("Lead")?o.push("/franchisor/dashboard/leads"):(s.description.includes("Task"),o.push("/franchisor/dashboard/operations"))},ie=s=>{s.description.includes("Lead")?o.push("/franchisor/dashboard/leads"):(s.description.includes("Task"),o.push("/franchisor/dashboard/operations"))};return ke(()=>{_()}),(s,a)=>{const f=le;return C(),w("section",null,[i(De,{class:"mb-6"},{default:l(()=>[(C(!0),w(j,null,N(D(k),t=>(C(),S(Te,{key:t.title,cols:"12",sm:"6",md:"3"},{default:l(()=>[i(x,null,{default:l(()=>[i($,null,{default:l(()=>[m("div",Be,[m("div",null,[m("div",Pe,g(t.title),1),m("h4",Ae,g(t.value),1)]),i(F,{color:t.color,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[i(L,{icon:t.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),i(x,null,{default:l(()=>[i(q,null,{append:l(()=>[m("div",Me,[i(f,{modelValue:D(r),"onUpdate:modelValue":a[0]||(a[0]=t=>pe(r)?r.value=t:null),items:c,placeholder:"Filter"},null,8,["modelValue"])])]),default:l(()=>[i(U,null,{default:l(()=>a[1]||(a[1]=[p("Development Timeline")])),_:1,__:[1]})]),_:1}),i($,null,{default:l(()=>[i(Re,{align:"start","line-inset":"19","truncate-line":"start",justify:"center",density:D(y)?"compact":"default",class:"mt-4"},{default:l(()=>[(C(!0),w(j,null,N(D(X),t=>(C(),S($e,{key:t.id,"fill-dot":"",size:"small"},{opposite:l(()=>[m("div",Oe,[m("span",je,g(t.week),1),m("span",Ne,g(t.date),1)])]),icon:l(()=>[m("div",Ee,[i(F,{size:"32",color:t.color,variant:"tonal"},{default:l(()=>[i(L,{icon:t.icon,size:"20"},null,8,["icon"])]),_:2},1032,["color"])])]),default:l(()=>[i(x,{class:"mb-6 mt-n4"},{default:l(()=>[i(q,{class:"pb-4"},{default:l(()=>[i(U,{class:"d-flex align-center justify-space-between"},{default:l(()=>[m("span",null,g(t.title),1),i(ze,{color:t.color,size:"small",label:"",class:"text-capitalize"},{default:l(()=>[p(g(t.status),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024),i($,null,{default:l(()=>[m("p",Fe,g(t.description),1)]),_:2},1024),i(Se,null,{default:l(()=>[i(I,{variant:"tonal",size:"small",onClick:d=>ee(t)},{default:l(()=>a[2]||(a[2]=[p(" View Details ")])),_:2,__:[2]},1032,["onClick"]),t.status==="overdue"?(C(),S(I,{key:0,variant:"tonal",color:"error",size:"small",onClick:d=>te(t)},{default:l(()=>a[3]||(a[3]=[p(" Take Action ")])),_:2,__:[3]},1032,["onClick"])):E("",!0),t.status==="scheduled"?(C(),S(I,{key:1,variant:"tonal",color:"info",size:"small",onClick:d=>ie(t)},{default:l(()=>a[4]||(a[4]=[p(" Reschedule ")])),_:2,__:[4]},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["density"])]),_:1})]),_:1})])}}}),ft=we(qe,[["__scopeId","data-v-3ce4d52c"]]);export{ft as default};
