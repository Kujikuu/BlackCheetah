import{V as he,_ as _e}from"./VDialog-6C-NQXCx.js";import{V as Ve,_ as be}from"./VDataTableServer-CCw8wB-D.js";import{_ as Ce}from"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import{_ as ye}from"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import{d as xe,r as m,w as Te,P as z,G as De,c as U,b as t,f as a,aR as g,m as s,o as C,F as E,i as R,t as k,ax as y,v,e as p,g as M,x as we,l as X,a9 as w,b3 as Se}from"./main-gemCwVks.js";import{_ as Le}from"./ViewTaskDialog.vue_vue_type_script_setup_true_lang-DR7wBnkT.js";import{_ as Ae}from"./DeleteTaskDialog.vue_vue_type_script_setup_true_lang-fFIWZoVX.js";import{u as Ue}from"./useApi-D_y4oFWX.js";import{a as $e,V as Pe}from"./VTabs-CeX-zYGq.js";import{a as Ie,V as Fe}from"./VWindowItem-CPQ2k3dD.js";import{V as j,a as V}from"./VRow-DiX7eN30.js";import{V as N,a as Be,b as Oe,d as ze}from"./VCard-DJ82mpnW.js";import{V as $}from"./VCardText-BD5AHO-w.js";import{V as Y}from"./VAvatar-12xz6mHy.js";import{V as Z}from"./VDivider-B4ry9pxl.js";import{V as ee}from"./VSpacer-Cpeayo2U.js";import{V as Ee}from"./VMenu-CeaiRCNz.js";import{V as Re,a as H,b as W}from"./VList-MyW-iB3v.js";import{V as te}from"./VChip-DlNApjyg.js";import{V as Me}from"./VForm-FUZpY-zG.js";import"./VOverlay-p8m6-W96.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-BgtgI3QF.js";import"./VImg-DSB6m92Q.js";import"./dialog-transition-C9rYmnXC.js";import"./VDataTable-C-SlKz4P.js";import"./VSelect-C9dxRhag.js";import"./VTextField-BhxF6EAD.js";import"./VField-CsHfcJSz.js";import"./form-DjHlhIbZ.js";import"./VInput-B3GinL-f.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";import"./VTable-0Z68chLt.js";import"./VSlideGroup-CEWgOBQJ.js";/* empty css              */const je={class:"d-flex mb-6"},Ne={class:"d-flex justify-space-between"},He={class:"d-flex flex-column gap-y-1"},We={class:"text-body-1 text-high-emphasis"},Ge={class:"d-flex gap-x-2 align-center"},Qe={class:"text-h4"},qe={class:"text-sm"},Je={class:"me-3 d-flex gap-3"},Ke={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Xe={style:{"inline-size":"15.625rem"}},Ye={class:"d-flex flex-column"},Ze={class:"text-base font-weight-medium"},et={class:"d-flex align-center gap-x-4"},tt={class:"text-body-1"},at={class:"text-body-1"},Mt=xe({__name:"operations",setup(lt){const{data:ae,execute:le,isFetching:st}=Ue("/v1/franchisor/dashboard/operations"),u=m("franchisee"),P=m(""),I=m(),F=m(),x=m(10),T=m(1),se=m(),oe=m(),h=m([]),ie=r=>{var e,c;se.value=(e=r.sortBy[0])==null?void 0:e.key,oe.value=(c=r.sortBy[0])==null?void 0:c.order},re=[{title:"Task",key:"task"},{title:"Assigned To",key:"assignedTo"},{title:"Priority",key:"priority"},{title:"Status",key:"status"},{title:"Due Date",key:"dueDate"},{title:"Actions",key:"actions",sortable:!1}],d=m({franchisee:{tasks:[],total:0},sales:{tasks:[],total:0},staff:{tasks:[],total:0}}),S=m({franchisee:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],sales:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],staff:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}]});Te(ae,r=>{const e=r;if(e!=null&&e.success&&(e!=null&&e.data)){const c=e.data,f=i=>Array.isArray(i)?i.map(l=>({id:l.id,task:l.task,assignedTo:l.assigned_to,priority:l.priority,status:l.status,dueDate:new Date(l.due_date).toLocaleDateString()})):[],_=c.tasks??{franchisee:[],sales:[],staff:[]},o=c.stats??{franchisee:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0},sales:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0},staff:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0}};d.value={franchisee:{tasks:f(_.franchisee),total:o.franchisee.total},sales:{tasks:f(_.sales),total:o.sales.total},staff:{tasks:f(_.staff),total:o.staff.total}},S.value={franchisee:[{title:"Total",value:o.franchisee.total.toLocaleString(),change:o.franchisee.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.franchisee.completed.toLocaleString(),change:o.franchisee.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.franchisee.in_progress.toLocaleString(),change:o.franchisee.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.franchisee.due.toLocaleString(),change:o.franchisee.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],sales:[{title:"Total",value:o.sales.total.toLocaleString(),change:o.sales.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.sales.completed.toLocaleString(),change:o.sales.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.sales.in_progress.toLocaleString(),change:o.sales.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.sales.due.toLocaleString(),change:o.sales.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],staff:[{title:"Total",value:o.staff.total.toLocaleString(),change:o.staff.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.staff.completed.toLocaleString(),change:o.staff.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.staff.in_progress.toLocaleString(),change:o.staff.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.staff.due.toLocaleString(),change:o.staff.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}]}}},{immediate:!0});const B=z(()=>u.value==="franchisee"?d.value.franchisee.tasks:u.value==="sales"?d.value.sales.tasks:d.value.staff.tasks),G=z(()=>u.value==="franchisee"?d.value.franchisee.total:u.value==="sales"?d.value.sales.total:d.value.staff.total),ne=z(()=>u.value==="franchisee"?S.value.franchisee:u.value==="sales"?S.value.sales:S.value.staff);De(()=>{le()});const Q=[{title:"High",value:"high"},{title:"Medium",value:"medium"},{title:"Low",value:"low"}],q=[{title:"Completed",value:"completed"},{title:"In Progress",value:"in_progress"},{title:"Due",value:"due"}],ce=r=>{const e=r.toLowerCase();return e==="completed"?"success":e==="in_progress"?"info":e==="due"?"error":"primary"},ue=r=>{const e=r.toLowerCase();return e==="high"?"error":e==="medium"?"warning":e==="low"?"success":"primary"},D=m(!1),O=m(null),de=r=>{O.value=r,D.value=!0},L=m(!1),b=m(!1),n=m(null),fe=r=>{const c=(u.value==="franchisee"?d.value.franchisee.tasks:u.value==="sales"?d.value.sales.tasks:d.value.staff.tasks).find(f=>f.id===r);c&&(n.value=c,L.value=!0)},pe=r=>{const c=(u.value==="franchisee"?d.value.franchisee.tasks:u.value==="sales"?d.value.sales.tasks:d.value.staff.tasks).find(f=>f.id===r);c&&(n.value={...c},b.value=!0)},J=async()=>{if(!n.value)return;const r=u.value==="franchisee"?d.value.franchisee.tasks:u.value==="sales"?d.value.sales.tasks:d.value.staff.tasks,e=r.findIndex(c=>c.id===n.value.id);e!==-1&&(r[e]={...n.value}),b.value=!1,n.value=null},me=r=>{const e=u.value==="franchisee"?d.value.franchisee.tasks:u.value==="sales"?d.value.sales.tasks:d.value.staff.tasks,c=e.findIndex(f=>f.id===r);c!==-1&&e.splice(c,1),D.value=!1,O.value=null},ve=()=>{const e=["Task,Assigned To,Priority,Status,Due Date",...(h.value.length>0?B.value.filter(o=>h.value.includes(o.id)):B.value).map(o=>`"${o.task}","${o.assignedTo}","${o.priority}","${o.status}","${o.dueDate}"`)].join(`
`),c=new Blob([e],{type:"text/csv"}),f=window.URL.createObjectURL(c),_=document.createElement("a");_.href=f,_.download=`${u.value}_tasks_${h.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,_.click(),window.URL.revokeObjectURL(f)},ge=r=>r>0?`+${r}`:`${r}`,ke=r=>r.split(" ").map(e=>e[0]).join("").toUpperCase(),K=[{title:"Franchisee",value:"franchisee",icon:"tabler-building-store"},{title:"Sales Associate",value:"sales",icon:"tabler-users"},{title:"Staff",value:"staff",icon:"tabler-user"}];return(r,e)=>{const c=ye,f=Ce,_=be,o=_e;return C(),U("section",null,[t($e,{modelValue:s(u),"onUpdate:modelValue":e[0]||(e[0]=i=>g(u)?u.value=i:null),class:"mb-6"},{default:a(()=>[(C(),U(E,null,R(K,i=>t(Pe,{key:i.value,value:i.value},{default:a(()=>[t(y,{icon:i.icon,start:""},null,8,["icon"]),k(" "+v(i.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(Ie,{modelValue:s(u),"onUpdate:modelValue":e[9]||(e[9]=i=>g(u)?u.value=i:null),class:"disable-tab-transition"},{default:a(()=>[(C(),U(E,null,R(K,i=>t(Fe,{key:i.value,value:i.value},{default:a(()=>[p("div",je,[t(j,null,{default:a(()=>[(C(!0),U(E,null,R(s(ne),(l,A)=>(C(),M(V,{key:A,cols:"12",md:"3",sm:"6"},{default:a(()=>[t(N,null,{default:a(()=>[t($,null,{default:a(()=>[p("div",Ne,[p("div",He,[p("div",We,v(l.title),1),p("div",Ge,[p("h4",Qe,v(l.value),1),p("div",{class:we(["text-base",l.change>0?"text-success":"text-error"])}," ("+v(ge(l.change))+"%) ",3)]),p("div",qe,v(l.desc),1)]),t(Y,{color:l.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[t(y,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(N,{class:"mb-6"},{default:a(()=>[t(Be,{class:"pb-4"},{default:a(()=>[t(Oe,null,{default:a(()=>e[20]||(e[20]=[k("Filters")])),_:1,__:[20]})]),_:1}),t($,null,{default:a(()=>[t(j,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s(F),"onUpdate:modelValue":e[1]||(e[1]=l=>g(F)?F.value=l:null),placeholder:"Select Priority",items:Q,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s(I),"onUpdate:modelValue":e[2]||(e[2]=l=>g(I)?I.value=l:null),placeholder:"Select Status",items:q,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Z),t($,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[p("div",Je,[t(c,{"model-value":s(x),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[3]||(e[3]=l=>x.value=parseInt(l,10))},null,8,["model-value"]),s(h).length>0?(C(),M(w,{key:0,variant:"tonal",color:"error",onClick:r.bulkDelete},{default:a(()=>[t(y,{icon:"tabler-trash",class:"me-2"}),k(" Delete Selected ("+v(s(h).length)+") ",1)]),_:1},8,["onClick"])):X("",!0)]),t(ee),p("div",Ke,[p("div",Xe,[t(f,{modelValue:s(P),"onUpdate:modelValue":e[4]||(e[4]=l=>g(P)?P.value=l:null),placeholder:"Search Task"},null,8,["modelValue"])]),t(w,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:ve},{default:a(()=>[k(" Export "+v(s(h).length>0?`(${s(h).length})`:"All"),1)]),_:1})])]),_:1}),t(Z),t(Ve,{"items-per-page":s(x),"onUpdate:itemsPerPage":e[6]||(e[6]=l=>g(x)?x.value=l:null),"model-value":s(h),"onUpdate:modelValue":e[7]||(e[7]=l=>g(h)?h.value=l:null),page:s(T),"onUpdate:page":e[8]||(e[8]=l=>g(T)?T.value=l:null),items:s(B),"item-value":"id","items-length":s(G),headers:re,class:"text-no-wrap","show-select":"","onUpdate:options":ie},{"item.task":a(({item:l})=>[p("div",Ye,[p("h6",Ze,v(l.task),1)])]),"item.assignedTo":a(({item:l})=>[p("div",et,[t(Y,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[p("span",null,v(ke(l.assignedTo)),1)]),_:2},1024),p("div",tt,v(l.assignedTo),1)])]),"item.priority":a(({item:l})=>[t(te,{color:ue(l.priority),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[k(v(l.priority),1)]),_:2},1032,["color"])]),"item.status":a(({item:l})=>[t(te,{color:ce(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[k(v(l.status.replace("_"," ")),1)]),_:2},1032,["color"])]),"item.dueDate":a(({item:l})=>[p("div",at,v(l.dueDate),1)]),"item.actions":a(({item:l})=>[t(w,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[t(y,{icon:"tabler-dots-vertical"}),t(Ee,{activator:"parent"},{default:a(()=>[t(Re,null,{default:a(()=>[t(H,{onClick:A=>fe(l.id)},{prepend:a(()=>[t(y,{icon:"tabler-eye"})]),default:a(()=>[t(W,null,{default:a(()=>e[21]||(e[21]=[k("View")])),_:1,__:[21]})]),_:2},1032,["onClick"]),t(H,{onClick:A=>pe(l.id)},{prepend:a(()=>[t(y,{icon:"tabler-pencil"})]),default:a(()=>[t(W,null,{default:a(()=>e[22]||(e[22]=[k("Edit")])),_:1,__:[22]})]),_:2},1032,["onClick"]),t(H,{onClick:A=>de(l.id)},{prepend:a(()=>[t(y,{icon:"tabler-trash"})]),default:a(()=>[t(W,null,{default:a(()=>e[23]||(e[23]=[k("Delete")])),_:1,__:[23]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[t(_,{page:s(T),"onUpdate:page":e[5]||(e[5]=l=>g(T)?T.value=l:null),"items-per-page":s(x),"total-items":s(G)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(Le,{"is-dialog-visible":s(L),"onUpdate:isDialogVisible":e[10]||(e[10]=i=>g(L)?L.value=i:null),task:s(n)?{...s(n),title:s(n).task,category:"general",description:s(n).task,startDate:null,assignedTo:s(n).assignedTo,dueDate:s(n).dueDate,priority:s(n).priority,status:s(n).status,estimatedHours:0,actualHours:0}:null},null,8,["is-dialog-visible","task"]),t(he,{modelValue:s(b),"onUpdate:modelValue":e[18]||(e[18]=i=>g(b)?b.value=i:null),"max-width":"600"},{default:a(()=>[t(o,{onClick:e[11]||(e[11]=i=>b.value=!1)}),s(n)?(C(),M(N,{key:0,title:"Edit Task"},{default:a(()=>[t($,null,{default:a(()=>[t(Me,{onSubmit:Se(J,["prevent"])},{default:a(()=>[t(j,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(f,{modelValue:s(n).task,"onUpdate:modelValue":e[12]||(e[12]=i=>s(n).task=i),label:"Task",placeholder:"Enter task description"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"6"},{default:a(()=>[t(f,{modelValue:s(n).assignedTo,"onUpdate:modelValue":e[13]||(e[13]=i=>s(n).assignedTo=i),label:"Assigned To",placeholder:"Enter assignee name"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"6"},{default:a(()=>[t(f,{modelValue:s(n).dueDate,"onUpdate:modelValue":e[14]||(e[14]=i=>s(n).dueDate=i),label:"Due Date",type:"date"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(n).priority,"onUpdate:modelValue":e[15]||(e[15]=i=>s(n).priority=i),label:"Priority",items:Q,placeholder:"Select priority"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(n).status,"onUpdate:modelValue":e[16]||(e[16]=i=>s(n).status=i),label:"Status",items:q,placeholder:"Select status"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(ze,null,{default:a(()=>[t(ee),t(w,{color:"secondary",variant:"tonal",onClick:e[17]||(e[17]=i=>b.value=!1)},{default:a(()=>e[24]||(e[24]=[k(" Cancel ")])),_:1,__:[24]}),t(w,{color:"primary",onClick:J},{default:a(()=>e[25]||(e[25]=[k(" Save Changes ")])),_:1,__:[25]})]),_:1})]),_:1})):X("",!0)]),_:1},8,["modelValue"]),t(Ae,{"is-dialog-visible":s(D),"onUpdate:isDialogVisible":e[19]||(e[19]=i=>g(D)?D.value=i:null),"task-id":s(O),onTaskDeleted:me},null,8,["is-dialog-visible","task-id"])])}}});export{Mt as default};
