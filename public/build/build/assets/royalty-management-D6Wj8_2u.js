import{f as Q}from"./formatters--UtN2sCw.js";import{d as Te,r as d,P as ye,G as qe,c as Fe,b as a,f as l,b5 as X,o as A,e as s,a9 as f,t as u,ax as _,v as i,m as L,g as z,l as I,b3 as pe}from"./main-ZX0RELSf.js";import{r as P}from"./royalty-BGEbTdv6.js";import{V as h,a as n}from"./VRow-Cqbjxu10.js";import{V as B}from"./VDialog-Dnb-q-MU.js";import{V}from"./VSelect-CM_Ce6Fz.js";import{V as b,a as M,b as T,c as Oe,d as N}from"./VCard-BPtOKe4P.js";import{V as w}from"./VCardText-DO_FRZge.js";import{V as fe}from"./VAvatar-Dwbi0l9K.js";import{S as je}from"./saudi-riyal-BIqFB-kD.js";import{V as q}from"./VDivider-DRORfMXN.js";import{V as Le}from"./VDataTable-CHmbGzQf.js";import{V as ve}from"./VTooltip-BqTXI_Ub.js";import{V as K}from"./VChip-BX1klc4g.js";import{V as ze}from"./VAlert-DtX8sKY_.js";import{V as E}from"./VSpacer-DBsXqXW-.js";import{V as ce}from"./VForm-CMcQHaRk.js";import{V as v}from"./VTextField-vxp1RpFW.js";import{V as _e}from"./VTextarea-KmmZ1HjF.js";import{V as Ie}from"./VFileInput-BX2KlnoB.js";import{V as Be}from"./VTable-BRZOEiHP.js";/* empty css              */import"./VOverlay-B0AA_Njd.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-B6sKQhYQ.js";import"./VImg-BhWA0TmX.js";import"./dialog-transition-DDagBWdU.js";import"./form-BPJFMOHG.js";import"./VList-lm2yDhsx.js";import"./VMenu-CFk79Z2P.js";import"./VCheckboxBtn-CZL42UAA.js";import"./VSelectionControl-6Sm4Tpt1.js";import"./VSlideGroup-D2CZ4fkn.js";import"./VField-D__vLB60.js";import"./VInput-CMh6ZUdK.js";const Ne={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Ee={class:"d-flex gap-3 align-center flex-wrap"},$e={class:"d-flex align-center justify-space-between"},Ge={class:"text-h4 text-success"},Ye={class:"d-flex align-center justify-space-between"},He={class:"text-h4 text-warning"},Je={class:"font-weight-medium"},Qe={class:"font-weight-medium text-primary"},Xe={class:"text-body-2 text-medium-emphasis"},Ke={class:"text-body-2"},We={class:"font-weight-medium text-info"},Ze={class:"font-weight-medium text-success"},et={class:"d-flex gap-2"},tt={class:"text-body-2"},at={class:"mb-4"},lt={class:"font-weight-medium"},ot={class:"mb-4"},st={class:"font-weight-medium"},rt={class:"mb-4"},nt={class:"font-weight-medium text-primary"},it={class:"mb-4"},ut={class:"font-weight-medium"},dt={class:"text-center"},mt={class:"text-h6 font-weight-bold"},yt={class:"text-center"},pt={class:"text-h6 font-weight-bold"},ft={class:"text-center"},vt={class:"text-h6 font-weight-bold"},ct={class:"mb-4"},_t={class:"mb-4"},bt={class:"font-weight-medium"},gt={class:"text-end"},Vt={class:"text-end"},xt={class:"text-end"},ht={class:"bg-primary-lighten-5"},wt={class:"text-end font-weight-bold text-primary"},ra=Te({__name:"royalty-management",setup(kt){const W=d(!1),Z=d(!1),F=d(!1),g=d("monthly"),k=d(!1),C=d(!1),R=d(!1),S=d(!1),O=d(null),m=d(null),D=d("csv"),j=d("all"),r=d({franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}),ee=d([]),te=d([]),ae=d([]),c=d({amount_paid:0,payment_date:"",payment_type:"",attachment:null}),le=d([]),$=d({royalty_collected_till_date:0,upcoming_royalties:0,total_royalties:0,pending_amount:0,paid_amount:0,overdue_amount:0,overdue_count:0}),be=ye(()=>{var e;const t=(e=$.value)==null?void 0:e.royalty_collected_till_date;return t?Number(t):0}),ge=ye(()=>{var e;const t=(e=$.value)==null?void 0:e.upcoming_royalties;return t?Number(t):0}),oe=[{title:"Monthly",value:"monthly"},{title:"Quarterly",value:"quarterly"},{title:"Annual",value:"annual"},{title:"Special",value:"special"}],Ve=[{title:"CSV",value:"csv"},{title:"Excel",value:"excel"}],se=[{title:"All Royalties",value:"all"},{title:"Paid Only",value:"paid"},{title:"Pending Only",value:"pending"},{title:"Overdue Only",value:"overdue"}],xe=[{title:"Bank Transfer",value:"bank_transfer"},{title:"Credit Card",value:"credit_card"},{title:"Mada",value:"mada"},{title:"STC Pay",value:"stc_pay"},{title:"SADAD",value:"sadad"},{title:"Check",value:"check"},{title:"Cash",value:"cash"},{title:"Online Payment",value:"online_payment"}],he=[{title:"Billing Period",key:"billingPeriod",sortable:!0},{title:"Franchisee Name",key:"franchiseeName",sortable:!0},{title:"Store Location",key:"storeLocation",sortable:!0},{title:"Due Date",key:"dueDate",sortable:!0},{title:"Gross Sales (SAR)",key:"grossSales",sortable:!0},{title:"Royalty %",key:"royaltyPercentage",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],G=async()=>{try{W.value=!0;const t=await P.getRoyalties({period:g.value});le.value=t.data.data}catch{}finally{W.value=!1}},Y=async()=>{try{Z.value=!0;const t=await P.getStatistics({period:g.value});$.value=t.data}catch{}finally{Z.value=!1}},we=()=>{k.value=!0},ke=async()=>{try{const t=await P.exportRoyalties({format:D.value,data_type:j.value,period:g.value}),e=window.URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download=`royalty-data-${g.value}-${new Date().toISOString().split("T")[0]}.${D.value==="csv"?"csv":"xlsx"}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e),k.value=!1}catch{}},Ce=t=>{m.value=t,R.value=!0},re=t=>{O.value=t,c.value={amount_paid:t.amount,payment_date:new Date().toISOString().split("T")[0],payment_type:"",attachment:null},C.value=!0},ne=async()=>{if(O.value)try{await P.markAsPaid(O.value.id,c.value),await G(),await Y(),C.value=!1,O.value=null,c.value={amount_paid:0,payment_date:"",payment_type:"",attachment:null}}catch{}},Re=t=>{const e=t.target;e.files&&e.files[0]&&(c.value.attachment=e.files[0])},ie=t=>{switch(t){case"paid":return"success";case"pending":return"warning";case"overdue":return"error";default:return"default"}},ue=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Se=async()=>{try{const t=await X("/api/v1/franchisor/franchise");t.success&&t.data&&(ee.value=[t.data])}catch{}},De=async()=>{try{const t=await X("/api/v1/franchisor/units");t.success&&t.data&&(te.value=t.data.data||[])}catch{}},Ue=async()=>{try{const t=await X("/api/v1/franchisor/franchisees");t.success&&t.data&&(ae.value=t.data.data||[])}catch{}},x=()=>{const t=r.value.base_revenue;r.value.royalty_amount=t*r.value.royalty_rate/100,r.value.marketing_fee_amount=t*r.value.marketing_fee_rate/100,r.value.technology_fee_rate>0&&(r.value.technology_fee_amount=t*r.value.technology_fee_rate/100),r.value.total_amount=r.value.royalty_amount+r.value.marketing_fee_amount+r.value.technology_fee_amount+r.value.other_fees+r.value.adjustments},de=async()=>{try{if(F.value=!0,Me(),!await Pe())return;x();const e={...r.value,franchise_id:r.value.franchise_id||void 0,unit_id:r.value.unit_id||void 0,franchisee_id:r.value.franchisee_id||void 0};(await P.createRoyalty(e)).success&&(me(),S.value=!1,await G(),await Y())}catch{}finally{F.value=!1}},me=()=>{r.value={franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}},Ae=()=>{me(),S.value=!0};qe(()=>{G(),Y(),Se(),De(),Ue()});const y=d({}),p={franchise_id:[t=>!!t||"Franchise selection is required"],franchisee_id:[t=>!!t||"Franchisee selection is required"],type:[t=>!!t||"Royalty type is required",t=>["monthly","quarterly"].includes(t)||"Invalid royalty type"],period_year:[t=>!!t||"Period year is required",t=>t>=2020||"Period year must be at least 2020",t=>t<=new Date().getFullYear()+1||"Period year cannot be more than next year"],period_month:[t=>r.value.type==="monthly"?!!t||"Period month is required for monthly royalties":!0,t=>t&&(t<1||t>12)?"Period month must be between 1 and 12":!0],period_quarter:[t=>r.value.type==="quarterly"?!!t||"Period quarter is required for quarterly royalties":!0,t=>t&&(t<1||t>4)?"Period quarter must be between 1 and 4":!0],base_revenue:[t=>t!=null&&t!==""||"Base revenue is required",t=>t>=0||"Base revenue cannot be negative",t=>t<=99999999999e-2||"Base revenue is too large"],royalty_rate:[t=>t!=null&&t!==""||"Royalty rate is required",t=>t>=0||"Royalty rate cannot be negative",t=>t<=100||"Royalty rate cannot exceed 100%"],marketing_fee_rate:[t=>t!=null&&t!==""||"Marketing fee rate is required",t=>t>=0||"Marketing fee rate cannot be negative",t=>t<=100||"Marketing fee rate cannot exceed 100%"],due_date:[t=>!!t||"Due date is required",t=>{if(t){const e=new Date().toISOString().split("T")[0];return t>=e||"Due date cannot be in the past"}return!0}],technology_fee_amount:[t=>t==null||t===""||t>=0||"Technology fee cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Technology fee is too large"],other_fees:[t=>t==null||t===""||t>=0||"Other fees cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Other fees is too large"],adjustments:[t=>t==null||t===""||t>=-99999999999e-2||"Adjustments value is too low",t=>t==null||t===""||t<=99999999999e-2||"Adjustments value is too high"],description:[t=>!t||t.length<=1e3||"Description cannot exceed 1000 characters"],notes:[t=>!t||t.length<=2e3||"Notes cannot exceed 2000 characters"]},H=d(!1),U=d(),Pe=async()=>{if(U.value){const{valid:t}=await U.value.validate();return H.value=t,t}return!1},Me=()=>{y.value={},U.value&&U.value.resetValidation()};return(t,e)=>(A(),Fe("section",null,[a(h,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[s("div",Ne,[e[33]||(e[33]=s("div",null,[s("h4",{class:"text-h4 mb-1"}," Royalty Management "),s("p",{class:"text-body-1 text-medium-emphasis"}," Track and manage royalty payments from all franchise units ")],-1)),s("div",Ee,[a(V,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o),items:oe,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"]),a(f,{color:"success",variant:"elevated",onClick:Ae},{default:l(()=>[a(_,{icon:"tabler-plus",class:"me-2"}),e[31]||(e[31]=u(" Create Royalty "))]),_:1,__:[31]}),a(f,{color:"primary",variant:"elevated",onClick:we},{default:l(()=>[a(_,{icon:"tabler-download",class:"me-2"}),e[32]||(e[32]=u(" Export "))]),_:1,__:[32]})])])]),_:1})]),_:1}),a(h,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(b,null,{default:l(()=>[a(w,null,{default:l(()=>[s("div",$e,[s("div",null,[e[34]||(e[34]=s("h6",{class:"text-h6 mb-1"}," Royalty Collected Till Date ",-1)),e[35]||(e[35]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Total payments received ",-1)),s("h4",Ge,i(("formatCurrency"in t?t.formatCurrency:L(Q))(be.value,"SAR",!0)),1)]),a(fe,{color:"success",variant:"tonal",size:"56"},{default:l(()=>[a(L(je),{size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(b,null,{default:l(()=>[a(w,null,{default:l(()=>[s("div",Ye,[s("div",null,[e[36]||(e[36]=s("h6",{class:"text-h6 mb-1"}," Upcoming Royalties ",-1)),e[37]||(e[37]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Pending payments due ",-1)),s("h4",He,i(("formatCurrency"in t?t.formatCurrency:L(Q))(ge.value,"SAR",!0)),1)]),a(fe,{color:"warning",variant:"tonal",size:"56"},{default:l(()=>[a(_,{icon:"tabler-clock",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(b,null,{default:l(()=>[a(M,{class:"pb-4"},{default:l(()=>[a(T,{class:"text-h6"},{default:l(()=>e[38]||(e[38]=[u(" Royalty Records ")])),_:1,__:[38]}),a(Oe,{class:"text-body-2"},{default:l(()=>e[39]||(e[39]=[u(" Manage royalty payments and track collection status ")])),_:1,__:[39]})]),_:1}),a(q),a(Le,{headers:he,items:le.value,"items-per-page":10,class:"text-no-wrap"},{"item.billingPeriod":l(({item:o})=>[s("div",Je,i(o.billing_period),1)]),"item.franchiseeName":l(({item:o})=>[s("div",Qe,i(o.franchisee_name),1)]),"item.storeLocation":l(({item:o})=>[s("div",Xe,i(o.store_location),1)]),"item.dueDate":l(({item:o})=>[s("div",Ke,i(ue(o.due_date)),1)]),"item.grossSales":l(({item:o})=>[s("div",We,i(("formatCurrency"in t?t.formatCurrency:L(Q))(o.gross_sales||0,"SAR",!1)),1)]),"item.royaltyPercentage":l(({item:o})=>[a(K,{size:"small",variant:"tonal",color:"primary"},{default:l(()=>[u(i(o.royalty_percentage)+"% ",1)]),_:2},1024)]),"item.amount":l(({item:o})=>[s("div",Ze,i((o.amount||0).toLocaleString()),1)]),"item.status":l(({item:o})=>[a(K,{color:ie(o.status),size:"small",variant:"tonal",class:"text-capitalize"},{default:l(()=>[u(i(o.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[s("div",et,[a(f,{icon:"",size:"small",color:"info",variant:"text",onClick:J=>Ce(o)},{default:l(()=>[a(_,{icon:"tabler-eye",size:"20"}),a(ve,{activator:"parent",location:"top"},{default:l(()=>e[40]||(e[40]=[u(" View Details ")])),_:1,__:[40]})]),_:2},1032,["onClick"]),o.status!=="paid"?(A(),z(f,{key:0,icon:"",size:"small",color:"success",variant:"text",onClick:J=>re(o)},{default:l(()=>[a(_,{icon:"tabler-check",size:"20"}),a(ve,{activator:"parent",location:"top"},{default:l(()=>e[41]||(e[41]=[u(" Mark as Completed ")])),_:1,__:[41]})]),_:2},1032,["onClick"])):I("",!0)])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),a(B,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),"max-width":"500"},{default:l(()=>[a(b,null,{default:l(()=>[a(M,null,{default:l(()=>[a(T,null,{default:l(()=>e[42]||(e[42]=[u("Export Royalty Data")])),_:1,__:[42]})]),_:1}),a(w,null,{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=o=>j.value=o),items:se,"item-title":"title","item-value":"value",label:"Data Type",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=o=>D.value=o),items:Ve,"item-title":"title","item-value":"value",label:"Export Format",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),a(ze,{type:"info",variant:"tonal",class:"mt-4"},{default:l(()=>{var o;return[s("div",tt,[e[43]||(e[43]=s("strong",null,"Current Selection:",-1)),e[44]||(e[44]=s("br",null,null,-1)),u(" Period: "+i(g.value.charAt(0).toUpperCase()+g.value.slice(1)),1),e[45]||(e[45]=s("br",null,null,-1)),u(" Data Type: "+i((o=se.find(J=>J.value===j.value))==null?void 0:o.title),1),e[46]||(e[46]=s("br",null,null,-1)),u(" Format: "+i(D.value.toUpperCase()),1)])]}),_:1})]),_:1}),a(N,null,{default:l(()=>[a(E),a(f,{color:"secondary",variant:"tonal",onClick:e[3]||(e[3]=o=>k.value=!1)},{default:l(()=>e[47]||(e[47]=[u(" Cancel ")])),_:1,__:[47]}),a(f,{color:"primary",onClick:ke},{default:l(()=>e[48]||(e[48]=[u(" Export Data ")])),_:1,__:[48]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:S.value,"onUpdate:modelValue":e[22]||(e[22]=o=>S.value=o),"max-width":"800",persistent:""},{default:l(()=>[a(b,null,{default:l(()=>[a(M,null,{default:l(()=>[a(T,null,{default:l(()=>e[49]||(e[49]=[u("Create New Royalty Record")])),_:1,__:[49]})]),_:1}),a(w,null,{default:l(()=>[a(ce,{ref_key:"formRef",ref:U,modelValue:H.value,"onUpdate:modelValue":e[20]||(e[20]=o=>H.value=o),onSubmit:pe(de,["prevent"])},{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.franchise_id,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.franchise_id=o),items:ee.value,"item-title":"business_name","item-value":"id",label:"Franchise *",variant:"outlined",density:"compact",required:"",clearable:"",rules:p.franchise_id,"error-messages":y.value.franchise_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.unit_id,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.unit_id=o),items:te.value,"item-title":"unit_name","item-value":"id",label:"Unit",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.franchisee_id,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.franchisee_id=o),items:ae.value,"item-title":"name","item-value":"id",label:"Franchisee *",variant:"outlined",density:"compact",required:"",clearable:"",rules:p.franchisee_id,"error-messages":y.value.franchisee_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.type,"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.type=o),items:oe,"item-title":"title","item-value":"value",label:"Royalty Type *",variant:"outlined",density:"compact",required:"",rules:p.type,"error-messages":y.value.type},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(v,{modelValue:r.value.period_year,"onUpdate:modelValue":e[9]||(e[9]=o=>r.value.period_year=o),modelModifiers:{number:!0},label:"Period Year *",type:"number",variant:"outlined",density:"compact",required:"",rules:p.period_year,"error-messages":y.value.period_year},null,8,["modelValue","rules","error-messages"])]),_:1}),r.value.type==="monthly"?(A(),z(n,{key:0,cols:"12",md:"4"},{default:l(()=>[a(v,{modelValue:r.value.period_month,"onUpdate:modelValue":e[10]||(e[10]=o=>r.value.period_month=o),modelModifiers:{number:!0},label:"Period Month *",type:"number",min:"1",max:"12",variant:"outlined",density:"compact",required:"",rules:p.period_month,"error-messages":y.value.period_month},null,8,["modelValue","rules","error-messages"])]),_:1})):I("",!0),a(n,{cols:"12",md:"4"},{default:l(()=>[a(v,{modelValue:r.value.due_date,"onUpdate:modelValue":e[11]||(e[11]=o=>r.value.due_date=o),label:"Due Date *",type:"date",variant:"outlined",density:"compact",required:"",rules:p.due_date,"error-messages":y.value.due_date},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.base_revenue,"onUpdate:modelValue":e[12]||(e[12]=o=>r.value.base_revenue=o),modelModifiers:{number:!0},label:"Base Revenue (SAR) *",type:"number",step:"0.01",variant:"outlined",density:"compact",required:"",rules:p.base_revenue,"error-messages":y.value.base_revenue,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.royalty_rate,"onUpdate:modelValue":e[13]||(e[13]=o=>r.value.royalty_rate=o),modelModifiers:{number:!0},label:"Royalty Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",rules:p.royalty_rate,"error-messages":y.value.royalty_rate,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.marketing_fee_rate,"onUpdate:modelValue":e[14]||(e[14]=o=>r.value.marketing_fee_rate=o),modelModifiers:{number:!0},label:"Marketing Fee Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",rules:p.marketing_fee_rate,"error-messages":y.value.marketing_fee_rate,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.technology_fee_amount,"onUpdate:modelValue":e[15]||(e[15]=o=>r.value.technology_fee_amount=o),modelModifiers:{number:!0},label:"Technology Fee (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.technology_fee_amount,"error-messages":y.value.technology_fee_amount,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.other_fees,"onUpdate:modelValue":e[16]||(e[16]=o=>r.value.other_fees=o),modelModifiers:{number:!0},label:"Other Fees (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.other_fees,"error-messages":y.value.other_fees,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:r.value.adjustments,"onUpdate:modelValue":e[17]||(e[17]=o=>r.value.adjustments=o),modelModifiers:{number:!0},label:"Adjustments (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.adjustments,"error-messages":y.value.adjustments,onInput:x},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(_e,{modelValue:r.value.description,"onUpdate:modelValue":e[18]||(e[18]=o=>r.value.description=o),label:"Description",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(_e,{modelValue:r.value.notes,"onUpdate:modelValue":e[19]||(e[19]=o=>r.value.notes=o),label:"Notes",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(N,null,{default:l(()=>[a(E),a(f,{color:"secondary",variant:"tonal",disabled:F.value,onClick:e[21]||(e[21]=o=>S.value=!1)},{default:l(()=>e[50]||(e[50]=[u(" Cancel ")])),_:1,__:[50]},8,["disabled"]),a(f,{color:"primary",loading:F.value,onClick:de},{default:l(()=>e[51]||(e[51]=[u(" Create Royalty ")])),_:1,__:[51]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:C.value,"onUpdate:modelValue":e[27]||(e[27]=o=>C.value=o),"max-width":"600"},{default:l(()=>[a(b,null,{default:l(()=>[a(M,null,{default:l(()=>[a(T,null,{default:l(()=>e[52]||(e[52]=[u("Mark Royalty as Completed")])),_:1,__:[52]})]),_:1}),a(w,null,{default:l(()=>[a(ce,{onSubmit:pe(ne,["prevent"])},{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:c.value.amount_paid,"onUpdate:modelValue":e[23]||(e[23]=o=>c.value.amount_paid=o),modelModifiers:{number:!0},label:"Amount Paid (SAR)",type:"number",variant:"outlined",density:"compact",rules:[o=>!!o||"Amount is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(v,{modelValue:c.value.payment_date,"onUpdate:modelValue":e[24]||(e[24]=o=>c.value.payment_date=o),label:"Payment Date",type:"date",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment date is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:c.value.payment_type,"onUpdate:modelValue":e[25]||(e[25]=o=>c.value.payment_type=o),items:xe,"item-title":"title","item-value":"value",label:"Payment Type",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment type is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(Ie,{label:"Attachment (Optional)",variant:"outlined",density:"compact",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:Re}),e[53]||(e[53]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Supported formats: PDF, JPG, PNG, DOC, DOCX ",-1))]),_:1,__:[53]})]),_:1})]),_:1})]),_:1}),a(N,null,{default:l(()=>[a(E),a(f,{color:"secondary",variant:"tonal",onClick:e[26]||(e[26]=o=>C.value=!1)},{default:l(()=>e[54]||(e[54]=[u(" Cancel ")])),_:1,__:[54]}),a(f,{color:"primary",onClick:ne},{default:l(()=>e[55]||(e[55]=[u(" Mark as Completed ")])),_:1,__:[55]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:R.value,"onUpdate:modelValue":e[30]||(e[30]=o=>R.value=o),"max-width":"700"},{default:l(()=>[m.value?(A(),z(b,{key:0},{default:l(()=>[a(M,null,{default:l(()=>[a(T,null,{default:l(()=>e[56]||(e[56]=[u("Royalty Details")])),_:1,__:[56]})]),_:1}),a(q,{class:"mb-4"}),a(w,null,{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>e[57]||(e[57]=[s("h6",{class:"text-h6 mb-4 text-primary"}," Basic Information ",-1)])),_:1,__:[57]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",at,[e[58]||(e[58]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Billing Period ",-1)),s("div",lt,i(m.value.billing_period),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",ot,[e[59]||(e[59]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Due Date ",-1)),s("div",st,i(ue(m.value.due_date)),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",rt,[e[60]||(e[60]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Franchisee Name ",-1)),s("div",nt,i(m.value.franchisee_name),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",it,[e[61]||(e[61]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Store Location ",-1)),s("div",ut,i(m.value.store_location),1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[62]||(e[62]=s("h6",{class:"text-h6 mb-4 text-primary"}," Financial Details ",-1))]),_:1,__:[62]}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(b,{variant:"tonal",color:"info",class:"pa-4"},{default:l(()=>[s("div",dt,[a(_,{icon:"tabler-chart-line",size:"32",class:"mb-2"}),e[63]||(e[63]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Gross Sales ",-1)),s("div",mt,i((m.value.gross_sales||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(b,{variant:"tonal",color:"primary",class:"pa-4"},{default:l(()=>[s("div",yt,[a(_,{icon:"tabler-percentage",size:"32",class:"mb-2"}),e[64]||(e[64]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Rate ",-1)),s("div",pt,i(m.value.royalty_percentage)+"% ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(b,{variant:"tonal",color:"success",class:"pa-4"},{default:l(()=>[s("div",ft,[a(_,{icon:"tabler-coins",size:"32",class:"mb-2"}),e[65]||(e[65]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Amount ",-1)),s("div",vt,i((m.value.amount||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[66]||(e[66]=s("h6",{class:"text-h6 mb-4 text-primary"}," Status Information ",-1))]),_:1,__:[66]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",ct,[e[67]||(e[67]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Payment Status ",-1)),a(K,{color:ie(m.value.status),size:"large",variant:"tonal",class:"text-capitalize"},{default:l(()=>[a(_,{icon:m.value.status==="paid"?"tabler-check":m.value.status==="pending"?"tabler-clock":"tabler-alert-triangle",class:"me-2"},null,8,["icon"]),u(" "+i(m.value.status),1)]),_:1},8,["color"])])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",_t,[e[68]||(e[68]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Days Until Due ",-1)),s("div",bt,i(Math.ceil((new Date(m.value.due_date).getTime()-new Date().getTime())/(1e3*60*60*24)))+" days ",1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[69]||(e[69]=s("h6",{class:"text-h6 mb-4 text-primary"}," Calculation Breakdown ",-1))]),_:1,__:[69]}),a(n,{cols:"12"},{default:l(()=>[a(Be,{density:"compact"},{default:l(()=>[s("tbody",null,[s("tr",null,[e[70]||(e[70]=s("td",{class:"font-weight-medium"}," Gross Sales: ",-1)),s("td",gt,i((m.value.gross_sales||0).toLocaleString())+" SAR ",1)]),s("tr",null,[e[71]||(e[71]=s("td",{class:"font-weight-medium"}," Royalty Rate: ",-1)),s("td",Vt,i(m.value.royalty_percentage)+"% ",1)]),s("tr",null,[e[72]||(e[72]=s("td",{class:"font-weight-medium"}," Calculation: ",-1)),s("td",xt,i((m.value.gross_sales||0).toLocaleString())+" Ã— "+i(m.value.royalty_percentage)+"% ",1)]),s("tr",ht,[e[73]||(e[73]=s("td",{class:"font-weight-bold text-primary"}," Total Royalty Amount: ",-1)),s("td",wt,i((m.value.amount||0).toLocaleString())+" SAR ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:l(()=>[a(E),a(f,{color:"secondary",variant:"tonal",onClick:e[28]||(e[28]=o=>R.value=!1)},{default:l(()=>e[74]||(e[74]=[u(" Close ")])),_:1,__:[74]}),m.value.status!=="paid"?(A(),z(f,{key:0,color:"primary",onClick:e[29]||(e[29]=o=>{re(m.value),R.value=!1})},{default:l(()=>[a(_,{icon:"tabler-check",class:"me-2"}),e[75]||(e[75]=u(" Mark as Completed "))]),_:1,__:[75]})):I("",!0)]),_:1})]),_:1})):I("",!0)]),_:1},8,["modelValue"])]))}});export{ra as default};
