import{a as oe}from"./formatters-WDr9EcLN.js";import{d as xe,r as m,P as ie,G as we,c as M,b as t,f as a,au as V,m as s,aO as R,o as y,t as d,e as n,g as U,l as z,a3 as _,aa as b,v as r,F as Se,i as Ce,aM as Ae}from"./main-D0PmdS1Y.js";import{V as he,_ as ke}from"./VDataTableServer-By6shMb6.js";import{_ as Ee}from"./AppTextField.vue_vue_type_script_setup_true_lang-Bd9HByxJ.js";import{_ as Ue}from"./AppSelect.vue_vue_type_script_setup_true_lang-CDeD-2O6.js";import{V as I,a as O,b as G,d as W}from"./VCard-B7UpWRaQ.js";import{V as X}from"./VDialog-sZu71cKP.js";import{V as L}from"./VCardText-CIwjKnf_.js";import{V as K,a as p}from"./VRow-Cak-Lgex.js";import{V as Y}from"./VDivider-BtoRnDHG.js";import{V as j}from"./VSpacer-CdkRG-y7.js";import{V as ne}from"./VMenu-DOD60N4z.js";import{V as re,a as F,b as B}from"./VList-pUfpgzrf.js";import{V as J}from"./VChip-DdEqOyic.js";import{V as ue}from"./VAvatar-CxHe0yBd.js";import{V as Le}from"./VImg-jjfUM9_b.js";import{V as Te}from"./VTable-CN_P_eEe.js";import{V as $e}from"./VForm-aksOmHMd.js";import"./VPagination-DkAbFOUn.js";import"./VDataTable-CPa50lFd.js";import"./VSelect-RqmmXubD.js";import"./VTextField-B880wQkJ.js";/* empty css                   */import"./VCounter-DBvBtD1O.js";import"./VField-D5-MFzvq.js";import"./form-BAdaD-wq.js";import"./easing-Bybner-F.js";import"./VInput-DP_kSFGC.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-CIZ4lwe7.js";import"./VOverlay-B9QLNbJM.js";import"./lazy-D5mATHLk.js";import"./scopeId-BKGdYQgZ.js";import"./VCheckboxBtn-Zi_PB_hu.js";import"./VSelectionControl-mXH6gVlO.js";import"./filter-L-0-N-uW.js";/* empty css              */import"./ssrBoot-BefThYZR.js";import"./VSlideGroup-CFIWL1zD.js";const Pe={class:"me-3 d-flex gap-3"},De={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ne={style:{"inline-size":"15.625rem"}},ze={class:"d-flex align-center gap-x-4"},Ie={key:1},Fe={class:"d-flex flex-column"},Be={class:"text-base font-weight-medium"},qe={class:"text-body-1"},Me={class:"text-body-1"},Re={class:"text-body-1 font-weight-medium"},Oe={class:"d-flex align-center gap-4 mb-6"},Ge={class:"text-h4"},Ke={class:"text-h4 mb-1"},je={class:"mb-4"},Je={class:"text-body-1"},Ze={class:"mb-4"},Qe={class:"text-body-1"},He={class:"mb-4"},We={class:"text-body-1"},Xe={class:"mb-4"},Ye={class:"text-body-1"},et={class:"mb-4"},tt={class:"text-body-1"},lt={class:"mb-4"},at={class:"text-body-1"},Gt=xe({__name:"sales-associates",setup(st){const T=m(""),$=m(),g=m(10),x=m(1),Z=m(),Q=m(),v=m([]),q=m(!1),S=m(!1);m(!1);const P=m(),de=i=>{var e,u;Z.value=(e=i.sortBy[0])==null?void 0:e.key,Q.value=(u=i.sortBy[0])==null?void 0:u.order,H()},me=[{title:"Sales Associate",key:"name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Status",key:"status"},{title:"Assigned Leads",key:"assignedLeads"},{title:"Actions",key:"actions",sortable:!1}],C=m({associates:[],total:0}),w=ie(()=>C.value.associates),ee=ie(()=>C.value.total),ce=i=>({new:"primary",contacted:"info",qualified:"warning",converted:"success",lost:"error",follow_up:"secondary"})[i]||"default",pe=i=>({low:"success",medium:"warning",high:"error"})[i]||"default",H=async()=>{try{q.value=!0;const i=new URLSearchParams({page:x.value.toString(),per_page:g.value.toString()});T.value&&i.append("search",T.value),$.value&&i.append("status",$.value),Z.value&&i.append("sort_by",Z.value),Q.value&&i.append("order_by",Q.value);const e=await R(`/v1/franchisor/sales-associates?${i.toString()}`,{method:"GET"});e.success&&(C.value={associates:e.data||[],total:e.total||0})}catch(i){console.error("Error fetching sales associates:",i)}finally{q.value=!1}},te=[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],ve=[{title:"United States",value:"United States"},{title:"Canada",value:"Canada"},{title:"United Kingdom",value:"United Kingdom"},{title:"Australia",value:"Australia"},{title:"Germany",value:"Germany"},{title:"France",value:"France"},{title:"Japan",value:"Japan"},{title:"Brazil",value:"Brazil"},{title:"India",value:"India"},{title:"Mexico",value:"Mexico"},{title:"Spain",value:"Spain"},{title:"Italy",value:"Italy"},{title:"Netherlands",value:"Netherlands"},{title:"Sweden",value:"Sweden"},{title:"Norway",value:"Norway"},{title:"Switzerland",value:"Switzerland"},{title:"South Korea",value:"South Korea"},{title:"Singapore",value:"Singapore"},{title:"New Zealand",value:"New Zealand"},{title:"South Africa",value:"South Africa"}],le=i=>{const e=i.toLowerCase();return e==="active"?"success":e==="inactive"?"secondary":"primary"},A=m(!1),h=m(null),fe=i=>{h.value=i,A.value=!0},ye=async()=>{if(h.value!==null)try{if(S.value=!0,(await R(`/v1/franchisor/sales-associates/${h.value}`,{method:"DELETE"})).success){const e=C.value.associates.findIndex(c=>c.id===h.value);e!==-1&&(C.value.associates.splice(e,1),C.value.total-=1);const u=v.value.findIndex(c=>c===h.value);u!==-1&&v.value.splice(u,1),console.log("Sales associate deleted successfully")}}catch(i){console.error("Error deleting sales associate:",i)}finally{S.value=!1,A.value=!1,h.value=null}},k=m(!1),D=m(!1),N=m(!1),o=m(null),_e=async i=>{if(i===null)return;const e=w.value.find(u=>u.id===i);if(e)try{q.value=!0;const u=await R(`/v1/franchisor/sales-associates/${e.id}`);u.success&&(o.value=u.data,k.value=!0)}catch(u){console.error("Error fetching associate details:",u),o.value=e,k.value=!0}finally{q.value=!1}},ae=i=>{if(i===null)return;const e=w.value.find(u=>u.id===i);e&&(o.value={...e},D.value=!0)},Ve=()=>{o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",assignedLeads:0,avatar:"",password:""},N.value=!0},se=async()=>{if(o.value){if(P.value){const{valid:i}=await P.value.validate();if(!i)return}try{S.value=!0;const i=o.value.id!==null,e=i?"PUT":"POST",u=i?`/v1/franchisor/sales-associates/${o.value.id}`:"/v1/franchisor/sales-associates",c={name:o.value.name,email:o.value.email,phone:o.value.phone,status:o.value.status,country:o.value.country||"",state:o.value.state||"",city:o.value.city||""};!i&&o.value.password&&(c.password=o.value.password),(await R(u,{method:e,body:c})).success&&(P.value&&P.value.reset(),N.value=!1,D.value=!1,o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",password:"",assignedLeads:0,avatar:"",avatarText:""},await H(),console.log(i?"Associate updated successfully":"Associate created successfully"))}catch(i){console.error("Error saving associate:",i)}finally{S.value=!1}}},be=()=>{const e=["Name,Email,Phone,Status,Country,State,City,Assigned Leads",...(v.value.length>0?w.value.filter(l=>v.value.includes(l.id)):w.value).map(l=>`"${l.name}","${l.email}","${l.phone}","${l.status}","${l.country||""}","${l.state||""}","${l.city||""}","${l.assignedLeads}"`)].join(`
`),u=new Blob([e],{type:"text/csv"}),c=window.URL.createObjectURL(u),E=document.createElement("a");E.href=c,E.download=`sales_associates_${v.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,E.click(),window.URL.revokeObjectURL(c)},ge=()=>{const i=v.value.length>0?w.value.filter(e=>v.value.includes(e.id)):w.value;console.log("Exporting to PDF:",i)};return we(()=>{H()}),(i,e)=>{const u=Ue,c=Ee,E=ke;return y(),M("section",null,[t(I,{class:"mb-6"},{default:a(()=>[t(O,{class:"pb-4"},{default:a(()=>[t(G,null,{default:a(()=>e[22]||(e[22]=[d("Filters")])),_:1,__:[22]})]),_:1}),t(L,null,{default:a(()=>[t(K,null,{default:a(()=>[t(p,{cols:"12",sm:"6"},{default:a(()=>[t(u,{modelValue:s($),"onUpdate:modelValue":e[0]||(e[0]=l=>V($)?$.value=l:null),placeholder:"Select Status",items:te,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Y),t(L,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[n("div",Pe,[t(u,{"model-value":s(g),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=parseInt(l,10))},null,8,["model-value"]),s(v).length>0?(y(),U(_,{key:0,variant:"tonal",color:"error",onClick:i.bulkDelete},{default:a(()=>[t(b,{icon:"tabler-trash",class:"me-2"}),d(" Delete Selected ("+r(s(v).length)+") ",1)]),_:1},8,["onClick"])):z("",!0)]),t(j),n("div",De,[n("div",Ne,[t(c,{modelValue:s(T),"onUpdate:modelValue":e[2]||(e[2]=l=>V(T)?T.value=l:null),placeholder:"Search Sales Associate"},null,8,["modelValue"])]),t(_,{variant:"tonal",color:"secondary"},{default:a(()=>[t(b,{icon:"tabler-upload",class:"me-2"}),d(" Export "+r(s(v).length>0?`(${s(v).length})`:"All")+" ",1),t(ne,{activator:"parent"},{default:a(()=>[t(re,null,{default:a(()=>[t(F,{onClick:be},{prepend:a(()=>[t(b,{icon:"tabler-file-type-csv"})]),default:a(()=>[t(B,null,{default:a(()=>e[23]||(e[23]=[d("Export to CSV")])),_:1,__:[23]})]),_:1}),t(F,{onClick:ge},{prepend:a(()=>[t(b,{icon:"tabler-file-type-pdf"})]),default:a(()=>[t(B,null,{default:a(()=>e[24]||(e[24]=[d("Export to PDF")])),_:1,__:[24]})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{"prepend-icon":"tabler-plus",onClick:Ve},{default:a(()=>e[25]||(e[25]=[d(" Add Sales Associate ")])),_:1,__:[25]})])]),_:1}),t(Y),t(he,{"items-per-page":s(g),"onUpdate:itemsPerPage":e[4]||(e[4]=l=>V(g)?g.value=l:null),"model-value":s(v),"onUpdate:modelValue":e[5]||(e[5]=l=>V(v)?v.value=l:null),page:s(x),"onUpdate:page":e[6]||(e[6]=l=>V(x)?x.value=l:null),items:s(w),"item-value":"id","items-length":s(ee),headers:me,class:"text-no-wrap","show-select":"","onUpdate:options":de},{"item.name":a(({item:l})=>[n("div",ze,[t(ue,{size:"34",variant:l.avatar?void 0:"tonal",color:l.avatar?void 0:"primary"},{default:a(()=>[l.avatar?(y(),U(Le,{key:0,src:l.avatar},null,8,["src"])):(y(),M("span",Ie,r(("avatarText"in i?i.avatarText:s(oe))(l.name)),1))]),_:2},1032,["variant","color"]),n("div",Fe,[n("h6",Be,r(l.name),1)])])]),"item.email":a(({item:l})=>[n("div",qe,r(l.email),1)]),"item.phone":a(({item:l})=>[n("div",Me,r(l.phone),1)]),"item.status":a(({item:l})=>[t(J,{color:le(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[d(r(l.status),1)]),_:2},1032,["color"])]),"item.assignedLeads":a(({item:l})=>[n("div",Re,r(l.assignedLeads),1)]),"item.actions":a(({item:l})=>[t(_,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[t(b,{icon:"tabler-dots-vertical"}),t(ne,{activator:"parent"},{default:a(()=>[t(re,null,{default:a(()=>[t(F,{onClick:f=>_e(l.id)},{prepend:a(()=>[t(b,{icon:"tabler-eye"})]),default:a(()=>[t(B,null,{default:a(()=>e[26]||(e[26]=[d("View")])),_:1,__:[26]})]),_:2},1032,["onClick"]),t(F,{onClick:f=>ae(l.id)},{prepend:a(()=>[t(b,{icon:"tabler-pencil"})]),default:a(()=>[t(B,null,{default:a(()=>e[27]||(e[27]=[d("Edit")])),_:1,__:[27]})]),_:2},1032,["onClick"]),t(F,{onClick:f=>fe(l.id)},{prepend:a(()=>[t(b,{icon:"tabler-trash"})]),default:a(()=>[t(B,null,{default:a(()=>e[28]||(e[28]=[d("Delete")])),_:1,__:[28]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[t(E,{page:s(x),"onUpdate:page":e[3]||(e[3]=l=>V(x)?x.value=l:null),"items-per-page":s(g),"total-items":s(ee)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),t(X,{modelValue:s(k),"onUpdate:modelValue":e[9]||(e[9]=l=>V(k)?k.value=l:null),"max-width":"600"},{default:a(()=>[s(o)?(y(),U(I,{key:0},{default:a(()=>[t(O,null,{default:a(()=>[t(G,null,{default:a(()=>e[29]||(e[29]=[d("Sales Associate Details")])),_:1,__:[29]})]),_:1}),t(L,null,{default:a(()=>[t(K,null,{default:a(()=>[t(p,{cols:"12"},{default:a(()=>{var l;return[n("div",Oe,[t(ue,{size:"80",variant:"tonal",color:"primary"},{default:a(()=>[n("span",Ge,r(("avatarText"in i?i.avatarText:s(oe))(s(o).name)),1)]),_:1}),n("div",null,[n("h4",Ke,r(s(o).name),1),t(J,{color:le(((l=s(o))==null?void 0:l.status)||""),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[d(r(s(o).status),1)]),_:1},8,["color"])])])]}),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",je,[e[30]||(e[30]=n("div",{class:"text-sm text-disabled mb-1"}," Email ",-1)),n("div",Je,r(s(o).email),1)])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",Ze,[e[31]||(e[31]=n("div",{class:"text-sm text-disabled mb-1"}," Phone ",-1)),n("div",Qe,r(s(o).phone),1)])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",He,[e[32]||(e[32]=n("div",{class:"text-sm text-disabled mb-1"}," Country ",-1)),n("div",We,r(s(o).country||"Not specified"),1)])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",Xe,[e[33]||(e[33]=n("div",{class:"text-sm text-disabled mb-1"}," State ",-1)),n("div",Ye,r(s(o).state||"Not specified"),1)])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",et,[e[34]||(e[34]=n("div",{class:"text-sm text-disabled mb-1"}," City ",-1)),n("div",tt,r(s(o).city||"Not specified"),1)])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[n("div",lt,[e[35]||(e[35]=n("div",{class:"text-sm text-disabled mb-1"}," Assigned Leads ",-1)),n("div",at,r(s(o).assignedLeads),1)])]),_:1})]),_:1}),s(o).leads&&s(o).leads.length>0?(y(),U(K,{key:0},{default:a(()=>[t(p,{cols:"12"},{default:a(()=>[t(Y,{class:"my-4"}),e[37]||(e[37]=n("div",{class:"text-h6 mb-4"}," Assigned Leads ",-1)),t(I,{variant:"outlined"},{default:a(()=>[t(L,{class:"pa-0"},{default:a(()=>[t(Te,null,{default:a(()=>{var l;return[e[36]||(e[36]=n("thead",null,[n("tr",null,[n("th",null,"Name"),n("th",null,"Email"),n("th",null,"Status"),n("th",null,"Priority")])],-1)),n("tbody",null,[(y(!0),M(Se,null,Ce(((l=s(o))==null?void 0:l.leads)||[],f=>(y(),M("tr",{key:f.id},[n("td",null,r(f.first_name)+" "+r(f.last_name),1),n("td",null,r(f.email),1),n("td",null,[t(J,{color:ce(f.status),size:"small",class:"text-capitalize"},{default:a(()=>[d(r(f.status.replace("_"," ")),1)]),_:2},1032,["color"])]),n("td",null,[t(J,{color:pe(f.priority),size:"small",class:"text-capitalize"},{default:a(()=>[d(r(f.priority),1)]),_:2},1032,["color"])])]))),128))])]}),_:1,__:[36]})]),_:1})]),_:1})]),_:1,__:[37]})]),_:1})):z("",!0)]),_:1}),t(W,null,{default:a(()=>[t(j),t(_,{color:"secondary",variant:"tonal",onClick:e[7]||(e[7]=l=>k.value=!1)},{default:a(()=>e[38]||(e[38]=[d(" Close ")])),_:1,__:[38]}),t(_,{color:"primary",onClick:e[8]||(e[8]=l=>ae(s(o).id))},{default:a(()=>e[39]||(e[39]=[d(" Edit ")])),_:1,__:[39]})]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"]),t(X,{"model-value":s(N)||s(D),"max-width":"700",persistent:"","onUpdate:modelValue":e[19]||(e[19]=l=>{l||(N.value=!1,D.value=!1)})},{default:a(()=>[s(o)?(y(),U(I,{key:0},{default:a(()=>[t(O,null,{default:a(()=>[t(G,null,{default:a(()=>[d(r(s(o).id===null?"Add New":"Edit")+" Sales Associate",1)]),_:1})]),_:1}),t(L,null,{default:a(()=>[t($e,{ref_key:"associateForm",ref:P,onSubmit:Ae(se,["prevent"])},{default:a(()=>[t(K,null,{default:a(()=>[t(p,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).name,"onUpdate:modelValue":e[10]||(e[10]=l=>s(o).name=l),label:"Full Name",placeholder:"Enter full name",rules:[l=>!!l||"Full name is required",l=>l.length<=255||"Name must not exceed 255 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).email,"onUpdate:modelValue":e[11]||(e[11]=l=>s(o).email=l),label:"Email Address",type:"email",placeholder:"Enter email address",rules:[l=>!!l||"Email is required",l=>/.+@.+\..+/.test(l)||"Email must be valid"],required:""},null,8,["modelValue","rules"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).phone,"onUpdate:modelValue":e[12]||(e[12]=l=>s(o).phone=l),label:"Phone Number",placeholder:"Enter phone number",rules:[l=>!!l||"Phone number is required",l=>l.length<=20||"Phone number must not exceed 20 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(u,{modelValue:s(o).status,"onUpdate:modelValue":e[13]||(e[13]=l=>s(o).status=l),label:"Status",items:te,placeholder:"Select status",rules:[l=>!!l||"Status is required"],required:""},null,8,["modelValue","rules"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(u,{modelValue:s(o).country,"onUpdate:modelValue":e[14]||(e[14]=l=>s(o).country=l),label:"Country",items:ve,placeholder:"Select country"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).state,"onUpdate:modelValue":e[15]||(e[15]=l=>s(o).state=l),label:"State/Province",placeholder:"Enter state or province",rules:[l=>!l||l.length<=100||"State must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).city,"onUpdate:modelValue":e[16]||(e[16]=l=>s(o).city=l),label:"City",placeholder:"Enter city",rules:[l=>!l||l.length<=100||"City must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),s(o).id===null?(y(),U(p,{key:0,cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:s(o).password,"onUpdate:modelValue":e[17]||(e[17]=l=>s(o).password=l),label:"Password",type:"password",placeholder:"Enter password (minimum 8 characters)",rules:[l=>!!l||"Password is required",l=>l.length>=8||"Password must be at least 8 characters"],required:""},null,8,["modelValue","rules"])]),_:1})):z("",!0)]),_:1})]),_:1},512)]),_:1}),t(W,null,{default:a(()=>[t(j),t(_,{color:"secondary",variant:"tonal",disabled:s(S),onClick:e[18]||(e[18]=l=>{N.value=!1,D.value=!1})},{default:a(()=>e[40]||(e[40]=[d(" Cancel ")])),_:1,__:[40]},8,["disabled"]),t(_,{color:"primary",loading:s(S),onClick:se},{default:a(()=>[d(r(s(o).id===null?"Create Associate":"Save Changes"),1)]),_:1},8,["loading"])]),_:1})]),_:1})):z("",!0)]),_:1},8,["model-value"]),t(X,{modelValue:s(A),"onUpdate:modelValue":e[21]||(e[21]=l=>V(A)?A.value=l:null),"max-width":"500"},{default:a(()=>[t(I,null,{default:a(()=>[t(O,null,{default:a(()=>[t(G,null,{default:a(()=>e[41]||(e[41]=[d("Confirm Delete")])),_:1,__:[41]})]),_:1}),t(L,null,{default:a(()=>e[42]||(e[42]=[d(" Are you sure you want to delete this sales associate? This action cannot be undone. ")])),_:1,__:[42]}),t(W,null,{default:a(()=>[t(j),t(_,{color:"secondary",variant:"tonal",onClick:e[20]||(e[20]=l=>A.value=!1)},{default:a(()=>e[43]||(e[43]=[d(" Cancel ")])),_:1,__:[43]}),t(_,{color:"error",onClick:ye},{default:a(()=>e[44]||(e[44]=[d(" Delete ")])),_:1,__:[44]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Gt as default};
