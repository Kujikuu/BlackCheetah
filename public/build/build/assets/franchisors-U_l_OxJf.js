import{V as be,_ as Ve}from"./VDataTableServer-DuqkQSwU.js";import{_ as Ce}from"./AppTextField.vue_vue_type_script_setup_true_lang-CO47FMF9.js";import{_ as Fe}from"./AppSelect.vue_vue_type_script_setup_true_lang-C9l7FSyM.js";import{_ as ke}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-QmbRosz8.js";import{_ as De,a as Ee}from"./ResetPasswordDialog.vue_vue_type_script_setup_true_lang-DQA7WoFv.js";import{_ as Pe}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-HL7bzv_B.js";import{d as $e,r as i,P as Le,G as Ne,aO as C,c as z,b as s,f as l,m as o,au as v,o as x,e as r,F as Te,i as Ue,g as T,v as u,x as Se,aa as f,l as W,t as c,a3 as $}from"./main-CpsWdFYr.js";import{V as B,a as I}from"./VRow-Bk9_G6aB.js";import{V as q,a as Ae,b as ze}from"./VCard-D_XCsLRw.js";import{V as O}from"./VCardText-j0JBfbAe.js";import{V as J}from"./VAvatar-CzxzJOWa.js";import{V as R}from"./VDivider-BP0aNN7O.js";import{V as Be}from"./VSpacer-D_nZvJpN.js";import{V as Q}from"./VMenu-PCh5aX_y.js";import{V as H,a as F,b as k}from"./VList-DZrW6fib.js";import{V as Ie}from"./VAlert-DRT0ey_A.js";import{V as K}from"./VChip-yrA_M1tP.js";import{V as Oe}from"./VImg-DCJkd1LN.js";import"./VPagination-CUSlXpHq.js";import"./VDataTable-BZUXZCW2.js";import"./VSelect-CtqI8NsY.js";import"./VTextField-CUOQrd4S.js";/* empty css                   */import"./VCounter-CbUu5J9F.js";import"./VField-DDq05bP2.js";import"./form-DyYLQJyt.js";import"./easing-Bybner-F.js";import"./VInput-B4TWBtjL.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-D456YNVX.js";import"./VOverlay-BGEfXIrC.js";import"./lazy-C2iFJq6n.js";import"./scopeId-D-NoPJiR.js";import"./VCheckboxBtn-D9UFBLvW.js";import"./VSelectionControl-BJqGXIsn.js";import"./VTable-CKwy69H0.js";import"./filter-jIliInNJ.js";import"./validators-BYiRrju8.js";import"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-CKW97nTe.js";import"./VNavigationDrawer-DzK6m3-S.js";import"./ssrBoot-BhGqyhmX.js";import"./VForm-D7q8z2rE.js";import"./VDialog-ChyOvTE6.js";import"./VTooltip-BjPBKR7d.js";import"./formatters-WDr9EcLN.js";/* empty css              */import"./VSlideGroup-93CEUUHa.js";const Re={class:"d-flex justify-space-between"},je={class:"d-flex flex-column gap-y-1"},Me={class:"text-body-1 text-high-emphasis"},Ge={class:"d-flex gap-x-2 align-center"},We={class:"text-h4"},qe={class:"text-sm"},Je={class:"me-3 d-flex gap-3"},Qe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},He={style:{"inline-size":"15.625rem"}},Ke={class:"text-center pa-8"},Xe={class:"d-flex align-center gap-x-4"},Ye={key:1},Ze={class:"d-flex flex-column"},et={class:"text-base font-weight-medium"},tt={class:"text-sm text-medium-emphasis"},st={class:"text-body-1 text-high-emphasis"},at={class:"text-body-1"},lt={class:"text-body-1"},ot={class:"d-flex gap-1"},es=$e({__name:"franchisors",setup(rt){const g=i(""),w=i(),_=i(10),h=i(1),U=i([{key:"created_at",order:"desc"}]),X=i("desc"),p=i([]),Y=t=>{var e;t.sortBy&&t.sortBy.length>0&&(U.value=t.sortBy,X.value=(e=t.sortBy[0])==null?void 0:e.order)},Z=[{title:"User",key:"user"},{title:"Franchise Name",key:"franchiseName"},{title:"Email",key:"email"},{title:"Last Login",key:"lastLogin"},{title:"Plan",key:"plan"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],b=i([]),S=i(!1),d=i(""),A=i(0),L=async()=>{var t,e;S.value=!0,d.value="";try{const n=await C("/v1/admin/users/franchisors",{method:"GET",query:{search:g.value,status:w.value,sort_by:((t=U.value[0])==null?void 0:t.key)||"created_at",sort_direction:((e=U.value[0])==null?void 0:e.order)||"desc",page:h.value,per_page:_.value}});n.success?(b.value=n.data.data||[],A.value=n.data.total||0):d.value=n.message||"Failed to fetch franchisors"}catch(n){console.error("Error fetching franchisors:",n),d.value="Failed to fetch franchisors"}finally{S.value=!1}},ee=t=>t>0?`+${t}`:t,te=t=>{if(!t||typeof t!="string")return"U";const e=t.split(" ");return e.length>1?`${e[0][0]}${e[1][0]}`:t.slice(0,2)},se=Le(()=>{let t=b.value;return g.value&&(t=t.filter(e=>e.fullName.toLowerCase().includes(g.value.toLowerCase())||e.email.toLowerCase().includes(g.value.toLowerCase())||e.franchiseName.toLowerCase().includes(g.value.toLowerCase()))),w.value&&(t=t.filter(e=>e.status===w.value)),t}),ae=[{title:"Pending",value:"pending"},{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],le=t=>{const e=t.toLowerCase();return e==="pending"?"warning":e==="active"?"success":e==="inactive"?"secondary":"primary"},oe=t=>{const e=t.toLowerCase();return e==="basic"?"primary":e==="pro"?"success":e==="enterprise"?"warning":"primary"},y=i(!1),D=i(!1),E=i(!1),N=i(!1),m=i(null),V=i(null),re=async t=>{try{const e=await C("/v1/admin/users",{method:"POST",body:{...t,role:"franchisor"}});e.success?await L():d.value=e.message||"Failed to create franchisor"}catch(e){console.error("Error creating franchisor:",e),d.value="Failed to create franchisor"}},ie=t=>{m.value={...t},y.value=!0},ne=async t=>{try{const e=await C(`/v1/admin/users/${t.id}`,{method:"PUT",body:t});e.success?(await L(),m.value=null):d.value=e.message||"Failed to update franchisor"}catch(e){console.error("Error updating franchisor:",e),d.value="Failed to update franchisor"}},ue=async t=>{t.id?await ne(t):await re(t)},de=t=>{V.value=t,D.value=!0},ce=async()=>{if(V.value){try{const t=await C(`/v1/admin/users/${V.value.id}`,{method:"DELETE"});if(t.success){await L();const e=p.value.findIndex(n=>n===V.value.id);e!==-1&&p.value.splice(e,1)}else d.value=t.message||"Failed to delete franchisor"}catch(t){console.error("Error deleting franchisor:",t),d.value="Failed to delete franchisor"}D.value=!1,V.value=null}},pe=t=>{m.value=t,E.value=!0},me=async t=>{var e;if(m.value){try{const n=await C(`/v1/admin/users/${m.value.id}/reset-password`,{method:"POST",body:{password:t}});n.success?console.log("Password reset successfully for:",(e=m.value)==null?void 0:e.fullName):d.value=n.message||"Failed to reset password"}catch(n){console.error("Error resetting password:",n),d.value="Failed to reset password"}E.value=!1,m.value=null}},fe=()=>{m.value=null};Ne(()=>{L(),ye()});const ve=t=>{m.value=t,N.value=!0},ge=()=>{y.value=!0},_e=()=>{const t=p.value.length>0?b.value.filter(e=>p.value.includes(e.id)):b.value;console.log("Exporting to CSV:",t)},he=()=>{const t=p.value.length>0?b.value.filter(e=>p.value.includes(e.id)):b.value;console.log("Exporting to PDF:",t)},j=i([{title:"Total Franchisors",value:"0",change:0,desc:"All registered franchisors",icon:"tabler-building-store",iconColor:"primary"},{title:"Active Franchisors",value:"0",change:0,desc:"Currently active",icon:"tabler-user-check",iconColor:"success"},{title:"Pending Approval",value:"0",change:0,desc:"Awaiting verification",icon:"tabler-clock",iconColor:"warning"}]),ye=async()=>{try{const t=await C("/v1/admin/users/franchisors/stats");t.success&&(j.value=t.data)}catch(t){console.error("Error fetching franchisor stats:",t)}};return(t,e)=>{var M,G;const n=Fe,xe=Ce,we=Ve;return x(),z("section",null,[s(B,{class:"mb-6"},{default:l(()=>[s(I,{cols:"12"},{default:l(()=>e[14]||(e[14]=[r("div",{class:"d-flex align-center justify-space-between"},[r("div",null,[r("h2",{class:"text-h2 mb-1"}," Franchisor Management "),r("p",{class:"text-body-1 text-medium-emphasis"}," Manage and monitor all franchisor accounts ")])],-1)])),_:1,__:[14]})]),_:1}),s(B,{class:"mb-6"},{default:l(()=>[(x(!0),z(Te,null,Ue(o(j),(a,P)=>(x(),T(I,{key:P,cols:"12",md:"4",sm:"6"},{default:l(()=>[s(q,null,{default:l(()=>[s(O,null,{default:l(()=>[r("div",Re,[r("div",je,[r("div",Me,u(a.title),1),r("div",Ge,[r("h4",We,u(a.value),1),r("div",{class:Se(["text-base",a.change>0?"text-success":"text-error"])}," ("+u(ee(a.change))+"%) ",3)]),r("div",qe,u(a.desc),1)]),s(J,{color:a.iconColor,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[s(f,{icon:a.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(q,{class:"mb-6"},{default:l(()=>[s(Ae,{class:"pb-4"},{default:l(()=>[s(ze,null,{default:l(()=>e[15]||(e[15]=[c("Filters")])),_:1,__:[15]})]),_:1}),s(O,null,{default:l(()=>[s(B,null,{default:l(()=>[s(I,{cols:"12",sm:"4"},{default:l(()=>[s(n,{modelValue:o(w),"onUpdate:modelValue":e[0]||(e[0]=a=>v(w)?w.value=a:null),placeholder:"Select Status",items:ae,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(R),s(O,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[r("div",Je,[s(n,{"model-value":o(_),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=a=>_.value=parseInt(a,10))},null,8,["model-value"]),o(p).length>0?(x(),T($,{key:0,variant:"tonal",color:"error",onClick:t.bulkDelete},{default:l(()=>[s(f,{icon:"tabler-trash",class:"me-2"}),c(" Delete Selected ("+u(o(p).length)+") ",1)]),_:1},8,["onClick"])):W("",!0)]),s(Be),r("div",Qe,[r("div",He,[s(xe,{modelValue:o(g),"onUpdate:modelValue":e[2]||(e[2]=a=>v(g)?g.value=a:null),placeholder:"Search Franchisor"},null,8,["modelValue"])]),s($,{variant:"tonal",color:"secondary"},{default:l(()=>[s(f,{icon:"tabler-upload",class:"me-2"}),c(" Export "+u(o(p).length>0?`(${o(p).length})`:"All")+" ",1),s(Q,{activator:"parent"},{default:l(()=>[s(H,null,{default:l(()=>[s(F,{onClick:_e},{prepend:l(()=>[s(f,{icon:"tabler-file-type-csv"})]),default:l(()=>[s(k,null,{default:l(()=>e[16]||(e[16]=[c("Export to CSV")])),_:1,__:[16]})]),_:1}),s(F,{onClick:he},{prepend:l(()=>[s(f,{icon:"tabler-file-type-pdf"})]),default:l(()=>[s(k,null,{default:l(()=>e[17]||(e[17]=[c("Export to PDF")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1}),s($,{"prepend-icon":"tabler-plus",onClick:e[3]||(e[3]=a=>y.value=!0)},{default:l(()=>e[18]||(e[18]=[c(" Add New Franchisor ")])),_:1,__:[18]})])]),_:1}),s(R),o(d)?(x(),T(Ie,{key:0,type:"error",class:"ma-4",closable:"","onClick:close":e[4]||(e[4]=a=>d.value="")},{default:l(()=>[c(u(o(d)),1)]),_:1})):W("",!0),s(be,{"items-per-page":o(_),"onUpdate:itemsPerPage":e[7]||(e[7]=a=>v(_)?_.value=a:null),"model-value":o(p),"onUpdate:modelValue":e[8]||(e[8]=a=>v(p)?p.value=a:null),page:o(h),"onUpdate:page":e[9]||(e[9]=a=>v(h)?h.value=a:null),items:o(se),"item-value":"id","items-length":o(A),headers:Z,loading:o(S),class:"text-no-wrap","show-select":"","onUpdate:options":Y},{"no-data":l(()=>[r("div",Ke,[s(f,{icon:"tabler-users-off",size:"64",class:"mb-4 text-disabled"}),e[20]||(e[20]=r("h3",{class:"text-h5 mb-2"}," No Franchisors Found ",-1)),e[21]||(e[21]=r("p",{class:"text-body-1 text-medium-emphasis mb-4"}," No franchisors match your search criteria. Try adjusting your filters. ",-1)),s($,{color:"primary",onClick:e[5]||(e[5]=a=>y.value=!0)},{default:l(()=>e[19]||(e[19]=[c(" Add First Franchisor ")])),_:1,__:[19]})])]),"item.user":l(({item:a})=>[r("div",Xe,[s(J,{size:"34",variant:a.avatar?void 0:"tonal",color:"primary"},{default:l(()=>[a.avatar?(x(),T(Oe,{key:0,src:a.avatar},null,8,["src"])):(x(),z("span",Ye,u(te(a.fullName)),1))]),_:2},1032,["variant"]),r("div",Ze,[r("h6",et,u(a.fullName),1),r("div",tt," Joined: "+u(a.joinedDate),1)])])]),"item.franchiseName":l(({item:a})=>[r("div",st,u(a.franchiseName),1)]),"item.email":l(({item:a})=>[r("div",at,u(a.email),1)]),"item.lastLogin":l(({item:a})=>[r("div",lt,u(a.lastLogin),1)]),"item.plan":l(({item:a})=>[s(K,{color:oe(a.plan),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[c(u(a.plan),1)]),_:2},1032,["color"])]),"item.status":l(({item:a})=>[s(K,{color:le(a.status),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[c(u(a.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:a})=>[r("div",ot,[s($,{icon:"",variant:"text",color:"medium-emphasis",size:"small"},{default:l(()=>[s(f,{icon:"tabler-dots-vertical",size:"22"}),s(Q,{activator:"parent"},{default:l(()=>[s(H,null,{default:l(()=>[s(F,{onClick:P=>ve(a)},{prepend:l(()=>[s(f,{icon:"tabler-eye"})]),default:l(()=>[s(k,null,{default:l(()=>e[22]||(e[22]=[c("View")])),_:1,__:[22]})]),_:2},1032,["onClick"]),s(F,{onClick:P=>ie(a)},{prepend:l(()=>[s(f,{icon:"tabler-pencil"})]),default:l(()=>[s(k,null,{default:l(()=>e[23]||(e[23]=[c("Edit")])),_:1,__:[23]})]),_:2},1032,["onClick"]),s(F,{onClick:P=>pe(a)},{prepend:l(()=>[s(f,{icon:"tabler-key"})]),default:l(()=>[s(k,null,{default:l(()=>e[24]||(e[24]=[c("Reset Password")])),_:1,__:[24]})]),_:2},1032,["onClick"]),s(R,{class:"my-2"}),s(F,{onClick:P=>de(a)},{prepend:l(()=>[s(f,{icon:"tabler-trash",color:"error"})]),default:l(()=>[s(k,{class:"text-error"},{default:l(()=>e[25]||(e[25]=[c(" Delete ")])),_:1,__:[25]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),bottom:l(()=>[s(we,{page:o(h),"onUpdate:page":e[6]||(e[6]=a=>v(h)?h.value=a:null),"items-per-page":o(_),"total-items":o(A)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),s(ke,{"is-drawer-open":o(y),"onUpdate:isDrawerOpen":[e[10]||(e[10]=a=>v(y)?y.value=a:null),fe],franchisor:o(m),onFranchisorData:ue},null,8,["is-drawer-open","franchisor"]),s(De,{"is-dialog-open":o(D),"onUpdate:isDialogOpen":e[11]||(e[11]=a=>v(D)?D.value=a:null),"user-name":(M=o(V))==null?void 0:M.fullName,"user-type":"Franchisor",onConfirm:ce},null,8,["is-dialog-open","user-name"]),s(Ee,{"is-dialog-open":o(E),"onUpdate:isDialogOpen":e[12]||(e[12]=a=>v(E)?E.value=a:null),"user-name":(G=o(m))==null?void 0:G.fullName,onConfirm:me},null,8,["is-dialog-open","user-name"]),s(Pe,{"is-dialog-open":o(N),"onUpdate:isDialogOpen":e[13]||(e[13]=a=>v(N)?N.value=a:null),user:o(m),"user-type":"Franchisor",onEdit:ge},null,8,["is-dialog-open","user"])])}}});export{es as default};
