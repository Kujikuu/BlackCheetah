import{M as J,L as ne,bc as Ne,N as ie,b as e,az as he,a9 as P,ai as Ee,c9 as Me,P as D,J as We,an as qe,bW as Le,ax as F,ca as Oe,U as Q,aj as je,Q as Ge,q as ge,V as He,c8 as Ye,bt as Qe,cI as Je,bZ as Se,aB as Ke,bY as Ze,c7 as Xe,by as et,F as ce,d as Ve,r as C,w as Ae,g as k,f as t,e as o,l as me,m as l,t as x,v as _,aR as j,b5 as se,o as g,G as tt,c as H,j as at,aF as ae,i as ke,b3 as we}from"./main-gemCwVks.js";import{f as lt}from"./formatters--UtN2sCw.js";import{_ as st}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-D29owYUD.js";import{_ as nt}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DJuxuOVb.js";import{_ as it}from"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import{_ as ot}from"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import{r as O,e as dt}from"./validators-BHkKs9Dp.js";import{V as Re,_ as rt}from"./VDialog-6C-NQXCx.js";import{b as pe,d as _e,V as W,a as Ue}from"./VCard-DJ82mpnW.js";import{V as $}from"./VCardText-BD5AHO-w.js";import{V as ve}from"./VAlert-RufLsxZw.js";import{c as ut,V as Z}from"./VAvatar-12xz6mHy.js";import{a as fe,m as ct,V as de,b as mt}from"./VWindowItem-CPQ2k3dD.js";import{V as Ce,m as pt}from"./VSheet-DOWPl_yc.js";import{V as re}from"./VDivider-B4ry9pxl.js";import{V as Pe}from"./VForm-FUZpY-zG.js";import{V as Y,a as S}from"./VRow-DiX7eN30.js";import{V as ze}from"./VSpacer-Cpeayo2U.js";import{V as Fe}from"./VSelect-C9dxRhag.js";import{a as vt,V as De}from"./VTabs-CeX-zYGq.js";import{S as ft}from"./saudi-riyal-DZyktURw.js";import{V as le}from"./VSkeletonLoader-D0dxFM6H.js";import{V as ue}from"./VChip-DlNApjyg.js";import{V as yt,a as bt}from"./VDataTable-C-SlKz4P.js";import{V as Ie}from"./VTooltip-CVtgTmoh.js";import"./VField-CsHfcJSz.js";import"./form-DjHlhIbZ.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-B3GinL-f.js";import"./VImg-DSB6m92Q.js";import"./VTextarea-OEcL0zKK.js";import"./VTextField-BhxF6EAD.js";import"./VOverlay-p8m6-W96.js";import"./scopeId-BgtgI3QF.js";import"./dialog-transition-C9rYmnXC.js";import"./VList-MyW-iB3v.js";/* empty css              */import"./VMenu-CeaiRCNz.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";import"./VSlideGroup-CEWgOBQJ.js";import"./VTable-0Z68chLt.js";const xe=Symbol.for("vuetify:v-stepper"),Te=J({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),gt=ne()({name:"VStepperActions",props:Te(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(n,I){let{emit:d,slots:m}=I;const{t:r}=Ne();function p(){d("click:prev")}function v(){d("click:next")}return ie(()=>{const i={onClick:p},f={onClick:v};return e("div",{class:"v-stepper-actions"},[e(he,{defaults:{VBtn:{disabled:["prev",!0].includes(n.disabled),text:r(n.prevText),variant:"text"}}},{default:()=>{var y;return[((y=m.prev)==null?void 0:y.call(m,{props:i}))??e(P,i,null)]}}),e(he,{defaults:{VBtn:{color:n.color,disabled:["next",!0].includes(n.disabled),text:r(n.nextText),variant:"tonal"}}},{default:()=>{var y;return[((y=m.next)==null?void 0:y.call(m,{props:f}))??e(P,f,null)]}})])}),{}}}),$e=ut("v-stepper-header"),Vt=J({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:Q,default:"$complete"},editable:Boolean,editIcon:{type:Q,default:"$edit"},error:Boolean,errorIcon:{type:Q,default:"$error"},icon:Q,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),_t=J({...Vt(),...Oe()},"VStepperItem"),ye=ne()({name:"VStepperItem",directives:{Ripple:Ee},props:_t(),emits:{"group:selected":n=>!0},setup(n,I){let{slots:d}=I;const m=Me(n,xe,!0),r=D(()=>(m==null?void 0:m.value.value)??n.value),p=D(()=>n.rules.every(z=>z()===!0)),v=D(()=>!n.disabled&&n.editable),i=D(()=>!n.disabled&&n.editable),f=D(()=>n.error||!p.value),y=D(()=>n.complete||n.rules.length>0&&p.value),R=D(()=>f.value?n.errorIcon:y.value?n.completeIcon:m.isSelected.value&&n.editable?n.editIcon:n.icon),A=D(()=>({canEdit:i.value,hasError:f.value,hasCompleted:y.value,title:n.title,subtitle:n.subtitle,step:r.value,value:n.value}));return ie(()=>{var w,u,U;const z=(!m||m.isSelected.value||y.value||i.value)&&!f.value&&!n.disabled,B=!!(n.title!=null||d.title),q=!!(n.subtitle!=null||d.subtitle);function L(){m==null||m.toggle()}return We(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":y.value,"v-stepper-item--disabled":n.disabled,"v-stepper-item--error":f.value},m==null?void 0:m.selectedClass.value],disabled:!n.editable,type:"button",onClick:L},[v.value&&Le(!0,"v-stepper-item"),e(Z,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:z?n.color:void 0,size:24},{default:()=>{var h;return[((h=d.icon)==null?void 0:h.call(d,A.value))??(R.value?e(F,{icon:R.value},null):r.value)]}}),e("div",{class:"v-stepper-item__content"},[B&&e("div",{key:"title",class:"v-stepper-item__title"},[((w=d.title)==null?void 0:w.call(d,A.value))??n.title]),q&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((u=d.subtitle)==null?void 0:u.call(d,A.value))??n.subtitle]),(U=d.default)==null?void 0:U.call(d,A.value)])]),[[qe("ripple"),n.ripple&&n.editable,null]])}),{}}}),xt=J({...He(ct(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),Be=ne()({name:"VStepperWindow",props:xt(),emits:{"update:modelValue":n=>!0},setup(n,I){let{slots:d}=I;const m=je(xe,null),r=Ge(n,"modelValue"),p=D({get(){var v;return r.value!=null||!m?r.value:(v=m.items.value.find(i=>m.selected.value.includes(i.id)))==null?void 0:v.value},set(v){r.value=v}});return ie(()=>{const v=fe.filterProps(n);return e(fe,ge({_as:"VStepperWindow"},v,{modelValue:p.value,"onUpdate:modelValue":i=>p.value=i,class:["v-stepper-window",n.class],style:n.style,mandatory:!1,touch:!1}),d)}),{}}}),ht=J({...mt()},"VStepperWindowItem"),be=ne()({name:"VStepperWindowItem",props:ht(),setup(n,I){let{slots:d}=I;return ie(()=>{const m=de.filterProps(n);return e(de,ge({_as:"VStepperWindowItem"},m,{class:["v-stepper-window-item",n.class],style:n.style}),d)}),{}}}),St=J({altLabels:Boolean,bgColor:String,completeIcon:Q,editIcon:Q,editable:Boolean,errorIcon:Q,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...et()},"Stepper"),kt=J({...St(),...Xe({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...pt(),...Ze(Te(),["prevText","nextText"])},"VStepper"),wt=ne()({name:"VStepper",props:kt(),emits:{"update:modelValue":n=>!0},setup(n,I){let{slots:d}=I;const{items:m,next:r,prev:p,selected:v}=Ye(n,xe),{displayClasses:i,mobile:f}=Qe(n),{completeIcon:y,editIcon:R,errorIcon:A,color:z,editable:B,prevText:q,nextText:L}=Je(n),w=D(()=>n.items.map((h,N)=>{const E=Se(h,n.itemTitle,h),c=Se(h,n.itemValue,N+1);return{title:E,value:c,raw:h}})),u=D(()=>m.value.findIndex(h=>v.value.includes(h.id))),U=D(()=>n.disabled?n.disabled:u.value===0?"prev":u.value===m.value.length-1?"next":!1);return Ke({VStepperItem:{editable:B,errorIcon:A,completeIcon:y,editIcon:R,prevText:q,nextText:L},VStepperActions:{color:z,disabled:U,prevText:q,nextText:L}}),ie(()=>{const h=Ce.filterProps(n),N=!!(d.header||n.items.length),E=n.items.length>0,c=!n.hideActions&&!!(E||d.actions);return e(Ce,ge(h,{color:n.bgColor,class:["v-stepper",{"v-stepper--alt-labels":n.altLabels,"v-stepper--flat":n.flat,"v-stepper--non-linear":n.nonLinear,"v-stepper--mobile":f.value},i.value,n.class],style:n.style}),{default:()=>{var G,X;return[N&&e($e,{key:"stepper-header"},{default:()=>[w.value.map((T,K)=>{let{raw:ee,...oe}=T;return e(ce,null,[!!K&&e(re,null,null),e(ye,oe,{default:d[`header-item.${oe.value}`]??d.header,icon:d.icon,title:d.title,subtitle:d.subtitle})])})]}),E&&e(Be,{key:"stepper-window"},{default:()=>[w.value.map(T=>e(be,{value:T.value},{default:()=>{var K,ee;return((K=d[`item.${T.value}`])==null?void 0:K.call(d,T))??((ee=d.item)==null?void 0:ee.call(d,T))}}))]}),(G=d.default)==null?void 0:G.call(d,{prev:p,next:r}),c&&(((X=d.actions)==null?void 0:X.call(d,{next:r,prev:p}))??e(gt,{key:"stepper-actions","onClick:prev":p,"onClick:next":r},d))]}})}),{prev:p,next:r}}}),Ut={class:"d-flex gap-3"},Ct=Ve({__name:"AddFranchiseeDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchiseeAdded"],setup(n,{emit:I}){const d=n,m=I,r=C(1),p=C(!1),v=C(null),i=C({name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),f=[{title:"Saudi Arabia",value:"SA"},{title:"United Arab Emirates",value:"AE"},{title:"Qatar",value:"QA"},{title:"Kuwait",value:"KW"},{title:"Oman",value:"OM"},{title:"Bahrain",value:"BH"},{title:"Jordan",value:"JO"},{title:"Lebanon",value:"LB"},{title:"Egypt",value:"EG"},{title:"Iraq",value:"IQ"}],y=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}],R=()=>{r.value=1,v.value=null,i.value={name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},A=w=>{m("update:isDialogVisible",w)},z=()=>{r.value<2&&(r.value++,v.value=null)},B=()=>{r.value>1&&(r.value--,v.value=null)};Ae(()=>d.isDialogVisible,w=>{w&&R()});const q=async()=>{var w,u,U;if(!i.value.name||!i.value.email||!i.value.phone){v.value="Please fill in all required fields";return}p.value=!0,v.value=null;try{const h=await se("/v1/franchisor/franchise"),N=((w=h.data)==null?void 0:w.id)||h.id,E={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:N,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,country:i.value.country,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},c=await se("/v1/franchisor/franchisees-with-unit",{method:"POST",body:E});if(c.success){const G={id:c.data.unit.id,name:c.data.unit.unit_name,email:c.data.franchisee.email,phone:c.data.franchisee.phone,type:c.data.unit.unit_type,sizeSqft:c.data.unit.size_sqft,capacity:null,openingDate:c.data.unit.opening_date,monthlyRent:c.data.unit.monthly_rent,managerId:c.data.unit.franchisee_id,managerName:c.data.franchisee.name,country:c.data.unit.country,state:c.data.unit.state_province,city:c.data.unit.city,address:c.data.unit.address,postalCode:c.data.unit.postal_code};m("franchiseeAdded",G),A(!1),R()}}catch(h){console.error("Error creating franchisee with unit:",h),v.value=((U=(u=h.response)==null?void 0:u.data)==null?void 0:U.message)||"Failed to create franchisee and unit. Please try again."}finally{p.value=!1}},L=w=>{m("update:isDialogVisible",w),w||R()};return(w,u)=>{const U=ot,h=it,N=nt,E=st;return g(),k(Re,{"model-value":d.isDialogVisible,"max-width":"800","onUpdate:modelValue":L},{default:t(()=>[e(W,null,{default:t(()=>[e(pe,{class:"text-center"},{default:t(()=>u[15]||(u[15]=[o("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[15]}),e($,null,{default:t(()=>[l(v)?(g(),k(ve,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":u[0]||(u[0]=c=>v.value=null)},{default:t(()=>[x(_(l(v)),1)]),_:1})):me("",!0),e(wt,{modelValue:l(r),"onUpdate:modelValue":u[13]||(u[13]=c=>j(r)?r.value=c:null),"alt-labels":""},{default:t(()=>[e($e,null,{default:t(()=>[e(ye,{complete:l(r)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(re),e(ye,{value:2,title:"Unit Details"})]),_:1}),e(Be,null,{default:t(()=>[e(be,{value:1},{default:t(()=>[e(Pe,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[e(U,{modelValue:l(i).name,"onUpdate:modelValue":u[1]||(u[1]=c=>l(i).name=c),label:"Branch Name",placeholder:"Enter Branch name",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(U,{modelValue:l(i).email,"onUpdate:modelValue":u[2]||(u[2]=c=>l(i).email=c),label:"Email Address",placeholder:"Enter email address",rules:[l(O),l(dt)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(U,{modelValue:l(i).phone,"onUpdate:modelValue":u[3]||(u[3]=c=>l(i).phone=c),label:"Contact Number",placeholder:"Enter contact number",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(h,{modelValue:l(i).country,"onUpdate:modelValue":u[4]||(u[4]=c=>l(i).country=c),items:f,label:"Country",placeholder:"Select country",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(U,{modelValue:l(i).state,"onUpdate:modelValue":u[5]||(u[5]=c=>l(i).state=c),label:"State",placeholder:"Enter state",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(U,{modelValue:l(i).city,"onUpdate:modelValue":u[6]||(u[6]=c=>l(i).city=c),label:"City",placeholder:"Enter city",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(N,{modelValue:l(i).address,"onUpdate:modelValue":u[7]||(u[7]=c=>l(i).address=c),label:"Address",placeholder:"Enter full address",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(ve,{type:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[o("strong",null,_(l(i).name||"New franchisee"),1),u[16]||(u[16]=x(" will be automatically assigned as the unit manager. "))]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{value:2},{default:t(()=>[e(Pe,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(S,{cols:"12",md:"6"},{default:t(()=>[e(h,{modelValue:l(i).type,"onUpdate:modelValue":u[8]||(u[8]=c=>l(i).type=c),items:y,label:"Unit Type",placeholder:"Select unit type",rules:[l(O)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(E,{modelValue:l(i).openingDate,"onUpdate:modelValue":u[9]||(u[9]=c=>l(i).openingDate=c),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(U,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":u[10]||(u[10]=c=>l(i).sizeSqft=c),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(U,{modelValue:l(i).capacity,"onUpdate:modelValue":u[11]||(u[11]=c=>l(i).capacity=c),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(U,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":u[12]||(u[12]=c=>l(i).monthlyRent=c),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"SAR"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(_e,{class:"justify-space-between pa-6"},{default:t(()=>[l(r)>1?(g(),k(P,{key:0,variant:"outlined",disabled:l(p),onClick:B},{default:t(()=>u[17]||(u[17]=[x(" Previous ")])),_:1,__:[17]},8,["disabled"])):(g(),k(ze,{key:1})),o("div",Ut,[e(P,{variant:"outlined",disabled:l(p),onClick:u[14]||(u[14]=c=>A(!1))},{default:t(()=>u[18]||(u[18]=[x(" Cancel ")])),_:1,__:[18]},8,["disabled"]),l(r)<2?(g(),k(P,{key:0,color:"primary",disabled:l(p),onClick:z},{default:t(()=>u[19]||(u[19]=[x(" Next ")])),_:1,__:[19]},8,["disabled"])):(g(),k(P,{key:1,color:"primary",loading:l(p),disabled:l(p),onClick:q},{default:t(()=>u[20]||(u[20]=[x(" Create Unit ")])),_:1,__:[20]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Pt=Ve({__name:"ChangeStatusDialog",props:{isDialogVisible:{type:Boolean},unitId:{},currentStatus:{},statusOptions:{}},emits:["update:isDialogVisible","status-updated"],setup(n,{emit:I}){const d=n,m=I,r=C(d.currentStatus),p=C(!1);Ae(()=>d.currentStatus,f=>{r.value=f},{immediate:!0});const v=async()=>{if(!(!d.unitId||!r.value||r.value===d.currentStatus))try{p.value=!0,(await se(`/v1/units/${d.unitId}/status`,{method:"PATCH",body:{status:r.value}})).success&&(m("status-updated",{unitId:d.unitId,newStatus:r.value}),m("update:isDialogVisible",!1))}catch(f){console.error("Failed to change unit status:",f)}finally{p.value=!1}},i=()=>{r.value=d.currentStatus,m("update:isDialogVisible",!1)};return(f,y)=>{const R=rt;return g(),k(Re,{"model-value":f.isDialogVisible,"max-width":"600","onUpdate:modelValue":y[1]||(y[1]=A=>m("update:isDialogVisible",A))},{default:t(()=>[e(R,{onClick:i}),e(W,{title:"Change Unit Status"},{default:t(()=>[e($,null,{default:t(()=>[e(Fe,{modelValue:l(r),"onUpdate:modelValue":y[0]||(y[0]=A=>j(r)?r.value=A:null),label:"Status",items:f.statusOptions,placeholder:"Select Status"},null,8,["modelValue","items"])]),_:1}),e(_e,null,{default:t(()=>[e(ze),e(P,{color:"secondary",variant:"tonal",onClick:i},{default:t(()=>y[2]||(y[2]=[x(" Cancel ")])),_:1,__:[2]}),e(P,{color:"primary",disabled:!l(r)||l(r)===f.currentStatus,loading:l(p),onClick:v},{default:t(()=>y[3]||(y[3]=[x(" Update Status ")])),_:1,__:[3]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Dt={class:"d-flex align-center justify-space-between"},It={class:"ms-4"},At={class:"text-h4"},Rt={key:1},zt={class:"ms-4"},Ft={class:"text-h4"},Tt={key:1},$t={class:"ms-4"},Bt={class:"text-h4"},Nt={key:1},Et={class:"ms-4"},Mt={class:"text-h4"},Wt={key:1},qt={class:"text-center py-8"},Lt={class:"d-flex align-center justify-space-between mb-3"},Ot={class:"text-h6"},jt={class:"mb-2"},Gt={class:"text-body-1"},Ht={class:"mb-2"},Yt={class:"text-body-2"},Qt={class:"mb-3"},Jt={class:"text-body-1 font-weight-medium"},Kt={class:"text-center"},Zt={class:"text-center"},Xt={class:"d-flex align-center gap-x-3"},ea={class:"text-base font-weight-medium"},ta={class:"text-body-2 text-disabled"},aa={class:"text-body-1 font-weight-medium"},la={class:"text-body-2 text-disabled"},sa={class:"text-body-1"},na={class:"text-body-2 text-disabled"},ia={class:"text-body-2 text-disabled"},oa={class:"text-body-2 text-disabled"},da={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},ra={class:"text-sm text-disabled mb-0"},ua={class:"d-flex align-center",style:{"inline-size":"8rem"}},Xa=Ve({__name:"my-units",setup(n){const I=(b,a,V)=>{const M=(b-1)*a+1,s=Math.min(b*a,V);return`Showing ${M} to ${s} of ${V} entries`},d=at(),m=C("overview"),r=C([]),p=C(!1),v=C(null),i=C(1),f=C(10);C(0);const y=C(!1),R=C(null),A=C(""),z=C({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),B=C(!1),q=D(()=>z.value.totalUnits||r.value.length),L=D(()=>z.value.activeUnits||r.value.filter(b=>b.status==="active").length),w=D(()=>z.value.pendingUnits||r.value.filter(b=>b.status==="pending").length),u=D(()=>z.value.monthlyRoyalty),U=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],h=[{title:"Planning",value:"planning"},{title:"Construction",value:"construction"},{title:"Training",value:"training"},{title:"Active",value:"active"},{title:"Pending",value:"pending"},{title:"Temporarily Closed",value:"temporarily_closed"},{title:"Permanently Closed",value:"permanently_closed"}],N=b=>b==="active"?"success":b==="pending"?"warning":b==="inactive"?"error":"secondary",E=async()=>{var b;p.value=!0,v.value=null;try{const a=await se("/v1/franchisor/units");a.success&&a.data.data?r.value=a.data.data.map(V=>{var M,s,te;return{id:V.id,branchName:V.unit_name||"Unnamed Unit",franchiseeName:((M=V.franchisee)==null?void 0:M.name)||"Unassigned",email:((s=V.franchisee)==null?void 0:s.email)||V.email||"unassigned@example.com",contactNumber:((te=V.franchisee)==null?void 0:te.phone)||V.phone||"Not available",address:V.address||"Address not available",city:V.city||"Unknown",state:V.state_province||"Unknown",country:V.country||"Unknown",royaltyPercentage:8.5,contractStartDate:V.lease_start_date||"2024-01-01",renewalDate:V.lease_end_date||"2027-01-01",status:V.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:V.employee_count||0,totalProducts:0,avgRating:0}}):r.value=[]}catch(a){console.error("Failed to load units data:",a),v.value=((b=a==null?void 0:a.data)==null?void 0:b.message)||"Failed to load units data",r.value=[]}finally{p.value=!1}},c=async()=>{var b,a,V,M;try{const s=await se("/v1/franchisor/units/statistics");s.success&&s.data&&(z.value={totalUnits:s.data.totalUnits||0,activeUnits:s.data.activeUnits||0,pendingUnits:s.data.pendingUnits||0,inactiveUnits:s.data.inactiveUnits||0,totalRevenue:s.data.totalRevenue||0,monthlyRoyalty:s.data.monthlyRoyalty||0,avgRevenuePerUnit:s.data.avgRevenuePerUnit||0,revenueChange:s.data.revenueChange||0,royaltyRate:s.data.royaltyRate||8.5,taskStats:{total:((b=s.data.taskStats)==null?void 0:b.total)||0,completed:((a=s.data.taskStats)==null?void 0:a.completed)||0,pending:((V=s.data.taskStats)==null?void 0:V.pending)||0,completionRate:((M=s.data.taskStats)==null?void 0:M.completionRate)||0}})}catch(s){console.error("Failed to load statistics data:",s)}},G=async()=>{await Promise.all([E(),c()])},X=b=>{d.push(`/franchisor/units/${b}`)},T=()=>{B.value=!0},K=b=>{G()};tt(()=>{G()});const ee=b=>{R.value=b,A.value=b.status,y.value=!0},oe=b=>{const a=r.value.findIndex(V=>V.id===b.unitId);a!==-1&&(r.value[a].status=b.newStatus),c()};return(b,a)=>{var V,M;return g(),H("section",null,[e(Y,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",Dt,[a[11]||(a[11]=o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Units "),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:T},{default:t(()=>a[10]||(a[10]=[x(" Add Franchisee ")])),_:1,__:[10]},8,["loading"])])]),_:1})]),_:1}),l(v)?(g(),k(ve,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":a[0]||(a[0]=s=>v.value=null)},{default:t(()=>[x(_(l(v)),1)]),_:1})):me("",!0),e(vt,{modelValue:l(m),"onUpdate:modelValue":a[1]||(a[1]=s=>j(m)?m.value=s:null),class:"mb-6"},{default:t(()=>[e(De,{value:"overview"},{default:t(()=>[e(F,{icon:"tabler-dashboard",start:""}),a[12]||(a[12]=x(" Overview "))]),_:1,__:[12]}),e(De,{value:"units"},{default:t(()=>[e(F,{icon:"tabler-building-store",start:""}),a[13]||(a[13]=x(" All Units "))]),_:1,__:[13]})]),_:1},8,["modelValue"]),e(fe,{modelValue:l(m),"onUpdate:modelValue":a[7]||(a[7]=s=>j(m)?m.value=s:null),class:"disable-tab-transition"},{default:t(()=>[e(de,{value:"overview"},{default:t(()=>[e(Y,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e($,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:t(()=>[e(F,{icon:"tabler-building-store",size:"26"})]),_:1}),o("div",It,[a[14]||(a[14]=o("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),o("h4",At,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),H("span",Rt,_(l(q)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e($,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:t(()=>[e(F,{icon:"tabler-check",size:"26"})]),_:1}),o("div",zt,[a[15]||(a[15]=o("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),o("h4",Ft,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),H("span",Tt,_(l(L)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e($,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:t(()=>[e(F,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",$t,[a[16]||(a[16]=o("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),o("h4",Bt,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),H("span",Nt,_(l(w)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(W,null,{default:t(()=>[e($,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:t(()=>[e(l(ft),{size:"26"})]),_:1}),o("div",Et,[a[17]||(a[17]=o("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),o("h4",Mt,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),H("span",Wt,_(l(lt)(l(u))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(Ue,{class:"pb-4"},{append:t(()=>[e(P,{variant:"text",color:"primary",onClick:a[2]||(a[2]=s=>m.value="units")},{default:t(()=>a[19]||(a[19]=[x(" View All ")])),_:1,__:[19]})]),default:t(()=>[e(pe,null,{default:t(()=>a[18]||(a[18]=[x("Recent Units")])),_:1,__:[18]})]),_:1}),e($,null,{default:t(()=>[l(p)?(g(),k(Y,{key:0},{default:t(()=>[(g(),H(ce,null,ke(3,s=>e(S,{key:s,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e($,null,{default:t(()=>[e(le,{type:"text",class:"mb-3"}),e(le,{type:"text",class:"mb-2"}),e(le,{type:"text",class:"mb-2"}),e(le,{type:"text",class:"mb-3"}),e(le,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(r).length===0?(g(),k(Y,{key:1},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",qt,[e(F,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),a[21]||(a[21]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[22]||(a[22]=o("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",onClick:T},{default:t(()=>a[20]||(a[20]=[x(" Add Your First Unit ")])),_:1,__:[20]})])]),_:1})]),_:1})):(g(),k(Y,{key:2},{default:t(()=>[(g(!0),H(ce,null,ke(l(r).slice(0,3),s=>(g(),k(S,{key:s.id,cols:"12",md:"4"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e($,null,{default:t(()=>[o("div",Lt,[o("h6",Ot,_(s.branchName),1),e(ue,{color:N(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(_(s.status),1)]),_:2},1032,["color"])]),o("div",jt,[a[23]||(a[23]=o("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),o("div",Gt,_(s.franchiseeName),1)]),o("div",Ht,[a[24]||(a[24]=o("div",{class:"text-body-2 text-disabled"}," Location ",-1)),o("div",Yt,_(s.city)+", "+_(s.state),1)]),o("div",Qt,[a[25]||(a[25]=o("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),o("div",Jt,_(s.royaltyPercentage)+"% ",1)])]),_:2},1024),e(_e,null,{default:t(()=>[e(P,{variant:"text",color:"primary",onClick:te=>X(s.id)},{default:t(()=>a[26]||(a[26]=[x(" View Details ")])),_:2,__:[26]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(de,{value:"units"},{default:t(()=>[e(W,null,{default:t(()=>[e(Ue,{class:"pb-4"},{append:t(()=>[e(P,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:T},{default:t(()=>a[28]||(a[28]=[x(" Add Franchisee ")])),_:1,__:[28]},8,["loading"])]),default:t(()=>[e(pe,null,{default:t(()=>a[27]||(a[27]=[x("All Franchise Units")])),_:1,__:[27]})]),_:1}),e(re),l(p)?(g(),k($,{key:0,class:"py-8"},{default:t(()=>[o("div",Kt,[e(ae,{indeterminate:"",size:"48",class:"mb-4"}),a[29]||(a[29]=o("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),a[30]||(a[30]=o("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(r).length===0?(g(),k($,{key:1,class:"py-8"},{default:t(()=>[o("div",Zt,[e(F,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),a[32]||(a[32]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[33]||(a[33]=o("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:T},{default:t(()=>a[31]||(a[31]=[x(" Add Your First Franchisee & Unit ")])),_:1,__:[31]})])]),_:1})):(g(),k(yt,{key:2,items:l(r),headers:U,class:"text-no-wrap","item-value":"id","items-per-page":l(f),page:l(i),"onUpdate:itemsPerPage":a[5]||(a[5]=s=>f.value=s),"onUpdate:page":a[6]||(a[6]=s=>i.value=s)},{"item.branchInfo":t(({item:s})=>[o("div",Xt,[e(Z,{size:"34",color:"primary",variant:"tonal"},{default:t(()=>[e(F,{icon:"tabler-building-store",size:"20"})]),_:1}),o("div",null,[o("h6",ea,_(s.branchName),1),o("div",ta,_(s.email),1)])])]),"item.franchisee":t(({item:s})=>[o("div",null,[o("div",aa,_(s.franchiseeName),1),o("div",la,[e(F,{icon:"tabler-user-check",size:"14",class:"me-1"}),x(" Unit Manager • "+_(s.contactNumber),1)])])]),"item.location":t(({item:s})=>[o("div",null,[o("div",sa,_(s.city)+", "+_(s.state),1),o("div",na,_(s.country),1)])]),"item.royaltyPercentage":t(({item:s})=>[s.royaltyPercentage>0?(g(),k(ue,{key:0,color:"primary",size:"small",class:"mt-1"},{default:t(()=>[x(_(s.royaltyPercentage)+"% Royalty ",1)]),_:2},1024)):me("",!0)]),"item.contractPeriod":t(({item:s})=>[o("div",null,[o("div",ia," Start: "+_(s.contractStartDate),1),o("div",oa," Renewal: "+_(s.renewalDate),1)])]),"item.status":t(({item:s})=>[e(ue,{color:N(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(_(s.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:s})=>[e(P,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(te=>X(s.id),["stop"])},{default:t(()=>[e(F,{icon:"tabler-eye"}),e(Ie,{activator:"parent"},{default:t(()=>a[34]||(a[34]=[x(" View Unit Details ")])),_:1,__:[34]})]),_:2},1032,["onClick"]),e(P,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(te=>ee(s),["stop"])},{default:t(()=>[e(F,{icon:"tabler-edit"}),e(Ie,{activator:"parent"},{default:t(()=>a[35]||(a[35]=[x(" Change Status ")])),_:1,__:[35]})]),_:2},1032,["onClick"])]),bottom:t(()=>[e(re),o("div",da,[o("p",ra,_(I(l(i),l(f),l(r).length)),1),e(bt,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=s=>j(i)?i.value=s:null),length:Math.ceil(l(r).length/l(f)),"total-visible":b.$vuetify.display.xs?1:Math.min(Math.ceil(l(r).length/l(f)),5)},null,8,["modelValue","length","total-visible"]),o("div",ua,[a[36]||(a[36]=o("span",{class:"text-no-wrap me-3"},"Rows per page:",-1)),e(Fe,{modelValue:l(f),"onUpdate:modelValue":a[4]||(a[4]=s=>j(f)?f.value=s:null),density:"compact",variant:"outlined",items:[5,10,25,50,100]},null,8,["modelValue"])])])]),_:1},8,["items","items-per-page","page"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ct,{"is-dialog-visible":l(B),"onUpdate:isDialogVisible":a[8]||(a[8]=s=>j(B)?B.value=s:null),onFranchiseeAdded:K},null,8,["is-dialog-visible"]),e(Pt,{"is-dialog-visible":l(y),"onUpdate:isDialogVisible":a[9]||(a[9]=s=>j(y)?y.value=s:null),"unit-id":((V=l(R))==null?void 0:V.id)||null,"current-status":((M=l(R))==null?void 0:M.status)||"","status-options":h,onStatusUpdated:oe},null,8,["is-dialog-visible","unit-id","current-status"])])}}});export{Xa as default};
