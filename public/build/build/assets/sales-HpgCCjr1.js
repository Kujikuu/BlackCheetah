import{V as we,_ as be}from"./VDataTableServer-DuqkQSwU.js";import{_ as Ve}from"./AppTextField.vue_vue_type_script_setup_true_lang-CO47FMF9.js";import{_ as Ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-C9l7FSyM.js";import{_ as he}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-DAIl_DQk.js";import{_ as ke,a as Se}from"./ResetPasswordDialog.vue_vue_type_script_setup_true_lang-DQA7WoFv.js";import{_ as Ue}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-HL7bzv_B.js";import{d as De,r as i,P as Ee,G as $e,aO as h,c as z,b as s,f as a,m as o,au as f,o as w,e as r,F as Pe,i as Te,g as F,v as u,x as Fe,aa as v,l as W,t as c,a3 as D}from"./main-CpsWdFYr.js";import{V as B,a as I}from"./VRow-Bk9_G6aB.js";import{V as q,a as Ae,b as Ne}from"./VCard-D_XCsLRw.js";import{V as O}from"./VCardText-j0JBfbAe.js";import{V as J}from"./VAvatar-CzxzJOWa.js";import{V as R}from"./VDivider-BP0aNN7O.js";import{V as Le}from"./VSpacer-D_nZvJpN.js";import{V as Q}from"./VMenu-PCh5aX_y.js";import{V as H,a as k,b as S}from"./VList-DZrW6fib.js";import{V as ze}from"./VAlert-DRT0ey_A.js";import{V as Be}from"./VChip-yrA_M1tP.js";import{V as Ie}from"./VImg-DCJkd1LN.js";import"./VPagination-CUSlXpHq.js";import"./VDataTable-BZUXZCW2.js";import"./VSelect-CtqI8NsY.js";import"./VTextField-CUOQrd4S.js";/* empty css                   */import"./VCounter-CbUu5J9F.js";import"./VField-DDq05bP2.js";import"./form-DyYLQJyt.js";import"./easing-Bybner-F.js";import"./VInput-B4TWBtjL.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-D456YNVX.js";import"./VOverlay-BGEfXIrC.js";import"./lazy-C2iFJq6n.js";import"./scopeId-D-NoPJiR.js";import"./VCheckboxBtn-D9UFBLvW.js";import"./VSelectionControl-BJqGXIsn.js";import"./VTable-CKwy69H0.js";import"./filter-jIliInNJ.js";import"./validators-BYiRrju8.js";import"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-CKW97nTe.js";import"./VNavigationDrawer-DzK6m3-S.js";import"./ssrBoot-BhGqyhmX.js";import"./VForm-D7q8z2rE.js";import"./VDialog-ChyOvTE6.js";import"./VTooltip-BjPBKR7d.js";import"./formatters-WDr9EcLN.js";/* empty css              */import"./VSlideGroup-93CEUUHa.js";const Oe={class:"d-flex justify-space-between"},Re={class:"d-flex flex-column gap-y-1"},je={class:"text-body-1 text-high-emphasis"},Me={class:"d-flex gap-x-2 align-center"},Ge={class:"text-h4"},We={class:"text-sm"},qe={class:"me-3 d-flex gap-3"},Je={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Qe={style:{"inline-size":"15.625rem"}},He={class:"text-center pa-8"},Ke={class:"d-flex align-center gap-x-4"},Xe={key:1},Ye={class:"d-flex flex-column"},Ze={class:"text-base font-weight-medium"},et={class:"text-sm text-medium-emphasis"},tt={class:"text-body-1 text-high-emphasis"},st={class:"text-body-1"},lt={class:"text-body-1"},at={class:"d-flex gap-1"},Zt=De({__name:"sales",setup(ot){const g=i(""),b=i(),_=i(10),y=i(1),A=i([{key:"created_at",order:"desc"}]),K=i("desc"),d=i([]),X=t=>{var e;t.sortBy&&t.sortBy.length>0&&(A.value=t.sortBy,K.value=(e=t.sortBy[0])==null?void 0:e.order)},Y=[{title:"User",key:"user"},{title:"City",key:"city"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],V=i([]),N=i(!1),n=i(""),L=i(0),E=async()=>{var t,e;N.value=!0,n.value="";try{const m=await h("/v1/admin/users/sales",{method:"GET",query:{search:g.value,status:b.value,sort_by:((t=A.value[0])==null?void 0:t.key)||"created_at",sort_direction:((e=A.value[0])==null?void 0:e.order)||"desc",page:y.value,per_page:_.value}});m.success?(V.value=m.data.data||[],L.value=m.data.total||0):n.value=m.message||"Failed to fetch sales users"}catch(m){console.error("Error fetching sales users:",m),n.value="Failed to fetch sales users"}finally{N.value=!1}},Z=Ee(()=>{let t=V.value;return g.value&&(t=t.filter(e=>e.fullName.toLowerCase().includes(g.value.toLowerCase())||e.email.toLowerCase().includes(g.value.toLowerCase())||e.city.toLowerCase().includes(g.value.toLowerCase()))),b.value&&(t=t.filter(e=>e.status===b.value)),t}),ee=[{title:"Pending",value:"pending"},{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],te=t=>{const e=t.toLowerCase();return e==="pending"?"warning":e==="active"?"success":e==="inactive"?"secondary":"primary"},x=i(!1),$=i(!1),P=i(!1),T=i(!1),p=i(null),C=i(null),se=t=>t>0?`+${t}`:t,le=t=>{if(!t||typeof t!="string")return"U";const e=t.split(" ");return e.length>1?`${e[0][0]}${e[1][0]}`:t.slice(0,2)},ae=async t=>{try{const e=await h("/v1/admin/users",{method:"POST",body:{...t,role:"sales"}});e.success?await E():n.value=e.message||"Failed to create sales user"}catch(e){console.error("Error creating sales user:",e),n.value="Failed to create sales user"}},oe=t=>{p.value={...t},x.value=!0},re=async t=>{try{const e=await h(`/v1/admin/users/${t.id}`,{method:"PUT",body:t});e.success?(await E(),p.value=null):n.value=e.message||"Failed to update sales user"}catch(e){console.error("Error updating sales user:",e),n.value="Failed to update sales user"}},ie=async t=>{t.id?await re(t):await ae(t)},ne=t=>{C.value=t,$.value=!0},ue=async()=>{if(C.value){try{const t=await h(`/v1/admin/users/${C.value.id}`,{method:"DELETE"});if(t.success){await E();const e=d.value.findIndex(m=>m===C.value.id);e!==-1&&d.value.splice(e,1)}else n.value=t.message||"Failed to delete sales user"}catch(t){console.error("Error deleting sales user:",t),n.value="Failed to delete sales user"}C.value=null}},de=t=>{p.value=t,P.value=!0},ce=async t=>{if(p.value){try{const e=await h(`/v1/admin/users/${p.value.id}/reset-password`,{method:"POST",body:{password:t}});e.success?console.log("Password reset successfully for:",p.value.fullName):n.value=e.message||"Failed to reset password"}catch(e){console.error("Error resetting password:",e),n.value="Failed to reset password"}p.value=null}},pe=()=>{p.value=null},me=t=>{p.value=t,T.value=!0},ve=()=>{x.value=!0},fe=()=>{const t=d.value.length>0?V.value.filter(e=>d.value.includes(e.id)):V.value;console.log("Exporting to CSV:",t)},ge=()=>{const t=d.value.length>0?V.value.filter(e=>d.value.includes(e.id)):V.value;console.log("Exporting to PDF:",t)};$e(()=>{E(),_e()});const j=i([{title:"Total Sales Users",value:"0",change:0,desc:"All sales team members",icon:"tabler-chart-line",iconColor:"primary"},{title:"Active Sales",value:"0",change:0,desc:"Currently active",icon:"tabler-user-check",iconColor:"success"},{title:"Pending Approval",value:"0",change:0,desc:"Awaiting verification",icon:"tabler-clock",iconColor:"warning"}]),_e=async()=>{try{const t=await h("/v1/admin/users/sales/stats");t.success&&(j.value=t.data)}catch(t){console.error("Error fetching sales stats:",t)}};return(t,e)=>{var M,G;const m=Ce,ye=Ve,xe=be;return w(),z("section",null,[s(B,{class:"mb-6"},{default:a(()=>[s(I,{cols:"12"},{default:a(()=>e[14]||(e[14]=[r("div",{class:"d-flex align-center justify-space-between"},[r("div",null,[r("h2",{class:"text-h2 mb-1"}," Sales Team Management "),r("p",{class:"text-body-1 text-medium-emphasis"}," Manage and monitor all sales team members ")])],-1)])),_:1,__:[14]})]),_:1}),s(B,{class:"mb-6"},{default:a(()=>[(w(!0),z(Pe,null,Te(o(j),(l,U)=>(w(),F(I,{key:U,cols:"12",md:"4",sm:"6"},{default:a(()=>[s(q,null,{default:a(()=>[s(O,null,{default:a(()=>[r("div",Oe,[r("div",Re,[r("div",je,u(l.title),1),r("div",Me,[r("h4",Ge,u(l.value),1),r("div",{class:Fe(["text-base",l.change>0?"text-success":"text-error"])}," ("+u(se(l.change))+"%) ",3)]),r("div",We,u(l.desc),1)]),s(J,{color:l.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[s(v,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(q,{class:"mb-6"},{default:a(()=>[s(Ae,{class:"pb-4"},{default:a(()=>[s(Ne,null,{default:a(()=>e[15]||(e[15]=[c("Filters")])),_:1,__:[15]})]),_:1}),s(O,null,{default:a(()=>[s(B,null,{default:a(()=>[s(I,{cols:"12",sm:"4"},{default:a(()=>[s(m,{modelValue:o(b),"onUpdate:modelValue":e[0]||(e[0]=l=>f(b)?b.value=l:null),placeholder:"Select Status",items:ee,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(R),s(O,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[r("div",qe,[s(m,{"model-value":o(_),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=parseInt(l,10))},null,8,["model-value"]),o(d).length>0?(w(),F(D,{key:0,variant:"tonal",color:"error",onClick:t.bulkDelete},{default:a(()=>[s(v,{icon:"tabler-trash",class:"me-2"}),c(" Delete Selected ("+u(o(d).length)+") ",1)]),_:1},8,["onClick"])):W("",!0)]),s(Le),r("div",Je,[r("div",Qe,[s(ye,{modelValue:o(g),"onUpdate:modelValue":e[2]||(e[2]=l=>f(g)?g.value=l:null),placeholder:"Search Sales User"},null,8,["modelValue"])]),s(D,{variant:"tonal",color:"secondary"},{default:a(()=>[s(v,{icon:"tabler-upload",class:"me-2"}),c(" Export "+u(o(d).length>0?`(${o(d).length})`:"All")+" ",1),s(Q,{activator:"parent"},{default:a(()=>[s(H,null,{default:a(()=>[s(k,{onClick:fe},{prepend:a(()=>[s(v,{icon:"tabler-file-type-csv"})]),default:a(()=>[s(S,null,{default:a(()=>e[16]||(e[16]=[c("Export to CSV")])),_:1,__:[16]})]),_:1}),s(k,{onClick:ge},{prepend:a(()=>[s(v,{icon:"tabler-file-type-pdf"})]),default:a(()=>[s(S,null,{default:a(()=>e[17]||(e[17]=[c("Export to PDF")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1}),s(D,{"prepend-icon":"tabler-plus",onClick:e[3]||(e[3]=l=>x.value=!0)},{default:a(()=>e[18]||(e[18]=[c(" Add New Sales User ")])),_:1,__:[18]})])]),_:1}),s(R),o(n)?(w(),F(ze,{key:0,type:"error",class:"ma-4",closable:"","onClick:close":e[4]||(e[4]=l=>n.value=null)},{default:a(()=>[c(u(o(n)),1)]),_:1})):W("",!0),s(we,{"items-per-page":o(_),"onUpdate:itemsPerPage":e[7]||(e[7]=l=>f(_)?_.value=l:null),"model-value":o(d),"onUpdate:modelValue":e[8]||(e[8]=l=>f(d)?d.value=l:null),page:o(y),"onUpdate:page":e[9]||(e[9]=l=>f(y)?y.value=l:null),items:o(Z),"item-value":"id","items-length":o(L),headers:Y,class:"text-no-wrap","show-select":"",loading:o(N),"onUpdate:options":X},{"no-data":a(()=>[r("div",He,[s(v,{icon:"tabler-users-off",size:"64",class:"mb-4 text-disabled"}),e[20]||(e[20]=r("h3",{class:"text-h5 mb-2"}," No Sales Users Found ",-1)),e[21]||(e[21]=r("p",{class:"text-body-1 text-medium-emphasis mb-4"}," No sales users match your search criteria. Try adjusting your filters. ",-1)),s(D,{color:"primary",onClick:e[5]||(e[5]=l=>x.value=!0)},{default:a(()=>e[19]||(e[19]=[c(" Add First Sales User ")])),_:1,__:[19]})])]),"item.user":a(({item:l})=>[r("div",Ke,[s(J,{size:"34",variant:l.avatar?void 0:"tonal",color:"warning"},{default:a(()=>[l.avatar?(w(),F(Ie,{key:0,src:l.avatar},null,8,["src"])):(w(),z("span",Xe,u(le(l.fullName)),1))]),_:2},1032,["variant"]),r("div",Ye,[r("h6",Ze,u(l.fullName),1),r("div",et," Joined: "+u(l.joinedDate),1)])])]),"item.city":a(({item:l})=>[r("div",tt,u(l.city),1)]),"item.email":a(({item:l})=>[r("div",st,u(l.email),1)]),"item.phone":a(({item:l})=>[r("div",lt,u(l.phone),1)]),"item.status":a(({item:l})=>[s(Be,{color:te(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[c(u(l.status),1)]),_:2},1032,["color"])]),"item.actions":a(({item:l})=>[r("div",at,[s(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small"},{default:a(()=>[s(v,{icon:"tabler-dots-vertical",size:"22"}),s(Q,{activator:"parent"},{default:a(()=>[s(H,null,{default:a(()=>[s(k,{onClick:U=>me(l)},{prepend:a(()=>[s(v,{icon:"tabler-eye"})]),default:a(()=>[s(S,null,{default:a(()=>e[22]||(e[22]=[c("View")])),_:1,__:[22]})]),_:2},1032,["onClick"]),s(k,{onClick:U=>oe(l)},{prepend:a(()=>[s(v,{icon:"tabler-pencil"})]),default:a(()=>[s(S,null,{default:a(()=>e[23]||(e[23]=[c("Edit")])),_:1,__:[23]})]),_:2},1032,["onClick"]),s(k,{onClick:U=>de(l)},{prepend:a(()=>[s(v,{icon:"tabler-key"})]),default:a(()=>[s(S,null,{default:a(()=>e[24]||(e[24]=[c("Reset Password")])),_:1,__:[24]})]),_:2},1032,["onClick"]),s(R,{class:"my-2"}),s(k,{onClick:U=>ne(l)},{prepend:a(()=>[s(v,{icon:"tabler-trash",color:"error"})]),default:a(()=>[s(S,{class:"text-error"},{default:a(()=>e[25]||(e[25]=[c(" Delete ")])),_:1,__:[25]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),bottom:a(()=>[s(xe,{page:o(y),"onUpdate:page":e[6]||(e[6]=l=>f(y)?y.value=l:null),"items-per-page":o(_),"total-items":o(L)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),s(he,{"is-drawer-open":o(x),"onUpdate:isDrawerOpen":[e[10]||(e[10]=l=>f(x)?x.value=l:null),pe],"sales-user":o(p),onSalesUserData:ie},null,8,["is-drawer-open","sales-user"]),s(ke,{"is-dialog-open":o($),"onUpdate:isDialogOpen":e[11]||(e[11]=l=>f($)?$.value=l:null),"user-name":(M=o(C))==null?void 0:M.fullName,"user-type":"Sales User",onConfirm:ue},null,8,["is-dialog-open","user-name"]),s(Se,{"is-dialog-open":o(P),"onUpdate:isDialogOpen":e[12]||(e[12]=l=>f(P)?P.value=l:null),"user-name":(G=o(p))==null?void 0:G.fullName,onConfirm:ce},null,8,["is-dialog-open","user-name"]),s(Ue,{"is-dialog-open":o(T),"onUpdate:isDialogOpen":e[13]||(e[13]=l=>f(T)?T.value=l:null),user:o(p),"user-type":"Sales User",onEdit:ve},null,8,["is-dialog-open","user"])])}}});export{Zt as default};
