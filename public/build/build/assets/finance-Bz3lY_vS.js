import{m as J}from"./vue3-apexcharts-DRaI8Jiw.js";import{f as m}from"./formatters-WDr9EcLN.js";import{u as U}from"./useApi-DYCiIsKN.js";import{V as _,a as u}from"./VRow-BhZ4svpb.js";import{V as h,a as v,b as q,c as X}from"./VCard-DneUGeMs.js";import{V as b}from"./VCardText-D9647M3L.js";import{V as Y}from"./VAvatar-BiIl4hu9.js";import{d as j,r as n,w as G,P as y,c as T,b as t,f as a,o as C,F as K,i as Q,m as d,g as Z,I as ee,e as l,aa as te,v as c,a3 as R,t as g}from"./main-Dhlv_lYh.js";import{V as ae}from"./VDivider-DmcXD_UB.js";import{q as oe}from"./VDataTable-DBP3GL9F.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-CqkleIqs.js";/* empty css              */import"./VImg-w3Zg-hsq.js";import"./VPagination-uIapqy_w.js";import"./VSelect-DciTQrMO.js";import"./VTextField-cleeZpmw.js";/* empty css                   */import"./VCounter-D1uzI7GI.js";import"./VField-Ca1Snnyd.js";import"./form-CTX8i0eJ.js";import"./easing-Bybner-F.js";import"./VInput-DHj7OjXT.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-CQSw0LK2.js";import"./ssrBoot-CMmi3XlW.js";import"./dialog-transition-4x8nqMt1.js";import"./VMenu-C7unrazO.js";import"./VOverlay-CZ4wdQIu.js";import"./lazy-APcxPsVL.js";import"./scopeId-SeYQuCZg.js";import"./VCheckboxBtn-ik8ryK8u.js";import"./VSelectionControl-kcwTEoOb.js";import"./VChip-6fHDyEWx.js";import"./VSlideGroup-C78OLP4w.js";import"./VTable-CwAmgxig.js";import"./filter-DLHRgPOn.js";const re={class:"d-flex align-center gap-x-4 mb-1"},le={class:"text-h4"},ie={class:"text-body-1 mb-1"},ne={class:"d-flex gap-x-2 align-center"},ce={class:"text-h6"},pe={class:"text-body-1 font-weight-medium"},me={class:"text-body-1 text-success font-weight-medium"},de={class:"text-body-1 text-error font-weight-medium"},fe={class:"text-body-1 text-warning font-weight-medium"},ue={class:"text-body-1 text-primary font-weight-medium"},he="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",f="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",z="rgba(var(--v-border-color), var(--v-border-opacity))",ye=j({__name:"finance",setup(ge){const{data:M,execute:_e,isFetching:ve}=U("/v1/franchisor/dashboard/finance",{immediate:!0}),i={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},x=n([]),A=n([{name:"Sales",data:[]}]),V=n([{name:"Royalty",data:[]}]),p=n([]),S=n([{name:"Sales",data:[]}]),w=n([{name:"Expenses",data:[]}]),k=n([{name:"Profit",data:[]}]),F=n([{name:"Royalty",data:[]}]),H=n([]);G(M,s=>{const r=s;if(r!=null&&r.success&&(r!=null&&r.data)){const o=r.data;x.value=[{icon:"tabler-currency-riyal",color:"primary",title:"Total Sales",value:m(parseFloat(o.stats.total_sales)||0),change:o.stats.sales_change,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:m(parseFloat(o.stats.total_expenses)||0),change:o.stats.expenses_change,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:m(parseFloat(o.stats.net_profit)||0),change:o.stats.profit_change,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:`${parseFloat(o.stats.profit_margin)||0}%`,change:o.stats.margin_change,isHover:!1}],o.top_stores_sales&&o.top_stores_sales.length>0&&(A.value=[{name:"Sales",data:o.top_stores_sales.map(e=>parseFloat(e.sales)||0)}],p.value=o.top_stores_sales.map(e=>e.name||"Unknown Store")),o.top_stores_royalty&&o.top_stores_royalty.length>0&&(V.value=[{name:"Royalty",data:o.top_stores_royalty.map(e=>parseFloat(e.royalty)||0)}],p.value.length===0&&(p.value=o.top_stores_royalty.map(e=>e.name||"Unknown Store"))),o.sales_chart&&(S.value=[{name:"Sales",data:o.sales_chart.map(e=>parseFloat(e.amount)||0)}]),o.expenses_chart&&(w.value=[{name:"Expenses",data:o.expenses_chart.map(e=>parseFloat(e.amount)||0)}]),o.profit_chart&&(k.value=[{name:"Profit",data:o.profit_chart.map(e=>parseFloat(e.amount)||0)}]),o.royalty_chart&&(F.value=[{name:"Royalty",data:o.royalty_chart.map(e=>parseFloat(e.amount)||0)}]),o.monthly_breakdown&&(H.value=o.monthly_breakdown)}});const $=[{icon:"tabler-currency-riyal",color:"primary",title:"Total Sales",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:"0%",change:0,isHover:!1}],B=y(()=>x.value.length>0?x.value:$),D=y(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(0)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.primary],xaxis:{categories:p.value.length>0?p.value:["No data available"],labels:{style:{colors:f,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:f,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:z,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),P=y(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(1)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.warning],xaxis:{categories:p.value.length>0?p.value:["No data available"],labels:{style:{colors:f,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:f,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:z,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),N=y(()=>[{name:"Sales",data:S.value.length>0?S.value[0].data:[]},{name:"Expenses",data:w.value.length>0?w.value[0].data:[]},{name:"Royalties",data:F.value.length>0?F.value[0].data:[]},{name:"Profit",data:k.value.length>0?k.value[0].data:[]}]),L={chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:4,colors:"#fff",strokeColors:[i.primary,i.error,i.warning,i.success],hover:{size:5},borderRadius:4},stroke:{curve:"smooth",width:3,lineCap:"round"},legend:{show:!0,position:"top",horizontalAlign:"left",markers:{width:10,height:10,offsetX:-3},fontSize:"14px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:he},itemMargin:{horizontal:12,vertical:8}},grid:{strokeDashArray:8,borderColor:z},colors:[i.primary,i.error,i.warning,i.success],dataLabels:{enabled:!1},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:f,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:f,fontSize:"13px",fontWeight:400},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}},E=y(()=>H.value.map(s=>({month:s.month,sales:m(parseFloat(s.sales)||0),expenses:m(parseFloat(s.expenses)||0),royalties:m(parseFloat(s.royalties)||0),profit:m(parseFloat(s.profit)||0)}))),O=[{title:"Month",key:"month"},{title:"Sales",key:"sales",align:"end"},{title:"Expenses",key:"expenses",align:"end"},{title:"Royalties",key:"royalties",align:"end"},{title:"Profit",key:"profit",align:"end"}];return(s,r)=>{const o=J;return C(),T("section",null,[t(_,{class:"mb-6"},{default:a(()=>[(C(!0),T(K,null,Q(d(B),(e,W)=>(C(),Z(u,{key:W,cols:"12",md:"3",sm:"6"},{default:a(()=>[t(h,{class:"finance-card-statistics cursor-pointer",style:ee(e.isHover?`border-block-end-color: rgb(var(--v-theme-${e.color}))`:`border-block-end-color: rgba(var(--v-theme-${e.color}),0.38)`),onMouseenter:I=>e.isHover=!0,onMouseleave:I=>e.isHover=!1},{default:a(()=>[t(b,null,{default:a(()=>[l("div",re,[t(Y,{variant:"tonal",color:e.color,rounded:""},{default:a(()=>[t(te,{icon:e.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),l("h4",le,c(e.value),1)]),l("div",ie,c(e.title),1),l("div",ne,[l("h6",ce,c(e.change>0?"+":"")+" "+c(e.change)+"% ",1),r[0]||(r[0]=l("div",{class:"text-sm text-disabled"}," than last month ",-1))])]),_:2},1024)]),_:2},1032,["style","onMouseenter","onMouseleave"])]),_:2},1024))),128))]),_:1}),t(_,{class:"mb-6"},{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{title:"Top 5 Stores by Monthly Sales",subtitle:"Performance comparison"},{append:a(()=>[t(R,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:a(()=>r[1]||(r[1]=[g(" This Month ")])),_:1,__:[1]})]),_:1}),t(b,null,{default:a(()=>[t(o,{type:"bar",height:"320",options:d(D),series:d(A)},null,8,["options","series"])]),_:1})]),_:1})]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{title:"Top 5 Stores by Monthly Royalty",subtitle:"Royalty contributions"},{append:a(()=>[t(R,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:a(()=>r[2]||(r[2]=[g(" This Month ")])),_:1,__:[2]})]),_:1}),t(b,null,{default:a(()=>[t(o,{type:"bar",height:"320",options:d(P),series:d(V)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{class:"mb-6"},{default:a(()=>[t(u,{cols:"12"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{title:"Financial Summary",subtitle:"Yearly overview of sales, expenses, royalties and profit"},{append:a(()=>[t(R,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:a(()=>r[3]||(r[3]=[g(" 2024 ")])),_:1,__:[3]})]),_:1}),t(b,null,{default:a(()=>[t(o,{type:"line",height:"400",options:L,series:d(N)},null,8,["series"])]),_:1})]),_:1})]),_:1})]),_:1}),t(_,null,{default:a(()=>[t(u,{cols:"12"},{default:a(()=>[t(h,null,{default:a(()=>[t(v,{class:"pb-4"},{default:a(()=>[t(q,null,{default:a(()=>r[4]||(r[4]=[g("Monthly Financial Breakdown")])),_:1,__:[4]}),t(X,null,{default:a(()=>r[5]||(r[5]=[g("Detailed monthly statistics")])),_:1,__:[5]})]),_:1}),t(ae),t(oe,{headers:O,items:d(E),"hide-default-footer":"",class:"text-no-wrap"},{"item.month":a(({item:e})=>[l("div",pe,c(e.month),1)]),"item.sales":a(({item:e})=>[l("div",me,c(e.sales),1)]),"item.expenses":a(({item:e})=>[l("div",de,c(e.expenses),1)]),"item.royalties":a(({item:e})=>[l("div",fe,c(e.royalties),1)]),"item.profit":a(({item:e})=>[l("div",ue,c(e.profit),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})])}}}),ot=se(ye,[["__scopeId","data-v-f8a2dcd7"]]);export{ot as default};
