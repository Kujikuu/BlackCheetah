var ne=Object.defineProperty;var le=(t,s,l)=>s in t?ne(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l;var G=(t,s,l)=>le(t,typeof s!="symbol"?s+"":s,l);import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b2 as S,d as $,g as B,w as W,E as Q,b3 as ce,b4 as de,a as v,o as f,k as r,x as ue,b as me,K as Z,L as ee,ao as fe,an as pe,b5 as he,aj as _e,aF as ve,b6 as ge,M as te,b7 as ye,y as o,n as M,b8 as be,b9 as ae,ad as ke,ba as xe,$ as oe,R as we,I as R,J as I,av as w,c as N,l as x,t as b,O as K,aU as X,q as C,i as d,r as z,F as P,h as T,bb as Ce,s as Se,bc as j,aE as Ae,aM as Ne,bd as Ve,b1 as O,a7 as $e,e as Be,be as Pe,aL as Ue}from"./main-CJoUlw71.js";import{V as F}from"./VMenu-ChdF8Fzb.js";import{m as Le,M as Te,V as Re,a as Ie,d as Ee,b as Y,e as J}from"./VCard-D0Kr6jJ3.js";import{V as Me}from"./VChip-B4nRRsDL.js";import{V as se}from"./VTooltip-DRAd6RrJ.js";import{V as q}from"./VDivider-BaGqyL8B.js";import{V as D,a as U,b as H,c as ze}from"./VList-dBGtPQa1.js";import{V as Fe}from"./VSpacer-CqgjN_yM.js";import{a as De}from"./auth-yTXB8IVG.js";class He{constructor(){G(this,"baseUrl","/v1/notifications")}async getNotifications(s){return await S(this.baseUrl,{method:"GET",query:s})}async getStats(){return await S(`${this.baseUrl}/stats`)}async markAsRead(s){return await S(`${this.baseUrl}/${s}/read`,{method:"PATCH"})}async markAsUnread(s){return await S(`${this.baseUrl}/${s}/unread`,{method:"PATCH"})}async markMultipleAsRead(s){return await S(`${this.baseUrl}/mark-multiple-read`,{method:"PATCH",body:s})}async markMultipleAsUnread(s){return await S(`${this.baseUrl}/mark-multiple-unread`,{method:"PATCH",body:s})}async markAllAsRead(){return await S(`${this.baseUrl}/mark-all-read`,{method:"PATCH"})}async deleteNotification(s){return await S(`${this.baseUrl}/${s}`,{method:"DELETE"})}}const A=new He,re=$({__name:"PerfectScrollbar",props:{tag:{default:"div"},options:{default:()=>({})}},emits:["scroll","ps-scroll-y","ps-scroll-x","ps-scroll-up","ps-scroll-down","ps-scroll-left","ps-scroll-right","ps-y-reach-start","ps-y-reach-end","ps-x-reach-start","ps-x-reach-end"],setup(t,{expose:s,emit:l}){const n=t,g=l,h=B(null),c=B(null);W(()=>n.options,()=>{m(),_()},{deep:!0}),Q(()=>{h.value&&_()}),ce(()=>{m()});function _(){h.value&&(c.value=new de(h.value,n.options),k())}function m(){c.value&&(k(!1),c.value.destroy(),c.value=null)}const p={scroll:i("scroll"),"ps-scroll-y":i("ps-scroll-y"),"ps-scroll-x":i("ps-scroll-x"),"ps-scroll-up":i("ps-scroll-up"),"ps-scroll-down":i("ps-scroll-down"),"ps-scroll-left":i("ps-scroll-left"),"ps-scroll-right":i("ps-scroll-right"),"ps-y-reach-start":i("ps-y-reach-start"),"ps-y-reach-end":i("ps-y-reach-end"),"ps-x-reach-start":i("ps-x-reach-start"),"ps-x-reach-end":i("ps-x-reach-end")};function i(e){return function(a){g(e,a)}}function k(e=!0){var a;(a=c.value)!=null&&a.element&&Object.entries(p).forEach(([u,y])=>{var V,L;e?(V=c.value)==null||V.element.addEventListener(u,y):(L=c.value)==null||L.element.removeEventListener(u,y)})}return s({ps:c}),(e,a)=>(f(),v(me(e.tag),{ref_key:"scrollbar",ref:h,class:"ps"},{default:r(()=>[ue(e.$slots,"default")]),_:3},512))}}),je=ee({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:we,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...oe(),...xe({location:"top end"}),...ke(),...ae(),...be(),...Le({transition:"scale-rotate-transition"})},"VBadge"),E=Z()({name:"VBadge",inheritAttrs:!1,props:je(),setup(t,s){const{backgroundColorClasses:l,backgroundColorStyles:n}=fe(()=>t.color),{roundedClasses:g}=pe(t),{t:h}=he(),{textColorClasses:c,textColorStyles:_}=_e(()=>t.textColor),{themeClasses:m}=ve(),{locationStyles:p}=ge(t,!0,i=>(t.floating?t.dot?2:4:t.dot?8:12)+(["top","bottom"].includes(i)?Number(t.offsetY??0):["left","right"].includes(i)?Number(t.offsetX??0):0));return te(()=>{const i=Number(t.content),k=!t.max||isNaN(i)?t.content:i<=Number(t.max)?i:`${t.max}+`,[e,a]=ye(s.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return o(t.tag,M({class:["v-badge",{"v-badge--bordered":t.bordered,"v-badge--dot":t.dot,"v-badge--floating":t.floating,"v-badge--inline":t.inline},t.class]},a,{style:t.style}),{default:()=>{var u,y;return[o("div",{class:"v-badge__wrapper"},[(y=(u=s.slots).default)==null?void 0:y.call(u),o(Te,{transition:t.transition},{default:()=>{var V,L;return[R(o("span",M({class:["v-badge__badge",m.value,l.value,g.value,c.value],style:[n.value,_.value,t.inline?{}:p.value],"aria-atomic":"true","aria-label":h(t.label,i),"aria-live":"polite",role:"status"},e),[t.dot?void 0:s.slots.badge?(L=(V=s.slots).badge)==null?void 0:L.call(V):t.icon?o(w,{icon:t.icon},null):k]),[[I,t.modelValue]])]}})])]}})}),{}}}),Oe=ee({start:Boolean,end:Boolean,...oe(),...ae()},"VListItemAction"),Ye=Z()({name:"VListItemAction",props:Oe(),setup(t,s){let{slots:l}=s;return te(()=>o(t.tag,{class:["v-list-item-action",{"v-list-item-action--start":t.start,"v-list-item-action--end":t.end},t.class],style:t.style},l)),{}}}),Je={},qe={class:"h-100 d-flex align-center justify-md-space-between justify-center"},Xe={class:"d-flex align-center text-medium-emphasis"};function Ge(t,s){return f(),N("div",qe,[x("span",Xe," Copyright Â© BlackCheetah "+b(new Date().getFullYear())+". ",1)])}const kt=ie(Je,[["render",Ge]]),Ke={class:"d-flex align-start gap-3"},We={key:0},Qe={class:"text-sm font-weight-medium mb-1"},Ze={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},et={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},tt={class:"d-flex flex-column align-end"},at=$({__name:"Notifications",props:{notifications:{},badgeProps:{default:void 0},location:{default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(t,{emit:s}){const l=t,n=s;function g(p){return p?p.split(" ").map(i=>i[0]).join("").toUpperCase():""}const h=K(()=>l.notifications.some(p=>p.isSeen===!1)),c=()=>{const p=l.notifications.map(i=>i.id);h.value?n("read",p):n("unread",p)},_=K(()=>l.notifications.filter(p=>p.isSeen===!1).length),m=(p,i)=>{p?n("unread",[i]):n("read",[i])};return(p,i)=>{const k=X("IconBtn");return f(),v(k,{id:"notification-btn"},{default:r(()=>[o(E,M(l.badgeProps,{"model-value":l.notifications.some(e=>!e.isSeen),color:"error",dot:"","offset-x":"2","offset-y":"3"}),{default:r(()=>[o(w,{icon:"tabler-bell"})]),_:1},16,["model-value"]),o(F,{activator:"parent",width:"380px",location:l.location,offset:"12px","close-on-content-click":!1},{default:r(()=>[o(Re,{class:"d-flex flex-column"},{default:r(()=>[o(Ie,{class:"notification-section"},{append:r(()=>[R(o(Me,{size:"small",color:"primary",class:"me-2"},{default:r(()=>[C(b(d(_))+" New ",1)]),_:1},512),[[I,l.notifications.some(e=>!e.isSeen)]]),R(o(k,{size:"34",onClick:c},{default:r(()=>[o(w,{size:"20",color:"high-emphasis",icon:d(h)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),o(se,{activator:"parent",location:"start"},{default:r(()=>[C(b(d(h)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[I,l.notifications.length]])]),default:r(()=>[o(Ee,{class:"text-h6"},{default:r(()=>i[0]||(i[0]=[C(" Notifications ")])),_:1,__:[0]})]),_:1}),o(q),o(d(re),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:r(()=>[o(D,{class:"notification-list rounded-0 py-0"},{default:r(()=>[(f(!0),N(P,null,z(l.notifications,(e,a)=>(f(),N(P,{key:e.id},[a>0?(f(),v(q,{key:0})):T("",!0),o(U,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:u=>p.$emit("click:notification",e)},{default:r(()=>{var u,y;return[x("div",Ke,[o(Y,{color:e.color&&!e.img?e.color:void 0,variant:e.img?void 0:"tonal"},{default:r(()=>[e.text?(f(),N("span",We,b(g(e.text)),1)):T("",!0),e.img?(f(),v(J,{key:1,src:e.img},null,8,["src"])):T("",!0),e.icon?(f(),v(w,{key:2,icon:e.icon},null,8,["icon"])):T("",!0)]),_:2},1032,["color","variant"]),x("div",null,[x("p",Qe,b((u=e.data)==null?void 0:u.title),1),x("p",Ze,b((y=e.data)==null?void 0:y.message),1),x("p",et,b(e.created_at?new Date(e.created_at).toLocaleString():""),1)]),o(Fe),x("div",tt,[o(w,{size:"10",icon:"tabler-circle-filled",color:e.isSeen?"#a8aaae":"primary",class:Se([`${e.isSeen?"visible-in-hover":""}`,"mb-2"]),onClick:Ce(V=>m(e.isSeen,e.id),["stop"])},null,8,["color","class","onClick"]),o(w,{size:"20",icon:"tabler-x",class:"visible-in-hover",onClick:V=>p.$emit("remove",e.id)},null,8,["onClick"])])])]}),_:2},1032,["onClick"])],64))),128)),R(o(U,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:r(()=>[o(H,null,{default:r(()=>i[1]||(i[1]=[C("No Notification Found!")])),_:1,__:[1]})]),_:1},512),[[I,!l.notifications.length]])]),_:1})]),_:1})]),_:1})]),_:1},8,["location"])]),_:1})}}}),ot=()=>{const t=B([]),s=B(!1),l=B({total:0,unread:0,read:0}),n=e=>{const a=new Date(e),y=Math.floor((new Date().getTime()-a.getTime())/(1e3*60*60));return y<1?"Just now":y<24?`${y}h ago`:y<48?"Yesterday":a.toLocaleDateString()},g=e=>{let a=e.data;if(typeof a=="string")try{a=JSON.parse(a)}catch(y){console.error("Failed to parse notification data:",y),a={}}const u=a||{};return{id:e.id,title:u.title||"Notification",subtitle:u.message||u.subtitle||"",time:n(e.created_at),color:u.color||"primary",isSeen:!!e.read_at,icon:u.icon||"tabler-bell",img:u.img,text:u.text,data:u,created_at:e.created_at,read_at:e.read_at}},h=async(e=!1)=>{try{s.value=!0;const a=e?{unread_only:!0}:{},u=await A.getNotifications(a);return u.success&&u.data?(t.value=u.data.data.map(g),u.data):null}catch(a){throw console.error("Error fetching notifications:",a),a}finally{s.value=!1}},c=async()=>{try{const e=await A.getStats();return e.success&&e.data?(l.value=e.data,e.data):null}catch(e){throw console.error("Error fetching notification stats:",e),e}},_=async e=>{try{e.length===1?await A.markAsRead(e[0]):await A.markMultipleAsRead({notification_ids:e}),t.value.forEach(a=>{e.includes(a.id)&&(a.isSeen=!0)}),await c()}catch(a){throw console.error("Error marking notifications as read:",a),a}},m=async e=>{try{e.length===1?await A.markAsUnread(e[0]):await A.markMultipleAsUnread({notification_ids:e}),t.value.forEach(a=>{e.includes(a.id)&&(a.isSeen=!1)}),await c()}catch(a){throw console.error("Error marking notifications as unread:",a),a}},p=async()=>{try{await A.markAllAsRead(),t.value.forEach(e=>{e.isSeen=!0}),await c()}catch(e){throw console.error("Error marking all notifications as read:",e),e}},i=async e=>{try{await A.deleteNotification(e);const a=t.value.findIndex(u=>u.id===e);a>-1&&t.value.splice(a,1),await c()}catch(a){throw console.error("Error removing notification:",a),a}},k=async e=>{e.isSeen||await _([e.id])};return{notifications:j(t),loading:j(s),stats:j(l),fetchNotifications:h,fetchStats:c,markAsRead:_,markAsUnread:m,markAllAsRead:p,removeNotification:i,handleNotificationClick:k}},xt=$({__name:"NavBarNotifications",setup(t){const{notifications:s,fetchNotifications:l,fetchStats:n,markAsRead:g,markAsUnread:h,removeNotification:c,handleNotificationClick:_}=ot();Q(async()=>{try{await l(),await n()}catch(e){console.error("Failed to load notifications:",e)}});const m=async e=>{try{await c(e)}catch(a){console.error("Failed to remove notification:",a)}},p=async e=>{try{await g(e)}catch(a){console.error("Failed to mark notifications as read:",a)}},i=async e=>{try{await h(e)}catch(a){console.error("Failed to mark notifications as unread:",a)}},k=async e=>{try{await _(e)}catch(a){console.error("Failed to handle notification click:",a)}};return(e,a)=>{const u=at;return f(),v(u,{notifications:d(s),onRemove:m,onRead:p,onUnread:i,"onClick:notification":k},null,8,["notifications"])}}}),st={class:"text-capitalize"},rt=$({__name:"ThemeSwitcher",props:{themes:{}},setup(t){const s=t,l=Ae(),n=B([l.theme]);return W(()=>l.theme,()=>{n.value=[l.theme]},{deep:!0}),(g,h)=>{const c=X("IconBtn");return f(),v(c,{color:"rgba(var(--v-theme-on-surface), var(--v-high-emphasis-opacity))"},{default:r(()=>{var _;return[o(w,{icon:(_=s.themes.find(m=>m.name===d(l).theme))==null?void 0:_.icon},null,8,["icon"]),o(se,{activator:"parent","open-delay":"1000","scroll-strategy":"close"},{default:r(()=>[x("span",st,b(d(l).theme),1)]),_:1}),o(F,{activator:"parent",offset:"12px",width:180},{default:r(()=>[o(D,{selected:d(n),"onUpdate:selected":h[0]||(h[0]=m=>Ne(n)?n.value=m:null),mandatory:""},{default:r(()=>[(f(!0),N(P,null,z(s.themes,({name:m,icon:p})=>(f(),v(U,{key:m,value:m,"prepend-icon":p,color:"primary",onClick:()=>{d(l).theme=m}},{default:r(()=>[o(H,{class:"text-capitalize"},{default:r(()=>[C(b(m),1)]),_:2},1024)]),_:2},1032,["value","prepend-icon","onClick"]))),128))]),_:1},8,["selected"])]),_:1})]}),_:1})}}}),wt=$({__name:"NavbarThemeSwitcher",setup(t){const s=[{name:"light",icon:"tabler-sun-high"},{name:"dark",icon:"tabler-moon-stars"},{name:"system",icon:"tabler-device-desktop-analytics"}];return(l,n)=>{const g=rt;return f(),v(g,{themes:s})}}}),nt=()=>Ve(),lt={class:"d-flex gap-2 align-center"},it={class:"text-h6 font-weight-medium"},ct={class:"px-4 py-2"},Ct=$({__name:"UserProfile",setup(t){const s=Be(),l=nt(),n=O("userData"),g=async()=>{try{await De.logout()}catch(c){console.error("Logout API error:",c)}finally{O("accessToken").value=null,n.value=null,O("userAbilityRules").value=null,l.update([]),await s.push("/login")}},h=[{type:"divider"},{type:"navItem",icon:"tabler-user",title:"Profile",to:{name:"account-settings-tab",params:{tab:"account"}}},{type:"navItem",icon:"tabler-settings",title:"Settings",to:{name:"account-settings-tab",params:{tab:"security"}}},{type:"divider"}];return(c,_)=>d(n)?(f(),v(E,{key:0,dot:"",bordered:"",location:"bottom right","offset-x":"1","offset-y":"2",color:"success"},{default:r(()=>[o(Y,{size:"38",class:"cursor-pointer",color:d(n)&&d(n).avatar?void 0:"primary",variant:d(n)&&d(n).avatar?void 0:"tonal"},{default:r(()=>[d(n)&&d(n).avatar?(f(),v(J,{key:0,src:d(n).avatar},null,8,["src"])):(f(),v(w,{key:1,icon:"tabler-user"})),o(F,{activator:"parent",width:"240",location:"bottom end",offset:"12px"},{default:r(()=>[o(D,null,{default:r(()=>[o(U,null,{default:r(()=>[x("div",lt,[o(Ye,null,{default:r(()=>[o(E,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",color:"success",bordered:""},{default:r(()=>[o(Y,{color:d(n)&&d(n).avatar?void 0:"primary",variant:d(n)&&d(n).avatar?void 0:"tonal"},{default:r(()=>[d(n)&&d(n).avatar?(f(),v(J,{key:0,src:d(n).avatar},null,8,["src"])):(f(),v(w,{key:1,icon:"tabler-user"}))]),_:1},8,["color","variant"])]),_:1})]),_:1}),x("div",null,[x("h6",it,b(d(n).fullName||d(n).name||d(n).username||"User"),1),o(ze,{class:"text-capitalize text-disabled"},{default:r(()=>[C(b(d(n).role),1)]),_:1})])])]),_:1}),o(d(re),{options:{wheelPropagation:!1}},{default:r(()=>[(f(),N(P,null,z(h,m=>(f(),N(P,{key:m.title},[m.type==="navItem"?(f(),v(U,{key:0,to:m.to},Pe({prepend:r(()=>[o(w,{icon:m.icon,size:"22"},null,8,["icon"])]),default:r(()=>[o(H,null,{default:r(()=>[C(b(m.title),1)]),_:2},1024)]),_:2},[m.badgeProps?{name:"append",fn:r(()=>[o(E,M({rounded:"sm",class:"me-3",ref_for:!0},m.badgeProps),null,16)]),key:"0"}:void 0]),1032,["to"])):(f(),v(q,{key:1,class:"my-2"}))],64))),64)),x("div",ct,[o($e,{block:"",size:"small",color:"error","append-icon":"tabler-logout",onClick:g},{default:r(()=>_[0]||(_[0]=[C(" Logout ")])),_:1,__:[0]})])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","variant"])]),_:1})):T("",!0)}}),St=$({__name:"I18n",props:{languages:{},location:{default:"bottom end"}},setup(t){const s=t,{locale:l}=Ue({useScope:"global"});return(n,g)=>{const h=X("IconBtn");return f(),v(h,null,{default:r(()=>[o(w,{icon:"tabler-language"}),o(F,{activator:"parent",location:s.location,offset:"12px",width:"175"},{default:r(()=>[o(D,{selected:[d(l)],color:"primary"},{default:r(()=>[(f(!0),N(P,null,z(s.languages,c=>(f(),v(U,{key:c.i18nLang,value:c.i18nLang,onClick:_=>l.value=c.i18nLang},{default:r(()=>[o(H,null,{default:r(()=>[C(b(c.label),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["selected"])]),_:1},8,["location"])]),_:1})}}});export{re as C,kt as F,E as V,St as _,wt as a,xt as b,Ct as c};
