import{m as q}from"./vue3-apexcharts-BhKWjB5A.js";import{f}from"./formatters-WDr9EcLN.js";import{u as X}from"./useApi-2SWX7gWL.js";import{V as _,a as y}from"./VRow-DHZpC2G_.js";import{V as g,a as A,b as j,c as G}from"./VCard-BRrHEmo0.js";import{V as v}from"./VCardText-CYct27oJ.js";import{V as K}from"./VAvatar-BF957B0g.js";import{d as Q,r as c,w as Y,P as u,c as M,b as a,f as o,o as V,F as Z,i as ee,m as p,g as te,I as ae,e as n,aa as oe,v as m,a3 as $,t as b}from"./main-DWvNZBrn.js";import{V as se}from"./VDivider-zd98jbKy.js";import{q as re}from"./VDataTable-DPzeyqZA.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-CqkleIqs.js";/* empty css              */import"./VImg-g4h63Uey.js";import"./VPagination-DJWbeBTo.js";import"./VSelect-Chb4OroE.js";import"./VTextField-BNKDrFXd.js";/* empty css                   */import"./VCounter-Bl262PHw.js";import"./VField-CIhBnyVR.js";import"./form-tczHMY3v.js";import"./easing-Bybner-F.js";import"./VInput-CUQxW0lR.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-BI-6-ue7.js";import"./ssrBoot-CPO92_z_.js";import"./dialog-transition-QH9NzXuH.js";import"./VMenu-B8htNi0n.js";import"./VOverlay-C5oQOIIo.js";import"./lazy-6xXLFjDI.js";import"./scopeId-HdLjUcVL.js";import"./VCheckboxBtn-BASNK5CT.js";import"./VSelectionControl-BQfaGVgy.js";import"./VChip-HJm3k2du.js";import"./VSlideGroup-BSWxDDfs.js";import"./VTable-C2Gn40nP.js";import"./filter-CyJxu-d7.js";const ne={class:"d-flex align-center gap-x-4 mb-1"},ie={class:"text-h4"},ce={class:"text-body-1 mb-1"},me={class:"d-flex gap-x-2 align-center"},pe={class:"text-h6"},de={class:"text-body-1 font-weight-medium"},fe={class:"text-body-1 text-success font-weight-medium"},ue={class:"text-body-1 text-error font-weight-medium"},he={class:"text-body-1 text-warning font-weight-medium"},ye={class:"text-body-1 text-primary font-weight-medium"},ge="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",h="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",z="rgba(var(--v-border-color), var(--v-border-opacity))",_e=Q({__name:"finance",setup(ve){const{data:B,execute:be,isFetching:xe}=X("/v1/franchisor/dashboard/finance",{immediate:!0}),i={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},x=c([]),F=c([{name:"Sales",data:[]}]),H=c([{name:"Royalty",data:[]}]),d=c([]),S=c([{name:"Sales",data:[]}]),w=c([{name:"Expenses",data:[]}]),k=c([{name:"Profit",data:[]}]),C=c([{name:"Royalty",data:[]}]),R=c([]),T=c([]),l=s=>typeof s=="number"?s:parseFloat(s)||0;Y(B,s=>{const r=s;if(r!=null&&r.success&&(r!=null&&r.data)){const t=r.data;x.value=[{icon:"tabler-currency-riyal",color:"primary",title:"Total Sales",value:f(l(t.stats.total_sales)),change:t.stats.sales_change,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:f(l(t.stats.total_expenses)),change:t.stats.expenses_change,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:f(l(t.stats.net_profit)),change:t.stats.profit_change,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:`${l(t.stats.profit_margin).toFixed(2)}%`,change:t.stats.margin_change,isHover:!1}],t.top_stores_sales&&t.top_stores_sales.length>0&&(F.value=[{name:"Sales",data:t.top_stores_sales.map(e=>l(e.sales))}],d.value=t.top_stores_sales.map(e=>e.name||"Unknown Store")),t.top_stores_royalty&&t.top_stores_royalty.length>0&&(H.value=[{name:"Royalty",data:t.top_stores_royalty.map(e=>l(e.royalty))}],d.value.length===0&&(d.value=t.top_stores_royalty.map(e=>e.name||"Unknown Store"))),t.sales_chart&&t.sales_chart.length>0&&(S.value=[{name:"Sales",data:t.sales_chart.map(e=>l(e.amount))}],R.value=t.sales_chart.map(e=>e.month)),t.expenses_chart&&(w.value=[{name:"Expenses",data:t.expenses_chart.map(e=>l(e.amount))}]),t.profit_chart&&(k.value=[{name:"Profit",data:t.profit_chart.map(e=>l(e.amount))}]),t.royalty_chart&&(C.value=[{name:"Royalty",data:t.royalty_chart.map(e=>l(e.amount))}]),t.monthly_breakdown&&(T.value=t.monthly_breakdown)}});const D=[{icon:"tabler-currency-riyal",color:"primary",title:"Total Sales",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:"0%",change:0,isHover:!1}],N=u(()=>x.value.length>0?x.value:D),P=u(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(0)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.primary],xaxis:{categories:d.value.length>0?d.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:z,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),L=u(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(1)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.warning],xaxis:{categories:d.value.length>0?d.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:z,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),E=u(()=>[{name:"Sales",data:S.value.length>0?S.value[0].data:[]},{name:"Expenses",data:w.value.length>0?w.value[0].data:[]},{name:"Royalties",data:C.value.length>0?C.value[0].data:[]},{name:"Profit",data:k.value.length>0?k.value[0].data:[]}]),O=u(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:4,colors:"#fff",strokeColors:[i.primary,i.error,i.warning,i.success],hover:{size:5},borderRadius:4},stroke:{curve:"smooth",width:3,lineCap:"round"},legend:{show:!0,position:"top",horizontalAlign:"left",markers:{width:10,height:10,offsetX:-3},fontSize:"14px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:ge},itemMargin:{horizontal:12,vertical:8}},grid:{strokeDashArray:8,borderColor:z},colors:[i.primary,i.error,i.warning,i.success],dataLabels:{enabled:!1},xaxis:{categories:R.value.length>0?R.value:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:h,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px",fontWeight:400},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}}},tooltip:{y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),W=u(()=>T.value.map(s=>({month:s.month,sales:f(l(s.sales)),expenses:f(l(s.expenses)),royalties:f(l(s.royalties)),profit:f(l(s.profit))}))),I=[{title:"Month",key:"month"},{title:"Sales",key:"sales",align:"end"},{title:"Expenses",key:"expenses",align:"end"},{title:"Royalties",key:"royalties",align:"end"},{title:"Profit",key:"profit",align:"end"}];return(s,r)=>{const t=q;return V(),M("section",null,[a(_,{class:"mb-6"},{default:o(()=>[(V(!0),M(Z,null,ee(p(N),(e,J)=>(V(),te(y,{key:J,cols:"12",md:"3",sm:"6"},{default:o(()=>[a(g,{class:"finance-card-statistics cursor-pointer",style:ae(e.isHover?`border-block-end-color: rgb(var(--v-theme-${e.color}))`:`border-block-end-color: rgba(var(--v-theme-${e.color}),0.38)`),onMouseenter:U=>e.isHover=!0,onMouseleave:U=>e.isHover=!1},{default:o(()=>[a(v,null,{default:o(()=>[n("div",ne,[a(K,{variant:"tonal",color:e.color,rounded:""},{default:o(()=>[a(oe,{icon:e.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),n("h4",ie,m(e.value),1)]),n("div",ce,m(e.title),1),n("div",me,[n("h6",pe,m(e.change>0?"+":"")+" "+m(e.change)+"% ",1),r[0]||(r[0]=n("div",{class:"text-sm text-disabled"}," than last month ",-1))])]),_:2},1024)]),_:2},1032,["style","onMouseenter","onMouseleave"])]),_:2},1024))),128))]),_:1}),a(_,{class:"mb-6"},{default:o(()=>[a(y,{cols:"12",md:"6"},{default:o(()=>[a(g,null,{default:o(()=>[a(A,{title:"Top 5 Stores by Monthly Sales",subtitle:"Performance comparison"},{append:o(()=>[a($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:o(()=>r[1]||(r[1]=[b(" This Month ")])),_:1,__:[1]})]),_:1}),a(v,null,{default:o(()=>[a(t,{type:"bar",height:"320",options:p(P),series:p(F)},null,8,["options","series"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"6"},{default:o(()=>[a(g,null,{default:o(()=>[a(A,{title:"Top 5 Stores by Monthly Royalty",subtitle:"Royalty contributions"},{append:o(()=>[a($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:o(()=>r[2]||(r[2]=[b(" This Month ")])),_:1,__:[2]})]),_:1}),a(v,null,{default:o(()=>[a(t,{type:"bar",height:"320",options:p(L),series:p(H)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),a(_,{class:"mb-6"},{default:o(()=>[a(y,{cols:"12"},{default:o(()=>[a(g,null,{default:o(()=>[a(v,null,{default:o(()=>[a(t,{type:"line",height:"400",options:p(O),series:p(E)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),a(_,null,{default:o(()=>[a(y,{cols:"12"},{default:o(()=>[a(g,null,{default:o(()=>[a(A,{class:"pb-4"},{default:o(()=>[a(j,null,{default:o(()=>r[3]||(r[3]=[b("Monthly Financial Breakdown")])),_:1,__:[3]}),a(G,null,{default:o(()=>r[4]||(r[4]=[b("Detailed monthly statistics")])),_:1,__:[4]})]),_:1}),a(se),a(re,{headers:I,items:p(W),"hide-default-footer":"",class:"text-no-wrap"},{"item.month":o(({item:e})=>[n("div",de,m(e.month),1)]),"item.sales":o(({item:e})=>[n("div",fe,m(e.sales),1)]),"item.expenses":o(({item:e})=>[n("div",ue,m(e.expenses),1)]),"item.royalties":o(({item:e})=>[n("div",he,m(e.royalties),1)]),"item.profit":o(({item:e})=>[n("div",ye,m(e.profit),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})])}}}),rt=le(_e,[["__scopeId","data-v-41f79e97"]]);export{rt as default};
