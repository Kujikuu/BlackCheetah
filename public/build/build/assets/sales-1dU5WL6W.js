import{m as H}from"./vue3-apexcharts-u3qbBSg5.js";import{f as V}from"./franchisee-dashboard-CYv47Cko.js";import{b as O}from"./apexCharConfig-2liWPu9W.js";import{V as b,a as p}from"./VRow-LlT6Azsr.js";import{V as _,a as P,b as S,c as w}from"./VCard-D9PhtsJ0.js";import{S as W}from"./saudi-riyal-DBg1zXmT.js";import{V as g}from"./VCardText-Cbtr6Qhr.js";import{d as K,aH as Q,r as u,P as R,G as X,c as m,g as c,f as e,e as o,b as t,o as i,aF as F,t as d,v as n,a9 as Y,ax as M,F as C,i as A,x as Z,m as ee}from"./main-B8QbR-yS.js";import{V as te}from"./VAlert-DpqH6FXl.js";import{V as I}from"./VAvatar-87LH5tAk.js";import{V as B,a as J,b as q,d as E}from"./VList-BJCgULVd.js";import{V as U}from"./VChip-CgHwmC-k.js";import"./_commonjsHelpers-CqkleIqs.js";/* empty css              */import"./VImg-Ceu2Mboj.js";import"./VDivider-DOfIMbJY.js";import"./VSlideGroup-BuNiGLv2.js";const ae={key:2},se={class:"d-flex mb-6"},le={class:"d-flex justify-space-between"},oe={class:"d-flex flex-column gap-y-1"},re={class:"text-body-1 text-high-emphasis"},ne={class:"d-flex gap-x-2 align-center"},ie={class:"text-h4"},de={class:"text-sm"},ue={class:"text-sm font-weight-medium"},me={class:"text-body-2 font-weight-medium text-high-emphasis"},ce={class:"text-sm font-weight-medium"},fe={class:"text-body-2 font-weight-medium text-high-emphasis"},pe={key:1,class:"text-center py-8"},ze=K({__name:"sales",setup(_e){const k=Q(),h=u(!1),y=u(null),T=u(!1),$=l=>l>0?`+${l}`:l.toString(),D=u([]),L=u([]),z=u([]),v=u([{name:"Top Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Low Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Average Performance",data:[0,0,0,0,0,0,0,0,0,0,0,0]}]),j=R(()=>O(k.current.value)),G=R(()=>!h.value&&T.value&&v.value.length>0&&v.value.every(l=>l.data&&Array.isArray(l.data)&&l.data.length>0&&l.data.every(a=>typeof a=="number"&&!Number.isNaN(a)))),x=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"SAR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),N=async()=>{h.value=!0,y.value=null;try{const l=await V.getSalesStatistics();if(l.success&&l.data){const s=l.data;D.value=[{title:"Total Sales",value:x(s.totalSales),change:s.salesChange,desc:"This month sales",icon:W,iconColor:"primary"},{title:"Total Profit",value:x(s.totalProfit),change:s.profitChange,desc:"This month profit",icon:"tabler-trending-up",iconColor:"success"}]}const a=await V.getProductSales();a.success&&a.data&&(L.value=a.data.mostSelling,z.value=a.data.lowSelling);const f=await V.getMonthlyPerformance();if(f.success&&f.data){const s=f.data;v.value=[{name:"Top Performing Items",data:s.topPerforming},{name:"Low Performing Items",data:s.lowPerforming},{name:"Average Performance",data:s.averagePerformance}],T.value=!0}}catch(l){y.value="Failed to load dashboard data. Please try again.",console.error("Error loading dashboard data:",l)}finally{h.value=!1}};return X(()=>{N()}),(l,a)=>{const f=H;return i(),m("section",null,[h.value?(i(),c(b,{key:0,class:"mb-6"},{default:e(()=>[t(p,{cols:"12"},{default:e(()=>[t(_,null,{default:e(()=>[t(g,{class:"text-center py-8"},{default:e(()=>[t(F,{indeterminate:"",color:"primary",size:"64"}),a[0]||(a[0]=o("div",{class:"mt-4 text-body-1"}," Loading dashboard data... ",-1))]),_:1,__:[0]})]),_:1})]),_:1})]),_:1})):y.value?(i(),c(b,{key:1,class:"mb-6"},{default:e(()=>[t(p,{cols:"12"},{default:e(()=>[t(te,{type:"error",variant:"tonal",class:"mb-0"},{prepend:e(()=>[t(M,{icon:"tabler-alert-circle"})]),append:e(()=>[t(Y,{color:"error",variant:"text",size:"small",onClick:N},{default:e(()=>a[1]||(a[1]=[d(" Retry ")])),_:1,__:[1]})]),default:e(()=>[d(" "+n(y.value)+" ",1)]),_:1})]),_:1})]),_:1})):(i(),m("div",ae,[o("div",se,[t(b,null,{default:e(()=>[(i(!0),m(C,null,A(D.value,(s,r)=>(i(),c(p,{key:r,cols:"12",md:"6",sm:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(g,null,{default:e(()=>[o("div",le,[o("div",oe,[o("div",re,n(s.title),1),o("div",ne,[o("h4",ie,n(s.value),1),o("div",{class:Z(["text-base",s.change>0?"text-success":"text-error"])}," ("+n($(s.change))+"%) ",3)]),o("div",de,n(s.desc),1)]),t(I,{color:s.iconColor,variant:"tonal",rounded:"",size:"42"},{default:e(()=>[t(M,{icon:s.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(b,{class:"mb-6"},{default:e(()=>[t(p,{cols:"12",md:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(P,null,{default:e(()=>[t(S,null,{default:e(()=>a[2]||(a[2]=[d("Most Selling Items")])),_:1,__:[2]}),t(w,null,{default:e(()=>a[3]||(a[3]=[d("Top performing products")])),_:1,__:[3]})]),_:1}),t(g,null,{default:e(()=>[t(B,{class:"py-0"},{default:e(()=>[(i(!0),m(C,null,A(L.value,(s,r)=>(i(),c(J,{key:r,class:"px-0"},{prepend:e(()=>[t(I,{color:r===0?"success":r===1?"primary":r===2?"warning":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",ue,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(q,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(E,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(U,{size:"small",color:"success",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[4]||(a[4]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",me,n(s.avgPrice?x(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[4]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"6"},{default:e(()=>[t(_,null,{default:e(()=>[t(P,null,{default:e(()=>[t(S,null,{default:e(()=>a[5]||(a[5]=[d("Low Selling Items")])),_:1,__:[5]}),t(w,null,{default:e(()=>a[6]||(a[6]=[d("Underperforming products")])),_:1,__:[6]})]),_:1}),t(g,null,{default:e(()=>[t(B,{class:"py-0"},{default:e(()=>[(i(!0),m(C,null,A(z.value,(s,r)=>(i(),c(J,{key:r,class:"px-0"},{prepend:e(()=>[t(I,{color:r===0?"error":r===1?"warning":r===2?"info":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",ce,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(q,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(E,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(U,{size:"small",color:"error",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[7]||(a[7]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",fe,n(s.avgPrice?x(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[7]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{class:"mb-6"},{default:e(()=>[t(P,null,{default:e(()=>[t(S,null,{default:e(()=>a[8]||(a[8]=[d("Month wise Top and Low Performing Items")])),_:1,__:[8]}),t(w,null,{default:e(()=>a[9]||(a[9]=[d("Monthly performance comparison")])),_:1,__:[9]})]),_:1}),t(g,null,{default:e(()=>[G.value?(i(),c(f,{key:0,type:"area",height:"350",options:{...j.value,xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},tooltip:{theme:ee(k).current.value.dark?"dark":"light",y:{formatter:s=>`${s.toLocaleString()} SAR`}}},series:v.value},null,8,["options","series"])):(i(),m("div",pe,[t(F,{indeterminate:"",color:"primary",size:"32"}),a[10]||(a[10]=o("div",{class:"mt-4 text-body-2 text-medium-emphasis"}," Loading chart data... ",-1))]))]),_:1})]),_:1})]))])}}});export{ze as default};
