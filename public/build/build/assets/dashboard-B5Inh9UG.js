import{m as j}from"./vue3-apexcharts-DgpdtxRn.js";import{V as E}from"./VCardText-A5LE6kSN.js";import{V as X}from"./VAvatar-DYIYaXHU.js";import{d as z,g as D,o as c,f as t,b as e,l as G,e as a,aa as R,v as f,r as d,G as M,P as Y,t as V,c as x,m as s,x as Z,aO as O,ak as ee,a$ as oe,a as le,F as N,i as W,q as ne,a3 as ie,au as B}from"./main-CA5_5-fk.js";import{V as F,a as P,b as J,c as K}from"./VCard-BlRUAaMY.js";import{V as k}from"./VSkeletonLoader-D7bhj1Le.js";import{V as H}from"./VChip-C6OnuAx-.js";import{_ as ce}from"./AddEditFranchiseeDrawer.vue_vue_type_script_setup_true_lang-CDZvdfOg.js";import{_ as de}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-B-kWnjl6.js";import{_ as ue}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-CF6zayaP.js";import{_ as pe}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-D6V5AN1T.js";import{a as S,V as L}from"./VRow-Ct-W2dAj.js";import{V as he}from"./VAlert-JP0hX-Wz.js";import{V as fe}from"./VDivider-Bv9wRwWR.js";import{V as me}from"./VTable-B8DFGBPB.js";import{V as _e}from"./VImg-FsxkdVsl.js";import{V as Q}from"./VTooltip-C1IspaIa.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VSlideGroup-CwmyEgo9.js";import"./validators-BYiRrju8.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-bLssYecD.js";import"./form-bs2DZzDf.js";import"./VSelect-BuMSRPjV.js";import"./VTextField-tUni67cb.js";/* empty css                   */import"./VCounter-DEC0uZ17.js";import"./VField-8nFUoH-R.js";import"./easing-Bybner-F.js";import"./VInput-DhYwEXiV.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-Abz5zQko.js";import"./ssrBoot-B8_MECfQ.js";import"./dialog-transition-Dkald8FM.js";import"./VMenu-CPDfVQZz.js";import"./VOverlay-4pSpEGjx.js";import"./lazy-CN-iBTrZ.js";import"./scopeId-7q-wGPVf.js";import"./VCheckboxBtn-QLEgM55C.js";import"./VSelectionControl-DNfMVlT-.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-CjJGDy36.js";import"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-BN5XKPKe.js";import"./VSpacer-QI7PbBCv.js";/* empty css              */import"./VNavigationDrawer-B8vzdsF3.js";import"./VForm-BqXaPedu.js";import"./formatters-WDr9EcLN.js";import"./VDialog-BNpBCbFf.js";const ve={class:"text-h5"},xe={class:"text-sm"},ge=z({__name:"CardStatisticsVertical",props:{title:{},color:{default:"primary"},icon:{},stats:{},height:{},series:{},chartOptions:{}},setup(T){const m=T;return(h,b)=>{const p=j;return c(),D(F,null,{default:t(()=>[e(E,{class:"d-flex flex-column pb-0"},{default:t(()=>[m.icon?(c(),D(X,{key:0,size:"42",variant:"tonal",color:m.color,rounded:"",class:"mb-2"},{default:t(()=>[e(R,{icon:m.icon,size:"26"},null,8,["icon"])]),_:1},8,["color"])):G("",!0),a("h5",ve,f(m.stats),1),a("div",xe,f(m.title),1)]),_:1}),e(p,{series:m.series,options:m.chartOptions,height:m.height},null,8,["series","options","height"])]),_:1})}}}),be={key:0,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},ye={key:1,class:"text-center text-error text-sm mt-3"},we={key:2,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},Ve={class:"text-h4 text-center"},ke=z({__name:"AdminRequestsChart",setup(T){const m=d(!0),h=d(""),b=d(0),p=d(0),g=d([{name:"Requests",data:[0,0,0,0,0,0,0]}]),C=async()=>{try{m.value=!0;const _=await O("/v1/admin/dashboard/chart-data");if(_.success&&_.data.requests){const o=_.data.requests.slice(-7),i=o.map(u=>u.requests);g.value=[{name:"Requests",data:i}];const v=i[i.length-1]||0,y=i[i.length-2]||0;b.value=o.reduce((u,$)=>u+$.requests,0),y>0?p.value=(v-y)/y*100:p.value=v>0?100:0}}catch(_){console.error("Error fetching requests chart data:",_),h.value="Failed to load chart data"}finally{m.value=!1}};M(()=>{C()});const w={warning:"#FFB400"},U=Y(()=>({chart:{height:90,parentHeightOffset:0,type:"bar",toolbar:{show:!1}},tooltip:{enabled:!1},plotOptions:{bar:{barHeight:"100%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4,colors:{backgroundBarColors:[w.warning,w.warning,w.warning,w.warning,w.warning,w.warning,w.warning],backgroundBarRadius:4}}},colors:[w.warning],grid:{show:!1,padding:{top:-30,left:-16,bottom:0,right:-6}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},yaxis:{labels:{show:!1}},responsive:[{breakpoint:1264,options:{plotOptions:{bar:{borderRadius:6,columnWidth:"30%",colors:{backgroundBarRadius:6}}}}}]}));return(_,o)=>{const i=j;return c(),D(F,null,{default:t(()=>[e(P,{class:"pb-3"},{default:t(()=>[e(J,null,{default:t(()=>o[0]||(o[0]=[V("Technical Requests")])),_:1,__:[0]}),e(K,null,{default:t(()=>o[1]||(o[1]=[V("Last Week")])),_:1,__:[1]})]),_:1}),e(E,null,{default:t(()=>[e(i,{options:s(U),series:s(g),height:62},null,8,["options","series"]),s(m)?(c(),x("div",be,[e(k,{type:"text",width:"60px",height:"32px"}),e(k,{type:"text",width:"40px"})])):s(h)?(c(),x("div",ye,f(s(h)),1)):(c(),x("div",we,[a("h4",Ve,f(s(b).toLocaleString()),1),a("div",{class:Z(["text-sm",s(p)>=0?"text-success":"text-error"])},f(s(p)>=0?"+":"")+f(s(p).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),Ce={class:"d-flex flex-column"},$e={key:0},De={key:1},Ue={key:2},Se={class:"text-h3 mb-2"},Fe={key:1,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Te={key:2,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Le=z({__name:"AdminRevenueGrowth",setup(T){const m=ee(),h=d(!0),b=d(""),p=d(0),g=d(0),C=d([{data:[0,0,0,0,0,0,0]}]),w=async()=>{try{h.value=!0;const _=await O("/v1/admin/dashboard/chart-data");if(_.success&&_.data.revenue){const o=_.data.revenue.slice(-7),i=o.map(u=>u.revenue);C.value=[{data:i}];const v=i[i.length-1]||0,y=i[i.length-2]||0;p.value=o.reduce((u,$)=>u+$.revenue,0),y>0?g.value=(v-y)/y*100:g.value=v>0?100:0}}catch(_){console.error("Error fetching revenue chart data:",_),b.value="Failed to load chart data"}finally{h.value=!1}};M(()=>{w()});const U=Y(()=>{m.current.value.colors,m.current.value.variables;const _="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",o={success:"#56CA00"};return{chart:{height:162,type:"bar",parentHeightOffset:0,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"80%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:6,distributed:!0}},tooltip:{enabled:!1},grid:{show:!1,padding:{top:-20,bottom:-12,left:-10,right:0}},colors:[o.success,o.success,o.success,o.success,o.success,o.success,o.success],dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:_,fontSize:"13px"}}},yaxis:{labels:{show:!1}},states:{hover:{filter:{type:"none"}}},responsive:[{breakpoint:1640,options:{plotOptions:{bar:{columnWidth:"40%",borderRadius:6}}}}]}});return(_,o)=>{const i=j;return c(),D(F,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between"},{default:t(()=>[a("div",Ce,[o[2]||(o[2]=a("div",{class:"mb-auto"},[a("h5",{class:"text-h5 text-no-wrap mb-2"}," Revenue Growth "),a("div",{class:"text-body-1"}," Last 7 Months ")],-1)),s(h)?(c(),x("div",$e,[e(k,{type:"text",width:"100px",height:"32px",class:"mb-2"}),e(k,{type:"chip",width:"60px",height:"24px"})])):s(b)?(c(),x("div",De,[o[1]||(o[1]=a("h5",{class:"text-h3 mb-2 text-error"}," Error ",-1)),e(H,{label:"",color:"error",size:"small"},{default:t(()=>o[0]||(o[0]=[V(" Failed to load ")])),_:1,__:[0]})])):(c(),x("div",Ue,[a("h5",Se," SAR "+f(s(p).toLocaleString()),1),e(H,{label:"",color:s(g)>=0?"success":"error",size:"small"},{default:t(()=>[V(f(s(g)>=0?"+":"")+f(s(g).toFixed(1))+"% ",1)]),_:1},8,["color"])]))]),a("div",null,[!s(h)&&!s(b)?(c(),D(i,{key:0,options:s(U),series:s(C),height:162},null,8,["options","series"])):s(h)?(c(),x("div",Fe,[e(oe,{indeterminate:"",color:"primary",size:"40"})])):(c(),x("div",Te,[e(R,{icon:"tabler-alert-circle",color:"error",size:"40"})]))])]),_:1})]),_:1})}}}),Re={key:0,class:"d-flex align-center justify-space-between gap-x-2"},Oe={key:1,class:"text-center text-error text-sm"},Ee={key:2,class:"d-flex align-center justify-space-between gap-x-2"},ze={class:"text-h4 text-center"},Ae=z({__name:"AdminUsersChart",setup(T){ee().current.value.colors;const h=d(!0),b=d(""),p=d(0),g=d(0),C=d([{name:"Users",data:[0,0,0,0,0,0,0]}]),w=async()=>{try{h.value=!0;const o=await O("/v1/admin/dashboard/chart-data");if(o.success&&o.data.users){const i=o.data.users.slice(-7),v=i.map($=>$.users);C.value=[{name:"Users",data:v}];const y=v[v.length-1]||0,u=v[v.length-2]||0;p.value=i.reduce(($,A)=>$+A.users,0),u>0?g.value=(y-u)/u*100:g.value=y>0?100:0}}catch(o){console.error("Error fetching chart data:",o),b.value="Failed to load chart data"}finally{h.value=!1}};M(()=>{w()});const _={chart:{type:"area",parentHeightOffset:0,toolbar:{show:!1},sparkline:{enabled:!0}},markers:{colors:"transparent",strokeColors:"transparent"},grid:{show:!1},colors:[{primary:"#9155FD"}.primary],fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.5,opacityTo:.07,stops:[0,80,100]}},dataLabels:{enabled:!1},stroke:{width:2,curve:"smooth"},xaxis:{show:!0,lines:{show:!1},labels:{show:!1},stroke:{width:0},axisBorder:{show:!1}},yaxis:{stroke:{width:0},show:!1},tooltip:{enabled:!1}};return(o,i)=>{const v=j;return c(),D(F,null,{default:t(()=>[e(P,{class:"pb-3"},{default:t(()=>[e(J,null,{default:t(()=>i[0]||(i[0]=[V(" Total Users ")])),_:1,__:[0]}),e(K,null,{default:t(()=>i[1]||(i[1]=[V(" Last 7 Days ")])),_:1,__:[1]})]),_:1}),e(v,{options:_,series:s(C),height:68},null,8,["series"]),e(E,{class:"pt-1"},{default:t(()=>[s(h)?(c(),x("div",Re,[e(k,{type:"text",width:"60px",height:"32px"}),e(k,{type:"text",width:"40px"})])):s(b)?(c(),x("div",Oe,f(s(b)),1)):(c(),x("div",Ee,[a("h4",ze,f(s(p).toLocaleString()),1),a("span",{class:Z(["text-sm",s(g)>=0?"text-success":"text-error"])},f(s(g)>=0?"+":"")+f(s(g).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),qe={class:"d-flex justify-space-between"},Be={class:"d-flex flex-column gap-y-1"},je={class:"d-flex align-center gap-x-4"},Me={key:1},Ie={class:"d-flex flex-column"},Ne={class:"text-base font-weight-medium"},We={class:"text-sm text-medium-emphasis"},Ge={class:"d-flex align-center gap-x-2"},He={class:"text-capitalize text-high-emphasis text-body-1"},Pe={class:"text-body-1"},Je={class:"d-flex gap-1"},It=z({__name:"dashboard",setup(T){const m=d([]),h=d([]),b=d(!0),p=d(""),g=async()=>{try{const l=await O("/v1/admin/dashboard/stats");l.success&&(m.value=l.data)}catch(l){console.error("Error fetching stats:",l),p.value="Failed to load dashboard statistics"}},C=async()=>{try{const l=await O("/v1/admin/dashboard/recent-users");l.success&&(h.value=l.data)}catch(l){console.error("Error fetching recent users:",l),p.value="Failed to load recent users"}},w=async()=>{b.value=!0,p.value="";try{await Promise.all([g(),C()])}catch(l){console.error("Error loading dashboard data:",l),p.value="Failed to load dashboard data"}finally{b.value=!1}};M(()=>{w()});const U=l=>{const r=l.toLowerCase();return r==="franchisor"?{color:"success",icon:"tabler-building-store"}:r==="franchisee"?{color:"info",icon:"tabler-user-check"}:r==="sales"?{color:"warning",icon:"tabler-chart-line"}:{color:"primary",icon:"tabler-user"}},_=l=>{const r=l.toLowerCase();return r==="pending"?"warning":r==="active"?"success":r==="inactive"?"secondary":"primary"},o=d(!1),i=d(!1),v=d(!1),y=d(!1),u=d(null),$=l=>{u.value=l,o.value=!0},A=l=>{u.value={...l},l.role==="franchisor"?i.value=!0:l.role==="franchisee"?v.value=!0:l.role==="sales"&&(y.value=!0)},te=()=>{u.value&&A(u.value)},I=l=>{const r=h.value.findIndex(q=>q.id===l.id);r!==-1&&(h.value[r]={...h.value[r],...l}),u.value=null},se=l=>l==="franchisor"?"Franchisor":l==="franchisee"?"Franchisee":l==="sales"?"Sales User":"User",ae=l=>!l||typeof l!="string"?"U":l.split(" ").map(r=>r.charAt(0)).join("").toUpperCase();return(l,r)=>{const q=le("IconBtn");return c(),x("section",null,[e(L,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>r[5]||(r[5]=[a("div",{class:"d-flex align-center justify-space-between"},[a("div",null,[a("h2",{class:"text-h2 mb-1"}," Admin Dashboard "),a("p",{class:"text-body-1 text-medium-emphasis"}," Welcome back! Here's what's happening with your platform today. ")])],-1)])),_:1,__:[5]})]),_:1}),s(p)?(c(),D(L,{key:0,class:"mb-6"},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[e(he,{type:"error",variant:"tonal",closable:"","onClick:close":r[0]||(r[0]=n=>p.value="")},{default:t(()=>[V(f(s(p)),1)]),_:1})]),_:1})]),_:1})):G("",!0),e(L,{class:"mb-6"},{default:t(()=>[s(b)?(c(),x(N,{key:0},W(4,n=>e(S,{key:n,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(F,null,{default:t(()=>[e(E,null,{default:t(()=>[a("div",qe,[a("div",Be,[e(k,{type:"text",width:"80px"}),e(k,{type:"text",width:"60px",height:"32px"}),e(k,{type:"text",width:"120px"})]),e(k,{type:"avatar",size:"42"})])]),_:1})]),_:1})]),_:2},1024)),64)):G("",!0),(c(!0),x(N,null,W(s(m),n=>(c(),D(S,{key:n.title,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(ge,ne({ref_for:!0},n),null,16)]),_:2},1024))),128))]),_:1}),e(L,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12",md:"4"},{default:t(()=>[e(Ae)]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(Le)]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(ke)]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[e(P,{class:"pb-4"},{append:t(()=>[e(ie,{variant:"outlined",color:"primary",size:"small",to:{name:"admin-users-franchisors"}},{default:t(()=>r[8]||(r[8]=[V(" View All ")])),_:1,__:[8]})]),default:t(()=>[e(J,null,{default:t(()=>r[6]||(r[6]=[V("Recent Users")])),_:1,__:[6]}),e(K,null,{default:t(()=>r[7]||(r[7]=[V("Latest registered users")])),_:1,__:[7]})]),_:1}),e(fe),e(me,{class:"text-no-wrap"},{default:t(()=>[r[11]||(r[11]=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," USER "),a("th",{scope:"col"}," ROLE "),a("th",{scope:"col"}," STATUS "),a("th",{scope:"col"}," JOINED DATE "),a("th",{scope:"col"}," ACTIONS ")])],-1)),a("tbody",null,[(c(!0),x(N,null,W(s(h),n=>(c(),x("tr",{key:n.id},[a("td",null,[a("div",je,[e(X,{size:"34",variant:n.avatar?void 0:"tonal",color:n.avatar?void 0:U(n.role).color},{default:t(()=>[n.avatar?(c(),D(_e,{key:0,src:n.avatar},null,8,["src"])):(c(),x("span",Me,f(ae(n.fullName)),1))]),_:2},1032,["variant","color"]),a("div",Ie,[a("h6",Ne,f(n.fullName),1),a("div",We,f(n.email),1)])])]),a("td",null,[a("div",Ge,[e(R,{size:22,icon:U(n.role).icon,color:U(n.role).color},null,8,["icon","color"]),a("div",He,f(n.role),1)])]),a("td",null,[e(H,{color:_(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[V(f(n.status),1)]),_:2},1032,["color"])]),a("td",null,[a("div",Pe,f(n.joinedDate),1)]),a("td",null,[a("div",Je,[e(q,{size:"small",onClick:re=>$(n)},{default:t(()=>[e(R,{icon:"tabler-eye"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>r[9]||(r[9]=[V(" View ")])),_:1,__:[9]})]),_:2},1032,["onClick"]),e(q,{size:"small",onClick:re=>A(n)},{default:t(()=>[e(R,{icon:"tabler-edit"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>r[10]||(r[10]=[V(" Edit ")])),_:1,__:[10]})]),_:2},1032,["onClick"])])])]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),e(pe,{"is-dialog-open":s(o),"onUpdate:isDialogOpen":r[1]||(r[1]=n=>B(o)?o.value=n:null),user:s(u),"user-type":s(u)?se(s(u).role):"User",onEdit:te},null,8,["is-dialog-open","user","user-type"]),e(de,{"is-drawer-open":s(i),"onUpdate:isDrawerOpen":r[2]||(r[2]=n=>B(i)?i.value=n:null),franchisor:s(u),onFranchisorData:I},null,8,["is-drawer-open","franchisor"]),e(ce,{"is-drawer-open":s(v),"onUpdate:isDrawerOpen":r[3]||(r[3]=n=>B(v)?v.value=n:null),franchisee:s(u),onFranchiseeData:I},null,8,["is-drawer-open","franchisee"]),e(ue,{"is-drawer-open":s(y),"onUpdate:isDrawerOpen":r[4]||(r[4]=n=>B(y)?y.value=n:null),"sales-user":s(u),onSalesUserData:I},null,8,["is-drawer-open","sales-user"])])}}});export{It as default};
