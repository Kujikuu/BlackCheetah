import{a as le}from"./formatters--UtN2sCw.js";import{d as xe,r as d,P as ae,G as we,c as R,b as t,f as a,aR as _,m as s,b5 as O,o as b,t as c,e as n,g as U,l as q,a9 as g,ax as V,v as u,F as Ce,i as Se,b3 as he}from"./main-gemCwVks.js";import{V as se,_ as Ae}from"./VDialog-6C-NQXCx.js";import{V as ke,_ as Ee}from"./VDataTableServer-CCw8wB-D.js";import{_ as $e}from"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import{_ as Le}from"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import{_ as Ue}from"./ConfirmDeleteDialog.vue_vue_type_script_setup_true_lang-DLjIa95G.js";import{V as M,a as Pe,b as Te,d as oe}from"./VCard-DJ82mpnW.js";import{V as B}from"./VCardText-BD5AHO-w.js";import{V as j,a as v}from"./VRow-DiX7eN30.js";import{V as Y}from"./VDivider-B4ry9pxl.js";import{V as H}from"./VSpacer-Cpeayo2U.js";import{V as ie}from"./VMenu-CeaiRCNz.js";import{V as ne,a as N,b as z}from"./VList-MyW-iB3v.js";import{V as Q}from"./VChip-DlNApjyg.js";import{V as re}from"./VAvatar-12xz6mHy.js";import{V as De}from"./VImg-DSB6m92Q.js";import{V as Ie}from"./VTable-0Z68chLt.js";import{V as qe}from"./VForm-FUZpY-zG.js";import"./VOverlay-p8m6-W96.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-BgtgI3QF.js";import"./dialog-transition-C9rYmnXC.js";import"./VDataTable-C-SlKz4P.js";import"./VSelect-C9dxRhag.js";import"./VTextField-BhxF6EAD.js";import"./VField-CsHfcJSz.js";import"./form-DjHlhIbZ.js";import"./VInput-B3GinL-f.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";/* empty css              */import"./VSlideGroup-CEWgOBQJ.js";const Be={class:"me-3 d-flex gap-3"},Ne={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},ze={style:{"inline-size":"15.625rem"}},Fe={class:"d-flex align-center gap-x-4"},Re={key:1},Oe={class:"d-flex flex-column"},Me={class:"text-base font-weight-medium"},je={class:"text-body-1"},Qe={class:"text-body-1"},Ge={class:"text-body-1 font-weight-medium"},Je={class:"d-flex align-center gap-4 mb-6"},Ke={class:"text-h4"},Ye={class:"text-h4 mb-1"},He={class:"mb-4"},We={class:"text-body-1"},Xe={class:"mb-4"},Ze={class:"text-body-1"},et={class:"mb-4"},tt={class:"text-body-1"},lt={class:"mb-4"},at={class:"text-body-1"},st={class:"mb-4"},ot={class:"text-body-1"},it={class:"mb-4"},nt={class:"text-body-1"},Ot=xe({__name:"sales-associates",setup(rt){const P=d(""),T=d(),x=d(10),w=d(1),G=d(),J=d(),p=d([]),F=d(!1),h=d(!1);d(!1);const D=d(),ue=i=>{var e,r;G.value=(e=i.sortBy[0])==null?void 0:e.key,J.value=(r=i.sortBy[0])==null?void 0:r.order,K()},de=[{title:"Sales Associate",key:"name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Status",key:"status"},{title:"Assigned Leads",key:"assignedLeads"},{title:"Actions",key:"actions",sortable:!1}],A=d({associates:[],total:0}),C=ae(()=>A.value.associates),W=ae(()=>A.value.total),me=i=>({new:"primary",contacted:"info",qualified:"warning",converted:"success",lost:"error",follow_up:"secondary"})[i]||"default",ce=i=>({low:"success",medium:"warning",high:"error"})[i]||"default",K=async()=>{try{F.value=!0;const i=new URLSearchParams({page:w.value.toString(),per_page:x.value.toString()});P.value&&i.append("search",P.value),T.value&&i.append("status",T.value),G.value&&i.append("sort_by",G.value),J.value&&i.append("order_by",J.value);const e=await O(`/v1/franchisor/sales-associates?${i.toString()}`,{method:"GET"});e.success&&(A.value={associates:e.data||[],total:e.total||0})}catch(i){console.error("Error fetching sales associates:",i)}finally{F.value=!1}},X=[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],ve=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Palestine",value:"Palestine"},{title:"Syria",value:"Syria"},{title:"Yemen",value:"Yemen"},{title:"Iran",value:"Iran"}],Z=i=>{const e=i.toLowerCase();return e==="active"?"success":e==="inactive"?"secondary":"primary"},I=d(!1),k=d(null),pe=i=>{k.value=i,I.value=!0},fe=async()=>{if(k.value!==null)try{if(h.value=!0,(await O(`/v1/franchisor/sales-associates/${k.value}`,{method:"DELETE"})).success){const e=A.value.associates.findIndex(m=>m.id===k.value);e!==-1&&(A.value.associates.splice(e,1),A.value.total-=1);const r=p.value.findIndex(m=>m===k.value);r!==-1&&p.value.splice(r,1),console.log("Sales associate deleted successfully")}}catch(i){console.error("Error deleting sales associate:",i)}finally{h.value=!1,I.value=!1,k.value=null}},S=d(!1),E=d(!1),$=d(!1),o=d(null),ye=async i=>{if(i===null)return;const e=C.value.find(r=>r.id===i);if(e)try{F.value=!0;const r=await O(`/v1/franchisor/sales-associates/${e.id}`);r.success&&(o.value=r.data,S.value=!0)}catch(r){console.error("Error fetching associate details:",r),o.value=e,S.value=!0}finally{F.value=!1}},ee=i=>{if(i===null)return;const e=C.value.find(r=>r.id===i);e&&(o.value={...e},E.value=!0)},be=()=>{o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",assignedLeads:0,avatar:"",password:""},$.value=!0},te=async()=>{if(o.value){if(D.value){const{valid:i}=await D.value.validate();if(!i)return}try{h.value=!0;const i=o.value.id!==null,e=i?"PUT":"POST",r=i?`/v1/franchisor/sales-associates/${o.value.id}`:"/v1/franchisor/sales-associates",m={name:o.value.name,email:o.value.email,phone:o.value.phone,status:o.value.status,country:o.value.country||"",state:o.value.state||"",city:o.value.city||""};!i&&o.value.password&&(m.password=o.value.password),(await O(r,{method:e,body:m})).success&&(D.value&&D.value.reset(),$.value=!1,E.value=!1,o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",password:"",assignedLeads:0,avatar:"",avatarText:""},await K(),console.log(i?"Associate updated successfully":"Associate created successfully"))}catch(i){console.error("Error saving associate:",i)}finally{h.value=!1}}},_e=()=>{const e=["Name,Email,Phone,Status,Country,State,City,Assigned Leads",...(p.value.length>0?C.value.filter(f=>p.value.includes(f.id)):C.value).map(f=>`"${f.name}","${f.email}","${f.phone}","${f.status}","${f.country||""}","${f.state||""}","${f.city||""}","${f.assignedLeads}"`)].join(`
`),r=new Blob([e],{type:"text/csv"}),m=window.URL.createObjectURL(r),L=document.createElement("a");L.href=m,L.download=`sales_associates_${p.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,L.click(),window.URL.revokeObjectURL(m)},ge=()=>{const i=p.value.length>0?C.value.filter(e=>p.value.includes(e.id)):C.value;console.log("Exporting to PDF:",i)},Ve=async()=>{await fe()};return we(()=>{K()}),(i,e)=>{const r=Le,m=$e,L=Ee,f=Ae;return b(),R("section",null,[t(M,{class:"mb-6"},{default:a(()=>[t(Pe,{class:"pb-4"},{default:a(()=>[t(Te,null,{default:a(()=>e[23]||(e[23]=[c("Filters")])),_:1,__:[23]})]),_:1}),t(B,null,{default:a(()=>[t(j,null,{default:a(()=>[t(v,{cols:"12",sm:"6"},{default:a(()=>[t(r,{modelValue:s(T),"onUpdate:modelValue":e[0]||(e[0]=l=>_(T)?T.value=l:null),placeholder:"Select Status",items:X,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Y),t(B,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[n("div",Be,[t(r,{"model-value":s(x),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=l=>x.value=parseInt(l,10))},null,8,["model-value"]),s(p).length>0?(b(),U(g,{key:0,variant:"tonal",color:"error",onClick:i.bulkDelete},{default:a(()=>[t(V,{icon:"tabler-trash",class:"me-2"}),c(" Delete Selected ("+u(s(p).length)+") ",1)]),_:1},8,["onClick"])):q("",!0)]),t(H),n("div",Ne,[n("div",ze,[t(m,{modelValue:s(P),"onUpdate:modelValue":e[2]||(e[2]=l=>_(P)?P.value=l:null),placeholder:"Search Sales Associate"},null,8,["modelValue"])]),t(g,{variant:"tonal",color:"secondary"},{default:a(()=>[t(V,{icon:"tabler-upload",class:"me-2"}),c(" Export "+u(s(p).length>0?`(${s(p).length})`:"All")+" ",1),t(ie,{activator:"parent"},{default:a(()=>[t(ne,null,{default:a(()=>[t(N,{onClick:_e},{prepend:a(()=>[t(V,{icon:"tabler-file-type-csv"})]),default:a(()=>[t(z,null,{default:a(()=>e[24]||(e[24]=[c("Export to CSV")])),_:1,__:[24]})]),_:1}),t(N,{onClick:ge},{prepend:a(()=>[t(V,{icon:"tabler-file-type-pdf"})]),default:a(()=>[t(z,null,{default:a(()=>e[25]||(e[25]=[c("Export to PDF")])),_:1,__:[25]})]),_:1})]),_:1})]),_:1})]),_:1}),t(g,{"prepend-icon":"tabler-plus",onClick:be},{default:a(()=>e[26]||(e[26]=[c(" Add Sales Associate ")])),_:1,__:[26]})])]),_:1}),t(Y),t(ke,{"items-per-page":s(x),"onUpdate:itemsPerPage":e[4]||(e[4]=l=>_(x)?x.value=l:null),"model-value":s(p),"onUpdate:modelValue":e[5]||(e[5]=l=>_(p)?p.value=l:null),page:s(w),"onUpdate:page":e[6]||(e[6]=l=>_(w)?w.value=l:null),items:s(C),"item-value":"id","items-length":s(W),headers:de,class:"text-no-wrap","show-select":"","onUpdate:options":ue},{"item.name":a(({item:l})=>[n("div",Fe,[t(re,{size:"34",variant:l.avatar?void 0:"tonal",color:l.avatar?void 0:"primary"},{default:a(()=>[l.avatar?(b(),U(De,{key:0,src:l.avatar},null,8,["src"])):(b(),R("span",Re,u(("avatarText"in i?i.avatarText:s(le))(l.name)),1))]),_:2},1032,["variant","color"]),n("div",Oe,[n("h6",Me,u(l.name),1)])])]),"item.email":a(({item:l})=>[n("div",je,u(l.email),1)]),"item.phone":a(({item:l})=>[n("div",Qe,u(l.phone),1)]),"item.status":a(({item:l})=>[t(Q,{color:Z(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[c(u(l.status),1)]),_:2},1032,["color"])]),"item.assignedLeads":a(({item:l})=>[n("div",Ge,u(l.assignedLeads),1)]),"item.actions":a(({item:l})=>[t(g,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[t(V,{icon:"tabler-dots-vertical"}),t(ie,{activator:"parent"},{default:a(()=>[t(ne,null,{default:a(()=>[t(N,{onClick:y=>ye(l.id)},{prepend:a(()=>[t(V,{icon:"tabler-eye"})]),default:a(()=>[t(z,null,{default:a(()=>e[27]||(e[27]=[c("View")])),_:1,__:[27]})]),_:2},1032,["onClick"]),t(N,{onClick:y=>ee(l.id)},{prepend:a(()=>[t(V,{icon:"tabler-pencil"})]),default:a(()=>[t(z,null,{default:a(()=>e[28]||(e[28]=[c("Edit")])),_:1,__:[28]})]),_:2},1032,["onClick"]),t(N,{onClick:y=>pe(l.id)},{prepend:a(()=>[t(V,{icon:"tabler-trash"})]),default:a(()=>[t(z,null,{default:a(()=>e[29]||(e[29]=[c("Delete")])),_:1,__:[29]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[t(L,{page:s(w),"onUpdate:page":e[3]||(e[3]=l=>_(w)?w.value=l:null),"items-per-page":s(x),"total-items":s(W)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),t(se,{modelValue:s(S),"onUpdate:modelValue":e[10]||(e[10]=l=>_(S)?S.value=l:null),"max-width":"600"},{default:a(()=>[t(f,{onClick:e[7]||(e[7]=l=>S.value=!1)}),s(o)?(b(),U(M,{key:0,title:"Sales Associate Details"},{default:a(()=>[t(B,null,{default:a(()=>[t(j,null,{default:a(()=>[t(v,{cols:"12"},{default:a(()=>{var l;return[n("div",Je,[t(re,{size:"80",variant:"tonal",color:"primary"},{default:a(()=>[n("span",Ke,u(("avatarText"in i?i.avatarText:s(le))(s(o).name)),1)]),_:1}),n("div",null,[n("h4",Ye,u(s(o).name),1),t(Q,{color:Z(((l=s(o))==null?void 0:l.status)||""),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[c(u(s(o).status),1)]),_:1},8,["color"])])])]}),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",He,[e[30]||(e[30]=n("div",{class:"text-sm text-disabled mb-1"}," Email ",-1)),n("div",We,u(s(o).email),1)])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",Xe,[e[31]||(e[31]=n("div",{class:"text-sm text-disabled mb-1"}," Phone ",-1)),n("div",Ze,u(s(o).phone),1)])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",et,[e[32]||(e[32]=n("div",{class:"text-sm text-disabled mb-1"}," Country ",-1)),n("div",tt,u(s(o).country||"Not specified"),1)])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",lt,[e[33]||(e[33]=n("div",{class:"text-sm text-disabled mb-1"}," State ",-1)),n("div",at,u(s(o).state||"Not specified"),1)])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",st,[e[34]||(e[34]=n("div",{class:"text-sm text-disabled mb-1"}," City ",-1)),n("div",ot,u(s(o).city||"Not specified"),1)])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[n("div",it,[e[35]||(e[35]=n("div",{class:"text-sm text-disabled mb-1"}," Assigned Leads ",-1)),n("div",nt,u(s(o).assignedLeads),1)])]),_:1})]),_:1}),s(o).leads&&s(o).leads.length>0?(b(),U(j,{key:0},{default:a(()=>[t(v,{cols:"12"},{default:a(()=>[t(Y,{class:"my-4"}),e[37]||(e[37]=n("div",{class:"text-h6 mb-4"}," Assigned Leads ",-1)),t(M,{variant:"outlined"},{default:a(()=>[t(B,{class:"pa-0"},{default:a(()=>[t(Ie,null,{default:a(()=>{var l;return[e[36]||(e[36]=n("thead",null,[n("tr",null,[n("th",null,"Name"),n("th",null,"Email"),n("th",null,"Status"),n("th",null,"Priority")])],-1)),n("tbody",null,[(b(!0),R(Ce,null,Se(((l=s(o))==null?void 0:l.leads)||[],y=>(b(),R("tr",{key:y.id},[n("td",null,u(y.first_name)+" "+u(y.last_name),1),n("td",null,u(y.email),1),n("td",null,[t(Q,{color:me(y.status),size:"small",class:"text-capitalize"},{default:a(()=>[c(u(y.status.replace("_"," ")),1)]),_:2},1032,["color"])]),n("td",null,[t(Q,{color:ce(y.priority),size:"small",class:"text-capitalize"},{default:a(()=>[c(u(y.priority),1)]),_:2},1032,["color"])])]))),128))])]}),_:1,__:[36]})]),_:1})]),_:1})]),_:1,__:[37]})]),_:1})):q("",!0)]),_:1}),t(oe,null,{default:a(()=>[t(H),t(g,{color:"secondary",variant:"tonal",onClick:e[8]||(e[8]=l=>S.value=!1)},{default:a(()=>e[38]||(e[38]=[c(" Close ")])),_:1,__:[38]}),t(g,{color:"primary",onClick:e[9]||(e[9]=l=>ee(s(o).id))},{default:a(()=>e[39]||(e[39]=[c(" Edit ")])),_:1,__:[39]})]),_:1})]),_:1})):q("",!0)]),_:1},8,["modelValue"]),t(se,{"model-value":s($)||s(E),"max-width":"600",persistent:"","onUpdate:modelValue":e[21]||(e[21]=l=>{l||($.value=!1,E.value=!1)})},{default:a(()=>[t(f,{onClick:e[11]||(e[11]=l=>{$.value=!1,E.value=!1})}),s(o)?(b(),U(M,{key:0,title:s(o).id===null?"Add New":"Edit Sales Associate"},{default:a(()=>[t(B,null,{default:a(()=>[t(qe,{ref_key:"associateForm",ref:D,onSubmit:he(te,["prevent"])},{default:a(()=>[t(j,null,{default:a(()=>[t(v,{cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).name,"onUpdate:modelValue":e[12]||(e[12]=l=>s(o).name=l),label:"Full Name",placeholder:"Enter full name",rules:[l=>!!l||"Full name is required",l=>l.length<=255||"Name must not exceed 255 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).email,"onUpdate:modelValue":e[13]||(e[13]=l=>s(o).email=l),label:"Email Address",type:"email",placeholder:"Enter email address",rules:[l=>!!l||"Email is required",l=>/.+@.+\..+/.test(l)||"Email must be valid"],required:""},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).phone,"onUpdate:modelValue":e[14]||(e[14]=l=>s(o).phone=l),label:"Phone Number",placeholder:"+966 50 123 4567",rules:[l=>!!l||"Phone number is required",l=>l.length<=20||"Phone number must not exceed 20 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(r,{modelValue:s(o).status,"onUpdate:modelValue":e[15]||(e[15]=l=>s(o).status=l),label:"Status",items:X,placeholder:"Select status",rules:[l=>!!l||"Status is required"],required:""},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(r,{modelValue:s(o).country,"onUpdate:modelValue":e[16]||(e[16]=l=>s(o).country=l),label:"Country",items:ve,placeholder:"Select country"},null,8,["modelValue"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).state,"onUpdate:modelValue":e[17]||(e[17]=l=>s(o).state=l),label:"State/Province",placeholder:"Enter state or province",rules:[l=>!l||l.length<=100||"State must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).city,"onUpdate:modelValue":e[18]||(e[18]=l=>s(o).city=l),label:"City",placeholder:"Enter city",rules:[l=>!l||l.length<=100||"City must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),s(o).id===null?(b(),U(v,{key:0,cols:"12",md:"6"},{default:a(()=>[t(m,{modelValue:s(o).password,"onUpdate:modelValue":e[19]||(e[19]=l=>s(o).password=l),label:"Password",type:"password",placeholder:"Enter password (minimum 8 characters)",rules:[l=>!!l||"Password is required",l=>l.length>=8||"Password must be at least 8 characters"],required:""},null,8,["modelValue","rules"])]),_:1})):q("",!0)]),_:1})]),_:1},512)]),_:1}),t(oe,null,{default:a(()=>[t(H),t(g,{color:"secondary",variant:"tonal",disabled:s(h),onClick:e[20]||(e[20]=l=>{$.value=!1,E.value=!1})},{default:a(()=>e[40]||(e[40]=[c(" Cancel ")])),_:1,__:[40]},8,["disabled"]),t(g,{color:"primary",loading:s(h),onClick:te},{default:a(()=>[c(u(s(o).id===null?"Create Associate":"Save Changes"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])):q("",!0)]),_:1},8,["model-value"]),t(Ue,{"is-dialog-visible":s(I),"onUpdate:isDialogVisible":e[22]||(e[22]=l=>_(I)?I.value=l:null),title:"Confirm Delete Sales Associate",message:"Are you sure you want to delete this sales associate? This action cannot be undone.",onConfirm:Ve},null,8,["is-dialog-visible"])])}}});export{Ot as default};
