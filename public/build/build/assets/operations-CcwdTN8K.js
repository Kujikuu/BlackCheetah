import{V as N,_ as he}from"./VDialog-CEq2jzbd.js";import{V as Ve,_ as ye}from"./VDataTableServer-2Q8oqYfo.js";import{_ as Ce}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{_ as xe}from"./AppSelect.vue_vue_type_script_setup_true_lang-DOrgpFkU.js";import{d as Te,r as g,w as De,P as W,G as we,c as I,b as t,f as l,aR as b,m as a,o as y,F as G,i as H,t as p,ax as T,v,e as n,g as z,x as Se,l as Q,a9 as V,b3 as Le}from"./main-B8QbR-yS.js";import{u as Ae}from"./useApi-CCD9E6_s.js";import{a as $e,V as Ue}from"./VTabs-DXRKnteB.js";import{a as Pe,V as Ie}from"./VWindowItem-CHtlO5gs.js";import{V as F,a as k}from"./VRow-LlT6Azsr.js";import{V as $,a as ze,b as Fe,d as q}from"./VCard-D9PhtsJ0.js";import{V as L}from"./VCardText-Cbtr6Qhr.js";import{V as oe}from"./VAvatar-87LH5tAk.js";import{V as ie}from"./VDivider-DOfIMbJY.js";import{V as B}from"./VSpacer-BSXBFFTK.js";import{V as Be}from"./VMenu-TQcmpCCv.js";import{V as Ee,a as J,b as K}from"./VList-BJCgULVd.js";import{V as E}from"./VChip-CgHwmC-k.js";import{V as Oe}from"./VForm-C9sxpau4.js";import"./VOverlay-B3La6Ajr.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-DyQ6a1uN.js";import"./VImg-Ceu2Mboj.js";import"./dialog-transition-Dy2Gj1XO.js";import"./VDataTable-FYAU2aQJ.js";import"./VSelect-GSzN3Qps.js";import"./VTextField-C7_y5spr.js";import"./VField-Bw51LFql.js";import"./form-Dt-W1fp6.js";import"./VInput-DB3XZUVb.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VTable-CgkStP3y.js";import"./VSlideGroup-BuNiGLv2.js";/* empty css              */const Re={class:"d-flex mb-6"},Me={class:"d-flex justify-space-between"},je={class:"d-flex flex-column gap-y-1"},Ne={class:"text-body-1 text-high-emphasis"},We={class:"d-flex gap-x-2 align-center"},Ge={class:"text-h4"},He={class:"text-sm"},Qe={class:"me-3 d-flex gap-3"},qe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Je={style:{"inline-size":"15.625rem"}},Ke={class:"d-flex flex-column"},Xe={class:"text-base font-weight-medium"},Ye={class:"d-flex align-center gap-x-4"},Ze={class:"text-body-1"},et={class:"text-body-1"},tt={class:"mb-4"},lt={class:"text-body-1 font-weight-medium"},st={class:"mb-4"},at={class:"text-body-1"},ot={class:"mb-4"},it={class:"text-body-1"},nt={class:"mb-4"},rt={class:"mb-4"},Gt=Te({__name:"operations",setup(ut){const{data:ne,execute:re,isFetching:dt}=Ae("/v1/franchisor/dashboard/operations"),c=g("franchisee"),O=g(""),R=g(),M=g(),D=g(10),w=g(1),ue=g(),de=g(),_=g([]),ce=r=>{var e,d;ue.value=(e=r.sortBy[0])==null?void 0:e.key,de.value=(d=r.sortBy[0])==null?void 0:d.order},fe=[{title:"Task",key:"task"},{title:"Assigned To",key:"assignedTo"},{title:"Priority",key:"priority"},{title:"Status",key:"status"},{title:"Due Date",key:"dueDate"},{title:"Actions",key:"actions",sortable:!1}],f=g({franchisee:{tasks:[],total:0},sales:{tasks:[],total:0},staff:{tasks:[],total:0}}),U=g({franchisee:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],sales:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],staff:[{title:"Total",value:"0",change:0,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:"0",change:0,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:"0",change:0,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:"0",change:0,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}]});De(ne,r=>{const e=r;if(e!=null&&e.success&&(e!=null&&e.data)){const d=e.data,m=i=>Array.isArray(i)?i.map(s=>({id:s.id,task:s.task,assignedTo:s.assigned_to,priority:s.priority,status:s.status,dueDate:new Date(s.due_date).toLocaleDateString()})):[],h=d.tasks??{franchisee:[],sales:[],staff:[]},o=d.stats??{franchisee:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0},sales:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0},staff:{total:0,total_change:0,completed:0,completed_change:0,in_progress:0,in_progress_change:0,due:0,due_change:0}};f.value={franchisee:{tasks:m(h.franchisee),total:o.franchisee.total},sales:{tasks:m(h.sales),total:o.sales.total},staff:{tasks:m(h.staff),total:o.staff.total}},U.value={franchisee:[{title:"Total",value:o.franchisee.total.toLocaleString(),change:o.franchisee.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.franchisee.completed.toLocaleString(),change:o.franchisee.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.franchisee.in_progress.toLocaleString(),change:o.franchisee.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.franchisee.due.toLocaleString(),change:o.franchisee.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],sales:[{title:"Total",value:o.sales.total.toLocaleString(),change:o.sales.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.sales.completed.toLocaleString(),change:o.sales.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.sales.in_progress.toLocaleString(),change:o.sales.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.sales.due.toLocaleString(),change:o.sales.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}],staff:[{title:"Total",value:o.staff.total.toLocaleString(),change:o.staff.total_change,desc:"All tasks",icon:"tabler-list-check",iconColor:"primary"},{title:"Completed",value:o.staff.completed.toLocaleString(),change:o.staff.completed_change,desc:"Finished tasks",icon:"tabler-circle-check",iconColor:"success"},{title:"In Progress",value:o.staff.in_progress.toLocaleString(),change:o.staff.in_progress_change,desc:"Active tasks",icon:"tabler-progress",iconColor:"info"},{title:"Due",value:o.staff.due.toLocaleString(),change:o.staff.due_change,desc:"Overdue tasks",icon:"tabler-alert-circle",iconColor:"error"}]}}},{immediate:!0});const j=W(()=>c.value==="franchisee"?f.value.franchisee.tasks:c.value==="sales"?f.value.sales.tasks:f.value.staff.tasks),X=W(()=>c.value==="franchisee"?f.value.franchisee.total:c.value==="sales"?f.value.sales.total:f.value.staff.total),me=W(()=>c.value==="franchisee"?U.value.franchisee:c.value==="sales"?U.value.sales:U.value.staff);we(()=>{re()});const Y=[{title:"High",value:"high"},{title:"Medium",value:"medium"},{title:"Low",value:"low"}],Z=[{title:"Completed",value:"completed"},{title:"In Progress",value:"in_progress"},{title:"Due",value:"due"}],ee=r=>{const e=r.toLowerCase();return e==="completed"?"success":e==="in_progress"?"info":e==="due"?"error":"primary"},te=r=>{const e=r.toLowerCase();return e==="high"?"error":e==="medium"?"warning":e==="low"?"success":"primary"},C=g(!1),A=g(null),pe=r=>{A.value=r,C.value=!0},ve=async()=>{if(A.value===null)return;const r=c.value==="franchisee"?f.value.franchisee.tasks:c.value==="sales"?f.value.sales.tasks:f.value.staff.tasks,e=r.findIndex(m=>m.id===A.value);e!==-1&&r.splice(e,1);const d=_.value.findIndex(m=>m===A.value);d!==-1&&_.value.splice(d,1),C.value=!1,A.value=null},S=g(!1),x=g(!1),u=g(null),ge=r=>{const d=(c.value==="franchisee"?f.value.franchisee.tasks:c.value==="sales"?f.value.sales.tasks:f.value.staff.tasks).find(m=>m.id===r);d&&(u.value=d,S.value=!0)},le=r=>{const d=(c.value==="franchisee"?f.value.franchisee.tasks:c.value==="sales"?f.value.sales.tasks:f.value.staff.tasks).find(m=>m.id===r);d&&(u.value={...d},x.value=!0)},se=async()=>{if(!u.value)return;const r=c.value==="franchisee"?f.value.franchisee.tasks:c.value==="sales"?f.value.sales.tasks:f.value.staff.tasks,e=r.findIndex(d=>d.id===u.value.id);e!==-1&&(r[e]={...u.value}),x.value=!1,u.value=null},ke=()=>{const e=["Task,Assigned To,Priority,Status,Due Date",...(_.value.length>0?j.value.filter(o=>_.value.includes(o.id)):j.value).map(o=>`"${o.task}","${o.assignedTo}","${o.priority}","${o.status}","${o.dueDate}"`)].join(`
`),d=new Blob([e],{type:"text/csv"}),m=window.URL.createObjectURL(d),h=document.createElement("a");h.href=m,h.download=`${c.value}_tasks_${_.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,h.click(),window.URL.revokeObjectURL(m)},_e=r=>r>0?`+${r}`:`${r}`,be=r=>r.split(" ").map(e=>e[0]).join("").toUpperCase(),ae=[{title:"Franchisee",value:"franchisee",icon:"tabler-building-store"},{title:"Sales Associate",value:"sales",icon:"tabler-users"},{title:"Staff",value:"staff",icon:"tabler-user"}];return(r,e)=>{const d=xe,m=Ce,h=ye,o=he;return y(),I("section",null,[t($e,{modelValue:a(c),"onUpdate:modelValue":e[0]||(e[0]=i=>b(c)?c.value=i:null),class:"mb-6"},{default:l(()=>[(y(),I(G,null,H(ae,i=>t(Ue,{key:i.value,value:i.value},{default:l(()=>[t(T,{icon:i.icon,start:""},null,8,["icon"]),p(" "+v(i.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(Pe,{modelValue:a(c),"onUpdate:modelValue":e[9]||(e[9]=i=>b(c)?c.value=i:null),class:"disable-tab-transition"},{default:l(()=>[(y(),I(G,null,H(ae,i=>t(Ie,{key:i.value,value:i.value},{default:l(()=>[n("div",Re,[t(F,null,{default:l(()=>[(y(!0),I(G,null,H(a(me),(s,P)=>(y(),z(k,{key:P,cols:"12",md:"3",sm:"6"},{default:l(()=>[t($,null,{default:l(()=>[t(L,null,{default:l(()=>[n("div",Me,[n("div",je,[n("div",Ne,v(s.title),1),n("div",We,[n("h4",Ge,v(s.value),1),n("div",{class:Se(["text-base",s.change>0?"text-success":"text-error"])}," ("+v(_e(s.change))+"%) ",3)]),n("div",He,v(s.desc),1)]),t(oe,{color:s.iconColor,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[t(T,{icon:s.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t($,{class:"mb-6"},{default:l(()=>[t(ze,{class:"pb-4"},{default:l(()=>[t(Fe,null,{default:l(()=>e[25]||(e[25]=[p("Filters")])),_:1,__:[25]})]),_:1}),t(L,null,{default:l(()=>[t(F,null,{default:l(()=>[t(k,{cols:"12",sm:"6"},{default:l(()=>[t(d,{modelValue:a(M),"onUpdate:modelValue":e[1]||(e[1]=s=>b(M)?M.value=s:null),placeholder:"Select Priority",items:Y,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:l(()=>[t(d,{modelValue:a(R),"onUpdate:modelValue":e[2]||(e[2]=s=>b(R)?R.value=s:null),placeholder:"Select Status",items:Z,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ie),t(L,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[n("div",Qe,[t(d,{"model-value":a(D),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[3]||(e[3]=s=>D.value=parseInt(s,10))},null,8,["model-value"]),a(_).length>0?(y(),z(V,{key:0,variant:"tonal",color:"error",onClick:r.bulkDelete},{default:l(()=>[t(T,{icon:"tabler-trash",class:"me-2"}),p(" Delete Selected ("+v(a(_).length)+") ",1)]),_:1},8,["onClick"])):Q("",!0)]),t(B),n("div",qe,[n("div",Je,[t(m,{modelValue:a(O),"onUpdate:modelValue":e[4]||(e[4]=s=>b(O)?O.value=s:null),placeholder:"Search Task"},null,8,["modelValue"])]),t(V,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:ke},{default:l(()=>[p(" Export "+v(a(_).length>0?`(${a(_).length})`:"All"),1)]),_:1})])]),_:1}),t(ie),t(Ve,{"items-per-page":a(D),"onUpdate:itemsPerPage":e[6]||(e[6]=s=>b(D)?D.value=s:null),"model-value":a(_),"onUpdate:modelValue":e[7]||(e[7]=s=>b(_)?_.value=s:null),page:a(w),"onUpdate:page":e[8]||(e[8]=s=>b(w)?w.value=s:null),items:a(j),"item-value":"id","items-length":a(X),headers:fe,class:"text-no-wrap","show-select":"","onUpdate:options":ce},{"item.task":l(({item:s})=>[n("div",Ke,[n("h6",Xe,v(s.task),1)])]),"item.assignedTo":l(({item:s})=>[n("div",Ye,[t(oe,{size:"34",variant:"tonal",color:"primary"},{default:l(()=>[n("span",null,v(be(s.assignedTo)),1)]),_:2},1024),n("div",Ze,v(s.assignedTo),1)])]),"item.priority":l(({item:s})=>[t(E,{color:te(s.priority),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[p(v(s.priority),1)]),_:2},1032,["color"])]),"item.status":l(({item:s})=>[t(E,{color:ee(s.status),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[p(v(s.status.replace("_"," ")),1)]),_:2},1032,["color"])]),"item.dueDate":l(({item:s})=>[n("div",et,v(s.dueDate),1)]),"item.actions":l(({item:s})=>[t(V,{icon:"",variant:"text",color:"medium-emphasis"},{default:l(()=>[t(T,{icon:"tabler-dots-vertical"}),t(Be,{activator:"parent"},{default:l(()=>[t(Ee,null,{default:l(()=>[t(J,{onClick:P=>ge(s.id)},{prepend:l(()=>[t(T,{icon:"tabler-eye"})]),default:l(()=>[t(K,null,{default:l(()=>e[26]||(e[26]=[p("View")])),_:1,__:[26]})]),_:2},1032,["onClick"]),t(J,{onClick:P=>le(s.id)},{prepend:l(()=>[t(T,{icon:"tabler-pencil"})]),default:l(()=>[t(K,null,{default:l(()=>e[27]||(e[27]=[p("Edit")])),_:1,__:[27]})]),_:2},1032,["onClick"]),t(J,{onClick:P=>pe(s.id)},{prepend:l(()=>[t(T,{icon:"tabler-trash"})]),default:l(()=>[t(K,null,{default:l(()=>e[28]||(e[28]=[p("Delete")])),_:1,__:[28]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:l(()=>[t(h,{page:a(w),"onUpdate:page":e[5]||(e[5]=s=>b(w)?w.value=s:null),"items-per-page":a(D),"total-items":a(X)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(N,{modelValue:a(S),"onUpdate:modelValue":e[13]||(e[13]=i=>b(S)?S.value=i:null),"max-width":"600"},{default:l(()=>[t(o,{onClick:e[10]||(e[10]=i=>S.value=!1)}),a(u)?(y(),z($,{key:0,title:"Task Details"},{default:l(()=>[t(L,null,{default:l(()=>[t(F,null,{default:l(()=>[t(k,{cols:"12"},{default:l(()=>[n("div",tt,[e[29]||(e[29]=n("div",{class:"text-sm text-disabled mb-1"}," Task ",-1)),n("div",lt,v(a(u).task),1)])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[n("div",st,[e[30]||(e[30]=n("div",{class:"text-sm text-disabled mb-1"}," Assigned To ",-1)),n("div",at,v(a(u).assignedTo),1)])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[n("div",ot,[e[31]||(e[31]=n("div",{class:"text-sm text-disabled mb-1"}," Due Date ",-1)),n("div",it,v(a(u).dueDate),1)])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[n("div",nt,[e[32]||(e[32]=n("div",{class:"text-sm text-disabled mb-1"}," Priority ",-1)),t(E,{color:te(a(u).priority),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[p(v(a(u).priority),1)]),_:1},8,["color"])])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[n("div",rt,[e[33]||(e[33]=n("div",{class:"text-sm text-disabled mb-1"}," Status ",-1)),t(E,{color:ee(a(u).status),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[p(v(a(u).status.replace("_"," ")),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1}),t(q,null,{default:l(()=>[t(B),t(V,{color:"secondary",variant:"tonal",onClick:e[11]||(e[11]=i=>S.value=!1)},{default:l(()=>e[34]||(e[34]=[p(" Close ")])),_:1,__:[34]}),t(V,{color:"primary",onClick:e[12]||(e[12]=i=>le(a(u).id))},{default:l(()=>e[35]||(e[35]=[p(" Edit ")])),_:1,__:[35]})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["modelValue"]),t(N,{modelValue:a(x),"onUpdate:modelValue":e[21]||(e[21]=i=>b(x)?x.value=i:null),"max-width":"600"},{default:l(()=>[t(o,{onClick:e[14]||(e[14]=i=>x.value=!1)}),a(u)?(y(),z($,{key:0,title:"Edit Task"},{default:l(()=>[t(L,null,{default:l(()=>[t(Oe,{onSubmit:Le(se,["prevent"])},{default:l(()=>[t(F,null,{default:l(()=>[t(k,{cols:"12"},{default:l(()=>[t(m,{modelValue:a(u).task,"onUpdate:modelValue":e[15]||(e[15]=i=>a(u).task=i),label:"Task",placeholder:"Enter task description"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[t(m,{modelValue:a(u).assignedTo,"onUpdate:modelValue":e[16]||(e[16]=i=>a(u).assignedTo=i),label:"Assigned To",placeholder:"Enter assignee name"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[t(m,{modelValue:a(u).dueDate,"onUpdate:modelValue":e[17]||(e[17]=i=>a(u).dueDate=i),label:"Due Date",type:"date"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[t(d,{modelValue:a(u).priority,"onUpdate:modelValue":e[18]||(e[18]=i=>a(u).priority=i),label:"Priority",items:Y,placeholder:"Select priority"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",md:"6"},{default:l(()=>[t(d,{modelValue:a(u).status,"onUpdate:modelValue":e[19]||(e[19]=i=>a(u).status=i),label:"Status",items:Z,placeholder:"Select status"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(q,null,{default:l(()=>[t(B),t(V,{color:"secondary",variant:"tonal",onClick:e[20]||(e[20]=i=>x.value=!1)},{default:l(()=>e[36]||(e[36]=[p(" Cancel ")])),_:1,__:[36]}),t(V,{color:"primary",onClick:se},{default:l(()=>e[37]||(e[37]=[p(" Save Changes ")])),_:1,__:[37]})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["modelValue"]),t(N,{modelValue:a(C),"onUpdate:modelValue":e[24]||(e[24]=i=>b(C)?C.value=i:null),"max-width":"600"},{default:l(()=>[t(o,{onClick:e[22]||(e[22]=i=>C.value=!1)}),t($,{title:"Confirm Delete"},{default:l(()=>[t(L,null,{default:l(()=>e[38]||(e[38]=[p(" Are you sure you want to delete this task? This action cannot be undone. ")])),_:1,__:[38]}),t(q,null,{default:l(()=>[t(B),t(V,{color:"secondary",variant:"tonal",onClick:e[23]||(e[23]=i=>C.value=!1)},{default:l(()=>e[39]||(e[39]=[p(" Cancel ")])),_:1,__:[39]}),t(V,{color:"error",onClick:ve},{default:l(()=>e[40]||(e[40]=[p(" Delete ")])),_:1,__:[40]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Gt as default};
