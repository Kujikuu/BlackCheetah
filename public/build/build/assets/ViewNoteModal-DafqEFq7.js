import{_ as J}from"./AppTextarea.vue_vue_type_script_setup_true_lang-yoNOmpMf.js";import{_ as Q}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dp8jGCw7.js";import{V as T,_ as W}from"./VDialog-CEq2jzbd.js";import{d as I,r as E,P as L,w as X,g as _,f as l,aR as P,m as n,b as o,l as k,b3 as Y,e as c,c as N,i as R,F as G,a9 as x,t as A,b5 as S,o as u,ax as y,v as f}from"./main-B8QbR-yS.js";import{V as B,d as K}from"./VCard-D9PhtsJ0.js";import{V as Z}from"./VForm-C9sxpau4.js";import{V as M,a as v}from"./VRow-LlT6Azsr.js";import{V as ee}from"./VFileInput-Ip2n4ssl.js";import{V as O}from"./VCardText-Cbtr6Qhr.js";import{V as j}from"./VDivider-DOfIMbJY.js";import{V as q}from"./VSpacer-BSXBFFTK.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"flex-grow-1 me-3"},ae={class:"text-body-2 font-weight-medium"},le={class:"text-caption text-disabled"},De=I({__name:"EditNoteModal",props:{isDialogVisible:{type:Boolean},note:{}},emits:["update:isDialogVisible","noteUpdated"],setup(D,{emit:$}){const b=D,w=$,s=E(null),h=E([]),d=E(!1),p=L({get:()=>b.isDialogVisible,set:e=>w("update:isDialogVisible",e)});X(()=>b.note,e=>{e&&(s.value={...e})},{immediate:!0});const F=e=>{const a=e.target;a.files&&(h.value=Array.from(a.files))},t=e=>{if(e===0)return"0 Bytes";const a=1024,V=["Bytes","KB","MB","GB"],C=Math.floor(Math.log(e)/Math.log(a));return`${Number.parseFloat((e/a**C).toFixed(2))} ${V[C]}`},i=async e=>{if(s.value)try{const a=await S(`/v1/notes/${s.value.id}/attachments/${e}`,{method:"DELETE"});a.success?(s.value.attachments.splice(e,1),console.log("Attachment removed successfully")):console.error("Failed to remove attachment:",a.message)}catch(a){console.error("Error removing attachment:",a)}},g=async()=>{if(s.value)try{d.value=!0;const e=new FormData;e.append("title",s.value.title),e.append("description",s.value.description),e.append("_method","PUT"),h.value.forEach(V=>{e.append("attachments[]",V)});const a=await S(`/v1/notes/${s.value.id}`,{method:"POST",body:e});a.success?(console.log("Note updated successfully"),w("noteUpdated"),p.value=!1,h.value=[]):console.error("Failed to update note:",a.message)}catch(e){console.error("Error updating note:",e)}finally{d.value=!1}},r=()=>{p.value=!1,h.value=[],b.note&&(s.value={...b.note})},z=e=>e.startsWith("image/")?"tabler-photo":e.startsWith("video/")?"tabler-video":e.startsWith("audio/")?"tabler-music":e.includes("pdf")?"tabler-file-type-pdf":e.includes("word")||e.includes("document")?"tabler-file-type-doc":e.includes("excel")||e.includes("spreadsheet")?"tabler-file-type-xls":e.includes("zip")||e.includes("compressed")?"tabler-file-zip":"tabler-file";return(e,a)=>{const V=W,C=Q,H=J;return u(),_(T,{modelValue:n(p),"onUpdate:modelValue":a[2]||(a[2]=m=>P(p)?p.value=m:null),"max-width":"800"},{default:l(()=>[o(V,{onClick:r}),n(s)?(u(),_(B,{key:0,title:"Edit Note"},{default:l(()=>[o(O,null,{default:l(()=>[o(Z,{onSubmit:Y(g,["prevent"])},{default:l(()=>[o(M,null,{default:l(()=>[o(v,{cols:"12"},{default:l(()=>[o(C,{modelValue:n(s).title,"onUpdate:modelValue":a[0]||(a[0]=m=>n(s).title=m),label:"Title",placeholder:"Enter note title",disabled:n(d)},null,8,["modelValue","disabled"])]),_:1}),o(v,{cols:"12"},{default:l(()=>[o(H,{modelValue:n(s).description,"onUpdate:modelValue":a[1]||(a[1]=m=>n(s).description=m),label:"Description",placeholder:"Enter note description...",rows:"6",disabled:n(d)},null,8,["modelValue","disabled"])]),_:1}),n(s).attachments&&n(s).attachments.length>0?(u(),_(v,{key:0,cols:"12"},{default:l(()=>[a[3]||(a[3]=c("h6",{class:"text-h6 mb-3"}," Existing Attachments ",-1)),o(M,null,{default:l(()=>[(u(!0),N(G,null,R(n(s).attachments,(m,U)=>(u(),_(v,{key:U,cols:"12",md:"6"},{default:l(()=>[o(B,{variant:"tonal",class:"d-flex align-center pa-3"},{default:l(()=>[o(y,{icon:z(m.type),size:"32",class:"me-3"},null,8,["icon"]),c("div",oe,[c("div",ae,f(m.name),1),c("div",le,f(t(m.size)),1)]),o(x,{icon:"",size:"small",variant:"text",color:"error",disabled:n(d),onClick:pe=>i(U)},{default:l(()=>[o(y,{icon:"tabler-trash"})]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1,__:[3]})):k("",!0),o(v,{cols:"12"},{default:l(()=>[o(ee,{label:"Attachments",multiple:"","prepend-icon":"tabler-paperclip",placeholder:"Upload files",chips:"","show-size":"",disabled:n(d),onChange:F},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),o(j),o(K,null,{default:l(()=>[o(q),o(x,{color:"secondary",variant:"tonal",disabled:n(d),onClick:r},{default:l(()=>a[4]||(a[4]=[A(" Cancel ")])),_:1,__:[4]},8,["disabled"]),o(x,{color:"primary",loading:n(d),disabled:n(d),onClick:g},{default:l(()=>a[5]||(a[5]=[A(" Update Note ")])),_:1,__:[5]},8,["loading","disabled"])]),_:1})]),_:1})):k("",!0)]),_:1},8,["modelValue"])}}}),se={class:"mb-6"},ie={class:"text-body-1 whitespace-pre-wrap"},ne={class:"text-body-2 text-medium-emphasis"},re={key:0},de={class:"text-h6 mb-3"},ce={class:"flex-grow-1 me-3"},ue={class:"text-body-2 font-weight-medium"},me={class:"text-caption text-disabled"},fe=I({__name:"ViewNoteModal",props:{isDialogVisible:{type:Boolean},note:{}},emits:["update:isDialogVisible"],setup(D,{emit:$}){const b=D,w=$,s=L({get:()=>b.isDialogVisible,set:t=>w("update:isDialogVisible",t)}),h=t=>new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),d=t=>{if(t===0)return"0 Bytes";const i=1024,g=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(i));return`${Number.parseFloat((t/i**r).toFixed(2))} ${g[r]}`},p=t=>{const i=document.createElement("a");i.href=`/storage/${t.path}`,i.download=t.name,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)},F=t=>t.startsWith("image/")?"tabler-photo":t.startsWith("video/")?"tabler-video":t.startsWith("audio/")?"tabler-music":t.includes("pdf")?"tabler-file-type-pdf":t.includes("word")||t.includes("document")?"tabler-file-type-doc":t.includes("excel")||t.includes("spreadsheet")?"tabler-file-type-xls":t.includes("zip")||t.includes("compressed")?"tabler-file-zip":"tabler-file";return(t,i)=>{const g=W;return u(),_(T,{modelValue:n(s),"onUpdate:modelValue":i[2]||(i[2]=r=>P(s)?s.value=r:null),"max-width":"800"},{default:l(()=>[o(g,{onClick:i[0]||(i[0]=r=>s.value=!1)}),t.note?(u(),_(B,{key:0,title:"Note Details"},{default:l(()=>[o(O,null,{default:l(()=>[c("div",se,[c("p",ie,f(t.note.description),1),c("p",ne," Created by "+f(t.note.createdBy)+" at "+f(h(t.note.createdAt)),1)]),t.note.attachments&&t.note.attachments.length>0?(u(),N("div",re,[c("h6",de," Attachments ("+f(t.note.attachments.length)+") ",1),o(M,null,{default:l(()=>[(u(!0),N(G,null,R(t.note.attachments,(r,z)=>(u(),_(v,{key:z,cols:"12",md:"6"},{default:l(()=>[o(B,{variant:"tonal",class:"d-flex align-center pa-3"},{default:l(()=>[o(y,{icon:F(r.type),size:"32",class:"me-3"},null,8,["icon"]),c("div",ce,[c("div",ue,f(r.name),1),c("div",me,f(d(r.size)),1)]),o(x,{icon:"",size:"small",variant:"text",color:"primary",onClick:e=>p(r)},{default:l(()=>[o(y,{icon:"tabler-download"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):k("",!0)]),_:1}),o(j),o(K,null,{default:l(()=>[o(q),o(x,{color:"secondary",variant:"tonal",onClick:i[1]||(i[1]=r=>s.value=!1)},{default:l(()=>i[3]||(i[3]=[A(" Close ")])),_:1,__:[3]})]),_:1})]),_:1})):k("",!0)]),_:1},8,["modelValue"])}}}),$e=te(fe,[["__scopeId","data-v-fec9f381"]]);export{$e as V,De as _};
