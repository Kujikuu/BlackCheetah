import{L as J,K as ne,b5 as Ne,M as ie,y as e,ax as he,a7 as D,ag as Ee,bA as Me,O as I,I as We,al as qe,bG as Le,av as B,bB as Oe,R as Q,ah as je,P as Ge,n as ge,S as He,bC as Ke,bf as Ye,bH as Qe,bI as Se,az as Je,bi as Xe,bD as Ze,bx as et,F as ce,d as _e,g as P,w as Ae,a as k,o as g,k as t,l as o,h as me,i as l,q as x,t as V,aM as G,e as tt,E as at,c as K,aD as ae,r as ke,bb as we}from"./main-CJoUlw71.js";import{f as lt}from"./formatters--UtN2sCw.js";import{_ as st}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-Bzsz1vmo.js";import{_ as nt}from"./AppTextarea.vue_vue_type_script_setup_true_lang-B1eRZ8g1.js";import{_ as it}from"./AppSelect.vue_vue_type_script_setup_true_lang-BPi_8I55.js";import{_ as ot}from"./AppTextField.vue_vue_type_script_setup_true_lang-DBBt0k22.js";import{r as j,e as dt}from"./validators-BHkKs9Dp.js";import{f as se}from"./franchise-CaBrEO2E.js";import{c as rt,b as Z,V as q,d as pe,f as N,h as Ve,a as Ue}from"./VCard-D0Kr6jJ3.js";import{V as ve}from"./VAlert-Cmjxlqzr.js";import{V as fe,m as ut,a as de,b as ct}from"./VWindowItem-Sru_LTmb.js";import{V as Ce,m as mt}from"./VSheet-BvBInPRO.js";import{V as re}from"./VDivider-BaGqyL8B.js";import{V as Pe}from"./VForm-MxPZnCnL.js";import{V as Y,a as S}from"./VRow-I0aFN3ft.js";import{V as Re}from"./VSpacer-CqgjN_yM.js";import{V as ze,_ as pt}from"./VDialog-DNQTNeT1.js";import{V as Fe}from"./VSelect-DrBKrWpC.js";import{V as De,a as vt}from"./VTabs-CPaS4mMT.js";import{S as ft}from"./saudi-riyal-CW9kKWrq.js";import{V as le}from"./VSkeletonLoader-4jAbGrJD.js";import{V as ue}from"./VChip-B4nRRsDL.js";import{V as yt,a as bt}from"./VDataTable-bPHraWWW.js";import{V as Ie}from"./VTooltip-DRAd6RrJ.js";import"./VField-BK8GYuQp.js";import"./form-TZVfOcgQ.js";import"./forwardRefs-B931MWyl.js";import"./VInput-ljW8JGQT.js";import"./VTextarea-DlMZvYlN.js";import"./VTextField-D8E1qX-C.js";import"./api-router-CWf8jKcZ.js";import"./scopeId-BW4ci1pC.js";import"./VList-dBGtPQa1.js";/* empty css              */import"./VOverlay-DNweL6TL.js";import"./VMenu-ChdF8Fzb.js";import"./VCheckboxBtn-ClRj4-k1.js";import"./VSelectionControl-DPYfPVD0.js";import"./VSlideGroup-CFd1UCPD.js";import"./VTable-Z6ii9VWQ.js";const xe=Symbol.for("vuetify:v-stepper"),Te=J({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),gt=ne()({name:"VStepperActions",props:Te(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(n,A){let{emit:d,slots:c}=A;const{t:r}=Ne();function p(){d("click:prev")}function v(){d("click:next")}return ie(()=>{const i={onClick:p},f={onClick:v};return e("div",{class:"v-stepper-actions"},[e(he,{defaults:{VBtn:{disabled:["prev",!0].includes(n.disabled),text:r(n.prevText),variant:"text"}}},{default:()=>{var y;return[((y=c.prev)==null?void 0:y.call(c,{props:i}))??e(D,i,null)]}}),e(he,{defaults:{VBtn:{color:n.color,disabled:["next",!0].includes(n.disabled),text:r(n.nextText),variant:"tonal"}}},{default:()=>{var y;return[((y=c.next)==null?void 0:y.call(c,{props:f}))??e(D,f,null)]}})])}),{}}}),Be=rt("v-stepper-header"),_t=J({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:Q,default:"$complete"},editable:Boolean,editIcon:{type:Q,default:"$edit"},error:Boolean,errorIcon:{type:Q,default:"$error"},icon:Q,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Vt=J({..._t(),...Oe()},"VStepperItem"),ye=ne()({name:"VStepperItem",directives:{Ripple:Ee},props:Vt(),emits:{"group:selected":n=>!0},setup(n,A){let{slots:d}=A;const c=Me(n,xe,!0),r=I(()=>(c==null?void 0:c.value.value)??n.value),p=I(()=>n.rules.every(F=>F()===!0)),v=I(()=>!n.disabled&&n.editable),i=I(()=>!n.disabled&&n.editable),f=I(()=>n.error||!p.value),y=I(()=>n.complete||n.rules.length>0&&p.value),z=I(()=>f.value?n.errorIcon:y.value?n.completeIcon:c.isSelected.value&&n.editable?n.editIcon:n.icon),R=I(()=>({canEdit:i.value,hasError:f.value,hasCompleted:y.value,title:n.title,subtitle:n.subtitle,step:r.value,value:n.value}));return ie(()=>{var U,u,C;const F=(!c||c.isSelected.value||y.value||i.value)&&!f.value&&!n.disabled,E=!!(n.title!=null||d.title),L=!!(n.subtitle!=null||d.subtitle);function O(){c==null||c.toggle()}return We(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":y.value,"v-stepper-item--disabled":n.disabled,"v-stepper-item--error":f.value},c==null?void 0:c.selectedClass.value],disabled:!n.editable,type:"button",onClick:O},[v.value&&Le(!0,"v-stepper-item"),e(Z,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:F?n.color:void 0,size:24},{default:()=>{var w;return[((w=d.icon)==null?void 0:w.call(d,R.value))??(z.value?e(B,{icon:z.value},null):r.value)]}}),e("div",{class:"v-stepper-item__content"},[E&&e("div",{key:"title",class:"v-stepper-item__title"},[((U=d.title)==null?void 0:U.call(d,R.value))??n.title]),L&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((u=d.subtitle)==null?void 0:u.call(d,R.value))??n.subtitle]),(C=d.default)==null?void 0:C.call(d,R.value)])]),[[qe("ripple"),n.ripple&&n.editable,null]])}),{}}}),xt=J({...He(ut(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),$e=ne()({name:"VStepperWindow",props:xt(),emits:{"update:modelValue":n=>!0},setup(n,A){let{slots:d}=A;const c=je(xe,null),r=Ge(n,"modelValue"),p=I({get(){var v;return r.value!=null||!c?r.value:(v=c.items.value.find(i=>c.selected.value.includes(i.id)))==null?void 0:v.value},set(v){r.value=v}});return ie(()=>{const v=fe.filterProps(n);return e(fe,ge({_as:"VStepperWindow"},v,{modelValue:p.value,"onUpdate:modelValue":i=>p.value=i,class:["v-stepper-window",n.class],style:n.style,mandatory:!1,touch:!1}),d)}),{}}}),ht=J({...ct()},"VStepperWindowItem"),be=ne()({name:"VStepperWindowItem",props:ht(),setup(n,A){let{slots:d}=A;return ie(()=>{const c=de.filterProps(n);return e(de,ge({_as:"VStepperWindowItem"},c,{class:["v-stepper-window-item",n.class],style:n.style}),d)}),{}}}),St=J({altLabels:Boolean,bgColor:String,completeIcon:Q,editIcon:Q,editable:Boolean,errorIcon:Q,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...et()},"Stepper"),kt=J({...St(),...Ze({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...mt(),...Xe(Te(),["prevText","nextText"])},"VStepper"),wt=ne()({name:"VStepper",props:kt(),emits:{"update:modelValue":n=>!0},setup(n,A){let{slots:d}=A;const{items:c,next:r,prev:p,selected:v}=Ke(n,xe),{displayClasses:i,mobile:f}=Ye(n),{completeIcon:y,editIcon:z,errorIcon:R,color:F,editable:E,prevText:L,nextText:O}=Qe(n),U=I(()=>n.items.map((w,T)=>{const M=Se(w,n.itemTitle,w),m=Se(w,n.itemValue,T+1);return{title:M,value:m,raw:w}})),u=I(()=>c.value.findIndex(w=>v.value.includes(w.id))),C=I(()=>n.disabled?n.disabled:u.value===0?"prev":u.value===c.value.length-1?"next":!1);return Je({VStepperItem:{editable:E,errorIcon:R,completeIcon:y,editIcon:z,prevText:L,nextText:O},VStepperActions:{color:F,disabled:C,prevText:L,nextText:O}}),ie(()=>{const w=Ce.filterProps(n),T=!!(d.header||n.items.length),M=n.items.length>0,m=!n.hideActions&&!!(M||d.actions);return e(Ce,ge(w,{color:n.bgColor,class:["v-stepper",{"v-stepper--alt-labels":n.altLabels,"v-stepper--flat":n.flat,"v-stepper--non-linear":n.nonLinear,"v-stepper--mobile":f.value},i.value,n.class],style:n.style}),{default:()=>{var h,H;return[T&&e(Be,{key:"stepper-header"},{default:()=>[U.value.map(($,X)=>{let{raw:ee,...oe}=$;return e(ce,null,[!!X&&e(re,null,null),e(ye,oe,{default:d[`header-item.${oe.value}`]??d.header,icon:d.icon,title:d.title,subtitle:d.subtitle})])})]}),M&&e($e,{key:"stepper-window"},{default:()=>[U.value.map($=>e(be,{value:$.value},{default:()=>{var X,ee;return((X=d[`item.${$.value}`])==null?void 0:X.call(d,$))??((ee=d.item)==null?void 0:ee.call(d,$))}}))]}),(h=d.default)==null?void 0:h.call(d,{prev:p,next:r}),m&&(((H=d.actions)==null?void 0:H.call(d,{next:r,prev:p}))??e(gt,{key:"stepper-actions","onClick:prev":p,"onClick:next":r},d))]}})}),{prev:p,next:r}}}),Ut={class:"d-flex gap-3"},Ct=_e({__name:"AddFranchiseeDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchiseeAdded"],setup(n,{emit:A}){const d=n,c=A,r=P(1),p=P(!1),v=P(null),i=P({name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),f=[{title:"Saudi Arabia",value:"SA"},{title:"United Arab Emirates",value:"AE"},{title:"Qatar",value:"QA"},{title:"Kuwait",value:"KW"},{title:"Oman",value:"OM"},{title:"Bahrain",value:"BH"},{title:"Jordan",value:"JO"},{title:"Lebanon",value:"LB"},{title:"Egypt",value:"EG"},{title:"Iraq",value:"IQ"}],y=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}],z=()=>{r.value=1,v.value=null,i.value={name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},R=U=>{c("update:isDialogVisible",U)},F=()=>{r.value<2&&(r.value++,v.value=null)},E=()=>{r.value>1&&(r.value--,v.value=null)};Ae(()=>d.isDialogVisible,U=>{U&&z()});const L=async()=>{var U,u,C,w;if(!i.value.name||!i.value.email||!i.value.phone){v.value="Please fill in all required fields";return}p.value=!0,v.value=null;try{const M=((u=(U=(await se.getFranchises()).data)==null?void 0:U[0])==null?void 0:u.id)||null,m={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:M,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,country:i.value.country,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},h=await se.createFranchiseeWithUnit(m);if(h.success){const H={id:h.data.unit.id,name:h.data.unit.unit_name,email:h.data.franchisee.email,phone:h.data.franchisee.phone,type:h.data.unit.unit_type,sizeSqft:h.data.unit.size_sqft,capacity:null,openingDate:h.data.unit.opening_date,monthlyRent:h.data.unit.monthly_rent,managerId:h.data.unit.franchisee_id,managerName:h.data.franchisee.name,country:h.data.unit.country,state:h.data.unit.state_province,city:h.data.unit.city,address:h.data.unit.address,postalCode:h.data.unit.postal_code};c("franchiseeAdded",H),R(!1),z()}}catch(T){console.error("Error creating franchisee with unit:",T),v.value=((w=(C=T.response)==null?void 0:C.data)==null?void 0:w.message)||"Failed to create franchisee and unit. Please try again."}finally{p.value=!1}},O=U=>{c("update:isDialogVisible",U),U||z()};return(U,u)=>{const C=ot,w=it,T=nt,M=st;return g(),k(ze,{"model-value":d.isDialogVisible,"max-width":"800","onUpdate:modelValue":O},{default:t(()=>[e(q,null,{default:t(()=>[e(pe,{class:"text-center"},{default:t(()=>u[15]||(u[15]=[o("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[15]}),e(N,null,{default:t(()=>[l(v)?(g(),k(ve,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":u[0]||(u[0]=m=>v.value=null)},{default:t(()=>[x(V(l(v)),1)]),_:1})):me("",!0),e(wt,{modelValue:l(r),"onUpdate:modelValue":u[13]||(u[13]=m=>G(r)?r.value=m:null),"alt-labels":""},{default:t(()=>[e(Be,null,{default:t(()=>[e(ye,{complete:l(r)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(re),e(ye,{value:2,title:"Unit Details"})]),_:1}),e($e,null,{default:t(()=>[e(be,{value:1},{default:t(()=>[e(Pe,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[e(C,{modelValue:l(i).name,"onUpdate:modelValue":u[1]||(u[1]=m=>l(i).name=m),label:"Branch Name",placeholder:"Enter Branch name",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(C,{modelValue:l(i).email,"onUpdate:modelValue":u[2]||(u[2]=m=>l(i).email=m),label:"Email Address",placeholder:"Enter email address",rules:[l(j),l(dt)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(C,{modelValue:l(i).phone,"onUpdate:modelValue":u[3]||(u[3]=m=>l(i).phone=m),label:"Contact Number",placeholder:"Enter contact number",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(w,{modelValue:l(i).country,"onUpdate:modelValue":u[4]||(u[4]=m=>l(i).country=m),items:f,label:"Country",placeholder:"Select country",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).state,"onUpdate:modelValue":u[5]||(u[5]=m=>l(i).state=m),label:"State",placeholder:"Enter state",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).city,"onUpdate:modelValue":u[6]||(u[6]=m=>l(i).city=m),label:"City",placeholder:"Enter city",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(T,{modelValue:l(i).address,"onUpdate:modelValue":u[7]||(u[7]=m=>l(i).address=m),label:"Address",placeholder:"Enter full address",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(ve,{type:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[o("strong",null,V(l(i).name||"New franchisee"),1),u[16]||(u[16]=x(" will be automatically assigned as the unit manager. "))]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{value:2},{default:t(()=>[e(Pe,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(S,{cols:"12",md:"6"},{default:t(()=>[e(w,{modelValue:l(i).type,"onUpdate:modelValue":u[8]||(u[8]=m=>l(i).type=m),items:y,label:"Unit Type",placeholder:"Select unit type",rules:[l(j)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(M,{modelValue:l(i).openingDate,"onUpdate:modelValue":u[9]||(u[9]=m=>l(i).openingDate=m),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":u[10]||(u[10]=m=>l(i).sizeSqft=m),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).capacity,"onUpdate:modelValue":u[11]||(u[11]=m=>l(i).capacity=m),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":u[12]||(u[12]=m=>l(i).monthlyRent=m),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"SAR"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Ve,{class:"justify-space-between pa-6"},{default:t(()=>[l(r)>1?(g(),k(D,{key:0,variant:"outlined",disabled:l(p),onClick:E},{default:t(()=>u[17]||(u[17]=[x(" Previous ")])),_:1,__:[17]},8,["disabled"])):(g(),k(Re,{key:1})),o("div",Ut,[e(D,{variant:"outlined",disabled:l(p),onClick:u[14]||(u[14]=m=>R(!1))},{default:t(()=>u[18]||(u[18]=[x(" Cancel ")])),_:1,__:[18]},8,["disabled"]),l(r)<2?(g(),k(D,{key:0,color:"primary",disabled:l(p),onClick:F},{default:t(()=>u[19]||(u[19]=[x(" Next ")])),_:1,__:[19]},8,["disabled"])):(g(),k(D,{key:1,color:"primary",loading:l(p),disabled:l(p),onClick:L},{default:t(()=>u[20]||(u[20]=[x(" Create Unit ")])),_:1,__:[20]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Pt=_e({__name:"ChangeStatusDialog",props:{isDialogVisible:{type:Boolean},unitId:{},currentStatus:{},statusOptions:{}},emits:["update:isDialogVisible","status-updated"],setup(n,{emit:A}){const d=n,c=A,r=P(d.currentStatus),p=P(!1);Ae(()=>d.currentStatus,f=>{r.value=f},{immediate:!0});const v=async()=>{if(!(!d.unitId||!r.value||r.value===d.currentStatus))try{p.value=!0,(await se.updateUnitStatus(d.unitId,r.value)).success&&(c("status-updated",{unitId:d.unitId,newStatus:r.value}),c("update:isDialogVisible",!1))}catch(f){console.error("Failed to change unit status:",f)}finally{p.value=!1}},i=()=>{r.value=d.currentStatus,c("update:isDialogVisible",!1)};return(f,y)=>{const z=pt;return g(),k(ze,{"model-value":f.isDialogVisible,"max-width":"600","onUpdate:modelValue":y[1]||(y[1]=R=>c("update:isDialogVisible",R))},{default:t(()=>[e(z,{onClick:i}),e(q,{title:"Change Unit Status"},{default:t(()=>[e(N,null,{default:t(()=>[e(Fe,{modelValue:l(r),"onUpdate:modelValue":y[0]||(y[0]=R=>G(r)?r.value=R:null),label:"Status",items:f.statusOptions,placeholder:"Select Status"},null,8,["modelValue","items"])]),_:1}),e(Ve,null,{default:t(()=>[e(Re),e(D,{color:"secondary",variant:"tonal",onClick:i},{default:t(()=>y[2]||(y[2]=[x(" Cancel ")])),_:1,__:[2]}),e(D,{color:"primary",disabled:!l(r)||l(r)===f.currentStatus,loading:l(p),onClick:v},{default:t(()=>y[3]||(y[3]=[x(" Update Status ")])),_:1,__:[3]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Dt={class:"d-flex align-center justify-space-between"},It={class:"ms-4"},At={class:"text-h4"},Rt={key:1},zt={class:"ms-4"},Ft={class:"text-h4"},Tt={key:1},Bt={class:"ms-4"},$t={class:"text-h4"},Nt={key:1},Et={class:"ms-4"},Mt={class:"text-h4"},Wt={key:1},qt={class:"text-center py-8"},Lt={class:"d-flex align-center justify-space-between mb-3"},Ot={class:"text-h6"},jt={class:"mb-2"},Gt={class:"text-body-1"},Ht={class:"mb-2"},Kt={class:"text-body-2"},Yt={class:"mb-3"},Qt={class:"text-body-1 font-weight-medium"},Jt={class:"text-center"},Xt={class:"text-center"},Zt={class:"d-flex align-center gap-x-3"},ea={class:"text-base font-weight-medium"},ta={class:"text-body-2 text-disabled"},aa={class:"text-body-1 font-weight-medium"},la={class:"text-body-2 text-disabled"},sa={class:"text-body-1"},na={class:"text-body-2 text-disabled"},ia={class:"text-body-2 text-disabled"},oa={class:"text-body-2 text-disabled"},da={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},ra={class:"text-sm text-disabled mb-0"},ua={class:"d-flex align-center",style:{"inline-size":"8rem"}},Ja=_e({__name:"my-units",setup(n){const A=(b,a,_)=>{const W=(b-1)*a+1,s=Math.min(b*a,_);return`Showing ${W} to ${s} of ${_} entries`},d=tt(),c=P("overview"),r=P([]),p=P(!1),v=P(null),i=P(1),f=P(10);P(0);const y=P(!1),z=P(null),R=P(""),F=P({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),E=P(!1),L=I(()=>F.value.totalUnits||r.value.length),O=I(()=>F.value.activeUnits||r.value.filter(b=>b.status==="active").length),U=I(()=>F.value.pendingUnits||r.value.filter(b=>b.status==="pending").length),u=I(()=>F.value.monthlyRoyalty),C=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],w=[{title:"Planning",value:"planning"},{title:"Construction",value:"construction"},{title:"Training",value:"training"},{title:"Active",value:"active"},{title:"Pending",value:"pending"},{title:"Temporarily Closed",value:"temporarily_closed"},{title:"Permanently Closed",value:"permanently_closed"}],T=b=>b==="active"?"success":b==="pending"?"warning":b==="inactive"?"error":"secondary",M=async()=>{var b;p.value=!0,v.value=null;try{const a=await se.getUnits();a.success&&a.data.data?r.value=a.data.data.map(_=>{var W,s,te;return{id:_.id,branchName:_.unit_name||"Unnamed Unit",franchiseeName:((W=_.franchisee)==null?void 0:W.name)||"Unassigned",email:((s=_.franchisee)==null?void 0:s.email)||_.email||"unassigned@example.com",contactNumber:((te=_.franchisee)==null?void 0:te.phone)||_.phone||"Not available",address:_.address||"Address not available",city:_.city||"Unknown",state:_.state_province||"Unknown",country:_.country||"Unknown",royaltyPercentage:8.5,contractStartDate:_.lease_start_date||"2024-01-01",renewalDate:_.lease_end_date||"2027-01-01",status:_.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:_.employee_count||0,totalProducts:0,avgRating:0}}):r.value=[]}catch(a){console.error("Failed to load units data:",a),v.value=((b=a==null?void 0:a.data)==null?void 0:b.message)||"Failed to load units data",r.value=[]}finally{p.value=!1}},m=async()=>{var b,a,_,W;try{const s=await se.getUnitsStatistics();s.success&&s.data&&(F.value={totalUnits:s.data.totalUnits||0,activeUnits:s.data.activeUnits||0,pendingUnits:s.data.pendingUnits||0,inactiveUnits:s.data.inactiveUnits||0,totalRevenue:s.data.totalRevenue||0,monthlyRoyalty:s.data.monthlyRoyalty||0,avgRevenuePerUnit:s.data.avgRevenuePerUnit||0,revenueChange:s.data.revenueChange||0,royaltyRate:s.data.royaltyRate||8.5,taskStats:{total:((b=s.data.taskStats)==null?void 0:b.total)||0,completed:((a=s.data.taskStats)==null?void 0:a.completed)||0,pending:((_=s.data.taskStats)==null?void 0:_.pending)||0,completionRate:((W=s.data.taskStats)==null?void 0:W.completionRate)||0}})}catch(s){console.error("Failed to load statistics data:",s)}},h=async()=>{await Promise.all([M(),m()])},H=b=>{d.push(`/franchisor/units/${b}`)},$=()=>{E.value=!0},X=b=>{h()};at(()=>{h()});const ee=b=>{z.value=b,R.value=b.status,y.value=!0},oe=b=>{const a=r.value.findIndex(_=>_.id===b.unitId);a!==-1&&(r.value[a].status=b.newStatus),m()};return(b,a)=>{var _,W;return g(),K("section",null,[e(Y,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",Dt,[a[11]||(a[11]=o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Units "),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[10]||(a[10]=[x(" Add Franchisee ")])),_:1,__:[10]},8,["loading"])])]),_:1})]),_:1}),l(v)?(g(),k(ve,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":a[0]||(a[0]=s=>v.value=null)},{default:t(()=>[x(V(l(v)),1)]),_:1})):me("",!0),e(vt,{modelValue:l(c),"onUpdate:modelValue":a[1]||(a[1]=s=>G(c)?c.value=s:null),class:"mb-6"},{default:t(()=>[e(De,{value:"overview"},{default:t(()=>[e(B,{icon:"tabler-dashboard",start:""}),a[12]||(a[12]=x(" Overview "))]),_:1,__:[12]}),e(De,{value:"units"},{default:t(()=>[e(B,{icon:"tabler-building-store",start:""}),a[13]||(a[13]=x(" All Units "))]),_:1,__:[13]})]),_:1},8,["modelValue"]),e(fe,{modelValue:l(c),"onUpdate:modelValue":a[7]||(a[7]=s=>G(c)?c.value=s:null),class:"disable-tab-transition"},{default:t(()=>[e(de,{value:"overview"},{default:t(()=>[e(Y,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12",md:"3"},{default:t(()=>[e(q,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-building-store",size:"26"})]),_:1}),o("div",It,[a[14]||(a[14]=o("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),o("h4",At,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),K("span",Rt,V(l(L)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(q,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-check",size:"26"})]),_:1}),o("div",zt,[a[15]||(a[15]=o("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),o("h4",Ft,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),K("span",Tt,V(l(O)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(q,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",Bt,[a[16]||(a[16]=o("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),o("h4",$t,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),K("span",Nt,V(l(U)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(q,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(Z,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:t(()=>[e(l(ft),{size:"26"})]),_:1}),o("div",Et,[a[17]||(a[17]=o("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),o("h4",Mt,[l(p)?(g(),k(ae,{key:0,indeterminate:"",size:"20"})):(g(),K("span",Wt,V(l(lt)(l(u))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(Ue,{class:"pb-4"},{append:t(()=>[e(D,{variant:"text",color:"primary",onClick:a[2]||(a[2]=s=>c.value="units")},{default:t(()=>a[19]||(a[19]=[x(" View All ")])),_:1,__:[19]})]),default:t(()=>[e(pe,null,{default:t(()=>a[18]||(a[18]=[x("Recent Units")])),_:1,__:[18]})]),_:1}),e(N,null,{default:t(()=>[l(p)?(g(),k(Y,{key:0},{default:t(()=>[(g(),K(ce,null,ke(3,s=>e(S,{key:s,cols:"12",md:"4"},{default:t(()=>[e(q,{variant:"outlined"},{default:t(()=>[e(N,null,{default:t(()=>[e(le,{type:"text",class:"mb-3"}),e(le,{type:"text",class:"mb-2"}),e(le,{type:"text",class:"mb-2"}),e(le,{type:"text",class:"mb-3"}),e(le,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(r).length===0?(g(),k(Y,{key:1},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",qt,[e(B,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),a[21]||(a[21]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[22]||(a[22]=o("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",onClick:$},{default:t(()=>a[20]||(a[20]=[x(" Add Your First Unit ")])),_:1,__:[20]})])]),_:1})]),_:1})):(g(),k(Y,{key:2},{default:t(()=>[(g(!0),K(ce,null,ke(l(r).slice(0,3),s=>(g(),k(S,{key:s.id,cols:"12",md:"4"},{default:t(()=>[e(q,{variant:"outlined"},{default:t(()=>[e(N,null,{default:t(()=>[o("div",Lt,[o("h6",Ot,V(s.branchName),1),e(ue,{color:T(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(V(s.status),1)]),_:2},1032,["color"])]),o("div",jt,[a[23]||(a[23]=o("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),o("div",Gt,V(s.franchiseeName),1)]),o("div",Ht,[a[24]||(a[24]=o("div",{class:"text-body-2 text-disabled"}," Location ",-1)),o("div",Kt,V(s.city)+", "+V(s.state),1)]),o("div",Yt,[a[25]||(a[25]=o("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),o("div",Qt,V(s.royaltyPercentage)+"% ",1)])]),_:2},1024),e(Ve,null,{default:t(()=>[e(D,{variant:"text",color:"primary",onClick:te=>H(s.id)},{default:t(()=>a[26]||(a[26]=[x(" View Details ")])),_:2,__:[26]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(de,{value:"units"},{default:t(()=>[e(q,null,{default:t(()=>[e(Ue,{class:"pb-4"},{append:t(()=>[e(D,{color:"primary","prepend-icon":"tabler-plus",loading:l(p),onClick:$},{default:t(()=>a[28]||(a[28]=[x(" Add Franchisee ")])),_:1,__:[28]},8,["loading"])]),default:t(()=>[e(pe,null,{default:t(()=>a[27]||(a[27]=[x("All Franchise Units")])),_:1,__:[27]})]),_:1}),e(re),l(p)?(g(),k(N,{key:0,class:"py-8"},{default:t(()=>[o("div",Jt,[e(ae,{indeterminate:"",size:"48",class:"mb-4"}),a[29]||(a[29]=o("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),a[30]||(a[30]=o("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(r).length===0?(g(),k(N,{key:1,class:"py-8"},{default:t(()=>[o("div",Xt,[e(B,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),a[32]||(a[32]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[33]||(a[33]=o("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:$},{default:t(()=>a[31]||(a[31]=[x(" Add Your First Franchisee & Unit ")])),_:1,__:[31]})])]),_:1})):(g(),k(yt,{key:2,items:l(r),headers:C,class:"text-no-wrap","item-value":"id","items-per-page":l(f),page:l(i),"onUpdate:itemsPerPage":a[5]||(a[5]=s=>f.value=s),"onUpdate:page":a[6]||(a[6]=s=>i.value=s)},{"item.branchInfo":t(({item:s})=>[o("div",Zt,[e(Z,{size:"34",color:"primary",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-building-store",size:"20"})]),_:1}),o("div",null,[o("h6",ea,V(s.branchName),1),o("div",ta,V(s.email),1)])])]),"item.franchisee":t(({item:s})=>[o("div",null,[o("div",aa,V(s.franchiseeName),1),o("div",la,[e(B,{icon:"tabler-user-check",size:"14",class:"me-1"}),x(" Unit Manager • "+V(s.contactNumber),1)])])]),"item.location":t(({item:s})=>[o("div",null,[o("div",sa,V(s.city)+", "+V(s.state),1),o("div",na,V(s.country),1)])]),"item.royaltyPercentage":t(({item:s})=>[s.royaltyPercentage>0?(g(),k(ue,{key:0,color:"primary",size:"small",class:"mt-1"},{default:t(()=>[x(V(s.royaltyPercentage)+"% Royalty ",1)]),_:2},1024)):me("",!0)]),"item.contractPeriod":t(({item:s})=>[o("div",null,[o("div",ia," Start: "+V(s.contractStartDate),1),o("div",oa," Renewal: "+V(s.renewalDate),1)])]),"item.status":t(({item:s})=>[e(ue,{color:T(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(V(s.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:s})=>[e(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(te=>H(s.id),["stop"])},{default:t(()=>[e(B,{icon:"tabler-eye"}),e(Ie,{activator:"parent"},{default:t(()=>a[34]||(a[34]=[x(" View Unit Details ")])),_:1,__:[34]})]),_:2},1032,["onClick"]),e(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:we(te=>ee(s),["stop"])},{default:t(()=>[e(B,{icon:"tabler-edit"}),e(Ie,{activator:"parent"},{default:t(()=>a[35]||(a[35]=[x(" Change Status ")])),_:1,__:[35]})]),_:2},1032,["onClick"])]),bottom:t(()=>[e(re),o("div",da,[o("p",ra,V(A(l(i),l(f),l(r).length)),1),e(bt,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=s=>G(i)?i.value=s:null),length:Math.ceil(l(r).length/l(f)),"total-visible":b.$vuetify.display.xs?1:Math.min(Math.ceil(l(r).length/l(f)),5)},null,8,["modelValue","length","total-visible"]),o("div",ua,[a[36]||(a[36]=o("span",{class:"text-no-wrap me-3"},"Rows per page:",-1)),e(Fe,{modelValue:l(f),"onUpdate:modelValue":a[4]||(a[4]=s=>G(f)?f.value=s:null),density:"compact",variant:"outlined",items:[5,10,25,50,100]},null,8,["modelValue"])])])]),_:1},8,["items","items-per-page","page"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ct,{"is-dialog-visible":l(E),"onUpdate:isDialogVisible":a[8]||(a[8]=s=>G(E)?E.value=s:null),onFranchiseeAdded:X},null,8,["is-dialog-visible"]),e(Pt,{"is-dialog-visible":l(y),"onUpdate:isDialogVisible":a[9]||(a[9]=s=>G(y)?y.value=s:null),"unit-id":((_=l(z))==null?void 0:_.id)||null,"current-status":((W=l(z))==null?void 0:W.status)||"","status-options":w,onStatusUpdated:oe},null,8,["is-dialog-visible","unit-id","current-status"])])}}});export{Ja as default};
