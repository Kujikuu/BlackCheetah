import{m as q}from"./vue3-apexcharts-u3qbBSg5.js";import{f as u}from"./formatters--UtN2sCw.js";import{u as G}from"./useApi-CCD9E6_s.js";import{S as B}from"./saudi-riyal-DBg1zXmT.js";import{V as _,a as y}from"./VRow-LlT6Azsr.js";import{V as g,a as z,b as K,c as Q}from"./VCard-D9PhtsJ0.js";import{V as v}from"./VCardText-Cbtr6Qhr.js";import{V as Y}from"./VAvatar-87LH5tAk.js";import{d as Z,aH as ee,r as c,w as te,P as f,c as N,b as a,f as o,o as F,F as ae,i as oe,m as d,g as se,e as n,ax as re,v as m,a9 as $,t as b}from"./main-B8QbR-yS.js";import{V as le}from"./VDivider-DOfIMbJY.js";import{V as ne}from"./VDataTable-FYAU2aQJ.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-CqkleIqs.js";/* empty css              */import"./VImg-Ceu2Mboj.js";import"./VSelect-GSzN3Qps.js";import"./VTextField-C7_y5spr.js";import"./VField-Bw51LFql.js";import"./form-Dt-W1fp6.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-DB3XZUVb.js";import"./VList-BJCgULVd.js";import"./dialog-transition-Dy2Gj1XO.js";import"./VMenu-TQcmpCCv.js";import"./VOverlay-B3La6Ajr.js";import"./scopeId-DyQ6a1uN.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VChip-CgHwmC-k.js";import"./VSlideGroup-BuNiGLv2.js";import"./VTable-CgkStP3y.js";const ce={class:"d-flex align-center gap-x-4 mb-1"},me={class:"text-h4"},de={class:"text-body-1 mb-1"},pe={class:"d-flex gap-x-2 align-center"},ue={class:"text-h6"},fe={class:"text-body-1 font-weight-medium"},he={class:"text-body-1 text-success font-weight-medium"},ye={class:"text-body-1 text-error font-weight-medium"},ge={class:"text-body-1 text-warning font-weight-medium"},_e={class:"text-body-1 text-primary font-weight-medium"},ve="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",h="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",x="rgba(var(--v-border-color), var(--v-border-opacity))",be=Z({__name:"finance",setup(xe){const{data:D,execute:Se,isFetching:we}=G("/v1/franchisor/dashboard/finance",{immediate:!0}),S=ee(),i={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},w=c([]),T=c([{name:"Sales",data:[]}]),H=c([{name:"Royalty",data:[]}]),p=c([]),k=c([{name:"Sales",data:[]}]),R=c([{name:"Expenses",data:[]}]),C=c([{name:"Profit",data:[]}]),V=c([{name:"Royalty",data:[]}]),A=c([]),M=c([]),l=s=>typeof s=="number"?s:Number.parseFloat(s)||0;te(D,s=>{const r=s;if(r!=null&&r.success&&(r!=null&&r.data)){const t=r.data;w.value=[{icon:B,color:"primary",title:"Total Sales",value:u(l(t.stats.total_sales)),change:t.stats.sales_change,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:u(l(t.stats.total_expenses)),change:t.stats.expenses_change,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:u(l(t.stats.net_profit)),change:t.stats.profit_change,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:`${l(t.stats.profit_margin).toFixed(2)}%`,change:t.stats.margin_change,isHover:!1}],t.top_stores_sales&&t.top_stores_sales.length>0&&(T.value=[{name:"Sales",data:t.top_stores_sales.map(e=>l(e.sales))}],p.value=t.top_stores_sales.map(e=>e.name||"Unknown Store")),t.top_stores_royalty&&t.top_stores_royalty.length>0&&(H.value=[{name:"Royalty",data:t.top_stores_royalty.map(e=>l(e.royalty))}],p.value.length===0&&(p.value=t.top_stores_royalty.map(e=>e.name||"Unknown Store"))),t.sales_chart&&t.sales_chart.length>0&&(k.value=[{name:"Sales",data:t.sales_chart.map(e=>l(e.amount))}],A.value=t.sales_chart.map(e=>e.month)),t.expenses_chart&&(R.value=[{name:"Expenses",data:t.expenses_chart.map(e=>l(e.amount))}]),t.profit_chart&&(C.value=[{name:"Profit",data:t.profit_chart.map(e=>l(e.amount))}]),t.royalty_chart&&(V.value=[{name:"Royalty",data:t.royalty_chart.map(e=>l(e.amount))}]),t.monthly_breakdown&&(M.value=t.monthly_breakdown)}});const P=[{icon:B,color:"primary",title:"Total Sales",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:"0%",change:0,isHover:!1}],L=f(()=>w.value.length>0?w.value:P),E=f(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(0)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.primary],xaxis:{categories:p.value.length>0?p.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:x,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{theme:S.current.value.dark?"dark":"light",y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),O=f(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(s){return`${(s/1e3).toFixed(1)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[i.warning],xaxis:{categories:p.value.length>0?p.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:x,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{theme:S.current.value.dark?"dark":"light",y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),W=f(()=>[{name:"Sales",data:k.value.length>0?k.value[0].data:[]},{name:"Expenses",data:R.value.length>0?R.value[0].data:[]},{name:"Royalties",data:V.value.length>0?V.value[0].data:[]},{name:"Profit",data:C.value.length>0?C.value[0].data:[]}]),I=f(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:4,colors:"#fff",strokeColors:[i.primary,i.error,i.warning,i.success],hover:{size:5},borderRadius:4},stroke:{curve:"smooth",width:3,lineCap:"round"},legend:{show:!0,position:"top",horizontalAlign:"left",markers:{width:10,height:10,offsetX:-3},fontSize:"14px",fontWeight:400,labels:{colors:ve},itemMargin:{horizontal:12,vertical:8}},grid:{strokeDashArray:8,borderColor:x},colors:[i.primary,i.error,i.warning,i.success],dataLabels:{enabled:!1},xaxis:{categories:A.value.length>0?A.value:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:h,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px",fontWeight:400},formatter(s){return`${(s/1e3).toFixed(0)}k SAR`}}},tooltip:{theme:S.current.value.dark?"dark":"light",y:{formatter(s){return`${s.toLocaleString()} SAR`}}}})),J=f(()=>M.value.map(s=>({month:s.month,sales:u(l(s.sales)),expenses:u(l(s.expenses)),royalties:u(l(s.royalties)),profit:u(l(s.profit))}))),U=[{title:"Month",key:"month"},{title:"Sales",key:"sales",align:"end"},{title:"Expenses",key:"expenses",align:"end"},{title:"Royalties",key:"royalties",align:"end"},{title:"Profit",key:"profit",align:"end"}];return(s,r)=>{const t=q;return F(),N("section",null,[a(_,{class:"mb-6"},{default:o(()=>[(F(!0),N(ae,null,oe(d(L),(e,X)=>(F(),se(y,{key:X,cols:"12",md:"3",sm:"6"},{default:o(()=>[a(g,{class:"finance-card-statistics cursor-pointer",style:x,onMouseenter:j=>e.isHover=!0,onMouseleave:j=>e.isHover=!1},{default:o(()=>[a(v,null,{default:o(()=>[n("div",ce,[a(Y,{variant:"tonal",color:e.color,rounded:""},{default:o(()=>[a(re,{icon:e.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),n("h4",me,m(e.value),1)]),n("div",de,m(e.title),1),n("div",pe,[n("h6",ue,m(e.change>0?"+":"")+" "+m(e.change)+"% ",1),r[0]||(r[0]=n("div",{class:"text-sm text-disabled"}," than last month ",-1))])]),_:2},1024)]),_:2},1032,["onMouseenter","onMouseleave"])]),_:2},1024))),128))]),_:1}),a(_,{class:"mb-6"},{default:o(()=>[a(y,{cols:"12",md:"6"},{default:o(()=>[a(g,null,{default:o(()=>[a(z,{title:"Top 5 Stores by Monthly Sales",subtitle:"Performance comparison"},{append:o(()=>[a($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:o(()=>r[1]||(r[1]=[b(" This Month ")])),_:1,__:[1]})]),_:1}),a(v,null,{default:o(()=>[a(t,{type:"bar",height:"320",options:d(E),series:d(T)},null,8,["options","series"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"6"},{default:o(()=>[a(g,null,{default:o(()=>[a(z,{title:"Top 5 Stores by Monthly Royalty",subtitle:"Royalty contributions"},{append:o(()=>[a($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:o(()=>r[2]||(r[2]=[b(" This Month ")])),_:1,__:[2]})]),_:1}),a(v,null,{default:o(()=>[a(t,{type:"bar",height:"320",options:d(O),series:d(H)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),a(_,{class:"mb-6"},{default:o(()=>[a(y,{cols:"12"},{default:o(()=>[a(g,null,{default:o(()=>[a(v,null,{default:o(()=>[a(t,{type:"line",height:"400",options:d(I),series:d(W)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),a(_,null,{default:o(()=>[a(y,{cols:"12"},{default:o(()=>[a(g,null,{default:o(()=>[a(z,{class:"pb-4"},{default:o(()=>[a(K,null,{default:o(()=>r[3]||(r[3]=[b("Monthly Financial Breakdown")])),_:1,__:[3]}),a(Q,null,{default:o(()=>r[4]||(r[4]=[b("Detailed monthly statistics")])),_:1,__:[4]})]),_:1}),a(le),a(ne,{headers:U,items:d(J),"hide-default-footer":"",class:"text-no-wrap"},{"item.month":o(({item:e})=>[n("div",fe,m(e.month),1)]),"item.sales":o(({item:e})=>[n("div",he,m(e.sales),1)]),"item.expenses":o(({item:e})=>[n("div",ye,m(e.expenses),1)]),"item.royalties":o(({item:e})=>[n("div",ge,m(e.royalties),1)]),"item.profit":o(({item:e})=>[n("div",_e,m(e.profit),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})])}}}),tt=ie(be,[["__scopeId","data-v-31d716e9"]]);export{tt as default};
