import{_ as T}from"./AppTextarea.vue_vue_type_script_setup_true_lang-CsTg_oBX.js";import{_ as U}from"./AppSelect.vue_vue_type_script_setup_true_lang-CSZzORfI.js";import{_ as q}from"./AppTextField.vue_vue_type_script_setup_true_lang-CNhpV2B7.js";import{d as N,r as h,j as M,c2 as D,aL as y,G as F,aO as V,P as E,c as L,o as _,e as c,b as a,aA as g,m as e,f as r,H as k,v as C,aM as O,g as $,l as j,t as A,a3 as H,x as I,de as Y}from"./main-DWvNZBrn.js";import{a as z,b as J}from"./auth-v1-top-shape-Be0n9vOV.js";import{V as b}from"./VNodeRenderer-TRgwjpVh.js";import{a as K,b as Q,V as G}from"./VCard-BRrHEmo0.js";import{V as x}from"./VCardText-CYct27oJ.js";import{V as W}from"./VForm-DAJfMT5j.js";import{V as X,a as m}from"./VRow-DHZpC2G_.js";import{V as Z}from"./VAlert-DkP4tiR6.js";import"./form-tczHMY3v.js";import"./VTextarea-Dd1Z3Bm2.js";/* empty css                   */import"./VCounter-Bl262PHw.js";import"./VImg-g4h63Uey.js";import"./VField-CIhBnyVR.js";import"./easing-Bybner-F.js";import"./VInput-CUQxW0lR.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-Chb4OroE.js";import"./VTextField-BNKDrFXd.js";import"./VList-BI-6-ue7.js";import"./ssrBoot-CPO92_z_.js";import"./VAvatar-BF957B0g.js";import"./VDivider-zd98jbKy.js";import"./dialog-transition-QH9NzXuH.js";import"./VMenu-B8htNi0n.js";import"./VOverlay-C5oQOIIo.js";import"./lazy-6xXLFjDI.js";import"./scopeId-HdLjUcVL.js";import"./VCheckboxBtn-BASNK5CT.js";import"./VSelectionControl-BQfaGVgy.js";import"./VChip-HJm3k2du.js";import"./VSlideGroup-BSWxDDfs.js";/* empty css              */const ee={class:"auth-wrapper d-flex align-center justify-center pa-4"},ae={class:"position-relative my-sm-16"},oe={class:"app-logo"},se={class:"app-logo-title"},je=N({__name:"onboarding",setup(te){const t=h({name:"",phone:"",country:"",state:"",city:"",address:""}),f=h(!1),i=h(null),d=M(),{smAndUp:S}=D(),w=y("userData"),{updateAbility:re}=Y(),P=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Syria",value:"Syria"},{title:"Palestine",value:"Palestine"},{title:"Yemen",value:"Yemen"}];F(async()=>{var p;try{if((await V("/v1/onboarding/status")).profile_completed)switch((p=w.value)==null?void 0:p.role){case"admin":d.push("/admin/dashboard");break;case"franchisor":d.push("/franchisor");break;case"franchisee":d.push("/franchisee/dashboard/sales");break;case"sales":d.push("/sales/lead-management");break;default:d.push("/")}}catch(o){console.error("Failed to check onboarding status:",o)}});const B=async()=>{var p,o;f.value=!0,i.value=null;try{const l=await V("/v1/onboarding/complete",{method:"POST",body:t.value}),n=y("userData");switch(n.value&&(n.value={...n.value,profile_completed:!0,...l.user}),(p=n.value)==null?void 0:p.role){case"admin":d.push("/admin/dashboard");break;case"franchisor":d.push("/franchisor");break;case"franchisee":d.push("/franchisee/dashboard/sales");break;case"sales":d.push("/sales/lead-management");break;default:d.push("/")}}catch(l){const n=(l==null?void 0:l.data)||((o=l==null?void 0:l.response)==null?void 0:o._data)||null;n!=null&&n.errors?i.value=n.errors:i.value={general:[(n==null?void 0:n.message)||"Failed to complete profile. Please try again."]}}finally{f.value=!1}},R=E(()=>t.value.name&&t.value.phone&&t.value.country&&t.value.state&&t.value.city&&t.value.address);return(p,o)=>{const l=q,n=U,v=T;return _(),L("div",ee,[c("div",ae,[a(e(b),{nodes:g("div",{innerHTML:e(z)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),a(e(b),{nodes:g("div",{innerHTML:e(J)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),a(G,{class:I(["auth-card",e(S)?"pa-6":"pa-0"]),"max-width":"600"},{default:r(()=>[a(K,{class:"justify-center"},{default:r(()=>[a(Q,null,{default:r(()=>[c("div",oe,[a(e(b),{nodes:e(k).app.logo},null,8,["nodes"]),c("h1",se,C(e(k).app.title),1)])]),_:1})]),_:1}),a(x,null,{default:r(()=>o[6]||(o[6]=[c("h4",{class:"text-h4 mb-1"}," Complete Your Profile ",-1),c("p",{class:"mb-0"}," Please provide your personal information to complete your account setup ",-1)])),_:1,__:[6]}),a(x,null,{default:r(()=>[a(W,{onSubmit:O(B,["prevent"])},{default:r(()=>[a(X,null,{default:r(()=>[a(m,{cols:"12"},{default:r(()=>{var s;return[(s=e(i))!=null&&s.general?(_(),$(Z,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>[A(C(e(i).general[0]),1)]),_:1})):j("",!0)]}),_:1}),a(m,{cols:"12"},{default:r(()=>{var s;return[a(l,{modelValue:e(t).name,"onUpdate:modelValue":o[0]||(o[0]=u=>e(t).name=u),autofocus:"",label:"Full Name",placeholder:"Name","error-messages":(s=e(i))==null?void 0:s.name,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:r(()=>{var s;return[a(l,{modelValue:e(t).phone,"onUpdate:modelValue":o[1]||(o[1]=u=>e(t).phone=u),label:"Phone Number",placeholder:"+966 50 123 4567","error-messages":(s=e(i))==null?void 0:s.phone,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12",md:"6"},{default:r(()=>{var s;return[a(n,{modelValue:e(t).country,"onUpdate:modelValue":o[2]||(o[2]=u=>e(t).country=u),label:"Country",placeholder:"Select Country",items:P,"error-messages":(s=e(i))==null?void 0:s.country,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12",md:"6"},{default:r(()=>{var s;return[a(l,{modelValue:e(t).state,"onUpdate:modelValue":o[3]||(o[3]=u=>e(t).state=u),label:"State/Province",placeholder:"Riyadh","error-messages":(s=e(i))==null?void 0:s.state,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:r(()=>{var s;return[a(l,{modelValue:e(t).city,"onUpdate:modelValue":o[4]||(o[4]=u=>e(t).city=u),label:"City",placeholder:"Riyadh","error-messages":(s=e(i))==null?void 0:s.city,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:r(()=>{var s;return[a(v,{modelValue:e(t).address,"onUpdate:modelValue":o[5]||(o[5]=u=>e(t).address=u),label:"Address",placeholder:"123 Main Street, Apt 4B","error-messages":(s=e(i))==null?void 0:s.address,rows:"3",required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:r(()=>[a(H,{block:"",type:"submit",loading:e(f),disabled:e(f)||!e(R),color:"primary",size:"large"},{default:r(()=>o[7]||(o[7]=[A(" Complete Profile ")])),_:1,__:[7]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{je as default};
