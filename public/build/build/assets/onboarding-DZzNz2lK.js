import{_ as S}from"./AppTextarea.vue_vue_type_script_setup_true_lang-JUolI5ER.js";import{_ as U}from"./AppTextField.vue_vue_type_script_setup_true_lang-D3n1StTZ.js";import{d as B,r as h,j as D,c2 as M,aL as b,G as N,aO as g,P as R,c as q,o as y,e as c,b as a,aA as _,m as e,f as l,H as v,v as k,aM as F,g as L,l as j,t as C,a3 as H,x as $,de as z}from"./main-DDcdwm3V.js";import{a as O,b as E}from"./auth-v1-top-shape-gPxasD3d.js";import{V}from"./VNodeRenderer-6m_wUKbB.js";import{a as G,b as I,V as J}from"./VCard-Da4wWZa-.js";import{V as x}from"./VCardText-ATWVip1e.js";import{V as Y}from"./VForm-D1MZgsEH.js";import{V as K,a as m}from"./VRow-Du7OY2aM.js";import{V as Q}from"./VAlert-CP8IXMK2.js";import"./form-DClspoHM.js";import"./VTextarea-Ce0clciZ.js";/* empty css                   */import"./VCounter-_sTFn13_.js";import"./VImg-NWIUnknk.js";import"./VField-GCNV1_NY.js";import"./easing-Bybner-F.js";import"./VInput-DwSgT-lP.js";import"./forwardRefs-C-GTDzx5.js";import"./VTextField-B3UCTUVZ.js";import"./VAvatar-C3D4PMay.js";/* empty css              */const W={class:"auth-wrapper d-flex align-center justify-center pa-4"},X={class:"position-relative my-sm-16"},Z={class:"app-logo"},ee={class:"app-logo-title"},we=B({__name:"onboarding",setup(ae){const r=h({name:"",phone:"",country:"",state:"",city:"",address:""}),f=h(!1),d=h(null),i=D(),{smAndUp:w}=M(),A=b("userData"),{updateAbility:se}=z();N(async()=>{var p;try{if((await g("/v1/onboarding/status")).profile_completed)switch((p=A.value)==null?void 0:p.role){case"admin":i.push("/admin/dashboard");break;case"franchisor":i.push("/franchisor");break;case"franchisee":i.push("/franchisee/dashboard/sales");break;case"sales":i.push("/sales/lead-management");break;default:i.push("/")}}catch(s){console.error("Failed to check onboarding status:",s)}});const P=async()=>{var p,s;f.value=!0,d.value=null;try{const t=await g("/v1/onboarding/complete",{method:"POST",body:r.value}),n=b("userData");switch(n.value&&(n.value={...n.value,profile_completed:!0,...t.user}),(p=n.value)==null?void 0:p.role){case"admin":i.push("/admin/dashboard");break;case"franchisor":i.push("/franchisor");break;case"franchisee":i.push("/franchisee/dashboard/sales");break;case"sales":i.push("/sales/lead-management");break;default:i.push("/")}}catch(t){const n=(t==null?void 0:t.data)||((s=t==null?void 0:t.response)==null?void 0:s._data)||null;n!=null&&n.errors?d.value=n.errors:d.value={general:[(n==null?void 0:n.message)||"Failed to complete profile. Please try again."]}}finally{f.value=!1}},T=R(()=>r.value.name&&r.value.phone&&r.value.country&&r.value.state&&r.value.city&&r.value.address);return(p,s)=>{const t=U,n=S;return y(),q("div",W,[c("div",X,[a(e(V),{nodes:_("div",{innerHTML:e(O)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),a(e(V),{nodes:_("div",{innerHTML:e(E)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),a(J,{class:$(["auth-card",e(w)?"pa-6":"pa-0"]),"max-width":"600"},{default:l(()=>[a(G,{class:"justify-center"},{default:l(()=>[a(I,null,{default:l(()=>[c("div",Z,[a(e(V),{nodes:e(v).app.logo},null,8,["nodes"]),c("h1",ee,k(e(v).app.title),1)])]),_:1})]),_:1}),a(x,null,{default:l(()=>s[6]||(s[6]=[c("h4",{class:"text-h4 mb-1"}," Complete Your Profile ",-1),c("p",{class:"mb-0"}," Please provide your personal information to complete your account setup ",-1)])),_:1,__:[6]}),a(x,null,{default:l(()=>[a(Y,{onSubmit:F(P,["prevent"])},{default:l(()=>[a(K,null,{default:l(()=>[a(m,{cols:"12"},{default:l(()=>{var o;return[(o=e(d))!=null&&o.general?(y(),L(Q,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:l(()=>[C(k(e(d).general[0]),1)]),_:1})):j("",!0)]}),_:1}),a(m,{cols:"12"},{default:l(()=>{var o;return[a(t,{modelValue:e(r).name,"onUpdate:modelValue":s[0]||(s[0]=u=>e(r).name=u),autofocus:"",label:"Full Name",placeholder:"John Doe","error-messages":(o=e(d))==null?void 0:o.name,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:l(()=>{var o;return[a(t,{modelValue:e(r).phone,"onUpdate:modelValue":s[1]||(s[1]=u=>e(r).phone=u),label:"Phone Number",placeholder:"+966 50 123 4567","error-messages":(o=e(d))==null?void 0:o.phone,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12",md:"6"},{default:l(()=>{var o;return[a(t,{modelValue:e(r).country,"onUpdate:modelValue":s[2]||(s[2]=u=>e(r).country=u),label:"Country",placeholder:"United States","error-messages":(o=e(d))==null?void 0:o.country,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12",md:"6"},{default:l(()=>{var o;return[a(t,{modelValue:e(r).state,"onUpdate:modelValue":s[3]||(s[3]=u=>e(r).state=u),label:"State/Province",placeholder:"California","error-messages":(o=e(d))==null?void 0:o.state,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:l(()=>{var o;return[a(t,{modelValue:e(r).city,"onUpdate:modelValue":s[4]||(s[4]=u=>e(r).city=u),label:"City",placeholder:"Los Angeles","error-messages":(o=e(d))==null?void 0:o.city,required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:l(()=>{var o;return[a(n,{modelValue:e(r).address,"onUpdate:modelValue":s[5]||(s[5]=u=>e(r).address=u),label:"Address",placeholder:"123 Main Street, Apt 4B","error-messages":(o=e(d))==null?void 0:o.address,rows:"3",required:""},null,8,["modelValue","error-messages"])]}),_:1}),a(m,{cols:"12"},{default:l(()=>[a(H,{block:"",type:"submit",loading:e(f),disabled:e(f)||!e(T),color:"primary",size:"large"},{default:l(()=>s[7]||(s[7]=[C(" Complete Profile ")])),_:1,__:[7]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{we as default};
