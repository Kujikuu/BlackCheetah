import{f as Ue}from"./formatters-WDr9EcLN.js";import{_ as Ce}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BBVjeI7B.js";import{_ as Pe}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DhWC73gc.js";import{_ as Ie}from"./AppSelect.vue_vue_type_script_setup_true_lang-B8w7sLqh.js";import{_ as De}from"./AppTextField.vue_vue_type_script_setup_true_lang-CS3XUpD5.js";import{r as q,e as Ae}from"./validators-BYiRrju8.js";import{N as G,ac as K,bf as Re,V as Q,b as e,ae as me,a3 as P,bA as ze,cg as Fe,P as w,J as Te,bI as $e,bP as Be,aa as D,ch as Ne,bl as j,aE as Ee,af as We,q as re,br as qe,cf as Me,c2 as Le,cS as Oe,bT as pe,ai as je,bS as Ge,ce as He,c7 as Ye,F as ae,d as ge,r as F,w as Je,g as k,f as a,e as d,l as he,m as l,t as h,v as b,au as X,aO as Z,o as y,G as Ke,c as L,j as Qe,a$ as Y,i as ve}from"./main-Bx5MqBCc.js";import{V as Xe}from"./VDialog-Da4LCNox.js";import{b as le,d as xe,V as N,a as fe}from"./VCard-DXwsm8sH.js";import{V as z}from"./VCardText-881-qsDn.js";import{V as se}from"./VAlert-BH88qGLz.js";import{c as Ze,V as H}from"./VAvatar-Dq0WBzTg.js";import{a as ne,m as et,V as ee,b as tt}from"./VWindowItem-BDbMGyIp.js";import{V as ye,m as at}from"./VSheet-D-PI5yV6.js";import{V as de}from"./VDivider-BD3st0Tt.js";import{V as be}from"./VForm-CcS6fukz.js";import{V as O,a as g}from"./VRow-BSfsb00B.js";import{V as lt}from"./VSpacer-iz17AWYx.js";import{a as st,V as _e}from"./VTabs-CODMI5EY.js";import{V as J}from"./VSkeletonLoader-96TCbd3l.js";import{V as Ve}from"./VChip-bIxYFvin.js";import{q as nt}from"./VDataTable-D9ezTJkG.js";import{V as it}from"./VTooltip-DVQAZJkr.js";import"./VField-De9cGA2E.js";import"./form-Csz4zxvN.js";import"./easing-Bybner-F.js";import"./VInput-BjbhE5dO.js";import"./VImg-CzTq61uy.js";import"./VTextarea-CipZwbDl.js";/* empty css                   */import"./VCounter-Bi3axogA.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-BX1t_AVR.js";import"./VTextField-rRgG8u4K.js";import"./VList-Bj_5rawV.js";import"./ssrBoot-CXMLMhxv.js";import"./dialog-transition-C2XWOaDF.js";import"./VMenu-BM_tEo9-.js";import"./VOverlay-3xscGKag.js";import"./lazy-DJP8iQaQ.js";import"./scopeId-DLFuo6Fo.js";import"./VCheckboxBtn-CxMC97UZ.js";import"./VSelectionControl-C67ZBesC.js";/* empty css              */import"./VSlideGroup-rdxh0fbF.js";import"./VPagination-BxAxJSyf.js";import"./VTable-CiDf8Yyj.js";import"./filter-C6vb6ifu.js";const ue=Symbol.for("vuetify:v-stepper"),ke=G({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),ot=K()({name:"VStepperActions",props:ke(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(s,U){let{emit:r,slots:u}=U;const{t:c}=Re();function f(){r("click:prev")}function m(){r("click:next")}return Q(()=>{const i={onClick:f},C={onClick:m};return e("div",{class:"v-stepper-actions"},[e(me,{defaults:{VBtn:{disabled:["prev",!0].includes(s.disabled),text:c(s.prevText),variant:"text"}}},{default:()=>{var S;return[((S=u.prev)==null?void 0:S.call(u,{props:i}))??e(P,i,null)]}}),e(me,{defaults:{VBtn:{color:s.color,disabled:["next",!0].includes(s.disabled),text:c(s.nextText),variant:"tonal"}}},{default:()=>{var S;return[((S=u.next)==null?void 0:S.call(u,{props:C}))??e(P,C,null)]}})])}),{}}}),Se=Ze("v-stepper-header"),rt=G({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:j,default:"$complete"},editable:Boolean,editIcon:{type:j,default:"$edit"},error:Boolean,errorIcon:{type:j,default:"$error"},icon:j,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),dt=G({...rt(),...Ne()},"VStepperItem"),ie=K()({name:"VStepperItem",directives:{Ripple:ze},props:dt(),emits:{"group:selected":s=>!0},setup(s,U){let{slots:r}=U;const u=Fe(s,ue,!0),c=w(()=>(u==null?void 0:u.value.value)??s.value),f=w(()=>s.rules.every($=>$()===!0)),m=w(()=>!s.disabled&&s.editable),i=w(()=>!s.disabled&&s.editable),C=w(()=>s.error||!f.value),S=w(()=>s.complete||s.rules.length>0&&f.value),T=w(()=>C.value?s.errorIcon:S.value?s.completeIcon:u.isSelected.value&&s.editable?s.editIcon:s.icon),A=w(()=>({canEdit:i.value,hasError:C.value,hasCompleted:S.value,title:s.title,subtitle:s.subtitle,step:c.value,value:s.value}));return Q(()=>{var x,o,_;const $=(!u||u.isSelected.value||S.value||i.value)&&!C.value&&!s.disabled,R=!!(s.title!=null||r.title),E=!!(s.subtitle!=null||r.subtitle);function W(){u==null||u.toggle()}return Te(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":S.value,"v-stepper-item--disabled":s.disabled,"v-stepper-item--error":C.value},u==null?void 0:u.selectedClass.value],disabled:!s.editable,type:"button",onClick:W},[m.value&&Be(!0,"v-stepper-item"),e(H,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:$?s.color:void 0,size:24},{default:()=>{var V;return[((V=r.icon)==null?void 0:V.call(r,A.value))??(T.value?e(D,{icon:T.value},null):c.value)]}}),e("div",{class:"v-stepper-item__content"},[R&&e("div",{key:"title",class:"v-stepper-item__title"},[((x=r.title)==null?void 0:x.call(r,A.value))??s.title]),E&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((o=r.subtitle)==null?void 0:o.call(r,A.value))??s.subtitle]),(_=r.default)==null?void 0:_.call(r,A.value)])]),[[$e("ripple"),s.ripple&&s.editable,null]])}),{}}}),ut=G({...qe(et(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),we=K()({name:"VStepperWindow",props:ut(),emits:{"update:modelValue":s=>!0},setup(s,U){let{slots:r}=U;const u=Ee(ue,null),c=We(s,"modelValue"),f=w({get(){var m;return c.value!=null||!u?c.value:(m=u.items.value.find(i=>u.selected.value.includes(i.id)))==null?void 0:m.value},set(m){c.value=m}});return Q(()=>{const m=ne.filterProps(s);return e(ne,re({_as:"VStepperWindow"},m,{modelValue:f.value,"onUpdate:modelValue":i=>f.value=i,class:["v-stepper-window",s.class],style:s.style,mandatory:!1,touch:!1}),r)}),{}}}),ct=G({...tt()},"VStepperWindowItem"),oe=K()({name:"VStepperWindowItem",props:ct(),setup(s,U){let{slots:r}=U;return Q(()=>{const u=ee.filterProps(s);return e(ee,re({_as:"VStepperWindowItem"},u,{class:["v-stepper-window-item",s.class],style:s.style}),r)}),{}}}),mt=G({altLabels:Boolean,bgColor:String,completeIcon:j,editIcon:j,editable:Boolean,errorIcon:j,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...Ye()},"Stepper"),pt=G({...mt(),...He({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...at(),...Ge(ke(),["prevText","nextText"])},"VStepper"),vt=K()({name:"VStepper",props:pt(),emits:{"update:modelValue":s=>!0},setup(s,U){let{slots:r}=U;const{items:u,next:c,prev:f,selected:m}=Me(s,ue),{displayClasses:i,mobile:C}=Le(s),{completeIcon:S,editIcon:T,errorIcon:A,color:$,editable:R,prevText:E,nextText:W}=Oe(s),x=w(()=>s.items.map((V,B)=>{const p=pe(V,s.itemTitle,V),t=pe(V,s.itemValue,B+1);return{title:p,value:t,raw:V}})),o=w(()=>u.value.findIndex(V=>m.value.includes(V.id))),_=w(()=>s.disabled?s.disabled:o.value===0?"prev":o.value===u.value.length-1?"next":!1);return je({VStepperItem:{editable:R,errorIcon:A,completeIcon:S,editIcon:T,prevText:E,nextText:W},VStepperActions:{color:$,disabled:_,prevText:E,nextText:W}}),Q(()=>{const V=ye.filterProps(s),B=!!(r.header||s.items.length),p=s.items.length>0,t=!s.hideActions&&!!(p||r.actions);return e(ye,re(V,{color:s.bgColor,class:["v-stepper",{"v-stepper--alt-labels":s.altLabels,"v-stepper--flat":s.flat,"v-stepper--non-linear":s.nonLinear,"v-stepper--mobile":C.value},i.value,s.class],style:s.style}),{default:()=>{var n,I;return[B&&e(Se,{key:"stepper-header"},{default:()=>[x.value.map((v,M)=>{let{raw:te,...ce}=v;return e(ae,null,[!!M&&e(de,null,null),e(ie,ce,{default:r[`header-item.${ce.value}`]??r.header,icon:r.icon,title:r.title,subtitle:r.subtitle})])})]}),p&&e(we,{key:"stepper-window"},{default:()=>[x.value.map(v=>e(oe,{value:v.value},{default:()=>{var M,te;return((M=r[`item.${v.value}`])==null?void 0:M.call(r,v))??((te=r.item)==null?void 0:te.call(r,v))}}))]}),(n=r.default)==null?void 0:n.call(r,{prev:f,next:c}),t&&(((I=r.actions)==null?void 0:I.call(r,{next:c,prev:f}))??e(ot,{key:"stepper-actions","onClick:prev":f,"onClick:next":c},r))]}})}),{prev:f,next:c}}}),ft={class:"d-flex gap-3"},yt=ge({__name:"AddFranchiseeModal",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchisee-added"],setup(s,{emit:U}){const r=s,u=U,c=F(1),f=F(!1),m=F(null),i=F({name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),C=[{title:"Saudi Arabia",value:"SA"},{title:"United Arab Emirates",value:"AE"},{title:"Qatar",value:"QA"},{title:"Kuwait",value:"KW"},{title:"Oman",value:"OM"},{title:"Bahrain",value:"BH"},{title:"Jordan",value:"JO"},{title:"Lebanon",value:"LB"},{title:"Egypt",value:"EG"},{title:"Iraq",value:"IQ"}],S=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}];Je(()=>r.isDialogVisible,x=>{x&&R()});const T=x=>{u("update:isDialogVisible",x)},A=()=>{c.value<2&&(c.value++,m.value=null)},$=()=>{c.value>1&&(c.value--,m.value=null)},R=()=>{c.value=1,m.value=null,i.value={name:"",email:"",phone:"",country:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},E=async()=>{var x,o,_;if(!i.value.name||!i.value.email||!i.value.phone){m.value="Please fill in all required fields";return}f.value=!0,m.value=null;try{const V=await Z("/v1/franchisor/franchise"),B=((x=V.data)==null?void 0:x.id)||V.id,p={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:B,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,country:i.value.country,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},t=await Z("/v1/franchisor/franchisees-with-unit",{method:"POST",body:p});if(t.success){const n={id:t.data.unit.id,name:t.data.unit.unit_name,email:t.data.franchisee.email,phone:t.data.franchisee.phone,type:t.data.unit.unit_type,sizeSqft:t.data.unit.size_sqft,capacity:null,openingDate:t.data.unit.opening_date,monthlyRent:t.data.unit.monthly_rent,managerId:t.data.unit.franchisee_id,managerName:t.data.franchisee.name,country:t.data.unit.country,state:t.data.unit.state_province,city:t.data.unit.city,address:t.data.unit.address,postalCode:t.data.unit.postal_code};u("franchisee-added",n),T(!1),R()}}catch(V){console.error("Error creating franchisee with unit:",V),m.value=((_=(o=V.response)==null?void 0:o.data)==null?void 0:_.message)||"Failed to create franchisee and unit. Please try again."}finally{f.value=!1}},W=x=>{u("update:isDialogVisible",x),x||R()};return(x,o)=>{const _=De,V=Ie,B=Pe,p=Ce;return y(),k(Xe,{"model-value":r.isDialogVisible,"max-width":"800","onUpdate:modelValue":W},{default:a(()=>[e(N,null,{default:a(()=>[e(le,{class:"text-center"},{default:a(()=>o[16]||(o[16]=[d("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[16]}),e(z,null,{default:a(()=>[l(m)?(y(),k(se,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":o[0]||(o[0]=t=>m.value=null)},{default:a(()=>[h(b(l(m)),1)]),_:1})):he("",!0),e(vt,{modelValue:l(c),"onUpdate:modelValue":o[14]||(o[14]=t=>X(c)?c.value=t:null),"alt-labels":""},{default:a(()=>[e(Se,null,{default:a(()=>[e(ie,{complete:l(c)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(de),e(ie,{value:2,title:"Unit Details"})]),_:1}),e(we,null,{default:a(()=>[e(oe,{value:1},{default:a(()=>[e(be,null,{default:a(()=>[e(O,null,{default:a(()=>[e(g,{cols:"12"},{default:a(()=>[e(_,{modelValue:l(i).name,"onUpdate:modelValue":o[1]||(o[1]=t=>l(i).name=t),label:"Unit Name",placeholder:"Enter unit name",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:a(()=>[e(_,{modelValue:l(i).email,"onUpdate:modelValue":o[2]||(o[2]=t=>l(i).email=t),label:"Email Address",placeholder:"Enter email address",rules:[l(q),l(Ae)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:a(()=>[e(_,{modelValue:l(i).phone,"onUpdate:modelValue":o[3]||(o[3]=t=>l(i).phone=t),label:"Contact Number",placeholder:"Enter contact number",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(V,{modelValue:l(i).country,"onUpdate:modelValue":o[4]||(o[4]=t=>l(i).country=t),items:C,label:"Country",placeholder:"Select country",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:l(i).state,"onUpdate:modelValue":o[5]||(o[5]=t=>l(i).state=t),label:"State",placeholder:"Enter state",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:l(i).city,"onUpdate:modelValue":o[6]||(o[6]=t=>l(i).city=t),label:"City",placeholder:"Enter city",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:a(()=>[e(B,{modelValue:l(i).address,"onUpdate:modelValue":o[7]||(o[7]=t=>l(i).address=t),label:"Address",placeholder:"Enter full address",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:a(()=>[e(se,{type:"info",variant:"tonal",class:"mb-0"},{default:a(()=>[d("strong",null,b(l(i).name||"New franchisee"),1),o[17]||(o[17]=h(" will be automatically assigned as the unit manager. "))]),_:1,__:[17]})]),_:1}),e(g,{cols:"12",md:"6"},{default:a(()=>[e(_,{modelValue:l(i).postalCode,"onUpdate:modelValue":o[8]||(o[8]=t=>l(i).postalCode=t),label:"Postal Code",placeholder:"Enter postal code"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,{value:2},{default:a(()=>[e(be,null,{default:a(()=>[e(O,null,{default:a(()=>[e(g,{cols:"12",md:"6"},{default:a(()=>[e(V,{modelValue:l(i).type,"onUpdate:modelValue":o[9]||(o[9]=t=>l(i).type=t),items:S,label:"Unit Type",placeholder:"Select unit type",rules:[l(q)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:a(()=>[e(p,{modelValue:l(i).openingDate,"onUpdate:modelValue":o[10]||(o[10]=t=>l(i).openingDate=t),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":o[11]||(o[11]=t=>l(i).sizeSqft=t),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:l(i).capacity,"onUpdate:modelValue":o[12]||(o[12]=t=>l(i).capacity=t),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":o[13]||(o[13]=t=>l(i).monthlyRent=t),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"$"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(xe,{class:"justify-space-between pa-6"},{default:a(()=>[l(c)>1?(y(),k(P,{key:0,variant:"outlined",disabled:l(f),onClick:$},{default:a(()=>o[18]||(o[18]=[h(" Previous ")])),_:1,__:[18]},8,["disabled"])):(y(),k(lt,{key:1})),d("div",ft,[e(P,{variant:"outlined",disabled:l(f),onClick:o[15]||(o[15]=t=>T(!1))},{default:a(()=>o[19]||(o[19]=[h(" Cancel ")])),_:1,__:[19]},8,["disabled"]),l(c)<2?(y(),k(P,{key:0,color:"primary",disabled:l(f),onClick:A},{default:a(()=>o[20]||(o[20]=[h(" Next ")])),_:1,__:[20]},8,["disabled"])):(y(),k(P,{key:1,color:"primary",loading:l(f),disabled:l(f),onClick:E},{default:a(()=>o[21]||(o[21]=[h(" Create Unit ")])),_:1,__:[21]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),bt={class:"d-flex align-center justify-space-between"},_t={class:"ms-4"},Vt={class:"text-h4"},gt={key:1},ht={class:"ms-4"},xt={class:"text-h4"},kt={key:1},St={class:"ms-4"},wt={class:"text-h4"},Ut={key:1},Ct={class:"ms-4"},Pt={class:"text-h4"},It={key:1},Dt={class:"text-center py-8"},At={class:"d-flex align-center justify-space-between mb-3"},Rt={class:"text-h6"},zt={class:"mb-2"},Ft={class:"text-body-1"},Tt={class:"mb-2"},$t={class:"text-body-2"},Bt={class:"mb-3"},Nt={class:"text-body-1 font-weight-medium"},Et={class:"text-center"},Wt={class:"text-center"},qt={class:"d-flex align-center gap-x-3"},Mt={class:"text-base font-weight-medium"},Lt={class:"text-body-2 text-disabled"},Ot={class:"text-body-1 font-weight-medium"},jt={class:"text-body-2 text-disabled"},Gt={class:"text-body-1"},Ht={class:"text-body-2 text-disabled"},Yt={class:"text-body-1 font-weight-medium"},Jt={class:"text-body-2 text-disabled"},Kt={class:"text-body-2 text-disabled"},ja=ge({__name:"my-units",setup(s){const U=Qe(),r=F("overview"),u=F([]),c=F(!1),f=F(null),m=F({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),i=F(!1),C=w(()=>m.value.totalUnits||u.value.length),S=w(()=>m.value.activeUnits||u.value.filter(p=>p.status==="active").length),T=w(()=>m.value.pendingUnits||u.value.filter(p=>p.status==="pending").length),A=w(()=>m.value.monthlyRoyalty),$=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],R=p=>p==="active"?"success":p==="pending"?"warning":p==="inactive"?"error":"secondary",E=async()=>{var p;c.value=!0,f.value=null;try{const t=await Z("/v1/franchisor/units");t.success&&t.data.data?u.value=t.data.data.map(n=>{var I,v,M;return{id:n.id,branchName:n.unit_name||"Unnamed Unit",franchiseeName:((I=n.franchisee)==null?void 0:I.name)||"Unassigned",email:((v=n.franchisee)==null?void 0:v.email)||n.email||"unassigned@example.com",contactNumber:((M=n.franchisee)==null?void 0:M.phone)||n.phone||"Not available",address:n.address||"Address not available",city:n.city||"Unknown",state:n.state_province||"Unknown",country:n.country||"Unknown",royaltyPercentage:8.5,contractStartDate:n.lease_start_date||"2024-01-01",renewalDate:n.lease_end_date||"2027-01-01",status:n.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:n.employee_count||0,totalProducts:0,avgRating:0}}):u.value=[]}catch(t){console.error("Failed to load units data:",t),f.value=((p=t==null?void 0:t.data)==null?void 0:p.message)||"Failed to load units data",u.value=[]}finally{c.value=!1}},W=async()=>{var p,t,n,I;try{const v=await Z("/v1/franchisor/units/statistics");v.success&&v.data&&(m.value={totalUnits:v.data.totalUnits||0,activeUnits:v.data.activeUnits||0,pendingUnits:v.data.pendingUnits||0,inactiveUnits:v.data.inactiveUnits||0,totalRevenue:v.data.totalRevenue||0,monthlyRoyalty:v.data.monthlyRoyalty||0,avgRevenuePerUnit:v.data.avgRevenuePerUnit||0,revenueChange:v.data.revenueChange||0,royaltyRate:v.data.royaltyRate||8.5,taskStats:{total:((p=v.data.taskStats)==null?void 0:p.total)||0,completed:((t=v.data.taskStats)==null?void 0:t.completed)||0,pending:((n=v.data.taskStats)==null?void 0:n.pending)||0,completionRate:((I=v.data.taskStats)==null?void 0:I.completionRate)||0}})}catch(v){console.error("Failed to load statistics data:",v)}},x=async()=>{await Promise.all([E(),W()])},o=p=>{U.push(`/franchisor/units/${p}`)},_=()=>{i.value=!0},V=p=>{x()};Ke(()=>{x()});const B=p=>{U.push(`/franchisor/units/${p.id}`)};return(p,t)=>(y(),L("section",null,[e(O,{class:"mb-6"},{default:a(()=>[e(g,{cols:"12"},{default:a(()=>[d("div",bt,[t[7]||(t[7]=d("div",null,[d("h2",{class:"text-h2 mb-1"}," My Units "),d("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",loading:l(c),onClick:_},{default:a(()=>t[6]||(t[6]=[h(" Add Franchisee & Unit ")])),_:1,__:[6]},8,["loading"])])]),_:1})]),_:1}),l(f)?(y(),k(se,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":t[0]||(t[0]=n=>f.value=null)},{default:a(()=>[h(b(l(f)),1)]),_:1})):he("",!0),e(st,{modelValue:l(r),"onUpdate:modelValue":t[1]||(t[1]=n=>X(r)?r.value=n:null),class:"mb-6"},{default:a(()=>[e(_e,{value:"overview"},{default:a(()=>[e(D,{icon:"tabler-dashboard",start:""}),t[8]||(t[8]=h(" Overview "))]),_:1,__:[8]}),e(_e,{value:"units"},{default:a(()=>[e(D,{icon:"tabler-building-store",start:""}),t[9]||(t[9]=h(" All Units "))]),_:1,__:[9]})]),_:1},8,["modelValue"]),e(ne,{modelValue:l(r),"onUpdate:modelValue":t[4]||(t[4]=n=>X(r)?r.value=n:null),class:"disable-tab-transition"},{default:a(()=>[e(ee,{value:"overview"},{default:a(()=>[e(O,{class:"mb-6"},{default:a(()=>[e(g,{cols:"12",md:"3"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{class:"d-flex align-center"},{default:a(()=>[e(H,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:a(()=>[e(D,{icon:"tabler-building-store",size:"26"})]),_:1}),d("div",_t,[t[10]||(t[10]=d("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),d("h4",Vt,[l(c)?(y(),k(Y,{key:0,indeterminate:"",size:"20"})):(y(),L("span",gt,b(l(C)),1))])])]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"3"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{class:"d-flex align-center"},{default:a(()=>[e(H,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:a(()=>[e(D,{icon:"tabler-check",size:"26"})]),_:1}),d("div",ht,[t[11]||(t[11]=d("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),d("h4",xt,[l(c)?(y(),k(Y,{key:0,indeterminate:"",size:"20"})):(y(),L("span",kt,b(l(S)),1))])])]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"3"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{class:"d-flex align-center"},{default:a(()=>[e(H,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:a(()=>[e(D,{icon:"tabler-clock",size:"26"})]),_:1}),d("div",St,[t[12]||(t[12]=d("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),d("h4",wt,[l(c)?(y(),k(Y,{key:0,indeterminate:"",size:"20"})):(y(),L("span",Ut,b(l(T)),1))])])]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"3"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{class:"d-flex align-center"},{default:a(()=>[e(H,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:a(()=>[e(D,{icon:"tabler-currency-riyal",size:"26"})]),_:1}),d("div",Ct,[t[13]||(t[13]=d("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),d("h4",Pt,[l(c)?(y(),k(Y,{key:0,indeterminate:"",size:"20"})):(y(),L("span",It,b(l(Ue)(l(A))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,null,{default:a(()=>[e(fe,{class:"pb-4"},{append:a(()=>[e(P,{variant:"text",color:"primary",onClick:t[2]||(t[2]=n=>r.value="units")},{default:a(()=>t[15]||(t[15]=[h(" View All ")])),_:1,__:[15]})]),default:a(()=>[e(le,null,{default:a(()=>t[14]||(t[14]=[h("Recent Units")])),_:1,__:[14]})]),_:1}),e(z,null,{default:a(()=>[l(c)?(y(),k(O,{key:0},{default:a(()=>[(y(),L(ae,null,ve(3,n=>e(g,{key:n,cols:"12",md:"4"},{default:a(()=>[e(N,{variant:"outlined"},{default:a(()=>[e(z,null,{default:a(()=>[e(J,{type:"text",class:"mb-3"}),e(J,{type:"text",class:"mb-2"}),e(J,{type:"text",class:"mb-2"}),e(J,{type:"text",class:"mb-3"}),e(J,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(u).length===0?(y(),k(O,{key:1},{default:a(()=>[e(g,{cols:"12"},{default:a(()=>[d("div",Dt,[e(D,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),t[17]||(t[17]=d("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),t[18]||(t[18]=d("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",onClick:_},{default:a(()=>t[16]||(t[16]=[h(" Add Your First Unit ")])),_:1,__:[16]})])]),_:1})]),_:1})):(y(),k(O,{key:2},{default:a(()=>[(y(!0),L(ae,null,ve(l(u).slice(0,3),n=>(y(),k(g,{key:n.id,cols:"12",md:"4"},{default:a(()=>[e(N,{variant:"outlined"},{default:a(()=>[e(z,null,{default:a(()=>[d("div",At,[d("h6",Rt,b(n.branchName),1),e(Ve,{color:R(n.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[h(b(n.status),1)]),_:2},1032,["color"])]),d("div",zt,[t[19]||(t[19]=d("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),d("div",Ft,b(n.franchiseeName),1)]),d("div",Tt,[t[20]||(t[20]=d("div",{class:"text-body-2 text-disabled"}," Location ",-1)),d("div",$t,b(n.city)+", "+b(n.state),1)]),d("div",Bt,[t[21]||(t[21]=d("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),d("div",Nt,b(n.royaltyPercentage)+"% ",1)])]),_:2},1024),e(xe,null,{default:a(()=>[e(P,{variant:"text",color:"primary",onClick:I=>o(n.id)},{default:a(()=>t[22]||(t[22]=[h(" View Details ")])),_:2,__:[22]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(ee,{value:"units"},{default:a(()=>[e(N,null,{default:a(()=>[e(fe,{class:"pb-4"},{append:a(()=>[e(P,{color:"primary","prepend-icon":"tabler-plus",loading:l(c),onClick:_},{default:a(()=>t[24]||(t[24]=[h(" Add Franchisee & Unit ")])),_:1,__:[24]},8,["loading"])]),default:a(()=>[e(le,null,{default:a(()=>t[23]||(t[23]=[h("All Franchise Units")])),_:1,__:[23]})]),_:1}),e(de),l(c)?(y(),k(z,{key:0,class:"py-8"},{default:a(()=>[d("div",Et,[e(Y,{indeterminate:"",size:"48",class:"mb-4"}),t[25]||(t[25]=d("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),t[26]||(t[26]=d("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(u).length===0?(y(),k(z,{key:1,class:"py-8"},{default:a(()=>[d("div",Wt,[e(D,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),t[28]||(t[28]=d("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),t[29]||(t[29]=d("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(P,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:_},{default:a(()=>t[27]||(t[27]=[h(" Add Your First Franchisee & Unit ")])),_:1,__:[27]})])]),_:1})):(y(),k(nt,{key:2,items:l(u),headers:$,class:"text-no-wrap","item-value":"id",style:{cursor:"pointer"},"onClick:row":t[3]||(t[3]=(n,{item:I})=>B(I))},{"item.branchInfo":a(({item:n})=>[d("div",qt,[e(H,{size:"34",color:"primary",variant:"tonal"},{default:a(()=>[e(D,{icon:"tabler-building-store",size:"20"})]),_:1}),d("div",null,[d("h6",Mt,b(n.branchName),1),d("div",Lt,b(n.email),1)])])]),"item.franchisee":a(({item:n})=>[d("div",null,[d("div",Ot,b(n.franchiseeName),1),d("div",jt,[e(D,{icon:"tabler-user-check",size:"14",class:"me-1"}),h(" Unit Manager • "+b(n.contactNumber),1)])])]),"item.location":a(({item:n})=>[d("div",null,[d("div",Gt,b(n.city)+", "+b(n.state),1),d("div",Ht,b(n.country),1)])]),"item.royaltyPercentage":a(({item:n})=>[d("div",Yt,b(n.royaltyPercentage)+"% ",1)]),"item.contractPeriod":a(({item:n})=>[d("div",null,[d("div",Jt," Start: "+b(n.contractStartDate),1),d("div",Kt," Renewal: "+b(n.renewalDate),1)])]),"item.status":a(({item:n})=>[e(Ve,{color:R(n.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[h(b(n.status),1)]),_:2},1032,["color"])]),"item.actions":a(({item:n})=>[e(P,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:I=>o(n.id)},{default:a(()=>[e(D,{icon:"tabler-eye"}),e(it,{activator:"parent"},{default:a(()=>t[30]||(t[30]=[h(" View Unit Details ")])),_:1,__:[30]})]),_:2},1032,["onClick"])]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(yt,{"is-dialog-visible":l(i),"onUpdate:isDialogVisible":t[5]||(t[5]=n=>X(i)?i.value=n:null),onFranchiseeAdded:V},null,8,["is-dialog-visible"])]))}});export{ja as default};
