import{m as B}from"./vue3-apexcharts-soVH-Ma5.js";import{V as E}from"./VCardText-BD5AHO-w.js";import{V as X}from"./VAvatar-12xz6mHy.js";import{d as z,g as $,o as d,f as t,b as e,l as W,e as a,ax as T,v as m,r as p,G as j,P as Y,t as V,c as v,m as s,x as Z,b5 as O,aF as oe,a as re,F as I,i as N,q as le,a9 as ne,aR as q}from"./main-gemCwVks.js";import{V as F,a as H,b as P,c as J}from"./VCard-DJ82mpnW.js";import{V as C}from"./VSkeletonLoader-D0dxFM6H.js";import{V as G}from"./VChip-DlNApjyg.js";import{_ as ie}from"./AddEditFranchiseeDrawer.vue_vue_type_script_setup_true_lang-DCCM2kV0.js";import{_ as ce}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-S_rwAynV.js";import{_ as de}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-CHGkWaYX.js";import{_ as ue}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-CEFv26gJ.js";import{a as D,V as L}from"./VRow-DiX7eN30.js";import{V as pe}from"./VAlert-RufLsxZw.js";import{V as he}from"./VDivider-B4ry9pxl.js";import{V as fe}from"./VTable-0Z68chLt.js";import{V as me}from"./VImg-DSB6m92Q.js";import{V as Q}from"./VTooltip-CVtgTmoh.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VSlideGroup-CEWgOBQJ.js";import"./validators-BHkKs9Dp.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import"./form-DjHlhIbZ.js";import"./VSelect-C9dxRhag.js";import"./VTextField-BhxF6EAD.js";import"./VField-CsHfcJSz.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-B3GinL-f.js";import"./VList-MyW-iB3v.js";import"./dialog-transition-C9rYmnXC.js";import"./VMenu-CeaiRCNz.js";import"./VOverlay-p8m6-W96.js";import"./scopeId-BgtgI3QF.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import"./VNavigationDrawer-Clc9fIeI.js";import"./VForm-FUZpY-zG.js";import"./VSpacer-Cpeayo2U.js";/* empty css              */import"./formatters--UtN2sCw.js";import"./VDialog-6C-NQXCx.js";const _e={class:"text-h5"},ve={class:"text-sm"},xe=z({__name:"CardStatisticsVertical",props:{title:{},color:{default:"primary"},icon:{},stats:{},height:{},series:{},chartOptions:{}},setup(S){const u=S;return(_,y)=>{const c=B;return d(),$(F,null,{default:t(()=>[e(E,{class:"d-flex flex-column pb-0"},{default:t(()=>[u.icon?(d(),$(X,{key:0,size:"42",variant:"tonal",color:u.color,rounded:"",class:"mb-2"},{default:t(()=>[e(T,{icon:u.icon,size:"26"},null,8,["icon"])]),_:1},8,["color"])):W("",!0),a("h5",_e,m(u.stats),1),a("div",ve,m(u.title),1)]),_:1}),e(c,{series:u.series,options:u.chartOptions,height:u.height},null,8,["series","options","height"])]),_:1})}}}),ge={key:0,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},be={key:1,class:"text-center text-error text-sm mt-3"},ye={key:2,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},we={class:"text-h4 text-center"},Ve=z({__name:"AdminRequestsChart",setup(S){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{name:"Requests",data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const l=await O("/v1/admin/dashboard/chart-data");if(l.success&&l.data.requests){const i=l.data.requests.slice(-7),h=i.map(f=>f.requests);k.value=[{name:"Requests",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,R)=>f+R.requests,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching requests chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const w={warning:"#FFB400"},x=Y(()=>({chart:{height:90,parentHeightOffset:0,type:"bar",toolbar:{show:!1}},tooltip:{enabled:!1},plotOptions:{bar:{barHeight:"100%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4,colors:{backgroundBarColors:[w.warning,w.warning,w.warning,w.warning,w.warning,w.warning,w.warning],backgroundBarRadius:4}}},colors:[w.warning],grid:{show:!1,padding:{top:-30,left:-16,bottom:0,right:-6}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},yaxis:{labels:{show:!1}},responsive:[{breakpoint:1264,options:{plotOptions:{bar:{borderRadius:6,columnWidth:"30%",colors:{backgroundBarRadius:6}}}}}]}));return(l,i)=>{const h=B;return d(),$(F,null,{default:t(()=>[e(H,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[V("Technical Requests")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[V("Last Week")])),_:1,__:[1]})]),_:1}),e(E,null,{default:t(()=>[e(h,{options:s(x),series:s(k),height:62},null,8,["options","series"]),s(u)?(d(),v("div",ge,[e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"40px"})])):s(_)?(d(),v("div",be,m(s(_)),1)):(d(),v("div",ye,[a("h4",we,m(s(y).toLocaleString()),1),a("div",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),ke={class:"d-flex flex-column"},Ce={key:0},$e={key:1},De={key:2},Ue={class:"text-h3 mb-2"},Fe={key:1,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Se={key:2,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Re=z({__name:"AdminRevenueGrowth",setup(S){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const x=await O("/v1/admin/dashboard/chart-data");if(x.success&&x.data.revenue){const l=x.data.revenue.slice(-7),i=l.map(g=>g.revenue);k.value=[{data:i}];const h=i[i.length-1]||0,b=i[i.length-2]||0;y.value=l.reduce((g,f)=>g+f.revenue,0),b>0?c.value=(h-b)/b*100:c.value=h>0?100:0}}catch(x){console.error("Error fetching revenue chart data:",x),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const w=Y(()=>{const x="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",l={success:"#56CA00"};return{chart:{height:162,type:"bar",parentHeightOffset:0,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"80%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:6,distributed:!0}},tooltip:{enabled:!1},grid:{show:!1,padding:{top:-20,bottom:-12,left:-10,right:0}},colors:[l.success,l.success,l.success,l.success,l.success,l.success,l.success],dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:x,fontSize:"13px"}}},yaxis:{labels:{show:!1}},states:{hover:{filter:{type:"none"}}},responsive:[{breakpoint:1640,options:{plotOptions:{bar:{columnWidth:"40%",borderRadius:6}}}}]}});return(x,l)=>{const i=B;return d(),$(F,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between"},{default:t(()=>[a("div",ke,[l[2]||(l[2]=a("div",{class:"mb-auto"},[a("h5",{class:"text-h5 text-no-wrap mb-2"}," Revenue Growth "),a("div",{class:"text-body-1"}," Last 7 Months ")],-1)),s(u)?(d(),v("div",Ce,[e(C,{type:"text",width:"100px",height:"32px",class:"mb-2"}),e(C,{type:"chip",width:"60px",height:"24px"})])):s(_)?(d(),v("div",$e,[l[1]||(l[1]=a("h5",{class:"text-h3 mb-2 text-error"}," Error ",-1)),e(G,{label:"",color:"error",size:"small"},{default:t(()=>l[0]||(l[0]=[V(" Failed to load ")])),_:1,__:[0]})])):(d(),v("div",De,[a("h5",Ue," SAR "+m(s(y).toLocaleString()),1),e(G,{label:"",color:s(c)>=0?"success":"error",size:"small"},{default:t(()=>[V(m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",1)]),_:1},8,["color"])]))]),a("div",null,[!s(u)&&!s(_)?(d(),$(i,{key:0,options:s(w),series:s(k),height:162},null,8,["options","series"])):s(u)?(d(),v("div",Fe,[e(oe,{indeterminate:"",color:"primary",size:"40"})])):(d(),v("div",Se,[e(T,{icon:"tabler-alert-circle",color:"error",size:"40"})]))])]),_:1})]),_:1})}}}),Le={key:0,class:"d-flex align-center justify-space-between gap-x-2"},Te={key:1,class:"text-center text-error text-sm"},Oe={key:2,class:"d-flex align-center justify-space-between gap-x-2"},Ee={class:"text-h4 text-center"},ze=z({__name:"AdminUsersChart",setup(S){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{name:"Users",data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const l=await O("/v1/admin/dashboard/chart-data");if(l.success&&l.data.users){const i=l.data.users.slice(-7),h=i.map(f=>f.users);k.value=[{name:"Users",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,R)=>f+R.users,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const x={chart:{type:"area",parentHeightOffset:0,toolbar:{show:!1},sparkline:{enabled:!0}},markers:{colors:"transparent",strokeColors:"transparent"},grid:{show:!1},colors:[{primary:"#9155FD"}.primary],fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.5,opacityTo:.07,stops:[0,80,100]}},dataLabels:{enabled:!1},stroke:{width:2,curve:"smooth"},xaxis:{show:!0,lines:{show:!1},labels:{show:!1},stroke:{width:0},axisBorder:{show:!1}},yaxis:{stroke:{width:0},show:!1},tooltip:{enabled:!1}};return(l,i)=>{const h=B;return d(),$(F,null,{default:t(()=>[e(H,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[V(" Total Users ")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[V(" Last 7 Days ")])),_:1,__:[1]})]),_:1}),e(h,{options:x,series:s(k),height:68},null,8,["series"]),e(E,{class:"pt-1"},{default:t(()=>[s(u)?(d(),v("div",Le,[e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"40px"})])):s(_)?(d(),v("div",Te,m(s(_)),1)):(d(),v("div",Oe,[a("h4",Ee,m(s(y).toLocaleString()),1),a("span",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),Ae={class:"d-flex justify-space-between"},qe={class:"d-flex flex-column gap-y-1"},Be={class:"d-flex align-center gap-x-4"},je={key:1},Me={class:"d-flex flex-column"},Ie={class:"text-base font-weight-medium"},Ne={class:"text-sm text-medium-emphasis"},We={class:"d-flex align-center gap-x-2"},Ge={class:"text-capitalize text-high-emphasis text-body-1"},He={class:"text-body-1"},Pe={class:"d-flex gap-1"},Et=z({__name:"dashboard",setup(S){const u=p([]),_=p([]),y=p(!0),c=p(""),k=async()=>{try{const r=await O("/v1/admin/dashboard/stats");r.success&&(u.value=r.data)}catch(r){console.error("Error fetching stats:",r),c.value="Failed to load dashboard statistics"}},U=async()=>{try{const r=await O("/v1/admin/dashboard/recent-users");r.success&&(_.value=r.data)}catch(r){console.error("Error fetching recent users:",r),c.value="Failed to load recent users"}},w=async()=>{y.value=!0,c.value="";try{await Promise.all([k(),U()])}catch(r){console.error("Error loading dashboard data:",r),c.value="Failed to load dashboard data"}finally{y.value=!1}};j(()=>{w()});const x=r=>{const o=r.toLowerCase();return o==="franchisor"?{color:"success",icon:"tabler-building-store"}:o==="franchisee"?{color:"info",icon:"tabler-user-check"}:o==="sales"?{color:"warning",icon:"tabler-chart-line"}:{color:"primary",icon:"tabler-user"}},l=r=>{const o=r.toLowerCase();return o==="pending"?"warning":o==="active"?"success":o==="inactive"?"secondary":"primary"},i=p(!1),h=p(!1),b=p(!1),g=p(!1),f=p(null),R=r=>{f.value=r,i.value=!0},K=r=>{f.value={...r},r.role==="franchisor"?h.value=!0:r.role==="franchisee"?b.value=!0:r.role==="sales"&&(g.value=!0)},ee=()=>{f.value&&K(f.value)},M=r=>{const o=_.value.findIndex(A=>A.id===r.id);o!==-1&&(_.value[o]={..._.value[o],...r}),f.value=null},te=r=>r==="franchisor"?"Franchisor":r==="franchisee"?"Franchisee":r==="sales"?"Sales User":"User",se=r=>!r||typeof r!="string"?"U":r.split(" ").map(o=>o.charAt(0)).join("").toUpperCase();return(r,o)=>{const A=re("IconBtn");return d(),v("section",null,[e(L,{class:"mb-6"},{default:t(()=>[e(D,{cols:"12"},{default:t(()=>o[5]||(o[5]=[a("div",{class:"d-flex align-center justify-space-between"},[a("div",null,[a("h2",{class:"text-h2 mb-1"}," Admin Dashboard "),a("p",{class:"text-body-1 text-medium-emphasis"}," Welcome back! Here's what's happening with your platform today. ")])],-1)])),_:1,__:[5]})]),_:1}),s(c)?(d(),$(L,{key:0,class:"mb-6"},{default:t(()=>[e(D,{cols:"12"},{default:t(()=>[e(pe,{type:"error",variant:"tonal",closable:"","onClick:close":o[0]||(o[0]=n=>c.value="")},{default:t(()=>[V(m(s(c)),1)]),_:1})]),_:1})]),_:1})):W("",!0),e(L,{class:"mb-6"},{default:t(()=>[s(y)?(d(),v(I,{key:0},N(4,n=>e(D,{key:n,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(F,null,{default:t(()=>[e(E,null,{default:t(()=>[a("div",Ae,[a("div",qe,[e(C,{type:"text",width:"80px"}),e(C,{type:"text",width:"60px",height:"32px"}),e(C,{type:"text",width:"120px"})]),e(C,{type:"avatar",size:"42"})])]),_:1})]),_:1})]),_:2},1024)),64)):W("",!0),(d(!0),v(I,null,N(s(u),n=>(d(),$(D,{key:n.title,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(xe,le({ref_for:!0},n),null,16)]),_:2},1024))),128))]),_:1}),e(L,{class:"mb-6"},{default:t(()=>[e(D,{cols:"12",md:"4"},{default:t(()=>[e(ze)]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(Re)]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(Ve)]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(D,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[e(H,{class:"pb-4"},{append:t(()=>[e(ne,{variant:"outlined",color:"primary",size:"small",to:{name:"admin-users-franchisors"}},{default:t(()=>o[8]||(o[8]=[V(" View All ")])),_:1,__:[8]})]),default:t(()=>[e(P,null,{default:t(()=>o[6]||(o[6]=[V("Recent Users")])),_:1,__:[6]}),e(J,null,{default:t(()=>o[7]||(o[7]=[V("Latest registered users")])),_:1,__:[7]})]),_:1}),e(he),e(fe,{class:"text-no-wrap"},{default:t(()=>[o[11]||(o[11]=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," USER "),a("th",{scope:"col"}," ROLE "),a("th",{scope:"col"}," STATUS "),a("th",{scope:"col"}," JOINED DATE "),a("th",{scope:"col"}," ACTIONS ")])],-1)),a("tbody",null,[(d(!0),v(I,null,N(s(_),n=>(d(),v("tr",{key:n.id},[a("td",null,[a("div",Be,[e(X,{size:"34",variant:n.avatar?void 0:"tonal",color:n.avatar?void 0:x(n.role).color},{default:t(()=>[n.avatar?(d(),$(me,{key:0,src:n.avatar},null,8,["src"])):(d(),v("span",je,m(se(n.fullName)),1))]),_:2},1032,["variant","color"]),a("div",Me,[a("h6",Ie,m(n.fullName),1),a("div",Ne,m(n.email),1)])])]),a("td",null,[a("div",We,[e(T,{size:22,icon:x(n.role).icon,color:x(n.role).color},null,8,["icon","color"]),a("div",Ge,m(n.role),1)])]),a("td",null,[e(G,{color:l(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[V(m(n.status),1)]),_:2},1032,["color"])]),a("td",null,[a("div",He,m(n.joinedDate),1)]),a("td",null,[a("div",Pe,[e(A,{size:"small",onClick:ae=>R(n)},{default:t(()=>[e(T,{icon:"tabler-eye"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>o[9]||(o[9]=[V(" View ")])),_:1,__:[9]})]),_:2},1032,["onClick"]),e(A,{size:"small",onClick:ae=>K(n)},{default:t(()=>[e(T,{icon:"tabler-edit"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>o[10]||(o[10]=[V(" Edit ")])),_:1,__:[10]})]),_:2},1032,["onClick"])])])]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),e(ue,{"is-dialog-open":s(i),"onUpdate:isDialogOpen":o[1]||(o[1]=n=>q(i)?i.value=n:null),user:s(f),"user-type":s(f)?te(s(f).role):"User",onEdit:ee},null,8,["is-dialog-open","user","user-type"]),e(ce,{"is-drawer-open":s(h),"onUpdate:isDrawerOpen":o[2]||(o[2]=n=>q(h)?h.value=n:null),franchisor:s(f),onFranchisorData:M},null,8,["is-drawer-open","franchisor"]),e(ie,{"is-drawer-open":s(b),"onUpdate:isDrawerOpen":o[3]||(o[3]=n=>q(b)?b.value=n:null),franchisee:s(f),onFranchiseeData:M},null,8,["is-drawer-open","franchisee"]),e(de,{"is-drawer-open":s(g),"onUpdate:isDrawerOpen":o[4]||(o[4]=n=>q(g)?g.value=n:null),"sales-user":s(f),onSalesUserData:M},null,8,["is-drawer-open","sales-user"])])}}});export{Et as default};
