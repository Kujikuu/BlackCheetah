import{V as we,_ as ke}from"./VDataTableServer-2_QzWqQ8.js";import{_ as he}from"./AppTextField.vue_vue_type_script_setup_true_lang-CjJGDy36.js";import{_ as Se}from"./AppSelect.vue_vue_type_script_setup_true_lang-bLssYecD.js";import{_ as Le}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-DLWK1B1r.js";import{l as w}from"./lead-C1g8fbBw.js";import{d as Ue,r as i,P as De,w as Ae,G as Ne,c as W,e as n,b as l,f as a,au as c,m as s,j as Ee,a as Ie,o as $,F as $e,i as Fe,g as Q,v as d,x as Be,aa as D,t as u,l as Pe,a3 as p}from"./main-CA5_5-fk.js";import{V as G,a as F}from"./VRow-Ct-W2dAj.js";import{V as B,a as z,b as R,d as H}from"./VCard-BlRUAaMY.js";import{V as K}from"./VDialog-BNpBCbFf.js";import{V as A}from"./VCardText-A5LE6kSN.js";import{V as X}from"./VAvatar-DYIYaXHU.js";import{V as Y}from"./VDivider-Bv9wRwWR.js";import{V as j}from"./VSpacer-QI7PbBCv.js";import{V as Te}from"./VMenu-CPDfVQZz.js";import{V as ze,a as Z,b as ee}from"./VList-Abz5zQko.js";import{V as Re}from"./VChip-C6OnuAx-.js";import{V as je}from"./VFileInput-BgxvYusJ.js";import"./VPagination-3zfgEHOG.js";import"./VDataTable-D73IjFcA.js";import"./VSelect-BuMSRPjV.js";import"./VTextField-tUni67cb.js";/* empty css                   */import"./VCounter-DEC0uZ17.js";import"./VImg-FsxkdVsl.js";import"./VField-8nFUoH-R.js";import"./form-bs2DZzDf.js";import"./easing-Bybner-F.js";import"./VInput-DhYwEXiV.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Dkald8FM.js";import"./VOverlay-4pSpEGjx.js";import"./lazy-CN-iBTrZ.js";import"./scopeId-7q-wGPVf.js";import"./VCheckboxBtn-QLEgM55C.js";import"./VSelectionControl-DNfMVlT-.js";import"./VTable-B8DFGBPB.js";import"./filter-B6krjMCu.js";import"./AppTextarea.vue_vue_type_script_setup_true_lang-zsWzZhIh.js";import"./VTextarea-9czDO3yE.js";import"./VForm-BqXaPedu.js";/* empty css              */import"./ssrBoot-B8_MECfQ.js";import"./VSlideGroup-CwmyEgo9.js";const Oe={class:"d-flex mb-6"},qe={class:"d-flex justify-space-between"},Me={class:"d-flex flex-column gap-y-1"},Je={class:"text-body-1 text-high-emphasis"},We={class:"d-flex gap-x-2 align-center"},Qe={class:"text-h4"},Ge={class:"me-3 d-flex gap-3"},He={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ke={style:{"inline-size":"15.625rem"}},Xe={class:"text-body-1 font-weight-medium"},Ye={class:"d-flex align-center gap-x-4"},Ze={class:"d-flex flex-column"},et={class:"text-body-1"},tt={class:"text-body-1"},lt={class:"text-body-1"},at={class:"text-body-1"},ot={class:"text-body-1 text-capitalize"},st={class:"text-body-1"},nt={class:"text-body-1"},it={class:"mb-4"},Yt=Ue({__name:"lead-management",setup(rt){const k=i(""),h=i(),S=i(),L=i(),N=i(!1),O=i(null),g=i(!1),x=i(!1),b=i(null),V=i(!1),C=i(null),f=i(10),v=i(1),q=i(),M=i(),m=i([]),te=o=>{var e,r;q.value=(e=o.sortBy[0])==null?void 0:e.key,M.value=(r=o.sortBy[0])==null?void 0:r.order,U()},le=o=>o>0?`+${o}`:o,ae=o=>o.split(" ").map(e=>e[0]).join("").toUpperCase(),oe=[{title:"#",key:"index",sortable:!1},{title:"Lead Name",key:"name"},{title:"Company",key:"company"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Location",key:"location"},{title:"Source",key:"source"},{title:"Status",key:"status"},{title:"Owner",key:"owner"},{title:"Last Contacted",key:"lastContacted"},{title:"Actions",key:"actions",sortable:!1}],E=i([]),I=i(0),J=i([]),se=De(()=>E.value),U=async()=>{try{V.value=!0,C.value=null;const o=await w.getLeads({status:h.value,source:S.value,owner:L.value,search:k.value,itemsPerPage:f.value,page:v.value,sortBy:q.value,orderBy:M.value});o.success&&(E.value=o.leads,I.value=o.total)}catch(o){C.value=o.message||"Failed to fetch leads",console.error("Error fetching leads:",o)}finally{V.value=!1}},P=async()=>{try{const o=await w.getStatistics();o.success&&(J.value=o.data)}catch(o){console.error("Error fetching statistics:",o)}};Ae([k,h,S,L,v,f],()=>{U()}),Ne(()=>{U(),P()});const ne=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Email Campaign",value:"email"}],ie=[{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"}],re=[{title:"Sarah Johnson",value:"sarah_johnson"},{title:"John Smith",value:"john_smith"},{title:"Michael Brown",value:"michael_brown"}],de=o=>{const e=o.toLowerCase();return e==="qualified"?"success":e==="unqualified"?"error":"primary"},ue=o=>{b.value=o,x.value=!0},me=async()=>{if(b.value!==null)try{if(V.value=!0,(await w.deleteLead(b.value)).success){const e=E.value.findIndex(_=>_.id===b.value);e!==-1&&E.value.splice(e,1);const r=m.value.findIndex(_=>_===b.value);r!==-1&&m.value.splice(r,1),I.value--}}catch(o){console.error("Error deleting lead:",o),C.value=o.message||"Failed to delete lead"}finally{V.value=!1,x.value=!1,b.value=null}},ce=async()=>{if(m.value.length!==0)try{V.value=!0,(await w.bulkDelete(m.value)).success&&(await U(),await P(),m.value=[])}catch(o){console.error("Error bulk deleting leads:",o),C.value=o.message||"Failed to delete leads"}finally{V.value=!1}},y=i(null),pe=o=>{const e=o.target;e.files&&e.files[0]&&(y.value=e.files[0])},fe=()=>{const o=`First Name,Last Name,Email,Phone,Company,Country,State,City,Lead Source,Lead Status,Lead Owner
John,Doe,john.doe@example.com,+1234567890,Example Corp,USA,California,Los Angeles,Website,qualified,Sarah Johnson`,e=new Blob([o],{type:"text/csv"}),r=window.URL.createObjectURL(e),_=document.createElement("a");_.href=r,_.download="leads_example.csv",_.click(),window.URL.revokeObjectURL(r)},ve=async()=>{if(!y.value){C.value="Please select a CSV file";return}try{V.value=!0,(await w.importCsv(y.value)).success&&(await U(),await P(),g.value=!1,y.value=null)}catch(o){console.error("Error importing CSV:",o),C.value=o.message||"Failed to import CSV"}finally{V.value=!1}},_e=()=>{const o=m.value.length>0?m.value:void 0,e=w.exportCsv(o),r=document.createElement("a");r.href=e,r.download=`leads_${m.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},Ve=o=>{O.value=o,N.value=!0},ye=()=>{console.log("Note added successfully")},ge=Ee(),xe=()=>{ge.push({name:"sales-add-lead"})};return(o,e)=>{const r=Se,_=he,be=Ie("RouterLink"),Ce=ke;return $(),W("section",null,[n("div",Oe,[l(G,null,{default:a(()=>[($(!0),W($e,null,Fe(s(J),(t,T)=>($(),Q(F,{key:T,cols:"12",md:"4",sm:"6"},{default:a(()=>[l(B,null,{default:a(()=>[l(A,null,{default:a(()=>[n("div",qe,[n("div",Me,[n("div",Je,d(t.title),1),n("div",We,[n("h4",Qe,d(t.value),1),n("div",{class:Be(["text-base",t.change>0?"text-success":"text-error"])}," ("+d(le(t.change))+"%) ",3)])]),l(X,{color:t.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[l(D,{icon:t.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l(B,{class:"mb-6"},{default:a(()=>[l(z,{class:"pb-4"},{default:a(()=>[l(R,null,{default:a(()=>e[16]||(e[16]=[u("Filters")])),_:1,__:[16]})]),_:1}),l(A,null,{default:a(()=>[l(G,null,{default:a(()=>[l(F,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(S),"onUpdate:modelValue":e[0]||(e[0]=t=>c(S)?S.value=t:null),placeholder:"Select Source",items:ne,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(F,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(h),"onUpdate:modelValue":e[1]||(e[1]=t=>c(h)?h.value=t:null),placeholder:"Select Status",items:ie,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(F,{cols:"12",sm:"4"},{default:a(()=>[l(r,{modelValue:s(L),"onUpdate:modelValue":e[2]||(e[2]=t=>c(L)?L.value=t:null),placeholder:"Select Owner",items:re,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(Y),l(A,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[n("div",Ge,[l(r,{"model-value":s(f),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=parseInt(t,10))},null,8,["model-value"]),s(m).length>0?($(),Q(p,{key:0,variant:"tonal",color:"error",onClick:ce},{default:a(()=>[l(D,{icon:"tabler-trash",class:"me-2"}),u(" Delete Selected ("+d(s(m).length)+") ",1)]),_:1})):Pe("",!0)]),l(j),n("div",He,[n("div",Ke,[l(_,{modelValue:s(k),"onUpdate:modelValue":e[4]||(e[4]=t=>c(k)?k.value=t:null),placeholder:"Search Lead"},null,8,["modelValue"])]),l(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-file-import",onClick:e[5]||(e[5]=t=>g.value=!0)},{default:a(()=>e[17]||(e[17]=[u(" Import ")])),_:1,__:[17]}),l(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:_e},{default:a(()=>[u(" Export "+d(s(m).length>0?`(${s(m).length})`:"All"),1)]),_:1}),l(p,{"prepend-icon":"tabler-plus",onClick:xe},{default:a(()=>e[18]||(e[18]=[u(" Add Lead ")])),_:1,__:[18]})])]),_:1}),l(Y),l(we,{"items-per-page":s(f),"onUpdate:itemsPerPage":e[7]||(e[7]=t=>c(f)?f.value=t:null),"model-value":s(m),"onUpdate:modelValue":e[8]||(e[8]=t=>c(m)?m.value=t:null),page:s(v),"onUpdate:page":e[9]||(e[9]=t=>c(v)?v.value=t:null),items:s(se),"item-value":"id","items-length":s(I),headers:oe,class:"text-no-wrap","show-select":"","onUpdate:options":te},{"item.index":a(({index:t})=>[n("div",Xe,d((s(v)-1)*s(f)+t+1),1)]),"item.name":a(({item:t})=>[n("div",Ye,[l(X,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[n("span",null,d(ae(`${t.firstName} ${t.lastName}`)),1)]),_:2},1024),n("div",Ze,[l(be,{to:{name:"sales-leads-id",params:{id:t.id}},class:"text-link"},{default:a(()=>[u(d(t.firstName)+" "+d(t.lastName),1)]),_:2},1032,["to"])])])]),"item.company":a(({item:t})=>[n("div",et,d(t.company),1)]),"item.email":a(({item:t})=>[n("div",tt,d(t.email),1)]),"item.phone":a(({item:t})=>[n("div",lt,d(t.phone),1)]),"item.location":a(({item:t})=>[n("div",at,d(t.city)+", "+d(t.state),1)]),"item.source":a(({item:t})=>[n("div",ot,d(t.source),1)]),"item.status":a(({item:t})=>[l(Re,{color:de(t.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[u(d(t.status),1)]),_:2},1032,["color"])]),"item.owner":a(({item:t})=>[n("div",st,d(t.owner),1)]),"item.lastContacted":a(({item:t})=>[n("div",nt,d(t.lastContacted),1)]),"item.actions":a(({item:t})=>[l(p,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[l(D,{icon:"tabler-dots-vertical"}),l(Te,{activator:"parent"},{default:a(()=>[l(ze,null,{default:a(()=>[l(Z,{onClick:T=>Ve(t.id)},{prepend:a(()=>[l(D,{icon:"tabler-note"})]),default:a(()=>[l(ee,null,{default:a(()=>e[19]||(e[19]=[u("Add Note")])),_:1,__:[19]})]),_:2},1032,["onClick"]),l(Z,{onClick:T=>ue(t.id)},{prepend:a(()=>[l(D,{icon:"tabler-trash"})]),default:a(()=>[l(ee,null,{default:a(()=>e[20]||(e[20]=[u("Delete")])),_:1,__:[20]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[l(Ce,{page:s(v),"onUpdate:page":e[6]||(e[6]=t=>c(v)?v.value=t:null),"items-per-page":s(f),"total-items":s(I)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),l(K,{modelValue:s(g),"onUpdate:modelValue":e[12]||(e[12]=t=>c(g)?g.value=t:null),"max-width":"600"},{default:a(()=>[l(B,null,{default:a(()=>[l(z,null,{default:a(()=>[l(R,null,{default:a(()=>e[21]||(e[21]=[u("Import Leads from CSV")])),_:1,__:[21]})]),_:1}),l(A,null,{default:a(()=>[n("div",it,[l(p,{variant:"tonal",color:"secondary",size:"small","prepend-icon":"tabler-download",onClick:fe},{default:a(()=>e[22]||(e[22]=[u(" Download Example CSV ")])),_:1,__:[22]})]),l(je,{modelValue:s(y),"onUpdate:modelValue":e[10]||(e[10]=t=>c(y)?y.value=t:null),label:"Select CSV File",accept:".csv","prepend-icon":"tabler-file-upload","show-size":"",onChange:pe},null,8,["modelValue"])]),_:1}),l(H,null,{default:a(()=>[l(j),l(p,{color:"secondary",variant:"tonal",onClick:e[11]||(e[11]=t=>g.value=!1)},{default:a(()=>e[23]||(e[23]=[u(" Cancel ")])),_:1,__:[23]}),l(p,{color:"primary",onClick:ve},{default:a(()=>e[24]||(e[24]=[u(" Import ")])),_:1,__:[24]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:s(x),"onUpdate:modelValue":e[14]||(e[14]=t=>c(x)?x.value=t:null),"max-width":"500"},{default:a(()=>[l(B,null,{default:a(()=>[l(z,null,{default:a(()=>[l(R,null,{default:a(()=>e[25]||(e[25]=[u("Confirm Delete")])),_:1,__:[25]})]),_:1}),l(A,null,{default:a(()=>e[26]||(e[26]=[u(" Are you sure you want to delete this lead? This action cannot be undone. ")])),_:1,__:[26]}),l(H,null,{default:a(()=>[l(j),l(p,{color:"secondary",variant:"tonal",onClick:e[13]||(e[13]=t=>x.value=!1)},{default:a(()=>e[27]||(e[27]=[u(" Cancel ")])),_:1,__:[27]}),l(p,{color:"error",onClick:me},{default:a(()=>e[28]||(e[28]=[u(" Delete ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Le,{"is-dialog-visible":s(N),"onUpdate:isDialogVisible":e[15]||(e[15]=t=>c(N)?N.value=t:null),"lead-id":s(O)||0,onNoteAdded:ye},null,8,["is-dialog-visible","lead-id"])])}}});export{Yt as default};
