import{_ as S}from"./AppTextField.vue_vue_type_script_setup_true_lang-C1QkJzRA.js";import{d as D,r as f,j as B,c1 as L,a as M,c as U,o as h,e as m,b as a,aA as x,m as e,f as r,H as k,v as C,aM as $,g as j,l as I,t as b,a3 as E,x as F,aO as A,aL as u,dd as H}from"./main-CmF9Tu9X.js";import{_ as O}from"./AuthProvider.vue_vue_type_script_setup_true_lang-CiNmJD2n.js";import{a as z,b as q}from"./auth-v1-top-shape-Be0n9vOV.js";import{V as g}from"./VNodeRenderer-CwhUP98E.js";import{a as G,b as J,V as K}from"./VCard-BaQ80E-1.js";import{V as P}from"./VCardText-C80XsO14.js";import{V as Q}from"./VForm-DZliotcg.js";import{V as W,a as p}from"./VRow-CHcR5qvn.js";import{V as X}from"./VAlert-hOlFNs2Y.js";import{V as Y}from"./VCheckbox-Derh2P8q.js";import{V as Z}from"./form-0sOYWFNG.js";import{V as T}from"./VDivider-Bg3_3YcA.js";import"./VTextField-aisKyR0y.js";/* empty css                   */import"./VCounter-BFtCiXsp.js";import"./VImg-DCfN5bGZ.js";import"./VField-CBysmnBE.js";import"./easing-Bybner-F.js";import"./VInput-D3l3p6I4.js";import"./forwardRefs-C-GTDzx5.js";import"./VAvatar-BtKH23RP.js";/* empty css              */import"./VCheckboxBtn-oyTmTyVr.js";import"./VSelectionControl-D8diO4uz.js";const ee={class:"auth-wrapper d-flex align-center justify-center pa-4"},ae={class:"position-relative my-sm-16"},se={class:"app-logo"},oe={class:"app-logo-title"},re={class:"d-flex align-center my-6"},Se=D({__name:"register",setup(le){const l=f({name:"",email:"",password:"",password_confirmation:"",role:"franchisor",privacyPolicies:!1}),y=f(!1),v=f(!1),V=f(!1),d=f(null),c=B(),{smAndUp:R}=L(),{updateAbility:w}=H(),N=async()=>{var _,s;if(!l.value.privacyPolicies){d.value={general:"Please agree to the privacy policy & terms to continue."};return}V.value=!0,d.value=null;try{const t=await A("/auth/register",{method:"POST",body:{name:l.value.name,email:l.value.email,password:l.value.password,password_confirmation:l.value.password_confirmation,role:l.value.role}});u("accessToken").value=t.data.token,u("userData").value={id:t.data.user.id,fullName:t.data.user.name,username:t.data.user.email,avatar:void 0,email:t.data.user.email,role:t.data.user.role,status:t.data.user.status};let o;try{o=await A("/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password}}),u("accessToken").value=o.accessToken,u("userData").value=o.userData,u("userAbilityRules").value=o.userAbilityRules,w(o.userAbilityRules)}catch{u("userAbilityRules").value=[],w([])}switch(((_=o==null?void 0:o.userData)==null?void 0:_.role)||"franchisor"){case"admin":c.push("/admin/dashboard");break;case"franchisor":c.push("/franchisor");break;case"franchisee":c.push("/franchisee/dashboard/sales");break;case"sales":c.push("/sales/lead-management");break;default:c.push("/")}}catch(t){const o=(t==null?void 0:t.data)||((s=t==null?void 0:t.response)==null?void 0:s._data)||null;o!=null&&o.errors?d.value={name:o.errors.name,email:o.errors.email,password:o.errors.password,password_confirmation:o.errors.password_confirmation,role:o.errors.role,general:o.message}:d.value={general:(o==null?void 0:o.message)||"Registration failed. Please check your details and try again."}}finally{V.value=!1}};return(_,s)=>{const t=M("RouterLink"),o=S;return h(),U("div",ee,[m("div",ae,[a(e(g),{nodes:x("div",{innerHTML:e(z)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),a(e(g),{nodes:x("div",{innerHTML:e(q)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),a(K,{class:F(["auth-card",e(R)?"pa-6":"pa-0"]),"max-width":"460"},{default:r(()=>[a(G,{class:"justify-center"},{default:r(()=>[a(J,null,{default:r(()=>[a(t,{to:"/"},{default:r(()=>[m("div",se,[a(e(g),{nodes:e(k).app.logo},null,8,["nodes"]),m("h1",oe,C(e(k).app.title),1)])]),_:1})]),_:1})]),_:1}),a(P,null,{default:r(()=>s[7]||(s[7]=[m("h4",{class:"text-h4 mb-1"}," Adventure starts here 🚀 ",-1),m("p",{class:"mb-0"}," Make your app management easy and fun! ",-1)])),_:1,__:[7]}),a(P,null,{default:r(()=>[a(Q,{onSubmit:$(N,["prevent"])},{default:r(()=>[a(W,null,{default:r(()=>[a(p,{cols:"12"},{default:r(()=>{var i;return[(i=e(d))!=null&&i.general?(h(),j(X,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>{var n;return[b(C((n=e(d))==null?void 0:n.general),1)]}),_:1})):I("",!0)]}),_:1}),a(p,{cols:"12"},{default:r(()=>{var i;return[a(o,{modelValue:e(l).name,"onUpdate:modelValue":s[0]||(s[0]=n=>e(l).name=n),autofocus:"",label:"Full Name",placeholder:"Name","error-messages":(i=e(d))==null?void 0:i.name},null,8,["modelValue","error-messages"])]}),_:1}),a(p,{cols:"12"},{default:r(()=>{var i;return[a(o,{modelValue:e(l).email,"onUpdate:modelValue":s[1]||(s[1]=n=>e(l).email=n),label:"Email",type:"email",placeholder:"Email","error-messages":(i=e(d))==null?void 0:i.email},null,8,["modelValue","error-messages"])]}),_:1}),a(p,{cols:"12"},{default:r(()=>{var i;return[a(o,{modelValue:e(l).password,"onUpdate:modelValue":s[2]||(s[2]=n=>e(l).password=n),label:"Password",placeholder:"············",type:e(y)?"text":"password",autocomplete:"new-password","error-messages":(i=e(d))==null?void 0:i.password,"append-inner-icon":e(y)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[3]||(s[3]=n=>y.value=!e(y))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),a(p,{cols:"12"},{default:r(()=>{var i;return[a(o,{modelValue:e(l).password_confirmation,"onUpdate:modelValue":s[4]||(s[4]=n=>e(l).password_confirmation=n),label:"Confirm Password",autocomplete:"new-password",placeholder:"············",type:e(v)?"text":"password","error-messages":(i=e(d))==null?void 0:i.password_confirmation,"append-inner-icon":e(v)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[5]||(s[5]=n=>v.value=!e(v))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),a(p,{cols:"12"},{default:r(()=>[m("div",re,[a(Y,{id:"privacy-policy",modelValue:e(l).privacyPolicies,"onUpdate:modelValue":s[6]||(s[6]=i=>e(l).privacyPolicies=i),inline:""},null,8,["modelValue"]),a(Z,{for:"privacy-policy",style:{opacity:"1"}},{default:r(()=>s[8]||(s[8]=[m("span",{class:"me-1 text-high-emphasis"},"I agree to",-1),m("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1,__:[8]})]),a(E,{block:"",type:"submit",loading:e(V),disabled:e(V)},{default:r(()=>s[9]||(s[9]=[b(" Sign up ")])),_:1,__:[9]},8,["loading","disabled"])]),_:1}),a(p,{cols:"12",class:"text-center text-base"},{default:r(()=>[s[11]||(s[11]=m("span",null,"Already have an account?",-1)),a(t,{class:"text-primary ms-1",to:{name:"login"}},{default:r(()=>s[10]||(s[10]=[b(" Sign in instead ")])),_:1,__:[10]})]),_:1,__:[11]}),a(p,{cols:"12",class:"d-flex align-center"},{default:r(()=>[a(T),s[12]||(s[12]=m("span",{class:"mx-4"},"or",-1)),a(T)]),_:1,__:[12]}),a(p,{cols:"12",class:"text-center"},{default:r(()=>[a(O)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{Se as default};
