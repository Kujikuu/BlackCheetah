import{_ as L}from"./AppTextField.vue_vue_type_script_setup_true_lang-86Dhx7Dm.js";import{d as B,r as b,j as D,c2 as N,a as P,c as j,o as x,e as r,b as s,aA as w,m as a,f as o,H as V,v as g,t as m,aM as M,g as S,l as U,a3 as $,x as F,aO as H,aL as y,de as z}from"./main-45BFB2jp.js";import{_ as E}from"./AuthProvider.vue_vue_type_script_setup_true_lang-D84g9z_O.js";import{a as I,b as O}from"./auth-v1-top-shape-gPxasD3d.js";import{V as v}from"./VNodeRenderer-B4P7kGOs.js";import{a as W,b as q,V as G}from"./VCard-COfvtJ32.js";import{V as k}from"./VCardText-Vvg7knIC.js";import{V as J}from"./VForm--QCb8Zkn.js";import{V as K,a as p}from"./VRow-CtphHea4.js";import{V as Q}from"./VAlert-DAuA-mGI.js";import{V as X}from"./VCheckbox-BgunEYN8.js";import{V as C}from"./VDivider-NExkuXUC.js";import"./form-C5IVhvEs.js";import"./VTextField-DJAsS4Xq.js";/* empty css                   */import"./VCounter-5FzzpXQo.js";import"./VImg-Bl1z15mL.js";import"./VField-DkRLAvoK.js";import"./easing-Bybner-F.js";import"./VInput-BBDZpI7L.js";import"./forwardRefs-C-GTDzx5.js";import"./VAvatar-Df7e4Pxt.js";/* empty css              */import"./VCheckboxBtn-D0YrLnC_.js";import"./VSelectionControl-H7a93Ol1.js";const Y={class:"auth-wrapper d-flex align-center justify-center pa-4"},Z={class:"position-relative my-sm-16"},ee={class:"app-logo"},se={class:"app-logo-title"},ae={class:"text-h4 mb-1"},oe={class:"text-capitalize"},te={class:"d-flex align-center justify-space-between flex-wrap my-6"},De=B({__name:"login",setup(le){const n=b({email:"",password:"",remember:!1}),c=b(!1),f=b(!1),d=b(null),u=D(),{smAndUp:R}=N(),{updateAbility:T}=z(),A=async()=>{var _;f.value=!0,d.value=null;try{const e=await H("/auth/login",{method:"POST",body:{email:n.value.email,password:n.value.password}});switch(y("accessToken").value=e.accessToken,y("userData").value=e.userData,y("userAbilityRules").value=e.userAbilityRules,T(e.userAbilityRules),e.userData.role){case"admin":u.push("/admin/dashboard");break;case"franchisor":u.push("/franchisor");break;case"franchisee":u.push("/franchisee/dashboard/sales");break;case"sales":u.push("/sales/lead-management");break;default:u.push("/")}}catch(e){const t=(e==null?void 0:e.data)||((_=e==null?void 0:e.response)==null?void 0:_._data)||null;t!=null&&t.errors?d.value={email:t.errors.email,password:t.errors.password,general:t.message}:d.value={general:(t==null?void 0:t.message)||"Login failed. Please check your credentials and try again."}}finally{f.value=!1}};return(_,e)=>{const t=P("RouterLink"),h=L;return x(),j("div",Y,[r("div",Z,[s(a(v),{nodes:w("div",{innerHTML:a(I)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),s(a(v),{nodes:w("div",{innerHTML:a(O)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),s(G,{class:F(["auth-card",a(R)?"pa-6":"pa-0"]),"max-width":"460"},{default:o(()=>[s(W,{class:"justify-center"},{default:o(()=>[s(q,null,{default:o(()=>[s(t,{to:"/"},{default:o(()=>[r("div",ee,[s(a(v),{nodes:a(V).app.logo},null,8,["nodes"]),r("h1",se,g(a(V).app.title),1)])]),_:1})]),_:1})]),_:1}),s(k,null,{default:o(()=>[r("h4",ae,[e[4]||(e[4]=m(" Welcome to ")),r("span",oe,g(a(V).app.title),1),e[5]||(e[5]=m("! 👋🏻 "))]),e[6]||(e[6]=r("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1))]),_:1,__:[6]}),s(k,null,{default:o(()=>[s(J,{onSubmit:M(A,["prevent"])},{default:o(()=>[s(K,null,{default:o(()=>[s(p,{cols:"12"},{default:o(()=>{var i;return[(i=a(d))!=null&&i.general?(x(),S(Q,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:o(()=>{var l;return[m(g((l=a(d))==null?void 0:l.general),1)]}),_:1})):U("",!0)]}),_:1}),s(p,{cols:"12"},{default:o(()=>{var i;return[s(h,{modelValue:a(n).email,"onUpdate:modelValue":e[0]||(e[0]=l=>a(n).email=l),autofocus:"",label:"Email or Username",type:"email","error-messages":(i=a(d))==null?void 0:i.email,placeholder:"johndoe@email.com"},null,8,["modelValue","error-messages"])]}),_:1}),s(p,{cols:"12"},{default:o(()=>{var i;return[s(h,{modelValue:a(n).password,"onUpdate:modelValue":e[1]||(e[1]=l=>a(n).password=l),label:"Password",placeholder:"············",type:a(c)?"text":"password",autocomplete:"password","error-messages":(i=a(d))==null?void 0:i.password,"append-inner-icon":a(c)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=l=>c.value=!a(c))},null,8,["modelValue","type","error-messages","append-inner-icon"]),r("div",te,[s(X,{modelValue:a(n).remember,"onUpdate:modelValue":e[3]||(e[3]=l=>a(n).remember=l),label:"Remember me"},null,8,["modelValue"]),s(t,{class:"text-primary",to:{name:"forgot-password"}},{default:o(()=>e[7]||(e[7]=[m(" Forgot Password? ")])),_:1,__:[7]})]),s($,{block:"",type:"submit",loading:a(f),disabled:a(f)},{default:o(()=>e[8]||(e[8]=[m(" Login ")])),_:1,__:[8]},8,["loading","disabled"])]}),_:1}),s(p,{cols:"12",class:"text-body-1 text-center"},{default:o(()=>[e[10]||(e[10]=r("span",{class:"d-inline-block"}," New on our platform? ",-1)),s(t,{class:"text-primary ms-1 d-inline-block text-body-1",to:{name:"register"}},{default:o(()=>e[9]||(e[9]=[m(" Create an account ")])),_:1,__:[9]})]),_:1,__:[10]}),s(p,{cols:"12",class:"d-flex align-center"},{default:o(()=>[s(C),e[11]||(e[11]=r("span",{class:"mx-4 text-high-emphasis"},"or",-1)),s(C)]),_:1,__:[11]}),s(p,{cols:"12",class:"text-center"},{default:o(()=>[s(E)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{De as default};
