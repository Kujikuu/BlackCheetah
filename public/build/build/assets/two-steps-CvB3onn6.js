import{ac as G,N as J,bE as Q,af as Y,be as Z,P,r as V,ai as ee,aK as g,w as I,V as ae,bX as te,b as t,F as le,q as N,a$ as se,bR as oe,bK as ne,br as L,az as ue,d as ie,c1 as re,j as de,aL as x,a as ce,c as fe,o as O,e as m,aA as j,m as u,f as i,H as M,v as K,aM as me,g as pe,l as ve,t as q,au as be,a3 as ye,x as he,aO as ge,dd as Ve}from"./main-CmF9Tu9X.js";import{a as _e,b as ke}from"./auth-v1-top-shape-Be0n9vOV.js";import{V as S}from"./VNodeRenderer-CwhUP98E.js";import{a as we,b as xe,V as Ce}from"./VCard-BaQ80E-1.js";import{V as z}from"./VCardText-C80XsO14.js";import{V as Re}from"./VForm-DZliotcg.js";import{V as Ae,a as C}from"./VRow-CHcR5qvn.js";import{V as De}from"./VAlert-hOlFNs2Y.js";import{V as Te,m as Fe}from"./VField-CBysmnBE.js";import{a as Pe}from"./VOverlay-26Lm7od8.js";import{u as Se,m as Be}from"./form-0sOYWFNG.js";import"./VAvatar-BtKH23RP.js";import"./VImg-DCfN5bGZ.js";import"./forwardRefs-C-GTDzx5.js";/* empty css              */import"./easing-Bybner-F.js";import"./lazy-X6OUuNhY.js";import"./scopeId-nZWRusZv.js";const Ie=J({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...ne(),...Be(),...oe(Fe({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),Ne=G()({name:"VOtpInput",props:Ie(),emits:{finish:a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,R){let{attrs:b,emit:_,slots:r}=R;const{dimensionStyles:p}=Q(a),{isFocused:w,focus:A,blur:D}=Se(a),n=Y(a,"modelValue","",e=>e==null?[]:String(e).split(""),e=>e.join("")),{t:l}=Z(),v=P(()=>Number(a.length)),y=P(()=>Array(v.value).fill(0)),f=V(-1),T=V(),h=V([]),F=P(()=>h.value[f.value]);function E(){if(B(F.value.value)){F.value.value="";return}const e=n.value.slice(),s=F.value.value;e[f.value]=s;let d=null;f.value>n.value.length?d=n.value.length+1:f.value+1!==v.value&&(d="next"),n.value=e,d&&L(T.value,d)}function H(e){const s=n.value.slice(),d=f.value;let c=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(e.key)&&(e.preventDefault(),e.key==="ArrowLeft"?c="prev":e.key==="ArrowRight"?c="next":["Backspace","Delete"].includes(e.key)&&(s[f.value]="",n.value=s,f.value>0&&e.key==="Backspace"?c="prev":requestAnimationFrame(()=>{var o;(o=h.value[d])==null||o.select()})),requestAnimationFrame(()=>{c!=null&&L(T.value,c)}))}function $(e,s){var c,o;s.preventDefault(),s.stopPropagation();const d=((c=s==null?void 0:s.clipboardData)==null?void 0:c.getData("Text").slice(0,v.value))??"";B(d)||(n.value=d.split(""),(o=h.value)==null||o[e].blur())}function U(){n.value=[]}function W(e,s){A(),f.value=s}function X(){D(),f.value=-1}function B(e){return a.type==="number"&&/[^0-9]/g.test(e)}return ee({VField:{color:g(()=>a.color),bgColor:g(()=>a.color),baseColor:g(()=>a.baseColor),disabled:g(()=>a.disabled),error:g(()=>a.error),variant:g(()=>a.variant)}},{scoped:!0}),I(n,e=>{e.length===v.value&&_("finish",e.join(""))},{deep:!0}),I(f,e=>{e<0||ue(()=>{var s;(s=h.value[e])==null||s.select()})}),ae(()=>{var d;const[e,s]=te(b);return t("div",N({class:["v-otp-input",{"v-otp-input--divided":!!a.divider},a.class],style:[a.style]},e),[t("div",{ref:T,class:"v-otp-input__content",style:[p.value]},[y.value.map((c,o)=>t(le,null,[a.divider&&o!==0&&t("span",{class:"v-otp-input__divider"},[a.divider]),t(Te,{focused:w.value&&a.focusAll||f.value===o,key:o},{...r,loader:void 0,default:()=>t("input",{ref:k=>h.value[o]=k,"aria-label":l(a.label,o+1),autofocus:o===0&&a.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:a.disabled,inputmode:a.type==="number"?"numeric":"text",min:a.type==="number"?0:void 0,maxlength:o===0?v.value:"1",placeholder:a.placeholder,type:a.type==="number"?"text":a.type,value:n.value[o],onInput:E,onFocus:k=>W(k,o),onBlur:X,onKeydown:H,onPaste:k=>$(o,k)},null)})])),t("input",N({class:"v-otp-input-input",type:"hidden"},s,{value:n.value.join("")}),null),t(Pe,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!a.loading,persistent:!0},{default:()=>{var c;return[((c=r.loader)==null?void 0:c.call(r))??t(se,{color:typeof a.loading=="boolean"?void 0:a.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(d=r.default)==null?void 0:d.call(r)])])}),{blur:()=>{var e;(e=h.value)==null||e.some(s=>s.blur())},focus:()=>{var e;(e=h.value)==null||e[0].focus()},reset:U,isFocused:w}}}),Le={class:"auth-wrapper d-flex align-center justify-center pa-4"},Oe={class:"position-relative my-sm-16"},je={class:"app-logo"},Me={class:"app-logo-title"},sa=ie({__name:"two-steps",setup(a){const{smAndUp:R}=re(),b=de(),_=V(""),r=V(!1),p=V(null),w=x("userData"),{updateAbility:A}=Ve(),D=async()=>{var n;r.value=!0,p.value="Verifying code...";try{await new Promise(y=>setTimeout(y,800));const l=await ge("/auth/login",{method:"POST",body:{email:(n=w.value)==null?void 0:n.email,password:"password"}});switch(x("accessToken").value=l.accessToken,x("userData").value=l.userData,x("userAbilityRules").value=l.userAbilityRules,A(l.userAbilityRules),p.value="Code verified successfully. Redirecting...",await new Promise(y=>setTimeout(y,1200)),p.value=null,l.userData.role){case"admin":b.push("/admin/dashboard");break;case"franchisor":b.push("/franchisor");break;case"franchisee":b.push("/franchisee/dashboard/sales");break;case"sales":b.push("/sales/lead-management");break;default:b.push("/")}}catch{p.value="Verification failed. Please try again.",r.value=!1}};return(n,l)=>{const v=ce("RouterLink");return O(),fe("div",Le,[m("div",Oe,[t(u(S),{nodes:j("div",{innerHTML:u(_e)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),t(u(S),{nodes:j("div",{innerHTML:u(ke)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),t(Ce,{class:he(["auth-card",u(R)?"pa-6":"pa-0"]),"max-width":"460"},{default:i(()=>[t(we,{class:"justify-center"},{default:i(()=>[t(xe,null,{default:i(()=>[t(v,{to:"/"},{default:i(()=>[m("div",je,[t(u(S),{nodes:u(M).app.logo},null,8,["nodes"]),m("h1",Me,K(u(M).app.title),1)])]),_:1})]),_:1})]),_:1}),t(z,null,{default:i(()=>l[1]||(l[1]=[m("h4",{class:"text-h4 mb-1"}," Two Step Verification ðŸ’¬ ",-1),m("p",{class:"mb-1"}," We sent a verification code to your mobile. Enter the code from the mobile in the field below. ",-1),m("h6",{class:"text-h6"}," ******1234 ",-1)])),_:1,__:[1]}),t(z,null,{default:i(()=>[t(Re,{onSubmit:me(()=>{},["prevent"])},{default:i(()=>[t(Ae,null,{default:i(()=>[t(C,{cols:"12"},{default:i(()=>[u(p)?(O(),pe(De,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:i(()=>[q(K(u(p)),1)]),_:1})):ve("",!0)]),_:1}),t(C,{cols:"12"},{default:i(()=>[l[2]||(l[2]=m("h6",{class:"text-body-1"}," Type your 6 digit security code ",-1)),t(Ne,{modelValue:u(_),"onUpdate:modelValue":l[0]||(l[0]=y=>be(_)?_.value=y:null),disabled:u(r),type:"number",class:"pa-0",onFinish:D},null,8,["modelValue","disabled"])]),_:1,__:[2]}),t(C,{cols:"12"},{default:i(()=>[t(ye,{loading:u(r),disabled:u(r),block:"",type:"submit"},{default:i(()=>l[3]||(l[3]=[q(" Verify my account ")])),_:1,__:[3]},8,["loading","disabled"])]),_:1}),t(C,{cols:"12"},{default:i(()=>l[4]||(l[4]=[m("div",{class:"d-flex justify-center align-center flex-wrap"},[m("span",{class:"me-1"},"Didn't get the code?"),m("a",{href:"#"},"Resend")],-1)])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{sa as default};
