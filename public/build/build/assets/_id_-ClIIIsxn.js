import{_ as ne}from"./AppTextarea.vue_vue_type_script_setup_true_lang-Cf6ioYUM.js";import{_ as re}from"./AppTextField.vue_vue_type_script_setup_true_lang-Bw_GWu3c.js";import{d as ue,P as ie,u as me,r as c,G as fe,w as pe,c as M,g as V,l as C,b as l,m as a,f as t,F as I,au as U,aO as E,o as v,e as n,a$ as ce,v as p,t as u,a3 as y,i as X,aa as z,aM as ve}from"./main-Dhlv_lYh.js";import{_ as ye}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-B-HvdeeM.js";import{a as _e}from"./formatters-WDr9EcLN.js";import{V as b,a as S,b as F,c as Ve,d as P}from"./VCard-DneUGeMs.js";import{a as be,V as ge}from"./VTabs-DG9n14rK.js";import{a as Ce,V as Y}from"./VWindowItem-ZKe6stwH.js";import{V as q}from"./VDialog-Kcdh_GL2.js";import{V as g}from"./VCardText-D9647M3L.js";import{V as we}from"./VAvatar-BiIl4hu9.js";import{V as xe}from"./VChip-6fHDyEWx.js";import{V as w,a as r}from"./VRow-BhZ4svpb.js";import{V as Ne}from"./VDivider-DmcXD_UB.js";import{V as R}from"./VSpacer-C8jeatBp.js";import{V as ke}from"./VForm-DKI9vlwK.js";import{V as Ue}from"./VFileInput-BoS_aIhf.js";import"./form-CTX8i0eJ.js";import"./VTextarea-BwECT4AR.js";/* empty css                   */import"./VCounter-D1uzI7GI.js";import"./VImg-w3Zg-hsq.js";import"./VField-Ca1Snnyd.js";import"./easing-Bybner-F.js";import"./VInput-DHj7OjXT.js";import"./forwardRefs-C-GTDzx5.js";import"./VTextField-cleeZpmw.js";import"./VSlideGroup-C78OLP4w.js";import"./scopeId-SeYQuCZg.js";import"./lazy-APcxPsVL.js";import"./ssrBoot-CMmi3XlW.js";import"./VOverlay-CZ4wdQIu.js";import"./dialog-transition-4x8nqMt1.js";/* empty css              */const De={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Ee={class:"d-flex align-center gap-4"},Te={class:"text-h4"},$e={class:"text-h4 mb-1"},Ae={class:"text-body-1 mb-1"},Le={class:"d-flex gap-2"},Me={class:"d-flex justify-space-between align-start mb-2"},Se={class:"text-caption text-disabled mb-1"},Fe={class:"text-h6 mb-2"},Be={class:"d-flex gap-2"},Ie={class:"text-body-2 mb-2"},ze={class:"text-body-1"},gl=ue({__name:"[id]",setup(Pe){const Z=me(),_=ie(()=>Number(Z.params.id)),x=c("overview"),T=c(!1),D=c(!1),N=c(!1),k=c(!1),m=c(null),$=c(null),i=c(!1),s=c(null),B=c(!1),G=async()=>{var d;try{B.value=!0;const e=await E(`/v1/franchisor/leads/${_.value}`,{method:"GET"});e.success&&(s.value={id:e.data.id,firstName:e.data.first_name,lastName:e.data.last_name,email:e.data.email,phone:e.data.phone,company:e.data.company_name||e.data.company,country:e.data.country,state:e.data.state||e.data.address,city:e.data.city,source:e.data.lead_source,status:e.data.status,owner:((d=e.data.assignedUser)==null?void 0:d.name)||"Unassigned",lastContacted:e.data.last_contact_date,scheduledMeeting:e.data.next_follow_up_date,note:e.data.notes,priority:e.data.priority,estimatedInvestment:e.data.estimated_investment,franchiseFeeQuoted:e.data.franchise_fee_quoted,expectedDecisionDate:e.data.expected_decision_date,contactAttempts:e.data.contact_attempts,interests:e.data.interests,documents:e.data.documents})}catch(e){console.error("Error fetching lead data:",e)}finally{B.value=!1}};fe(()=>{G()});const O=c([]),j=c(!1),A=async()=>{if(_.value)try{j.value=!0;const d=await E("/v1/notes",{method:"GET",query:{lead_id:_.value}});d.success&&(O.value=d.data.map(e=>{var f;return{id:e.id,title:e.title,description:e.description,createdBy:((f=e.user)==null?void 0:f.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(d){console.error("Error fetching notes:",d)}finally{j.value=!1}};pe(_,()=>{_.value&&A()},{immediate:!0});const h=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],Q=d=>new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ee=(d,e=150)=>d.length<=e?d:`${d.substring(0,e)}...`,le=d=>{m.value=d,D.value=!0},te=d=>{m.value={...d},N.value=!0},ae=d=>{$.value=d,k.value=!0},oe=async()=>{if($.value!==null){try{const d=await E(`/v1/notes/${$.value}`,{method:"DELETE"});d.success?(await A(),console.log("Note deleted successfully")):console.error("Failed to delete note:",d.message)}catch(d){console.error("Error deleting note:",d)}k.value=!1,$.value=null}},W=async()=>{if(m.value)try{const d=await E(`/v1/notes/${m.value.id}`,{method:"PUT",body:{title:m.value.title,description:m.value.description,lead_id:_.value}});d.success?(await A(),N.value=!1,console.log("Note updated successfully")):console.error("Failed to update note:",d.message)}catch(d){console.error("Error updating note:",d)}},se=async()=>{await A(),console.log("Note added successfully")},H=()=>{i.value=!i.value},L=c(!1),de=async()=>{if(s.value)try{L.value=!0;const d={first_name:s.value.firstName,last_name:s.value.lastName,email:s.value.email,phone:s.value.phone,company:s.value.company,country:s.value.country,state:s.value.state,city:s.value.city,source:s.value.source,status:s.value.status,notes:s.value.note,priority:s.value.priority,estimated_investment:s.value.estimatedInvestment,franchise_fee_quoted:s.value.franchiseFeeQuoted,expected_decision_date:s.value.expectedDecisionDate};(await E(`/v1/franchisor/leads/${_.value}`,{method:"PUT",body:d})).success&&(await G(),i.value=!1,console.log("Lead updated successfully"))}catch(d){console.error("Error updating lead:",d)}finally{L.value=!1}};return(d,e)=>{const f=re,J=ne;return v(),M("section",null,[a(B)?(v(),V(b,{key:0,class:"mb-6"},{default:t(()=>[l(g,{class:"text-center py-10"},{default:t(()=>[l(ce,{indeterminate:"",color:"primary"}),e[23]||(e[23]=n("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[23]})]),_:1})):a(s)?(v(),V(b,{key:1,class:"mb-6"},{default:t(()=>[l(g,null,{default:t(()=>[n("div",De,[n("div",Ee,[l(we,{size:"80",variant:"tonal",color:"primary"},{default:t(()=>[n("span",Te,p(a(_e)(`${a(s).firstName} ${a(s).lastName}`)),1)]),_:1}),n("div",null,[n("h4",$e,p(a(s).firstName)+" "+p(a(s).lastName),1),n("div",Ae,p(a(s).company),1),l(xe,{color:a(s).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:t(()=>[u(p(a(s).status),1)]),_:1},8,["color"])])]),n("div",Le,[a(i)?C("",!0):(v(),V(y,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:H},{default:t(()=>e[24]||(e[24]=[u(" Edit ")])),_:1,__:[24]})),a(i)?(v(),V(y,{key:1,color:"success","prepend-icon":"tabler-check",loading:a(L),disabled:a(L),onClick:de},{default:t(()=>e[25]||(e[25]=[u(" Save ")])),_:1,__:[25]},8,["loading","disabled"])):C("",!0),a(i)?(v(),V(y,{key:2,color:"secondary",variant:"tonal",onClick:H},{default:t(()=>e[26]||(e[26]=[u(" Cancel ")])),_:1,__:[26]})):C("",!0)])])]),_:1})]),_:1})):C("",!0),a(s)?(v(),M(I,{key:2},[l(be,{modelValue:a(x),"onUpdate:modelValue":e[0]||(e[0]=o=>U(x)?x.value=o:null),class:"mb-6"},{default:t(()=>[(v(),M(I,null,X(h,o=>l(ge,{key:o.value,value:o.value},{default:t(()=>[l(z,{icon:o.icon,start:""},null,8,["icon"]),u(" "+p(o.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),l(Ce,{modelValue:a(x),"onUpdate:modelValue":e[13]||(e[13]=o=>U(x)?x.value=o:null),class:"disable-tab-transition"},{default:t(()=>[l(Y,{value:"overview"},{default:t(()=>[l(b,null,{default:t(()=>[l(g,null,{default:t(()=>[l(w,null,{default:t(()=>[l(r,{cols:"12",md:"6"},{default:t(()=>[e[27]||(e[27]=n("h6",{class:"text-h6 mb-4"}," Contact Information ",-1)),l(w,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).email,"onUpdate:modelValue":e[1]||(e[1]=o=>a(s).email=o),label:"Email",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).phone,"onUpdate:modelValue":e[2]||(e[2]=o=>a(s).phone=o),label:"Phone",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).company,"onUpdate:modelValue":e[3]||(e[3]=o=>a(s).company=o),label:"Company",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1,__:[27]}),l(r,{cols:"12",md:"6"},{default:t(()=>[e[28]||(e[28]=n("h6",{class:"text-h6 mb-4"}," Location ",-1)),l(w,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).city,"onUpdate:modelValue":e[4]||(e[4]=o=>a(s).city=o),label:"City",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).state,"onUpdate:modelValue":e[5]||(e[5]=o=>a(s).state=o),label:"State",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).country,"onUpdate:modelValue":e[6]||(e[6]=o=>a(s).country=o),label:"Country",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1,__:[28]}),l(r,{cols:"12",md:"6"},{default:t(()=>[e[29]||(e[29]=n("h6",{class:"text-h6 mb-4"}," Lead Details ",-1)),l(w,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).source,"onUpdate:modelValue":e[7]||(e[7]=o=>a(s).source=o),label:"Source",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).owner,"onUpdate:modelValue":e[8]||(e[8]=o=>a(s).owner=o),label:"Owner",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1,__:[29]}),l(r,{cols:"12",md:"6"},{default:t(()=>[e[30]||(e[30]=n("h6",{class:"text-h6 mb-4"}," Timeline ",-1)),l(w,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).lastContacted,"onUpdate:modelValue":e[9]||(e[9]=o=>a(s).lastContacted=o),label:"Last Contacted",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(s).scheduledMeeting,"onUpdate:modelValue":e[10]||(e[10]=o=>a(s).scheduledMeeting=o),label:"Scheduled Meeting",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1,__:[30]}),l(r,{cols:"12"},{default:t(()=>[e[31]||(e[31]=n("h6",{class:"text-h6 mb-4"}," Notes ",-1)),l(J,{modelValue:a(s).note,"onUpdate:modelValue":e[11]||(e[11]=o=>a(s).note=o),label:"Additional Notes",rows:"4",readonly:!a(i)},null,8,["modelValue","readonly"])]),_:1,__:[31]})]),_:1})]),_:1})]),_:1})]),_:1}),l(Y,{value:"notes"},{default:t(()=>[l(b,null,{default:t(()=>[l(S,{class:"pb-4"},{append:t(()=>[l(y,{color:"primary","prepend-icon":"tabler-plus",onClick:e[12]||(e[12]=o=>T.value=!0)},{default:t(()=>e[33]||(e[33]=[u(" Add Note ")])),_:1,__:[33]})]),default:t(()=>[l(F,null,{default:t(()=>e[32]||(e[32]=[u("Notes")])),_:1,__:[32]})]),_:1}),l(Ne),l(g,null,{default:t(()=>[l(w,null,{default:t(()=>[(v(!0),M(I,null,X(a(O),o=>(v(),V(r,{key:o.id,cols:"12"},{default:t(()=>[l(b,{variant:"tonal",class:"mb-4"},{default:t(()=>[l(g,null,{default:t(()=>[n("div",Me,[n("div",null,[n("div",Se," Created by "+p(o.createdBy)+" at "+p(Q(o.createdAt)),1),n("h6",Fe,p(o.title),1)]),n("div",Be,[l(y,{icon:"",size:"small",variant:"text",onClick:K=>te(o)},{default:t(()=>[l(z,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),l(y,{icon:"",size:"small",variant:"text",color:"error",onClick:K=>ae(o.id)},{default:t(()=>[l(z,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),n("p",Ie,p(ee(o.description)),1),l(y,{variant:"text",size:"small",onClick:K=>le(o)},{default:t(()=>e[34]||(e[34]=[u(" Read More ")])),_:2,__:[34]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):C("",!0),l(ye,{"is-dialog-visible":a(T),"onUpdate:isDialogVisible":e[14]||(e[14]=o=>U(T)?T.value=o:null),"lead-id":a(_),onNoteAdded:se},null,8,["is-dialog-visible","lead-id"]),l(q,{modelValue:a(D),"onUpdate:modelValue":e[16]||(e[16]=o=>U(D)?D.value=o:null),"max-width":"700"},{default:t(()=>[a(m)?(v(),V(b,{key:0},{default:t(()=>[l(S,null,{default:t(()=>[l(F,null,{default:t(()=>[u(p(a(m).title),1)]),_:1}),l(Ve,null,{default:t(()=>[u(" Created by "+p(a(m).createdBy)+" at "+p(Q(a(m).createdAt)),1)]),_:1})]),_:1}),l(g,null,{default:t(()=>[n("p",ze,p(a(m).description),1)]),_:1}),l(P,null,{default:t(()=>[l(R),l(y,{color:"secondary",variant:"tonal",onClick:e[15]||(e[15]=o=>D.value=!1)},{default:t(()=>e[35]||(e[35]=[u(" Close ")])),_:1,__:[35]})]),_:1})]),_:1})):C("",!0)]),_:1},8,["modelValue"]),l(q,{modelValue:a(N),"onUpdate:modelValue":e[20]||(e[20]=o=>U(N)?N.value=o:null),"max-width":"700"},{default:t(()=>[a(m)?(v(),V(b,{key:0},{default:t(()=>[l(S,null,{default:t(()=>[l(F,null,{default:t(()=>e[36]||(e[36]=[u("Edit Note")])),_:1,__:[36]})]),_:1}),l(g,null,{default:t(()=>[l(ke,{onSubmit:ve(W,["prevent"])},{default:t(()=>[l(w,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(f,{modelValue:a(m).title,"onUpdate:modelValue":e[17]||(e[17]=o=>a(m).title=o),label:"Title",placeholder:"Enter note title"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(J,{modelValue:a(m).description,"onUpdate:modelValue":e[18]||(e[18]=o=>a(m).description=o),label:"Description",placeholder:"Enter note description...",rows:"6"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(Ue,{label:"Attachments",multiple:"","prepend-icon":"tabler-paperclip",placeholder:"Upload files",chips:"","show-size":""})]),_:1})]),_:1})]),_:1})]),_:1}),l(P,null,{default:t(()=>[l(R),l(y,{color:"secondary",variant:"tonal",onClick:e[19]||(e[19]=o=>N.value=!1)},{default:t(()=>e[37]||(e[37]=[u(" Cancel ")])),_:1,__:[37]}),l(y,{color:"primary",onClick:W},{default:t(()=>e[38]||(e[38]=[u(" Update Note ")])),_:1,__:[38]})]),_:1})]),_:1})):C("",!0)]),_:1},8,["modelValue"]),l(q,{modelValue:a(k),"onUpdate:modelValue":e[22]||(e[22]=o=>U(k)?k.value=o:null),"max-width":"500"},{default:t(()=>[l(b,null,{default:t(()=>[l(S,null,{default:t(()=>[l(F,null,{default:t(()=>e[39]||(e[39]=[u("Confirm Delete")])),_:1,__:[39]})]),_:1}),l(g,null,{default:t(()=>e[40]||(e[40]=[u(" Are you sure you want to delete this note? This action cannot be undone. ")])),_:1,__:[40]}),l(P,null,{default:t(()=>[l(R),l(y,{color:"secondary",variant:"tonal",onClick:e[21]||(e[21]=o=>k.value=!1)},{default:t(()=>e[41]||(e[41]=[u(" Cancel ")])),_:1,__:[41]}),l(y,{color:"error",onClick:oe},{default:t(()=>e[42]||(e[42]=[u(" Delete ")])),_:1,__:[42]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{gl as default};
