import{_ as Ve}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DJuxuOVb.js";import{_ as ye}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-D29owYUD.js";import{_ as be}from"./AppSelect.vue_vue_type_script_setup_true_lang-B5FICR3b.js";import{_ as _e}from"./AppTextField.vue_vue_type_script_setup_true_lang-DSmTBduk.js";import{_ as ge}from"./AddNoteDialog.vue_vue_type_script_setup_true_lang-C9gcIppj.js";import{V as ke,_ as Ne,a as we}from"./DeleteNoteDialog.vue_vue_type_script_setup_true_lang-DkfHoLDE.js";import{l as H}from"./lead-DnsW79oj.js";import{a as Ue}from"./formatters--UtN2sCw.js";import{d as Ce,P as xe,u as De,r as p,G as W,w as Se,c as B,g as u,l as A,b as t,m as l,f as o,F as I,aR as x,b5 as K,o as d,e as f,aF as Ae,v as c,t as v,a9 as _,i as Y,ax as R}from"./main-gemCwVks.js";import{V,a as g,b as k}from"./VCard-DJ82mpnW.js";import{a as Ee,V as Le}from"./VTabs-CeX-zYGq.js";import{a as Te,V as X}from"./VWindowItem-CPQ2k3dD.js";import{V as y}from"./VCardText-BD5AHO-w.js";import{V as Me}from"./VAvatar-12xz6mHy.js";import{V as $e}from"./VChip-DlNApjyg.js";import{V as N,a as m}from"./VRow-DiX7eN30.js";import{V as w}from"./VDivider-B4ry9pxl.js";import"./form-DjHlhIbZ.js";import"./VTextarea-OEcL0zKK.js";import"./VTextField-BhxF6EAD.js";import"./VImg-DSB6m92Q.js";import"./VField-CsHfcJSz.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-B3GinL-f.js";import"./VSelect-C9dxRhag.js";import"./VList-MyW-iB3v.js";import"./dialog-transition-C9rYmnXC.js";import"./VMenu-CeaiRCNz.js";import"./VOverlay-p8m6-W96.js";import"./scopeId-BgtgI3QF.js";import"./VCheckboxBtn-ZAK0D-Rf.js";import"./VSelectionControl-COVpGwiX.js";import"./VDialog-6C-NQXCx.js";import"./VForm-FUZpY-zG.js";import"./VFileInput-CB0ItP4X.js";import"./VSpacer-Cpeayo2U.js";/* empty css              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ConfirmDeleteDialog.vue_vue_type_script_setup_true_lang-DLjIa95G.js";import"./VSlideGroup-CEWgOBQJ.js";const Be={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Fe={class:"d-flex align-center gap-4"},Pe={class:"text-h4"},ze={class:"text-h4 mb-1"},Ie={class:"text-body-1 mb-1"},Re={class:"d-flex gap-2"},qe={class:"d-flex justify-space-between align-start mb-2"},Je={class:"text-caption text-disabled mb-1"},Qe={class:"text-h6 mb-2"},Oe={class:"d-flex gap-2"},je={class:"text-body-2 mb-2"},Ml=Ce({__name:"[id]",setup(Ge){const Z=De(),b=xe(()=>Number(Z.params.id)),U=p("overview"),E=p(!1),L=p(!1),D=p(!1),S=p(!1),T=p(null),F=p(null),i=p(!1),s=p(null),P=p(!1),q=async()=>{try{P.value=!0;const n=await H.getLead(b.value);n.success&&n.data&&(s.value=n.data)}catch(n){console.error("Error fetching lead data:",n)}finally{P.value=!1}};W(()=>{q()});const J=p([]),Q=p(!1),M=async()=>{if(b.value)try{Q.value=!0;const n=await K("/v1/notes",{method:"GET",query:{lead_id:b.value}});n.success&&(J.value=n.data.map(e=>{var r;return{id:e.id,title:e.title,description:e.description,createdBy:((r=e.user)==null?void 0:r.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(n){console.error("Error fetching notes:",n)}finally{Q.value=!1}};Se(b,()=>{b.value&&M()},{immediate:!0});const h=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],ee=n=>new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),le=(n,e=150)=>n.length<=e?n:`${n.substring(0,e)}...`,te=n=>{T.value=n,L.value=!0},ae=n=>{T.value={...n},D.value=!0},oe=n=>{F.value=n,S.value=!0},se=async()=>{await M(),D.value=!1,console.log("Note updated successfully")},ne=async()=>{await M(),console.log("Note added successfully")},de=async()=>{await M(),S.value=!1,F.value=null,console.log("Note deleted successfully")},O=()=>{i.value=!i.value},$=p(!1),ie=async()=>{if(s.value)try{$.value=!0,(await H.updateLead(b.value,s.value)).success&&(await q(),i.value=!1,console.log("Lead updated successfully"))}catch(n){console.error("Error updating lead:",n)}finally{$.value=!1}},j=p([]),ue=async()=>{try{const n=await K("/v1/franchisor/sales-associates",{method:"GET"});n.success&&(j.value=n.data.map(e=>({title:e.name,value:e.name})))}catch(n){console.error("Error fetching sales associates:",n)}};W(()=>{ue()});const re=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Syria",value:"Syria"},{title:"Palestine",value:"Palestine"},{title:"Yemen",value:"Yemen"}],me=[{title:"Riyadh",value:"Riyadh"},{title:"Makkah",value:"Makkah"},{title:"Medina",value:"Medina"},{title:"Eastern Province",value:"Eastern Province"},{title:"Asir",value:"Asir"},{title:"Tabuk",value:"Tabuk"},{title:"Hail",value:"Hail"},{title:"Northern Borders",value:"Northern Borders"},{title:"Jazan",value:"Jazan"},{title:"Najran",value:"Najran"},{title:"Al Bahah",value:"Al Bahah"},{title:"Al Jawf",value:"Al Jawf"}],pe=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],fe=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],ve=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];return(n,e)=>{const r=_e,C=be,z=ye,ce=Ve;return d(),B("section",null,[l(P)?(d(),u(V,{key:0,class:"mb-6"},{default:o(()=>[t(y,{class:"text-center py-10"},{default:o(()=>[t(Ae,{indeterminate:"",color:"primary"}),e[35]||(e[35]=f("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[35]})]),_:1})):l(s)?(d(),u(V,{key:1,class:"mb-6"},{default:o(()=>[t(y,null,{default:o(()=>[f("div",Be,[f("div",Fe,[t(Me,{size:"80",variant:"tonal",color:"primary"},{default:o(()=>[f("span",Pe,c(l(Ue)(`${l(s).firstName} ${l(s).lastName}`)),1)]),_:1}),f("div",null,[f("h4",ze,c(l(s).firstName)+" "+c(l(s).lastName),1),f("div",Ie,c(l(s).company),1),t($e,{color:l(s).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:o(()=>[v(c(l(s).status),1)]),_:1},8,["color"])])]),f("div",Re,[l(i)?A("",!0):(d(),u(_,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:O},{default:o(()=>e[36]||(e[36]=[v(" Edit ")])),_:1,__:[36]})),l(i)?(d(),u(_,{key:1,color:"success","prepend-icon":"tabler-check",loading:l($),disabled:l($),onClick:ie},{default:o(()=>e[37]||(e[37]=[v(" Save ")])),_:1,__:[37]},8,["loading","disabled"])):A("",!0),l(i)?(d(),u(_,{key:2,color:"secondary",variant:"tonal",onClick:O},{default:o(()=>e[38]||(e[38]=[v(" Cancel ")])),_:1,__:[38]})):A("",!0)])])]),_:1})]),_:1})):A("",!0),l(s)?(d(),B(I,{key:2},[t(Ee,{modelValue:l(U),"onUpdate:modelValue":e[0]||(e[0]=a=>x(U)?U.value=a:null),class:"mb-6"},{default:o(()=>[(d(),B(I,null,Y(h,a=>t(Le,{key:a.value,value:a.value},{default:o(()=>[t(R,{icon:a.icon,start:""},null,8,["icon"]),v(" "+c(a.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(Te,{modelValue:l(U),"onUpdate:modelValue":e[30]||(e[30]=a=>x(U)?U.value=a:null),class:"disable-tab-transition"},{default:o(()=>[t(X,{value:"overview"},{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12",lg:"8"},{default:o(()=>[t(V,{class:"mb-6"},{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[39]||(e[39]=[v("Personal & Contact Information")])),_:1,__:[39]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).firstName,"onUpdate:modelValue":e[1]||(e[1]=a=>l(s).firstName=a),label:"First Name",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).lastName,"onUpdate:modelValue":e[2]||(e[2]=a=>l(s).lastName=a),label:"Last Name",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).email,"onUpdate:modelValue":e[3]||(e[3]=a=>l(s).email=a),label:"Email",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).phone,"onUpdate:modelValue":e[4]||(e[4]=a=>l(s).phone=a),label:"Phone",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(r,{modelValue:l(s).company,"onUpdate:modelValue":e[5]||(e[5]=a=>l(s).company=a),label:"Company",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),t(V,{class:"mb-6"},{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[40]||(e[40]=[v("Location")])),_:1,__:[40]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12",md:"4"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).country,"onUpdate:modelValue":e[6]||(e[6]=a=>l(s).country=a),label:"Country",placeholder:"Select Country",items:re},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).country,"onUpdate:modelValue":e[7]||(e[7]=a=>l(s).country=a),label:"Country",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).state,"onUpdate:modelValue":e[8]||(e[8]=a=>l(s).state=a),label:"State",placeholder:"Select State",items:me},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).state,"onUpdate:modelValue":e[9]||(e[9]=a=>l(s).state=a),label:"State",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[t(r,{modelValue:l(s).city,"onUpdate:modelValue":e[10]||(e[10]=a=>l(s).city=a),label:"City",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),t(V,{class:"mb-6"},{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[41]||(e[41]=[v("Financial Details")])),_:1,__:[41]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12",md:"4"},{default:o(()=>[t(r,{modelValue:l(s).estimatedInvestment,"onUpdate:modelValue":e[11]||(e[11]=a=>l(s).estimatedInvestment=a),label:"Estimated Investment",type:"number",prefix:"SAR",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[t(r,{modelValue:l(s).franchiseFeeQuoted,"onUpdate:modelValue":e[12]||(e[12]=a=>l(s).franchiseFeeQuoted=a),label:"Franchise Fee Quoted",type:"number",prefix:"SAR",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[l(i)?(d(),u(z,{key:0,modelValue:l(s).expectedDecisionDate,"onUpdate:modelValue":e[13]||(e[13]=a=>l(s).expectedDecisionDate=a),label:"Expected Decision Date",placeholder:"Select Date"},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).expectedDecisionDate,"onUpdate:modelValue":e[14]||(e[14]=a=>l(s).expectedDecisionDate=a),label:"Expected Decision Date",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(V,null,{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[42]||(e[42]=[v("Additional Notes")])),_:1,__:[42]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(ce,{modelValue:l(s).note,"onUpdate:modelValue":e[15]||(e[15]=a=>l(s).note=a),label:"Notes",placeholder:"Add any additional notes about this lead...",rows:"4",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1}),t(m,{cols:"12",lg:"4"},{default:o(()=>[t(V,{class:"mb-6"},{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[43]||(e[43]=[v("Lead Management")])),_:1,__:[43]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).status,"onUpdate:modelValue":e[16]||(e[16]=a=>l(s).status=a),label:"Status",placeholder:"Select Status",items:fe},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).status,"onUpdate:modelValue":e[17]||(e[17]=a=>l(s).status=a),label:"Status",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).priority,"onUpdate:modelValue":e[18]||(e[18]=a=>l(s).priority=a),label:"Priority",placeholder:"Select Priority",items:ve},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).priority,"onUpdate:modelValue":e[19]||(e[19]=a=>l(s).priority=a),label:"Priority",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).source,"onUpdate:modelValue":e[20]||(e[20]=a=>l(s).source=a),label:"Source",placeholder:"Select Source",items:pe},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).source,"onUpdate:modelValue":e[21]||(e[21]=a=>l(s).source=a),label:"Source",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(C,{key:0,modelValue:l(s).owner,"onUpdate:modelValue":e[22]||(e[22]=a=>l(s).owner=a),label:"Assigned To",placeholder:"Select Owner",items:l(j)},null,8,["modelValue","items"])):(d(),u(r,{key:1,modelValue:l(s).owner,"onUpdate:modelValue":e[23]||(e[23]=a=>l(s).owner=a),label:"Assigned To",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(V,null,{default:o(()=>[t(g,null,{default:o(()=>[t(k,null,{default:o(()=>e[44]||(e[44]=[v("Timeline & Engagement")])),_:1,__:[44]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(z,{key:0,modelValue:l(s).lastContacted,"onUpdate:modelValue":e[24]||(e[24]=a=>l(s).lastContacted=a),label:"Last Contacted",placeholder:"Select Date"},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).lastContacted,"onUpdate:modelValue":e[25]||(e[25]=a=>l(s).lastContacted=a),label:"Last Contacted",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(i)?(d(),u(z,{key:0,modelValue:l(s).scheduledMeeting,"onUpdate:modelValue":e[26]||(e[26]=a=>l(s).scheduledMeeting=a),label:"Next Follow-up",placeholder:"Select Date"},null,8,["modelValue"])):(d(),u(r,{key:1,modelValue:l(s).scheduledMeeting,"onUpdate:modelValue":e[27]||(e[27]=a=>l(s).scheduledMeeting=a),label:"Next Follow-up",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(r,{modelValue:l(s).contactAttempts,"onUpdate:modelValue":e[28]||(e[28]=a=>l(s).contactAttempts=a),label:"Contact Attempts",type:"number",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(X,{value:"notes"},{default:o(()=>[t(V,null,{default:o(()=>[t(g,{class:"pb-4"},{append:o(()=>[t(_,{color:"primary","prepend-icon":"tabler-plus",onClick:e[29]||(e[29]=a=>E.value=!0)},{default:o(()=>e[46]||(e[46]=[v(" Add Note ")])),_:1,__:[46]})]),default:o(()=>[t(k,null,{default:o(()=>e[45]||(e[45]=[v("Notes")])),_:1,__:[45]})]),_:1}),t(w),t(y,null,{default:o(()=>[t(N,null,{default:o(()=>[(d(!0),B(I,null,Y(l(J),a=>(d(),u(m,{key:a.id,cols:"12"},{default:o(()=>[t(V,{variant:"tonal",class:"mb-4"},{default:o(()=>[t(y,null,{default:o(()=>[f("div",qe,[f("div",null,[f("div",Je," Created by "+c(a.createdBy)+" at "+c(ee(a.createdAt)),1),f("h6",Qe,c(a.title),1)]),f("div",Oe,[t(_,{icon:"",size:"small",variant:"text",onClick:G=>ae(a)},{default:o(()=>[t(R,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),t(_,{icon:"",size:"small",variant:"text",color:"error",onClick:G=>oe(a.id)},{default:o(()=>[t(R,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),f("p",je,c(le(a.description)),1),t(_,{variant:"text",size:"small",onClick:G=>te(a)},{default:o(()=>e[47]||(e[47]=[v(" Read More ")])),_:2,__:[47]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):A("",!0),t(ge,{"is-dialog-visible":l(E),"onUpdate:isDialogVisible":e[31]||(e[31]=a=>x(E)?E.value=a:null),"lead-id":l(b),onNoteAdded:ne},null,8,["is-dialog-visible","lead-id"]),t(ke,{"is-dialog-visible":l(L),"onUpdate:isDialogVisible":e[32]||(e[32]=a=>x(L)?L.value=a:null),note:l(T)},null,8,["is-dialog-visible","note"]),t(Ne,{"is-dialog-visible":l(D),"onUpdate:isDialogVisible":e[33]||(e[33]=a=>x(D)?D.value=a:null),note:l(T),onNoteUpdated:se},null,8,["is-dialog-visible","note"]),t(we,{"is-dialog-visible":l(S),"onUpdate:isDialogVisible":e[34]||(e[34]=a=>x(S)?S.value=a:null),"note-id":l(F),onNoteDeleted:de},null,8,["is-dialog-visible","note-id"])])}}});export{Ml as default};
