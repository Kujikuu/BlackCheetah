var se=Object.defineProperty;var oe=(x,u,i)=>u in x?se(x,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):x[u]=i;var Z=(x,u,i)=>oe(x,typeof u!="symbol"?u+"":u,i);import{_ as re}from"./AppSelect.vue_vue_type_script_setup_true_lang-BPi_8I55.js";import{_ as ee}from"./AppTextField.vue_vue_type_script_setup_true_lang-DBBt0k22.js";import{b2 as N,d as L,g as v,E as ae,a as U,o as h,k as l,y as e,i as t,l as m,h as M,c as S,t as P,aD as ne,a7 as A,av as J,q as V,bb as te,b1 as j,F as H,r as Q,aM as z,u as ue,O as ie}from"./main-CJoUlw71.js";import{a as w,V as E}from"./VRow-I0aFN3ft.js";import{V as X,f as I,b as de,a as pe,d as me}from"./VCard-D0Kr6jJ3.js";import{V as G,a as ce}from"./VAlert-Cmjxlqzr.js";import{V as K}from"./VDivider-BaGqyL8B.js";import{V as le}from"./VForm-MxPZnCnL.js";import{V as fe}from"./VTable-Z6ii9VWQ.js";import{V as O}from"./VCheckbox-C3YfIKr0.js";import{V as ve,a as ye}from"./VTabs-CPaS4mMT.js";import{a as W,V as ge}from"./VWindowItem-Sru_LTmb.js";import"./form-TZVfOcgQ.js";import"./VSelect-DrBKrWpC.js";import"./VTextField-D8E1qX-C.js";import"./VField-BK8GYuQp.js";import"./forwardRefs-B931MWyl.js";import"./VInput-ljW8JGQT.js";import"./VList-dBGtPQa1.js";import"./VMenu-ChdF8Fzb.js";import"./VOverlay-DNweL6TL.js";import"./scopeId-BW4ci1pC.js";import"./VCheckboxBtn-ClRj4-k1.js";import"./VSelectionControl-DPYfPVD0.js";import"./VChip-B4nRRsDL.js";import"./VSlideGroup-CFd1UCPD.js";/* empty css              */const be="/v1/account";class _e{constructor(){Z(this,"baseUrl",be)}async getProfile(){return await N(`${this.baseUrl}/profile`,{method:"GET"})}async updateProfile(u){return await N(`${this.baseUrl}/profile`,{method:"PUT",body:u})}async updatePassword(u){return await N(`${this.baseUrl}/password`,{method:"PUT",body:u})}async uploadAvatar(u){const i=new FormData;return i.append("avatar",u),await N(`${this.baseUrl}/avatar`,{method:"POST",body:i})}async deleteAvatar(){return await N(`${this.baseUrl}/avatar`,{method:"DELETE"})}async updateNotificationPreferences(u){return await N(`${this.baseUrl}/notifications`,{method:"PUT",body:{notifications:u}})}}const C=new _e,we={class:"d-flex align-center"},Ve={class:"position-relative me-6"},he={key:0,class:"text-5xl font-weight-medium"},xe={key:0,class:"position-absolute top-0 start-0 w-100 h-100 d-flex align-center justify-center",style:{background:"rgba(0,0,0,0.5)","border-radius":"8px"}},ke={class:"d-flex flex-column justify-center gap-4"},Pe={class:"d-flex flex-wrap gap-2"},Te=L({__name:"AccountSettingsAccount",setup(x){const u=v(),i=v(!1),y=v(!1),f=v(!1),o=v(null),s=v({avatarImg:"",name:"",email:"",role:"",phone:"",timezone:"(GMT+03:00) Riyadh"}),n=v({type:null,message:""}),r=["(GMT+03:00) Riyadh","(GMT+03:00) Kuwait","(GMT+03:00) Baghdad","(GMT+02:00) Cairo","(GMT+01:00) Amsterdam","(GMT+00:00) London","(GMT-05:00) Eastern Time (US & Canada)","(GMT-08:00) Pacific Time (US & Canada)"],c=p=>({admin:"Administrator",franchisor:"Franchisor",franchisee:"Franchisee",unit_manager:"Unit Manager",sales_associate:"Sales Associate",employee:"Employee"})[p]||p,g=async()=>{var p;try{i.value=!0;const a=await C.getProfile();a.success&&(o.value=a.data,s.value={avatarImg:a.data.avatar||"",name:a.data.name,email:a.data.email,role:c(a.data.role),phone:a.data.phone||"",timezone:((p=a.data.preferences)==null?void 0:p.timezone)||"(GMT+03:00) Riyadh"})}catch(a){console.error("Error loading profile:",a)}finally{i.value=!1}},k=()=>{var p;o.value&&(s.value={avatarImg:o.value.avatar||"",name:o.value.name,email:o.value.email,role:c(o.value.role),phone:o.value.phone||"",timezone:((p=o.value.preferences)==null?void 0:p.timezone)||"(GMT+03:00) Riyadh"})},B=async p=>{var b,D,_;const{files:a}=p.target;if(a&&a.length){const T=a[0];if(T.size>800*1024){n.value={type:"error",message:"File size must be less than 800KB"},setTimeout(()=>n.value={type:null,message:""},5e3);return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(T.type)){n.value={type:"error",message:"Only JPG, PNG, and GIF files are allowed"},setTimeout(()=>n.value={type:null,message:""},5e3);return}try{const F=new FileReader;F.onload=R=>{var Y;s.value.avatarImg=(Y=R.target)==null?void 0:Y.result},F.readAsDataURL(T),f.value=!0,n.value={type:null,message:"Uploading..."};const q=await C.uploadAvatar(T);if(q.success){s.value.avatarImg=q.data.avatar,o.value&&(o.value.avatar=q.data.avatar);const R=j("userData");R.value&&(R.value={...R.value,avatar:q.data.avatar}),n.value={type:"success",message:"Avatar uploaded successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}}catch(F){console.error("Error uploading avatar:",F),n.value={type:"error",message:((D=(b=F.response)==null?void 0:b.data)==null?void 0:D.message)||"Failed to upload avatar"},(_=o.value)!=null&&_.avatar&&(s.value.avatarImg=o.value.avatar),setTimeout(()=>n.value={type:null,message:""},5e3)}finally{f.value=!1}}},$=async()=>{var p,a;try{f.value=!0,n.value={type:null,message:"Removing avatar..."},await C.deleteAvatar(),s.value.avatarImg="",o.value&&(o.value.avatar=null);const b=j("userData");b.value&&(b.value={...b.value,avatar:null}),n.value={type:"success",message:"Avatar removed successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}catch(b){console.error("Error deleting avatar:",b),n.value={type:"error",message:((a=(p=b.response)==null?void 0:p.data)==null?void 0:a.message)||"Failed to remove avatar"},setTimeout(()=>n.value={type:null,message:""},5e3)}finally{f.value=!1}},d=async()=>{try{y.value=!0;const p=await C.updateProfile({name:s.value.name,phone:s.value.phone,preferences:{timezone:s.value.timezone}});if(p.success){o.value=p.data;const a=j("userData");a.value&&(a.value={...a.value,name:p.data.name,fullName:p.data.name})}}catch(p){console.error("Error updating profile:",p)}finally{y.value=!1}};return ae(()=>{g()}),(p,a)=>{const b=ee,D=re;return h(),U(E,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(X,{title:"Profile Details",loading:t(i)},{default:l(()=>[e(I,{class:"d-flex flex-column gap-4"},{default:l(()=>[m("div",we,[m("div",Ve,[e(de,{rounded:"",size:"100",image:t(s).avatarImg},{default:l(()=>[t(s).avatarImg?M("",!0):(h(),S("span",he,P(t(s).name.charAt(0).toUpperCase()),1))]),_:1},8,["image"]),t(f)?(h(),S("div",xe,[e(ne,{indeterminate:"",color:"white",size:"32"})])):M("",!0)]),m("div",ke,[m("div",Pe,[e(A,{color:"primary",loading:t(f),disabled:t(i)||t(f),onClick:a[0]||(a[0]=_=>{var T;return(T=t(u))==null?void 0:T.click()})},{default:l(()=>[e(J,{icon:"tabler-cloud-upload",class:"d-sm-none"}),a[7]||(a[7]=m("span",{class:"d-none d-sm-block"},"Upload new photo",-1))]),_:1,__:[7]},8,["loading","disabled"]),m("input",{ref_key:"refInputEl",ref:u,type:"file",name:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:B},null,544),e(A,{type:"reset",color:"secondary",variant:"outlined",loading:t(f),disabled:t(i)||t(f)||!t(s).avatarImg,onClick:$},{default:l(()=>a[8]||(a[8]=[V(" Reset ")])),_:1,__:[8]},8,["loading","disabled"])]),a[9]||(a[9]=m("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1))])]),t(n).message?(h(),U(G,{key:0,type:t(n).type||"info",variant:"tonal",closable:"","onClick:close":a[1]||(a[1]=_=>n.value={type:null,message:""})},{default:l(()=>[V(P(t(n).message),1)]),_:1},8,["type"])):M("",!0)]),_:1}),e(K),e(I,null,{default:l(()=>[e(le,{class:"mt-6"},{default:l(()=>[e(E,null,{default:l(()=>[e(w,{cols:"12",md:"12"},{default:l(()=>[e(b,{modelValue:t(s).name,"onUpdate:modelValue":a[2]||(a[2]=_=>t(s).name=_),label:"Full Name",placeholder:"Name"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).email,"onUpdate:modelValue":a[3]||(a[3]=_=>t(s).email=_),label:"Email",type:"email",placeholder:"admin@example.com",readonly:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).role,"onUpdate:modelValue":a[4]||(a[4]=_=>t(s).role=_),label:"Role",placeholder:"Administrator",readonly:""},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:t(s).phone,"onUpdate:modelValue":a[5]||(a[5]=_=>t(s).phone=_),label:"Phone Number",placeholder:"+966 50 123 4567"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(D,{modelValue:t(s).timezone,"onUpdate:modelValue":a[6]||(a[6]=_=>t(s).timezone=_),label:"Timezone",items:r,placeholder:"Select Timezone"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[e(A,{loading:t(y),disabled:t(i),onClick:d},{default:l(()=>a[10]||(a[10]=[V(" Save changes ")])),_:1,__:[10]},8,["loading","disabled"]),e(A,{color:"secondary",variant:"outlined",type:"reset",disabled:t(i)||t(y),onClick:te(k,["prevent"])},{default:l(()=>a[11]||(a[11]=[V(" Reset ")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}}),Ae={class:"text-body-1 text-high-emphasis"},Ce=L({__name:"AccountSettingsNotification",setup(x){const u=v(!1),i=v(!1),y=v(""),f=v([{key:"new_user_registration",type:"New user registration",email:!0,browser:!0,app:!0},{key:"new_technical_request",type:"New technical request",email:!0,browser:!0,app:!0},{key:"technical_request_status_change",type:"Technical request status change",email:!0,browser:!1,app:!0},{key:"new_franchisor_application",type:"New franchisor application",email:!0,browser:!0,app:!1},{key:"payment_received",type:"Payment received",email:!0,browser:!1,app:!1},{key:"system_alerts",type:"System alerts",email:!0,browser:!0,app:!0}]),o=async()=>{var n;try{u.value=!0;const r=await C.getProfile();if(r.success&&((n=r.data.preferences)!=null&&n.notifications)){const c=r.data.preferences.notifications;f.value.forEach(g=>{const k=g.key;c[k]&&(g.email=c[k].email,g.browser=c[k].browser,g.app=c[k].app)})}}catch(r){console.error("Error loading notifications:",r)}finally{u.value=!1}},s=async()=>{try{i.value=!0,y.value="";const n={};f.value.forEach(r=>{const c=r.key;n[c]={email:r.email,browser:r.browser,app:r.app}}),await C.updateNotificationPreferences(n),y.value="Notification preferences saved successfully",setTimeout(()=>{y.value=""},3e3)}catch(n){console.error("Error saving notifications:",n)}finally{i.value=!1}};return ae(()=>{o()}),(n,r)=>(h(),U(E,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(X,{loading:t(u)},{default:l(()=>[e(pe,null,{default:l(()=>[e(me,null,{default:l(()=>r[1]||(r[1]=[V("Notification Preferences")])),_:1,__:[1]}),r[2]||(r[2]=m("p",{class:"text-body-1 mb-0"},[V(" Choose how you want to receive notifications. We need permission from your browser to show notifications. "),m("span",{class:"text-primary cursor-pointer"},"Request Permission")],-1))]),_:1,__:[2]}),t(y)?(h(),U(I,{key:0},{default:l(()=>[e(G,{variant:"tonal",color:"success",closable:"","onClick:close":r[0]||(r[0]=c=>y.value="")},{default:l(()=>[V(P(t(y)),1)]),_:1})]),_:1})):M("",!0),e(I,{class:"px-0"},{default:l(()=>[e(K),e(fe,{class:"text-no-wrap rounded"},{default:l(()=>[r[3]||(r[3]=m("thead",null,[m("tr",null,[m("th",{scope:"col"}," Type "),m("th",{scope:"col"}," EMAIL "),m("th",{scope:"col"}," BROWSER "),m("th",{scope:"col"}," APP ")])],-1)),m("tbody",null,[(h(!0),S(H,null,Q(t(f),c=>(h(),S("tr",{key:c.type},[m("td",Ae,P(c.type),1),m("td",null,[e(O,{modelValue:c.email,"onUpdate:modelValue":g=>c.email=g},null,8,["modelValue","onUpdate:modelValue"])]),m("td",null,[e(O,{modelValue:c.browser,"onUpdate:modelValue":g=>c.browser=g},null,8,["modelValue","onUpdate:modelValue"])]),m("td",null,[e(O,{modelValue:c.app,"onUpdate:modelValue":g=>c.app=g},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1,__:[3]})]),_:1}),e(K),e(I,null,{default:l(()=>[e(A,{loading:t(i),disabled:t(u),onClick:s},{default:l(()=>r[4]||(r[4]=[V(" Save Changes ")])),_:1,__:[4]},8,["loading","disabled"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}}),Ue={class:"d-flex flex-column gap-y-2"},Se={class:"text-base"},Ne=L({__name:"AccountSettingsSecurity",setup(x){const u=v(!1),i=v(!1),y=v(!1),f=v(""),o=v(""),s=v(""),n=v(!1),r=v(""),c=v(""),g=["Minimum 8 characters long - the more, the better","At least one lowercase character","At least one uppercase character","At least one number, symbol, or whitespace character"],k=async()=>{var $,d;if(r.value="",c.value="",o.value!==s.value){r.value="New passwords do not match";return}if(o.value.length<8){r.value="Password must be at least 8 characters long";return}try{n.value=!0,await C.updatePassword({current_password:f.value,password:o.value,password_confirmation:s.value}),c.value="Password updated successfully",f.value="",o.value="",s.value=""}catch(p){(d=($=p.response)==null?void 0:$.data)!=null&&d.message?r.value=p.response.data.message:r.value="Failed to update password. Please try again.",console.error("Error updating password:",p)}finally{n.value=!1}},B=()=>{f.value="",o.value="",s.value="",r.value="",c.value=""};return($,d)=>{const p=ee;return h(),U(E,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(X,{title:"Change Password"},{default:l(()=>[e(I,null,{default:l(()=>[t(c)?(h(),U(G,{key:0,variant:"tonal",color:"success",class:"mb-6",closable:"","onClick:close":d[0]||(d[0]=a=>c.value="")},{default:l(()=>[V(P(t(c)),1)]),_:1})):M("",!0),t(r)?(h(),U(G,{key:1,variant:"tonal",color:"error",class:"mb-6",closable:"","onClick:close":d[1]||(d[1]=a=>r.value="")},{default:l(()=>[V(P(t(r)),1)]),_:1})):M("",!0),e(G,{variant:"tonal",color:"warning",class:"mb-6"},{default:l(()=>[e(ce,{class:"mb-1"},{default:l(()=>d[8]||(d[8]=[V(" Ensure that these requirements are met ")])),_:1,__:[8]}),d[9]||(d[9]=m("span",null,"Minimum 8 characters long, uppercase & symbol",-1))]),_:1,__:[9]}),e(le,{onSubmit:te(k,["prevent"])},{default:l(()=>[e(E,null,{default:l(()=>[e(w,{cols:"12",md:"6"},{default:l(()=>[e(p,{modelValue:t(f),"onUpdate:modelValue":d[2]||(d[2]=a=>z(f)?f.value=a:null),type:t(u)?"text":"password","append-inner-icon":t(u)?"tabler-eye-off":"tabler-eye",label:"Current Password",placeholder:"············","onClick:appendInner":d[3]||(d[3]=a=>u.value=!t(u))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(w,{cols:"12",md:"6"},{default:l(()=>[e(p,{modelValue:t(o),"onUpdate:modelValue":d[4]||(d[4]=a=>z(o)?o.value=a:null),type:t(i)?"text":"password","append-inner-icon":t(i)?"tabler-eye-off":"tabler-eye",label:"New Password",placeholder:"············","onClick:appendInner":d[5]||(d[5]=a=>i.value=!t(i))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(p,{modelValue:t(s),"onUpdate:modelValue":d[6]||(d[6]=a=>z(s)?s.value=a:null),type:t(y)?"text":"password","append-inner-icon":t(y)?"tabler-eye-off":"tabler-eye",label:"Confirm New Password",placeholder:"············","onClick:appendInner":d[7]||(d[7]=a=>y.value=!t(y))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(w,{cols:"12"},{default:l(()=>[d[10]||(d[10]=m("h6",{class:"text-h6 text-medium-emphasis mb-4"}," Password Requirements: ",-1)),m("ul",Ue,[(h(),S(H,null,Q(g,a=>m("li",{key:a,class:"d-flex align-center"},[m("div",null,[e(J,{size:"8",icon:"tabler-circle",class:"me-2"}),m("span",Se,P(a),1)])])),64))])]),_:1,__:[10]}),e(w,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[e(A,{type:"submit",loading:t(n)},{default:l(()=>d[11]||(d[11]=[V(" Save changes ")])),_:1,__:[11]},8,["loading"]),e(A,{type:"reset",color:"secondary",variant:"outlined",disabled:t(n),onClick:B},{default:l(()=>d[12]||(d[12]=[V(" Reset ")])),_:1,__:[12]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),na=L({__name:"[tab]",setup(x){const u=ue(),i=ie({get:()=>u.params.tab,set:()=>u.params.tab}),y=[{title:"Account",icon:"tabler-user",tab:"account"},{title:"Security",icon:"tabler-lock",tab:"security"},{title:"Notifications",icon:"tabler-bell",tab:"notifications"}];return(f,o)=>(h(),S("div",null,[o[2]||(o[2]=m("div",{class:"mb-6"},[m("h2",{class:"text-h2 mb-1"}," Account Settings "),m("p",{class:"text-body-1 text-medium-emphasis"}," Manage your account preferences and settings ")],-1)),e(ye,{modelValue:t(i),"onUpdate:modelValue":o[0]||(o[0]=s=>z(i)?i.value=s:null),class:"v-tabs-pill"},{default:l(()=>[(h(),S(H,null,Q(y,s=>e(ve,{key:s.icon,value:s.tab,to:{name:"account-settings-tab",params:{tab:s.tab}}},{default:l(()=>[e(J,{size:"20",start:"",icon:s.icon},null,8,["icon"]),V(" "+P(s.title),1)]),_:2},1032,["value","to"])),64))]),_:1},8,["modelValue"]),e(ge,{modelValue:t(i),"onUpdate:modelValue":o[1]||(o[1]=s=>z(i)?i.value=s:null),class:"mt-6 disable-tab-transition",touch:!1},{default:l(()=>[e(W,{value:"account"},{default:l(()=>[e(Te)]),_:1}),e(W,{value:"security"},{default:l(()=>[e(Ne)]),_:1}),e(W,{value:"notifications"},{default:l(()=>[e(Ce)]),_:1})]),_:1},8,["modelValue"])]))}});export{na as default};
