import{d as Pe,r as d,P as de,G as Me,c as qe,b as t,f as l,aO as J,o as A,e as s,a3 as v,t as u,aa as _,v as r,m as Te,g as j,l as z,aM as me}from"./main-CA5_5-fk.js";import{r as P}from"./royalty-CMYQPN0n.js";import{V as h,a as i}from"./VRow-Ct-W2dAj.js";import{V as I}from"./VDialog-BNpBCbFf.js";import{V}from"./VSelect-BuMSRPjV.js";import{V as g,a as M,b as q,c as Fe,d as B}from"./VCard-BlRUAaMY.js";import{V as w}from"./VCardText-A5LE6kSN.js";import{V as pe}from"./VAvatar-DYIYaXHU.js";import{S as Oe}from"./saudi-riyal-BdqGN1_e.js";import{V as T}from"./VDivider-Bv9wRwWR.js";import{q as Le}from"./VDataTable-D73IjFcA.js";import{V as ye}from"./VTooltip-C1IspaIa.js";import{V as Q}from"./VChip-C6OnuAx-.js";import{V as je}from"./VAlert-JP0hX-Wz.js";import{V as E}from"./VSpacer-QI7PbBCv.js";import{V as ve}from"./VForm-BqXaPedu.js";import{V as c}from"./VTextField-tUni67cb.js";import{V as ce}from"./VTextarea-9czDO3yE.js";import{V as ze}from"./VFileInput-BgxvYusJ.js";import{V as Ie}from"./VTable-B8DFGBPB.js";/* empty css              */import"./VOverlay-4pSpEGjx.js";import"./easing-Bybner-F.js";import"./lazy-CN-iBTrZ.js";import"./scopeId-7q-wGPVf.js";import"./VImg-FsxkdVsl.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Dkald8FM.js";import"./form-bs2DZzDf.js";import"./VList-Abz5zQko.js";import"./ssrBoot-B8_MECfQ.js";import"./VMenu-CPDfVQZz.js";import"./VCheckboxBtn-QLEgM55C.js";import"./VSelectionControl-DNfMVlT-.js";import"./VPagination-3zfgEHOG.js";import"./filter-B6krjMCu.js";import"./VSlideGroup-CwmyEgo9.js";/* empty css                   */import"./VCounter-DEC0uZ17.js";import"./VField-8nFUoH-R.js";import"./VInput-DhYwEXiV.js";const Be={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Ee={class:"d-flex gap-3 align-center flex-wrap"},Ne={class:"d-flex align-center justify-space-between"},$e={class:"text-h4 text-success"},Ge={class:"d-flex align-center justify-space-between"},Ye={class:"text-h4 text-warning"},He={class:"font-weight-medium"},Je={class:"font-weight-medium text-primary"},Qe={class:"text-body-2 text-medium-emphasis"},Xe={class:"text-body-2"},Ke={class:"font-weight-medium text-info"},We={class:"font-weight-medium text-success"},Ze={class:"d-flex gap-2"},et={class:"text-body-2"},tt={class:"mb-4"},at={class:"font-weight-medium"},lt={class:"mb-4"},ot={class:"font-weight-medium"},st={class:"mb-4"},nt={class:"font-weight-medium text-primary"},it={class:"mb-4"},rt={class:"font-weight-medium"},ut={class:"text-center"},dt={class:"text-h6 font-weight-bold"},mt={class:"text-center"},pt={class:"text-h6 font-weight-bold"},yt={class:"text-center"},vt={class:"text-h6 font-weight-bold"},ct={class:"mb-4"},ft={class:"mb-4"},_t={class:"font-weight-medium"},gt={class:"text-end"},bt={class:"text-end"},Vt={class:"text-end"},xt={class:"bg-primary-lighten-5"},ht={class:"text-end font-weight-bold text-primary"},ma=Pe({__name:"royalty-management",setup(wt){const X=d(!1),K=d(!1),F=d(!1),b=d("monthly"),k=d(!1),R=d(!1),C=d(!1),S=d(!1),O=d(null),m=d(null),D=d("csv"),L=d("all"),n=d({franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}),W=d([]),Z=d([]),ee=d([]),f=d({amount_paid:0,payment_date:"",payment_type:"",attachment:null}),te=d([]),N=d({royalty_collected_till_date:0,upcoming_royalties:0,total_royalties:0,pending_amount:0,paid_amount:0,overdue_amount:0,overdue_count:0}),fe=de(()=>{var a;return((a=N.value)==null?void 0:a.royalty_collected_till_date)||0}),_e=de(()=>{var a;return((a=N.value)==null?void 0:a.upcoming_royalties)||0}),ae=[{title:"Monthly",value:"monthly"},{title:"Quarterly",value:"quarterly"},{title:"Annual",value:"annual"},{title:"Special",value:"special"}],ge=[{title:"CSV",value:"csv"},{title:"Excel",value:"excel"}],le=[{title:"All Royalties",value:"all"},{title:"Paid Only",value:"paid"},{title:"Pending Only",value:"pending"},{title:"Overdue Only",value:"overdue"}],be=[{title:"Bank Transfer",value:"bank_transfer"},{title:"Credit Card",value:"credit_card"},{title:"Mada",value:"mada"},{title:"STC Pay",value:"stc_pay"},{title:"SADAD",value:"sadad"},{title:"Check",value:"check"},{title:"Cash",value:"cash"},{title:"Online Payment",value:"online_payment"}],Ve=[{title:"Billing Period",key:"billingPeriod",sortable:!0},{title:"Franchisee Name",key:"franchiseeName",sortable:!0},{title:"Store Location",key:"storeLocation",sortable:!0},{title:"Due Date",key:"dueDate",sortable:!0},{title:"Gross Sales (SAR)",key:"grossSales",sortable:!0},{title:"Royalty %",key:"royaltyPercentage",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],$=async()=>{try{X.value=!0;const a=await P.getRoyalties({period:b.value});te.value=a.data.data}catch{}finally{X.value=!1}},G=async()=>{try{K.value=!0;const a=await P.getStatistics({period:b.value});N.value=a.data}catch{}finally{K.value=!1}},xe=()=>{k.value=!0},he=async()=>{try{const a=await P.exportRoyalties({format:D.value,data_type:L.value,period:b.value}),e=window.URL.createObjectURL(a),o=document.createElement("a");o.href=e,o.download=`royalty-data-${b.value}-${new Date().toISOString().split("T")[0]}.${D.value==="csv"?"csv":"xlsx"}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e),k.value=!1}catch{}},we=a=>{m.value=a,C.value=!0},oe=a=>{O.value=a,f.value={amount_paid:a.amount,payment_date:new Date().toISOString().split("T")[0],payment_type:"",attachment:null},R.value=!0},se=async()=>{if(O.value)try{await P.markAsPaid(O.value.id,f.value),await $(),await G(),R.value=!1,O.value=null,f.value={amount_paid:0,payment_date:"",payment_type:"",attachment:null}}catch{}},ke=a=>{const e=a.target;e.files&&e.files[0]&&(f.value.attachment=e.files[0])},ne=a=>{switch(a){case"paid":return"success";case"pending":return"warning";case"overdue":return"error";default:return"default"}},ie=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Re=async()=>{try{const a=await J("/api/v1/franchisor/franchise");a.success&&a.data&&(W.value=[a.data])}catch{}},Ce=async()=>{try{const a=await J("/api/v1/franchisor/units");a.success&&a.data&&(Z.value=a.data.data||[])}catch{}},Se=async()=>{try{const a=await J("/api/v1/franchisor/franchisees");a.success&&a.data&&(ee.value=a.data.data||[])}catch{}},x=()=>{const a=n.value.base_revenue;n.value.royalty_amount=a*n.value.royalty_rate/100,n.value.marketing_fee_amount=a*n.value.marketing_fee_rate/100,n.value.technology_fee_rate>0&&(n.value.technology_fee_amount=a*n.value.technology_fee_rate/100),n.value.total_amount=n.value.royalty_amount+n.value.marketing_fee_amount+n.value.technology_fee_amount+n.value.other_fees+n.value.adjustments},re=async()=>{try{if(F.value=!0,Ae(),!await Ue())return;x();const e={...n.value,franchise_id:n.value.franchise_id||void 0,unit_id:n.value.unit_id||void 0,franchisee_id:n.value.franchisee_id||void 0};(await P.createRoyalty(e)).success&&(ue(),S.value=!1,await $(),await G())}catch{}finally{F.value=!1}},ue=()=>{n.value={franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}},De=()=>{ue(),S.value=!0};Me(()=>{$(),G(),Re(),Ce(),Se()});const p=d({}),y={franchise_id:[a=>!!a||"Franchise selection is required"],franchisee_id:[a=>!!a||"Franchisee selection is required"],type:[a=>!!a||"Royalty type is required",a=>["monthly","quarterly"].includes(a)||"Invalid royalty type"],period_year:[a=>!!a||"Period year is required",a=>a>=2020||"Period year must be at least 2020",a=>a<=new Date().getFullYear()+1||"Period year cannot be more than next year"],period_month:[a=>n.value.type==="monthly"?!!a||"Period month is required for monthly royalties":!0,a=>a&&(a<1||a>12)?"Period month must be between 1 and 12":!0],period_quarter:[a=>n.value.type==="quarterly"?!!a||"Period quarter is required for quarterly royalties":!0,a=>a&&(a<1||a>4)?"Period quarter must be between 1 and 4":!0],base_revenue:[a=>a!=null&&a!==""||"Base revenue is required",a=>a>=0||"Base revenue cannot be negative",a=>a<=99999999999e-2||"Base revenue is too large"],royalty_rate:[a=>a!=null&&a!==""||"Royalty rate is required",a=>a>=0||"Royalty rate cannot be negative",a=>a<=100||"Royalty rate cannot exceed 100%"],marketing_fee_rate:[a=>a!=null&&a!==""||"Marketing fee rate is required",a=>a>=0||"Marketing fee rate cannot be negative",a=>a<=100||"Marketing fee rate cannot exceed 100%"],due_date:[a=>!!a||"Due date is required",a=>{if(a){const e=new Date().toISOString().split("T")[0];return a>=e||"Due date cannot be in the past"}return!0}],technology_fee_amount:[a=>a==null||a===""||a>=0||"Technology fee cannot be negative",a=>a==null||a===""||a<=99999999999e-2||"Technology fee is too large"],other_fees:[a=>a==null||a===""||a>=0||"Other fees cannot be negative",a=>a==null||a===""||a<=99999999999e-2||"Other fees is too large"],adjustments:[a=>a==null||a===""||a>=-99999999999e-2||"Adjustments value is too low",a=>a==null||a===""||a<=99999999999e-2||"Adjustments value is too high"],description:[a=>!a||a.length<=1e3||"Description cannot exceed 1000 characters"],notes:[a=>!a||a.length<=2e3||"Notes cannot exceed 2000 characters"]},Y=d(!1),U=d(),Ue=async()=>{if(U.value){const{valid:a}=await U.value.validate();return Y.value=a,a}return!1},Ae=()=>{p.value={},U.value&&U.value.resetValidation()};return(a,e)=>(A(),qe("section",null,[t(h,{class:"mb-6"},{default:l(()=>[t(i,{cols:"12"},{default:l(()=>[s("div",Be,[e[33]||(e[33]=s("div",null,[s("h4",{class:"text-h4 mb-1"}," Royalty Management "),s("p",{class:"text-body-1 text-medium-emphasis"}," Track and manage royalty payments from all franchise units ")],-1)),s("div",Ee,[t(V,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o),items:ae,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"]),t(v,{color:"success",variant:"elevated",onClick:De},{default:l(()=>[t(_,{icon:"tabler-plus",class:"me-2"}),e[31]||(e[31]=u(" Create Royalty "))]),_:1,__:[31]}),t(v,{color:"primary",variant:"elevated",onClick:xe},{default:l(()=>[t(_,{icon:"tabler-download",class:"me-2"}),e[32]||(e[32]=u(" Export "))]),_:1,__:[32]})])])]),_:1})]),_:1}),t(h,{class:"mb-6"},{default:l(()=>[t(i,{cols:"12",md:"6"},{default:l(()=>[t(g,null,{default:l(()=>[t(w,null,{default:l(()=>[s("div",Ne,[s("div",null,[e[34]||(e[34]=s("h6",{class:"text-h6 mb-1"}," Royalty Collected Till Date ",-1)),e[35]||(e[35]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Total payments received ",-1)),s("h4",$e,r(fe.value.toLocaleString())+" SAR ",1)]),t(pe,{color:"success",variant:"tonal",size:"56"},{default:l(()=>[t(Te(Oe),{size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(g,null,{default:l(()=>[t(w,null,{default:l(()=>[s("div",Ge,[s("div",null,[e[36]||(e[36]=s("h6",{class:"text-h6 mb-1"}," Upcoming Royalties ",-1)),e[37]||(e[37]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Pending payments due ",-1)),s("h4",Ye,r(_e.value.toLocaleString())+" SAR ",1)]),t(pe,{color:"warning",variant:"tonal",size:"56"},{default:l(()=>[t(_,{icon:"tabler-clock",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(i,{cols:"12"},{default:l(()=>[t(g,null,{default:l(()=>[t(M,{class:"pb-4"},{default:l(()=>[t(q,{class:"text-h6"},{default:l(()=>e[38]||(e[38]=[u(" Royalty Records ")])),_:1,__:[38]}),t(Fe,{class:"text-body-2"},{default:l(()=>e[39]||(e[39]=[u(" Manage royalty payments and track collection status ")])),_:1,__:[39]})]),_:1}),t(T),t(Le,{headers:Ve,items:te.value,"items-per-page":10,class:"text-no-wrap"},{"item.billingPeriod":l(({item:o})=>[s("div",He,r(o.billing_period),1)]),"item.franchiseeName":l(({item:o})=>[s("div",Je,r(o.franchisee_name),1)]),"item.storeLocation":l(({item:o})=>[s("div",Qe,r(o.store_location),1)]),"item.dueDate":l(({item:o})=>[s("div",Xe,r(ie(o.due_date)),1)]),"item.grossSales":l(({item:o})=>[s("div",Ke,r((o.gross_sales||0).toLocaleString()),1)]),"item.royaltyPercentage":l(({item:o})=>[t(Q,{size:"small",variant:"tonal",color:"primary"},{default:l(()=>[u(r(o.royalty_percentage)+"% ",1)]),_:2},1024)]),"item.amount":l(({item:o})=>[s("div",We,r((o.amount||0).toLocaleString()),1)]),"item.status":l(({item:o})=>[t(Q,{color:ne(o.status),size:"small",variant:"tonal",class:"text-capitalize"},{default:l(()=>[u(r(o.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[s("div",Ze,[t(v,{icon:"",size:"small",color:"info",variant:"text",onClick:H=>we(o)},{default:l(()=>[t(_,{icon:"tabler-eye",size:"20"}),t(ye,{activator:"parent",location:"top"},{default:l(()=>e[40]||(e[40]=[u(" View Details ")])),_:1,__:[40]})]),_:2},1032,["onClick"]),o.status!=="paid"?(A(),j(v,{key:0,icon:"",size:"small",color:"success",variant:"text",onClick:H=>oe(o)},{default:l(()=>[t(_,{icon:"tabler-check",size:"20"}),t(ye,{activator:"parent",location:"top"},{default:l(()=>e[41]||(e[41]=[u(" Mark as Completed ")])),_:1,__:[41]})]),_:2},1032,["onClick"])):z("",!0)])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),t(I,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),"max-width":"500"},{default:l(()=>[t(g,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,null,{default:l(()=>e[42]||(e[42]=[u("Export Royalty Data")])),_:1,__:[42]})]),_:1}),t(w,null,{default:l(()=>[t(h,null,{default:l(()=>[t(i,{cols:"12"},{default:l(()=>[t(V,{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=o=>L.value=o),items:le,"item-title":"title","item-value":"value",label:"Data Type",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(V,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=o=>D.value=o),items:ge,"item-title":"title","item-value":"value",label:"Export Format",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(je,{type:"info",variant:"tonal",class:"mt-4"},{default:l(()=>{var o;return[s("div",et,[e[43]||(e[43]=s("strong",null,"Current Selection:",-1)),e[44]||(e[44]=s("br",null,null,-1)),u(" Period: "+r(b.value.charAt(0).toUpperCase()+b.value.slice(1)),1),e[45]||(e[45]=s("br",null,null,-1)),u(" Data Type: "+r((o=le.find(H=>H.value===L.value))==null?void 0:o.title),1),e[46]||(e[46]=s("br",null,null,-1)),u(" Format: "+r(D.value.toUpperCase()),1)])]}),_:1})]),_:1}),t(B,null,{default:l(()=>[t(E),t(v,{color:"secondary",variant:"tonal",onClick:e[3]||(e[3]=o=>k.value=!1)},{default:l(()=>e[47]||(e[47]=[u(" Cancel ")])),_:1,__:[47]}),t(v,{color:"primary",onClick:he},{default:l(()=>e[48]||(e[48]=[u(" Export Data ")])),_:1,__:[48]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(I,{modelValue:S.value,"onUpdate:modelValue":e[22]||(e[22]=o=>S.value=o),"max-width":"800",persistent:""},{default:l(()=>[t(g,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,null,{default:l(()=>e[49]||(e[49]=[u("Create New Royalty Record")])),_:1,__:[49]})]),_:1}),t(w,null,{default:l(()=>[t(ve,{ref_key:"formRef",ref:U,modelValue:Y.value,"onUpdate:modelValue":e[20]||(e[20]=o=>Y.value=o),onSubmit:me(re,["prevent"])},{default:l(()=>[t(h,null,{default:l(()=>[t(i,{cols:"12",md:"6"},{default:l(()=>[t(V,{modelValue:n.value.franchise_id,"onUpdate:modelValue":e[5]||(e[5]=o=>n.value.franchise_id=o),items:W.value,"item-title":"business_name","item-value":"id",label:"Franchise *",variant:"outlined",density:"compact",required:"",clearable:"",rules:y.franchise_id,"error-messages":p.value.franchise_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(V,{modelValue:n.value.unit_id,"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.unit_id=o),items:Z.value,"item-title":"unit_name","item-value":"id",label:"Unit",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(V,{modelValue:n.value.franchisee_id,"onUpdate:modelValue":e[7]||(e[7]=o=>n.value.franchisee_id=o),items:ee.value,"item-title":"name","item-value":"id",label:"Franchisee *",variant:"outlined",density:"compact",required:"",clearable:"",rules:y.franchisee_id,"error-messages":p.value.franchisee_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(V,{modelValue:n.value.type,"onUpdate:modelValue":e[8]||(e[8]=o=>n.value.type=o),items:ae,"item-title":"title","item-value":"value",label:"Royalty Type *",variant:"outlined",density:"compact",required:"",rules:y.type,"error-messages":p.value.type},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:l(()=>[t(c,{modelValue:n.value.period_year,"onUpdate:modelValue":e[9]||(e[9]=o=>n.value.period_year=o),modelModifiers:{number:!0},label:"Period Year *",type:"number",variant:"outlined",density:"compact",required:"",rules:y.period_year,"error-messages":p.value.period_year},null,8,["modelValue","rules","error-messages"])]),_:1}),n.value.type==="monthly"?(A(),j(i,{key:0,cols:"12",md:"4"},{default:l(()=>[t(c,{modelValue:n.value.period_month,"onUpdate:modelValue":e[10]||(e[10]=o=>n.value.period_month=o),modelModifiers:{number:!0},label:"Period Month *",type:"number",min:"1",max:"12",variant:"outlined",density:"compact",required:"",rules:y.period_month,"error-messages":p.value.period_month},null,8,["modelValue","rules","error-messages"])]),_:1})):z("",!0),t(i,{cols:"12",md:"4"},{default:l(()=>[t(c,{modelValue:n.value.due_date,"onUpdate:modelValue":e[11]||(e[11]=o=>n.value.due_date=o),label:"Due Date *",type:"date",variant:"outlined",density:"compact",required:"",rules:y.due_date,"error-messages":p.value.due_date},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.base_revenue,"onUpdate:modelValue":e[12]||(e[12]=o=>n.value.base_revenue=o),modelModifiers:{number:!0},label:"Base Revenue (SAR) *",type:"number",step:"0.01",variant:"outlined",density:"compact",required:"",onInput:x,rules:y.base_revenue,"error-messages":p.value.base_revenue},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.royalty_rate,"onUpdate:modelValue":e[13]||(e[13]=o=>n.value.royalty_rate=o),modelModifiers:{number:!0},label:"Royalty Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",onInput:x,rules:y.royalty_rate,"error-messages":p.value.royalty_rate},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.marketing_fee_rate,"onUpdate:modelValue":e[14]||(e[14]=o=>n.value.marketing_fee_rate=o),modelModifiers:{number:!0},label:"Marketing Fee Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",onInput:x,rules:y.marketing_fee_rate,"error-messages":p.value.marketing_fee_rate},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.technology_fee_amount,"onUpdate:modelValue":e[15]||(e[15]=o=>n.value.technology_fee_amount=o),modelModifiers:{number:!0},label:"Technology Fee (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.technology_fee_amount,"error-messages":p.value.technology_fee_amount},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.other_fees,"onUpdate:modelValue":e[16]||(e[16]=o=>n.value.other_fees=o),modelModifiers:{number:!0},label:"Other Fees (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.other_fees,"error-messages":p.value.other_fees},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:n.value.adjustments,"onUpdate:modelValue":e[17]||(e[17]=o=>n.value.adjustments=o),modelModifiers:{number:!0},label:"Adjustments (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.adjustments,"error-messages":p.value.adjustments},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(ce,{modelValue:n.value.description,"onUpdate:modelValue":e[18]||(e[18]=o=>n.value.description=o),label:"Description",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(ce,{modelValue:n.value.notes,"onUpdate:modelValue":e[19]||(e[19]=o=>n.value.notes=o),label:"Notes",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(B,null,{default:l(()=>[t(E),t(v,{color:"secondary",variant:"tonal",disabled:F.value,onClick:e[21]||(e[21]=o=>S.value=!1)},{default:l(()=>e[50]||(e[50]=[u(" Cancel ")])),_:1,__:[50]},8,["disabled"]),t(v,{color:"primary",loading:F.value,onClick:re},{default:l(()=>e[51]||(e[51]=[u(" Create Royalty ")])),_:1,__:[51]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(I,{modelValue:R.value,"onUpdate:modelValue":e[27]||(e[27]=o=>R.value=o),"max-width":"600"},{default:l(()=>[t(g,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,null,{default:l(()=>e[52]||(e[52]=[u("Mark Royalty as Completed")])),_:1,__:[52]})]),_:1}),t(w,null,{default:l(()=>[t(ve,{onSubmit:me(se,["prevent"])},{default:l(()=>[t(h,null,{default:l(()=>[t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:f.value.amount_paid,"onUpdate:modelValue":e[23]||(e[23]=o=>f.value.amount_paid=o),modelModifiers:{number:!0},label:"Amount Paid (SAR)",type:"number",variant:"outlined",density:"compact",rules:[o=>!!o||"Amount is required"]},null,8,["modelValue","rules"])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(c,{modelValue:f.value.payment_date,"onUpdate:modelValue":e[24]||(e[24]=o=>f.value.payment_date=o),label:"Payment Date",type:"date",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment date is required"]},null,8,["modelValue","rules"])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(V,{modelValue:f.value.payment_type,"onUpdate:modelValue":e[25]||(e[25]=o=>f.value.payment_type=o),items:be,"item-title":"title","item-value":"value",label:"Payment Type",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment type is required"]},null,8,["modelValue","rules"])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(ze,{label:"Attachment (Optional)",variant:"outlined",density:"compact",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:ke}),e[53]||(e[53]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Supported formats: PDF, JPG, PNG, DOC, DOCX ",-1))]),_:1,__:[53]})]),_:1})]),_:1})]),_:1}),t(B,null,{default:l(()=>[t(E),t(v,{color:"secondary",variant:"tonal",onClick:e[26]||(e[26]=o=>R.value=!1)},{default:l(()=>e[54]||(e[54]=[u(" Cancel ")])),_:1,__:[54]}),t(v,{color:"primary",onClick:se},{default:l(()=>e[55]||(e[55]=[u(" Mark as Completed ")])),_:1,__:[55]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(I,{modelValue:C.value,"onUpdate:modelValue":e[30]||(e[30]=o=>C.value=o),"max-width":"700"},{default:l(()=>[m.value?(A(),j(g,{key:0},{default:l(()=>[t(M,null,{default:l(()=>[t(q,null,{default:l(()=>e[56]||(e[56]=[u("Royalty Details")])),_:1,__:[56]})]),_:1}),t(T,{class:"mb-4"}),t(w,null,{default:l(()=>[t(h,null,{default:l(()=>[t(i,{cols:"12"},{default:l(()=>e[57]||(e[57]=[s("h6",{class:"text-h6 mb-4 text-primary"}," Basic Information ",-1)])),_:1,__:[57]}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",tt,[e[58]||(e[58]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Billing Period ",-1)),s("div",at,r(m.value.billing_period),1)])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",lt,[e[59]||(e[59]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Due Date ",-1)),s("div",ot,r(ie(m.value.due_date)),1)])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",st,[e[60]||(e[60]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Franchisee Name ",-1)),s("div",nt,r(m.value.franchisee_name),1)])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",it,[e[61]||(e[61]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Store Location ",-1)),s("div",rt,r(m.value.store_location),1)])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(T,{class:"my-4"}),e[62]||(e[62]=s("h6",{class:"text-h6 mb-4 text-primary"}," Financial Details ",-1))]),_:1,__:[62]}),t(i,{cols:"12",md:"4"},{default:l(()=>[t(g,{variant:"tonal",color:"info",class:"pa-4"},{default:l(()=>[s("div",ut,[t(_,{icon:"tabler-chart-line",size:"32",class:"mb-2"}),e[63]||(e[63]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Gross Sales ",-1)),s("div",dt,r((m.value.gross_sales||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),t(i,{cols:"12",md:"4"},{default:l(()=>[t(g,{variant:"tonal",color:"primary",class:"pa-4"},{default:l(()=>[s("div",mt,[t(_,{icon:"tabler-percentage",size:"32",class:"mb-2"}),e[64]||(e[64]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Rate ",-1)),s("div",pt,r(m.value.royalty_percentage)+"% ",1)])]),_:1})]),_:1}),t(i,{cols:"12",md:"4"},{default:l(()=>[t(g,{variant:"tonal",color:"success",class:"pa-4"},{default:l(()=>[s("div",yt,[t(_,{icon:"tabler-coins",size:"32",class:"mb-2"}),e[65]||(e[65]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Amount ",-1)),s("div",vt,r((m.value.amount||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(T,{class:"my-4"}),e[66]||(e[66]=s("h6",{class:"text-h6 mb-4 text-primary"}," Status Information ",-1))]),_:1,__:[66]}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",ct,[e[67]||(e[67]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Payment Status ",-1)),t(Q,{color:ne(m.value.status),size:"large",variant:"tonal",class:"text-capitalize"},{default:l(()=>[t(_,{icon:m.value.status==="paid"?"tabler-check":m.value.status==="pending"?"tabler-clock":"tabler-alert-triangle",class:"me-2"},null,8,["icon"]),u(" "+r(m.value.status),1)]),_:1},8,["color"])])]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",ft,[e[68]||(e[68]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Days Until Due ",-1)),s("div",_t,r(Math.ceil((new Date(m.value.due_date).getTime()-new Date().getTime())/(1e3*60*60*24)))+" days ",1)])]),_:1}),t(i,{cols:"12"},{default:l(()=>[t(T,{class:"my-4"}),e[69]||(e[69]=s("h6",{class:"text-h6 mb-4 text-primary"}," Calculation Breakdown ",-1))]),_:1,__:[69]}),t(i,{cols:"12"},{default:l(()=>[t(Ie,{density:"compact"},{default:l(()=>[s("tbody",null,[s("tr",null,[e[70]||(e[70]=s("td",{class:"font-weight-medium"}," Gross Sales: ",-1)),s("td",gt,r((m.value.gross_sales||0).toLocaleString())+" SAR ",1)]),s("tr",null,[e[71]||(e[71]=s("td",{class:"font-weight-medium"}," Royalty Rate: ",-1)),s("td",bt,r(m.value.royalty_percentage)+"% ",1)]),s("tr",null,[e[72]||(e[72]=s("td",{class:"font-weight-medium"}," Calculation: ",-1)),s("td",Vt,r((m.value.gross_sales||0).toLocaleString())+" × "+r(m.value.royalty_percentage)+"% ",1)]),s("tr",xt,[e[73]||(e[73]=s("td",{class:"font-weight-bold text-primary"}," Total Royalty Amount: ",-1)),s("td",ht,r((m.value.amount||0).toLocaleString())+" SAR ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),t(B,null,{default:l(()=>[t(E),t(v,{color:"secondary",variant:"tonal",onClick:e[28]||(e[28]=o=>C.value=!1)},{default:l(()=>e[74]||(e[74]=[u(" Close ")])),_:1,__:[74]}),m.value.status!=="paid"?(A(),j(v,{key:0,color:"primary",onClick:e[29]||(e[29]=o=>{oe(m.value),C.value=!1})},{default:l(()=>[t(_,{icon:"tabler-check",class:"me-2"}),e[75]||(e[75]=u(" Mark as Completed "))]),_:1,__:[75]})):z("",!0)]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"])]))}});export{ma as default};
