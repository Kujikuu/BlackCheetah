import{f as J}from"./formatters--UtN2sCw.js";import{d as Me,r as u,P as me,G as Te,c as qe,b as a,f as l,b5 as Q,o as P,e as s,a9 as v,t as m,ax as b,v as i,m as j,g as L,l as z,b3 as ye}from"./main-B8QbR-yS.js";import{V as $,_ as Fe}from"./VDialog-CEq2jzbd.js";import{r as M}from"./royalty-BtcUV0cC.js";import{V as w,a as n}from"./VRow-LlT6Azsr.js";import{V as x}from"./VSelect-GSzN3Qps.js";import{V as g,a as Oe,b as je,c as Le,d as B}from"./VCard-D9PhtsJ0.js";import{V as D}from"./VCardText-Cbtr6Qhr.js";import{V as pe}from"./VAvatar-87LH5tAk.js";import{S as ze}from"./saudi-riyal-DBg1zXmT.js";import{V as T}from"./VDivider-DOfIMbJY.js";import{V as $e}from"./VDataTable-FYAU2aQJ.js";import{V as ve}from"./VTooltip-D-apmXOm.js";import{V as X}from"./VChip-CgHwmC-k.js";import{V as Be}from"./VAlert-DpqH6FXl.js";import{V as I}from"./VSpacer-BSXBFFTK.js";import{V as ce}from"./VForm-C9sxpau4.js";import{V as f}from"./VTextField-C7_y5spr.js";import{V as fe}from"./VTextarea-1ursQqQ2.js";import{V as Ie}from"./VFileInput-Ip2n4ssl.js";import{V as Ne}from"./VTable-CgkStP3y.js";import"./VOverlay-B3La6Ajr.js";import"./forwardRefs--KQCZfKO.js";import"./scopeId-DyQ6a1uN.js";import"./VImg-Ceu2Mboj.js";import"./dialog-transition-Dy2Gj1XO.js";/* empty css              */import"./form-Dt-W1fp6.js";import"./VList-BJCgULVd.js";import"./VMenu-TQcmpCCv.js";import"./VCheckboxBtn-CWPoGbRz.js";import"./VSelectionControl-DDEVNAf7.js";import"./VSlideGroup-BuNiGLv2.js";import"./VField-Bw51LFql.js";import"./VInput-DB3XZUVb.js";const Ee={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Ge={class:"d-flex gap-3 align-center flex-wrap"},Ye={class:"d-flex align-center justify-space-between"},He={class:"text-h4 text-success"},Je={class:"d-flex align-center justify-space-between"},Qe={class:"text-h4 text-warning"},Xe={class:"font-weight-medium"},Ke={class:"font-weight-medium text-primary"},We={class:"text-body-2 text-medium-emphasis"},Ze={class:"text-body-2"},et={class:"font-weight-medium text-info"},tt={class:"font-weight-medium text-success"},at={class:"d-flex gap-2"},lt={class:"text-body-2"},ot={class:"mb-4"},st={class:"font-weight-medium"},rt={class:"mb-4"},nt={class:"font-weight-medium"},it={class:"mb-4"},ut={class:"font-weight-medium text-primary"},dt={class:"mb-4"},mt={class:"font-weight-medium"},yt={class:"text-center"},pt={class:"text-h6 font-weight-bold"},vt={class:"text-center"},ct={class:"text-h6 font-weight-bold"},ft={class:"text-center"},_t={class:"text-h6 font-weight-bold"},bt={class:"mb-4"},gt={class:"mb-4"},Vt={class:"font-weight-medium"},xt={class:"text-end"},ht={class:"text-end"},wt={class:"text-end"},kt={class:"bg-primary-lighten-5"},Ct={class:"text-end font-weight-bold text-primary"},ia=Me({__name:"royalty-management",setup(Rt){const K=u(!1),W=u(!1),q=u(!1),V=u("monthly"),k=u(!1),C=u(!1),R=u(!1),S=u(!1),F=u(null),d=u(null),U=u("csv"),O=u("all"),r=u({franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}),Z=u([]),ee=u([]),te=u([]),_=u({amount_paid:0,payment_date:"",payment_type:"",attachment:null}),ae=u([]),N=u({royalty_collected_till_date:0,upcoming_royalties:0,total_royalties:0,pending_amount:0,paid_amount:0,overdue_amount:0,overdue_count:0}),_e=me(()=>{var e;const t=(e=N.value)==null?void 0:e.royalty_collected_till_date;return t?Number(t):0}),be=me(()=>{var e;const t=(e=N.value)==null?void 0:e.upcoming_royalties;return t?Number(t):0}),le=[{title:"Monthly",value:"monthly"},{title:"Quarterly",value:"quarterly"},{title:"Annual",value:"annual"},{title:"Special",value:"special"}],ge=[{title:"CSV",value:"csv"},{title:"Excel",value:"excel"}],oe=[{title:"All Royalties",value:"all"},{title:"Paid Only",value:"paid"},{title:"Pending Only",value:"pending"},{title:"Overdue Only",value:"overdue"}],Ve=[{title:"Bank Transfer",value:"bank_transfer"},{title:"Credit Card",value:"credit_card"},{title:"Mada",value:"mada"},{title:"STC Pay",value:"stc_pay"},{title:"SADAD",value:"sadad"},{title:"Check",value:"check"},{title:"Cash",value:"cash"},{title:"Online Payment",value:"online_payment"}],xe=[{title:"Billing Period",key:"billingPeriod",sortable:!0},{title:"Franchisee Name",key:"franchiseeName",sortable:!0},{title:"Store Location",key:"storeLocation",sortable:!0},{title:"Due Date",key:"dueDate",sortable:!0},{title:"Gross Sales (SAR)",key:"grossSales",sortable:!0},{title:"Royalty %",key:"royaltyPercentage",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],E=async()=>{try{K.value=!0;const t=await M.getRoyalties({period:V.value});ae.value=t.data.data}catch{}finally{K.value=!1}},G=async()=>{try{W.value=!0;const t=await M.getStatistics({period:V.value});N.value=t.data}catch{}finally{W.value=!1}},he=()=>{k.value=!0},we=async()=>{try{const t=await M.exportRoyalties({format:U.value,data_type:O.value,period:V.value}),e=window.URL.createObjectURL(t),c=document.createElement("a");c.href=e,c.download=`royalty-data-${V.value}-${new Date().toISOString().split("T")[0]}.${U.value==="csv"?"csv":"xlsx"}`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(e),k.value=!1}catch{}},ke=t=>{d.value=t,R.value=!0},se=t=>{F.value=t,_.value={amount_paid:t.amount,payment_date:new Date().toISOString().split("T")[0],payment_type:"",attachment:null},C.value=!0},re=async()=>{if(F.value)try{await M.markAsPaid(F.value.id,_.value),await E(),await G(),C.value=!1,F.value=null,_.value={amount_paid:0,payment_date:"",payment_type:"",attachment:null}}catch{}},Ce=t=>{const e=t.target;e.files&&e.files[0]&&(_.value.attachment=e.files[0])},ne=t=>{switch(t){case"paid":return"success";case"pending":return"warning";case"overdue":return"error";default:return"default"}},ie=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Re=async()=>{try{const t=await Q("/api/v1/franchisor/franchise");t.success&&t.data&&(Z.value=[t.data])}catch{}},Se=async()=>{try{const t=await Q("/api/v1/franchisor/units");t.success&&t.data&&(ee.value=t.data.data||[])}catch{}},De=async()=>{try{const t=await Q("/api/v1/franchisor/franchisees");t.success&&t.data&&(te.value=t.data.data||[])}catch{}},h=()=>{const t=r.value.base_revenue;r.value.royalty_amount=t*r.value.royalty_rate/100,r.value.marketing_fee_amount=t*r.value.marketing_fee_rate/100,r.value.technology_fee_rate>0&&(r.value.technology_fee_amount=t*r.value.technology_fee_rate/100),r.value.total_amount=r.value.royalty_amount+r.value.marketing_fee_amount+r.value.technology_fee_amount+r.value.other_fees+r.value.adjustments},ue=async()=>{try{if(q.value=!0,Pe(),!await Ae())return;h();const e={...r.value,franchise_id:r.value.franchise_id||void 0,unit_id:r.value.unit_id||void 0,franchisee_id:r.value.franchisee_id||void 0};(await M.createRoyalty(e)).success&&(de(),S.value=!1,await E(),await G())}catch{}finally{q.value=!1}},de=()=>{r.value={franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}},Ue=()=>{de(),S.value=!0};Te(()=>{E(),G(),Re(),Se(),De()});const y=u({}),p={franchise_id:[t=>!!t||"Franchise selection is required"],franchisee_id:[t=>!!t||"Franchisee selection is required"],type:[t=>!!t||"Royalty type is required",t=>["monthly","quarterly"].includes(t)||"Invalid royalty type"],period_year:[t=>!!t||"Period year is required",t=>t>=2020||"Period year must be at least 2020",t=>t<=new Date().getFullYear()+1||"Period year cannot be more than next year"],period_month:[t=>r.value.type==="monthly"?!!t||"Period month is required for monthly royalties":!0,t=>t&&(t<1||t>12)?"Period month must be between 1 and 12":!0],period_quarter:[t=>r.value.type==="quarterly"?!!t||"Period quarter is required for quarterly royalties":!0,t=>t&&(t<1||t>4)?"Period quarter must be between 1 and 4":!0],base_revenue:[t=>t!=null&&t!==""||"Base revenue is required",t=>t>=0||"Base revenue cannot be negative",t=>t<=99999999999e-2||"Base revenue is too large"],royalty_rate:[t=>t!=null&&t!==""||"Royalty rate is required",t=>t>=0||"Royalty rate cannot be negative",t=>t<=100||"Royalty rate cannot exceed 100%"],marketing_fee_rate:[t=>t!=null&&t!==""||"Marketing fee rate is required",t=>t>=0||"Marketing fee rate cannot be negative",t=>t<=100||"Marketing fee rate cannot exceed 100%"],due_date:[t=>!!t||"Due date is required",t=>{if(t){const e=new Date().toISOString().split("T")[0];return t>=e||"Due date cannot be in the past"}return!0}],technology_fee_amount:[t=>t==null||t===""||t>=0||"Technology fee cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Technology fee is too large"],other_fees:[t=>t==null||t===""||t>=0||"Other fees cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Other fees is too large"],adjustments:[t=>t==null||t===""||t>=-99999999999e-2||"Adjustments value is too low",t=>t==null||t===""||t<=99999999999e-2||"Adjustments value is too high"],description:[t=>!t||t.length<=1e3||"Description cannot exceed 1000 characters"],notes:[t=>!t||t.length<=2e3||"Notes cannot exceed 2000 characters"]},Y=u(!1),A=u(),Ae=async()=>{if(A.value){const{valid:t}=await A.value.validate();return Y.value=t,t}return!1},Pe=()=>{y.value={},A.value&&A.value.resetValidation()};return(t,e)=>{const c=Fe;return P(),qe("section",null,[a(w,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[s("div",Ee,[e[37]||(e[37]=s("div",null,[s("h4",{class:"text-h4 mb-1"}," Royalty Management "),s("p",{class:"text-body-1 text-medium-emphasis"}," Track and manage royalty payments from all franchise units ")],-1)),s("div",Ge,[a(x,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=o=>V.value=o),items:le,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"]),a(v,{color:"success",variant:"elevated",onClick:Ue},{default:l(()=>[a(b,{icon:"tabler-plus",class:"me-2"}),e[35]||(e[35]=m(" Create Royalty "))]),_:1,__:[35]}),a(v,{color:"primary",variant:"elevated",onClick:he},{default:l(()=>[a(b,{icon:"tabler-download",class:"me-2"}),e[36]||(e[36]=m(" Export "))]),_:1,__:[36]})])])]),_:1})]),_:1}),a(w,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(g,null,{default:l(()=>[a(D,null,{default:l(()=>[s("div",Ye,[s("div",null,[e[38]||(e[38]=s("h6",{class:"text-h6 mb-1"}," Royalty Collected Till Date ",-1)),e[39]||(e[39]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Total payments received ",-1)),s("h4",He,i(("formatCurrency"in t?t.formatCurrency:j(J))(_e.value,"SAR",!0)),1)]),a(pe,{color:"success",variant:"tonal",size:"56"},{default:l(()=>[a(j(ze),{size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(g,null,{default:l(()=>[a(D,null,{default:l(()=>[s("div",Je,[s("div",null,[e[40]||(e[40]=s("h6",{class:"text-h6 mb-1"}," Upcoming Royalties ",-1)),e[41]||(e[41]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Pending payments due ",-1)),s("h4",Qe,i(("formatCurrency"in t?t.formatCurrency:j(J))(be.value,"SAR",!0)),1)]),a(pe,{color:"warning",variant:"tonal",size:"56"},{default:l(()=>[a(b,{icon:"tabler-clock",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(g,null,{default:l(()=>[a(Oe,{class:"pb-4"},{default:l(()=>[a(je,{class:"text-h6"},{default:l(()=>e[42]||(e[42]=[m(" Royalty Records ")])),_:1,__:[42]}),a(Le,{class:"text-body-2"},{default:l(()=>e[43]||(e[43]=[m(" Manage royalty payments and track collection status ")])),_:1,__:[43]})]),_:1}),a(T),a($e,{headers:xe,items:ae.value,"items-per-page":10,class:"text-no-wrap"},{"item.billingPeriod":l(({item:o})=>[s("div",Xe,i(o.billing_period),1)]),"item.franchiseeName":l(({item:o})=>[s("div",Ke,i(o.franchisee_name),1)]),"item.storeLocation":l(({item:o})=>[s("div",We,i(o.store_location),1)]),"item.dueDate":l(({item:o})=>[s("div",Ze,i(ie(o.due_date)),1)]),"item.grossSales":l(({item:o})=>[s("div",et,i(("formatCurrency"in t?t.formatCurrency:j(J))(o.gross_sales||0,"SAR",!1)),1)]),"item.royaltyPercentage":l(({item:o})=>[a(X,{size:"small",variant:"tonal",color:"primary"},{default:l(()=>[m(i(o.royalty_percentage)+"% ",1)]),_:2},1024)]),"item.amount":l(({item:o})=>[s("div",tt,i((o.amount||0).toLocaleString()),1)]),"item.status":l(({item:o})=>[a(X,{color:ne(o.status),size:"small",variant:"tonal",class:"text-capitalize"},{default:l(()=>[m(i(o.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[s("div",at,[a(v,{icon:"",size:"small",color:"info",variant:"text",onClick:H=>ke(o)},{default:l(()=>[a(b,{icon:"tabler-eye",size:"20"}),a(ve,{activator:"parent",location:"top"},{default:l(()=>e[44]||(e[44]=[m(" View Details ")])),_:1,__:[44]})]),_:2},1032,["onClick"]),o.status!=="paid"?(P(),L(v,{key:0,icon:"",size:"small",color:"success",variant:"text",onClick:H=>se(o)},{default:l(()=>[a(b,{icon:"tabler-check",size:"20"}),a(ve,{activator:"parent",location:"top"},{default:l(()=>e[45]||(e[45]=[m(" Mark as Completed ")])),_:1,__:[45]})]),_:2},1032,["onClick"])):z("",!0)])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),a($,{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=o=>k.value=o),"max-width":"600"},{default:l(()=>[a(c,{onClick:e[1]||(e[1]=o=>k.value=!1)}),a(g,{title:"Export Royalty Data"},{default:l(()=>[a(D,null,{default:l(()=>[a(w,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(x,{modelValue:O.value,"onUpdate:modelValue":e[2]||(e[2]=o=>O.value=o),items:oe,"item-title":"title","item-value":"value",label:"Data Type",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(x,{modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=o=>U.value=o),items:ge,"item-title":"title","item-value":"value",label:"Export Format",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),a(Be,{type:"info",variant:"tonal",class:"mt-4"},{default:l(()=>{var o;return[s("div",lt,[e[46]||(e[46]=s("strong",null,"Current Selection:",-1)),e[47]||(e[47]=s("br",null,null,-1)),m(" Period: "+i(V.value.charAt(0).toUpperCase()+V.value.slice(1)),1),e[48]||(e[48]=s("br",null,null,-1)),m(" Data Type: "+i((o=oe.find(H=>H.value===O.value))==null?void 0:o.title),1),e[49]||(e[49]=s("br",null,null,-1)),m(" Format: "+i(U.value.toUpperCase()),1)])]}),_:1})]),_:1}),a(B,null,{default:l(()=>[a(I),a(v,{color:"secondary",variant:"tonal",onClick:e[4]||(e[4]=o=>k.value=!1)},{default:l(()=>e[50]||(e[50]=[m(" Cancel ")])),_:1,__:[50]}),a(v,{color:"primary",onClick:we},{default:l(()=>e[51]||(e[51]=[m(" Export Data ")])),_:1,__:[51]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a($,{modelValue:S.value,"onUpdate:modelValue":e[24]||(e[24]=o=>S.value=o),"max-width":"600",persistent:""},{default:l(()=>[a(c,{onClick:e[6]||(e[6]=o=>S.value=!1)}),a(g,{title:"Create New Royalty Record"},{default:l(()=>[a(D,null,{default:l(()=>[a(ce,{ref_key:"formRef",ref:A,modelValue:Y.value,"onUpdate:modelValue":e[22]||(e[22]=o=>Y.value=o),onSubmit:ye(ue,["prevent"])},{default:l(()=>[a(w,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(x,{modelValue:r.value.franchise_id,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.franchise_id=o),items:Z.value,"item-title":"business_name","item-value":"id",label:"Franchise *",variant:"outlined",density:"compact",required:"",clearable:"",rules:p.franchise_id,"error-messages":y.value.franchise_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(x,{modelValue:r.value.unit_id,"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.unit_id=o),items:ee.value,"item-title":"unit_name","item-value":"id",label:"Unit",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(x,{modelValue:r.value.franchisee_id,"onUpdate:modelValue":e[9]||(e[9]=o=>r.value.franchisee_id=o),items:te.value,"item-title":"name","item-value":"id",label:"Franchisee *",variant:"outlined",density:"compact",required:"",clearable:"",rules:p.franchisee_id,"error-messages":y.value.franchisee_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(x,{modelValue:r.value.type,"onUpdate:modelValue":e[10]||(e[10]=o=>r.value.type=o),items:le,"item-title":"title","item-value":"value",label:"Royalty Type *",variant:"outlined",density:"compact",required:"",rules:p.type,"error-messages":y.value.type},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.period_year,"onUpdate:modelValue":e[11]||(e[11]=o=>r.value.period_year=o),modelModifiers:{number:!0},label:"Period Year *",type:"number",variant:"outlined",density:"compact",required:"",rules:p.period_year,"error-messages":y.value.period_year},null,8,["modelValue","rules","error-messages"])]),_:1}),r.value.type==="monthly"?(P(),L(n,{key:0,cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.period_month,"onUpdate:modelValue":e[12]||(e[12]=o=>r.value.period_month=o),modelModifiers:{number:!0},label:"Period Month *",type:"number",min:"1",max:"12",variant:"outlined",density:"compact",required:"",rules:p.period_month,"error-messages":y.value.period_month},null,8,["modelValue","rules","error-messages"])]),_:1})):z("",!0),a(n,{cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.due_date,"onUpdate:modelValue":e[13]||(e[13]=o=>r.value.due_date=o),label:"Due Date *",type:"date",variant:"outlined",density:"compact",required:"",rules:p.due_date,"error-messages":y.value.due_date},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.base_revenue,"onUpdate:modelValue":e[14]||(e[14]=o=>r.value.base_revenue=o),modelModifiers:{number:!0},label:"Base Revenue (SAR) *",type:"number",step:"0.01",variant:"outlined",density:"compact",required:"",rules:p.base_revenue,"error-messages":y.value.base_revenue,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.royalty_rate,"onUpdate:modelValue":e[15]||(e[15]=o=>r.value.royalty_rate=o),modelModifiers:{number:!0},label:"Royalty Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",rules:p.royalty_rate,"error-messages":y.value.royalty_rate,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.marketing_fee_rate,"onUpdate:modelValue":e[16]||(e[16]=o=>r.value.marketing_fee_rate=o),modelModifiers:{number:!0},label:"Marketing Fee Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",rules:p.marketing_fee_rate,"error-messages":y.value.marketing_fee_rate,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.technology_fee_amount,"onUpdate:modelValue":e[17]||(e[17]=o=>r.value.technology_fee_amount=o),modelModifiers:{number:!0},label:"Technology Fee (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.technology_fee_amount,"error-messages":y.value.technology_fee_amount,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.other_fees,"onUpdate:modelValue":e[18]||(e[18]=o=>r.value.other_fees=o),modelModifiers:{number:!0},label:"Other Fees (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.other_fees,"error-messages":y.value.other_fees,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.adjustments,"onUpdate:modelValue":e[19]||(e[19]=o=>r.value.adjustments=o),modelModifiers:{number:!0},label:"Adjustments (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",rules:p.adjustments,"error-messages":y.value.adjustments,onInput:h},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(fe,{modelValue:r.value.description,"onUpdate:modelValue":e[20]||(e[20]=o=>r.value.description=o),label:"Description",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(fe,{modelValue:r.value.notes,"onUpdate:modelValue":e[21]||(e[21]=o=>r.value.notes=o),label:"Notes",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(B,null,{default:l(()=>[a(I),a(v,{color:"secondary",variant:"tonal",disabled:q.value,onClick:e[23]||(e[23]=o=>S.value=!1)},{default:l(()=>e[52]||(e[52]=[m(" Cancel ")])),_:1,__:[52]},8,["disabled"]),a(v,{color:"primary",loading:q.value,onClick:ue},{default:l(()=>e[53]||(e[53]=[m(" Create Royalty ")])),_:1,__:[53]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a($,{modelValue:C.value,"onUpdate:modelValue":e[30]||(e[30]=o=>C.value=o),"max-width":"600"},{default:l(()=>[a(c,{onClick:e[25]||(e[25]=o=>C.value=!1)}),a(g,{title:"Mark Royalty as Completed"},{default:l(()=>[a(D,null,{default:l(()=>[a(ce,{onSubmit:ye(re,["prevent"])},{default:l(()=>[a(w,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:_.value.amount_paid,"onUpdate:modelValue":e[26]||(e[26]=o=>_.value.amount_paid=o),modelModifiers:{number:!0},label:"Amount Paid (SAR)",type:"number",variant:"outlined",density:"compact",rules:[o=>!!o||"Amount is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:_.value.payment_date,"onUpdate:modelValue":e[27]||(e[27]=o=>_.value.payment_date=o),label:"Payment Date",type:"date",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment date is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(x,{modelValue:_.value.payment_type,"onUpdate:modelValue":e[28]||(e[28]=o=>_.value.payment_type=o),items:Ve,"item-title":"title","item-value":"value",label:"Payment Type",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment type is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(Ie,{label:"Attachment (Optional)",variant:"outlined",density:"compact",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:Ce}),e[54]||(e[54]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Supported formats: PDF, JPG, PNG, DOC, DOCX ",-1))]),_:1,__:[54]})]),_:1})]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(I),a(v,{color:"secondary",variant:"tonal",onClick:e[29]||(e[29]=o=>C.value=!1)},{default:l(()=>e[55]||(e[55]=[m(" Cancel ")])),_:1,__:[55]}),a(v,{color:"primary",onClick:re},{default:l(()=>e[56]||(e[56]=[m(" Mark as Completed ")])),_:1,__:[56]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a($,{modelValue:R.value,"onUpdate:modelValue":e[34]||(e[34]=o=>R.value=o),"max-width":"600"},{default:l(()=>[a(c,{onClick:e[31]||(e[31]=o=>R.value=!1)}),d.value?(P(),L(g,{key:0,title:"Royalty Details"},{default:l(()=>[a(T,{class:"mb-4"}),a(D,null,{default:l(()=>[a(w,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>e[57]||(e[57]=[s("h6",{class:"text-h6 mb-4 text-primary"}," Basic Information ",-1)])),_:1,__:[57]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",ot,[e[58]||(e[58]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Billing Period ",-1)),s("div",st,i(d.value.billing_period),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",rt,[e[59]||(e[59]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Due Date ",-1)),s("div",nt,i(ie(d.value.due_date)),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",it,[e[60]||(e[60]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Franchisee Name ",-1)),s("div",ut,i(d.value.franchisee_name),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",dt,[e[61]||(e[61]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Store Location ",-1)),s("div",mt,i(d.value.store_location),1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(T,{class:"my-4"}),e[62]||(e[62]=s("h6",{class:"text-h6 mb-4 text-primary"}," Financial Details ",-1))]),_:1,__:[62]}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"info",class:"pa-4"},{default:l(()=>[s("div",yt,[a(b,{icon:"tabler-chart-line",size:"32",class:"mb-2"}),e[63]||(e[63]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Gross Sales ",-1)),s("div",pt,i((d.value.gross_sales||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"primary",class:"pa-4"},{default:l(()=>[s("div",vt,[a(b,{icon:"tabler-percentage",size:"32",class:"mb-2"}),e[64]||(e[64]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Rate ",-1)),s("div",ct,i(d.value.royalty_percentage)+"% ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"success",class:"pa-4"},{default:l(()=>[s("div",ft,[a(b,{icon:"tabler-coins",size:"32",class:"mb-2"}),e[65]||(e[65]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Amount ",-1)),s("div",_t,i((d.value.amount||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(T,{class:"my-4"}),e[66]||(e[66]=s("h6",{class:"text-h6 mb-4 text-primary"}," Status Information ",-1))]),_:1,__:[66]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",bt,[e[67]||(e[67]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Payment Status ",-1)),a(X,{color:ne(d.value.status),size:"large",variant:"tonal",class:"text-capitalize"},{default:l(()=>[a(b,{icon:d.value.status==="paid"?"tabler-check":d.value.status==="pending"?"tabler-clock":"tabler-alert-triangle",class:"me-2"},null,8,["icon"]),m(" "+i(d.value.status),1)]),_:1},8,["color"])])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",gt,[e[68]||(e[68]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Days Until Due ",-1)),s("div",Vt,i(Math.ceil((new Date(d.value.due_date).getTime()-new Date().getTime())/(1e3*60*60*24)))+" days ",1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(T,{class:"my-4"}),e[69]||(e[69]=s("h6",{class:"text-h6 mb-4 text-primary"}," Calculation Breakdown ",-1))]),_:1,__:[69]}),a(n,{cols:"12"},{default:l(()=>[a(Ne,{density:"compact"},{default:l(()=>[s("tbody",null,[s("tr",null,[e[70]||(e[70]=s("td",{class:"font-weight-medium"}," Gross Sales: ",-1)),s("td",xt,i((d.value.gross_sales||0).toLocaleString())+" SAR ",1)]),s("tr",null,[e[71]||(e[71]=s("td",{class:"font-weight-medium"}," Royalty Rate: ",-1)),s("td",ht,i(d.value.royalty_percentage)+"% ",1)]),s("tr",null,[e[72]||(e[72]=s("td",{class:"font-weight-medium"}," Calculation: ",-1)),s("td",wt,i((d.value.gross_sales||0).toLocaleString())+" × "+i(d.value.royalty_percentage)+"% ",1)]),s("tr",kt,[e[73]||(e[73]=s("td",{class:"font-weight-bold text-primary"}," Total Royalty Amount: ",-1)),s("td",Ct,i((d.value.amount||0).toLocaleString())+" SAR ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(I),a(v,{color:"secondary",variant:"tonal",onClick:e[32]||(e[32]=o=>R.value=!1)},{default:l(()=>e[74]||(e[74]=[m(" Close ")])),_:1,__:[74]}),d.value.status!=="paid"?(P(),L(v,{key:0,color:"primary",onClick:e[33]||(e[33]=o=>{se(d.value),R.value=!1})},{default:l(()=>[a(b,{icon:"tabler-check",class:"me-2"}),e[75]||(e[75]=m(" Mark as Completed "))]),_:1,__:[75]})):z("",!0)]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"])])}}});export{ia as default};
