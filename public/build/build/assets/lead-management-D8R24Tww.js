import{V as we,_ as ke}from"./VDataTableServer-BWxyP1dG.js";import{_ as he}from"./AppTextField.vue_vue_type_script_setup_true_lang-DNHIefB9.js";import{_ as Se}from"./AppSelect.vue_vue_type_script_setup_true_lang-BXcpWyT4.js";import{_ as Le}from"./AddNoteModal.vue_vue_type_script_setup_true_lang-CRvPyrn5.js";import{l as w}from"./lead-FmLmqpxP.js";import{d as Ue,r as i,P as De,w as Ae,G as Ne,c as W,e as n,b as t,f as a,aR as m,m as s,j as Ee,a as Ie,o as $,F as $e,i as Fe,g as Q,v as d,x as Be,ax as D,t as u,l as Pe,a9 as p}from"./main-ZX0RELSf.js";import{V as G,a as F}from"./VRow-Cqbjxu10.js";import{V as B,a as T,b as z,d as H}from"./VCard-BPtOKe4P.js";import{V as K}from"./VDialog-Dnb-q-MU.js";import{V as A}from"./VCardText-DO_FRZge.js";import{V as X}from"./VAvatar-Dwbi0l9K.js";import{V as Y}from"./VDivider-DRORfMXN.js";import{V as j}from"./VSpacer-DBsXqXW-.js";import{V as Re}from"./VMenu-CFk79Z2P.js";import{V as Te,a as Z,b as ee}from"./VList-lm2yDhsx.js";import{V as ze}from"./VChip-BX1klc4g.js";import{V as je}from"./VFileInput-BX2KlnoB.js";import"./VDataTable-CHmbGzQf.js";import"./VSelect-CM_Ce6Fz.js";import"./VTextField-vxp1RpFW.js";import"./VImg-BhWA0TmX.js";import"./VField-D__vLB60.js";import"./form-BPJFMOHG.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-CMh6ZUdK.js";import"./dialog-transition-DDagBWdU.js";import"./VOverlay-B0AA_Njd.js";import"./scopeId-B6sKQhYQ.js";import"./VCheckboxBtn-CZL42UAA.js";import"./VSelectionControl-6Sm4Tpt1.js";import"./VTable-BRZOEiHP.js";import"./AppTextarea.vue_vue_type_script_setup_true_lang-nRgD-ubi.js";import"./VTextarea-KmmZ1HjF.js";import"./VForm-CMcQHaRk.js";/* empty css              */import"./VSlideGroup-D2CZ4fkn.js";const Oe={class:"d-flex mb-6"},qe={class:"d-flex justify-space-between"},Me={class:"d-flex flex-column gap-y-1"},Je={class:"text-body-1 text-high-emphasis"},We={class:"d-flex gap-x-2 align-center"},Qe={class:"text-h4"},Ge={class:"me-3 d-flex gap-3"},He={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ke={style:{"inline-size":"15.625rem"}},Xe={class:"text-body-1 font-weight-medium"},Ye={class:"d-flex align-center gap-x-4"},Ze={class:"d-flex flex-column"},el={class:"text-body-1"},ll={class:"text-body-1"},tl={class:"text-body-1"},al={class:"text-body-1"},ol={class:"text-body-1 text-capitalize"},sl={class:"text-body-1"},nl={class:"text-body-1"},il={class:"mb-4"},Jl=Ue({__name:"lead-management",setup(rl){const k=i(""),h=i(),S=i(),L=i(),N=i(!1),O=i(null),g=i(!1),x=i(!1),b=i(null),V=i(!1),C=i(null),f=i(10),v=i(1),q=i(),M=i(),c=i([]),le=o=>{var e,r;q.value=(e=o.sortBy[0])==null?void 0:e.key,M.value=(r=o.sortBy[0])==null?void 0:r.order,U()},te=o=>o>0?`+${o}`:o,ae=o=>o.split(" ").map(e=>e[0]).join("").toUpperCase(),oe=[{title:"#",key:"index",sortable:!1},{title:"Lead Name",key:"name"},{title:"Company",key:"company"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Location",key:"location"},{title:"Source",key:"source"},{title:"Status",key:"status"},{title:"Owner",key:"owner"},{title:"Last Contacted",key:"lastContacted"},{title:"Actions",key:"actions",sortable:!1}],E=i([]),I=i(0),J=i([]),se=De(()=>E.value),U=async()=>{try{V.value=!0,C.value=null;const o=await w.getLeads({status:h.value,source:S.value,owner:L.value,search:k.value,itemsPerPage:f.value,page:v.value,sortBy:q.value,orderBy:M.value});o.success&&(E.value=o.leads,I.value=o.total)}catch(o){C.value=o.message||"Failed to fetch leads",console.error("Error fetching leads:",o)}finally{V.value=!1}},P=async()=>{try{const o=await w.getStatistics();o.success&&(J.value=o.data)}catch(o){console.error("Error fetching statistics:",o)}};Ae([k,h,S,L,v,f],()=>{U()}),Ne(()=>{U(),P()});const ne=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Email Campaign",value:"email"}],ie=[{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"}],re=[{title:"Sarah Johnson",value:"sarah_johnson"},{title:"John Smith",value:"john_smith"},{title:"Michael Brown",value:"michael_brown"}],de=o=>{const e=o.toLowerCase();return e==="qualified"?"success":e==="unqualified"?"error":"primary"},ue=o=>{b.value=o,x.value=!0},ce=async()=>{if(b.value!==null)try{if(V.value=!0,(await w.deleteLead(b.value)).success){const e=E.value.findIndex(_=>_.id===b.value);e!==-1&&E.value.splice(e,1);const r=c.value.findIndex(_=>_===b.value);r!==-1&&c.value.splice(r,1),I.value--}}catch(o){console.error("Error deleting lead:",o),C.value=o.message||"Failed to delete lead"}finally{V.value=!1,x.value=!1,b.value=null}},me=async()=>{if(c.value.length!==0)try{V.value=!0,(await w.bulkDelete(c.value)).success&&(await U(),await P(),c.value=[])}catch(o){console.error("Error bulk deleting leads:",o),C.value=o.message||"Failed to delete leads"}finally{V.value=!1}},y=i(null),pe=o=>{const e=o.target;e.files&&e.files[0]&&(y.value=e.files[0])},fe=()=>{const o=`First Name,Last Name,Email,Phone,Company,Country,State,City,Lead Source,Lead Status,Lead Owner
John,Doe,john.doe@example.com,+1234567890,Example Corp,USA,California,Los Angeles,Website,qualified,Sarah Johnson`,e=new Blob([o],{type:"text/csv"}),r=window.URL.createObjectURL(e),_=document.createElement("a");_.href=r,_.download="leads_example.csv",_.click(),window.URL.revokeObjectURL(r)},ve=async()=>{if(!y.value){C.value="Please select a CSV file";return}try{V.value=!0,(await w.importCsv(y.value)).success&&(await U(),await P(),g.value=!1,y.value=null)}catch(o){console.error("Error importing CSV:",o),C.value=o.message||"Failed to import CSV"}finally{V.value=!1}},_e=()=>{const o=c.value.length>0?c.value:void 0,e=w.exportCsv(o),r=document.createElement("a");r.href=e,r.download=`leads_${c.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},Ve=o=>{O.value=o,N.value=!0},ye=()=>{console.log("Note added successfully")},ge=Ee(),xe=()=>{ge.push({name:"sales-add-lead"})};return(o,e)=>{const r=Se,_=he,be=Ie("RouterLink"),Ce=ke;return $(),W("section",null,[n("div",Oe,[t(G,null,{default:a(()=>[($(!0),W($e,null,Fe(s(J),(l,R)=>($(),Q(F,{key:R,cols:"12",md:"4",sm:"6"},{default:a(()=>[t(B,null,{default:a(()=>[t(A,null,{default:a(()=>[n("div",qe,[n("div",Me,[n("div",Je,d(l.title),1),n("div",We,[n("h4",Qe,d(l.value),1),n("div",{class:Be(["text-base",l.change>0?"text-success":"text-error"])}," ("+d(te(l.change))+"%) ",3)])]),t(X,{color:l.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[t(D,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(B,{class:"mb-6"},{default:a(()=>[t(T,{class:"pb-4"},{default:a(()=>[t(z,null,{default:a(()=>e[16]||(e[16]=[u("Filters")])),_:1,__:[16]})]),_:1}),t(A,null,{default:a(()=>[t(G,null,{default:a(()=>[t(F,{cols:"12",sm:"4"},{default:a(()=>[t(r,{modelValue:s(S),"onUpdate:modelValue":e[0]||(e[0]=l=>m(S)?S.value=l:null),placeholder:"Select Source",items:ne,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"4"},{default:a(()=>[t(r,{modelValue:s(h),"onUpdate:modelValue":e[1]||(e[1]=l=>m(h)?h.value=l:null),placeholder:"Select Status",items:ie,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"4"},{default:a(()=>[t(r,{modelValue:s(L),"onUpdate:modelValue":e[2]||(e[2]=l=>m(L)?L.value=l:null),placeholder:"Select Owner",items:re,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Y),t(A,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[n("div",Ge,[t(r,{"model-value":s(f),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=parseInt(l,10))},null,8,["model-value"]),s(c).length>0?($(),Q(p,{key:0,variant:"tonal",color:"error",onClick:me},{default:a(()=>[t(D,{icon:"tabler-trash",class:"me-2"}),u(" Delete Selected ("+d(s(c).length)+") ",1)]),_:1})):Pe("",!0)]),t(j),n("div",He,[n("div",Ke,[t(_,{modelValue:s(k),"onUpdate:modelValue":e[4]||(e[4]=l=>m(k)?k.value=l:null),placeholder:"Search Lead"},null,8,["modelValue"])]),t(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-file-import",onClick:e[5]||(e[5]=l=>g.value=!0)},{default:a(()=>e[17]||(e[17]=[u(" Import ")])),_:1,__:[17]}),t(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:_e},{default:a(()=>[u(" Export "+d(s(c).length>0?`(${s(c).length})`:"All"),1)]),_:1}),t(p,{"prepend-icon":"tabler-plus",onClick:xe},{default:a(()=>e[18]||(e[18]=[u(" Add Lead ")])),_:1,__:[18]})])]),_:1}),t(Y),t(we,{"items-per-page":s(f),"onUpdate:itemsPerPage":e[7]||(e[7]=l=>m(f)?f.value=l:null),"model-value":s(c),"onUpdate:modelValue":e[8]||(e[8]=l=>m(c)?c.value=l:null),page:s(v),"onUpdate:page":e[9]||(e[9]=l=>m(v)?v.value=l:null),items:s(se),"item-value":"id","items-length":s(I),headers:oe,class:"text-no-wrap","show-select":"","onUpdate:options":le},{"item.index":a(({index:l})=>[n("div",Xe,d((s(v)-1)*s(f)+l+1),1)]),"item.name":a(({item:l})=>[n("div",Ye,[t(X,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[n("span",null,d(ae(`${l.firstName} ${l.lastName}`)),1)]),_:2},1024),n("div",Ze,[t(be,{to:{name:"sales-leads-id",params:{id:l.id}},class:"text-link"},{default:a(()=>[u(d(l.firstName)+" "+d(l.lastName),1)]),_:2},1032,["to"])])])]),"item.company":a(({item:l})=>[n("div",el,d(l.company),1)]),"item.email":a(({item:l})=>[n("div",ll,d(l.email),1)]),"item.phone":a(({item:l})=>[n("div",tl,d(l.phone),1)]),"item.location":a(({item:l})=>[n("div",al,d(l.city)+", "+d(l.state),1)]),"item.source":a(({item:l})=>[n("div",ol,d(l.source),1)]),"item.status":a(({item:l})=>[t(ze,{color:de(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[u(d(l.status),1)]),_:2},1032,["color"])]),"item.owner":a(({item:l})=>[n("div",sl,d(l.owner),1)]),"item.lastContacted":a(({item:l})=>[n("div",nl,d(l.lastContacted),1)]),"item.actions":a(({item:l})=>[t(p,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[t(D,{icon:"tabler-dots-vertical"}),t(Re,{activator:"parent"},{default:a(()=>[t(Te,null,{default:a(()=>[t(Z,{onClick:R=>Ve(l.id)},{prepend:a(()=>[t(D,{icon:"tabler-note"})]),default:a(()=>[t(ee,null,{default:a(()=>e[19]||(e[19]=[u("Add Note")])),_:1,__:[19]})]),_:2},1032,["onClick"]),t(Z,{onClick:R=>ue(l.id)},{prepend:a(()=>[t(D,{icon:"tabler-trash"})]),default:a(()=>[t(ee,null,{default:a(()=>e[20]||(e[20]=[u("Delete")])),_:1,__:[20]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[t(Ce,{page:s(v),"onUpdate:page":e[6]||(e[6]=l=>m(v)?v.value=l:null),"items-per-page":s(f),"total-items":s(I)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),t(K,{modelValue:s(g),"onUpdate:modelValue":e[12]||(e[12]=l=>m(g)?g.value=l:null),"max-width":"600"},{default:a(()=>[t(B,null,{default:a(()=>[t(T,null,{default:a(()=>[t(z,null,{default:a(()=>e[21]||(e[21]=[u("Import Leads from CSV")])),_:1,__:[21]})]),_:1}),t(A,null,{default:a(()=>[n("div",il,[t(p,{variant:"tonal",color:"secondary",size:"small","prepend-icon":"tabler-download",onClick:fe},{default:a(()=>e[22]||(e[22]=[u(" Download Example CSV ")])),_:1,__:[22]})]),t(je,{modelValue:s(y),"onUpdate:modelValue":e[10]||(e[10]=l=>m(y)?y.value=l:null),label:"Select CSV File",accept:".csv","prepend-icon":"tabler-file-upload","show-size":"",onChange:pe},null,8,["modelValue"])]),_:1}),t(H,null,{default:a(()=>[t(j),t(p,{color:"secondary",variant:"tonal",onClick:e[11]||(e[11]=l=>g.value=!1)},{default:a(()=>e[23]||(e[23]=[u(" Cancel ")])),_:1,__:[23]}),t(p,{color:"primary",onClick:ve},{default:a(()=>e[24]||(e[24]=[u(" Import ")])),_:1,__:[24]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(K,{modelValue:s(x),"onUpdate:modelValue":e[14]||(e[14]=l=>m(x)?x.value=l:null),"max-width":"500"},{default:a(()=>[t(B,null,{default:a(()=>[t(T,null,{default:a(()=>[t(z,null,{default:a(()=>e[25]||(e[25]=[u("Confirm Delete")])),_:1,__:[25]})]),_:1}),t(A,null,{default:a(()=>e[26]||(e[26]=[u(" Are you sure you want to delete this lead? This action cannot be undone. ")])),_:1,__:[26]}),t(H,null,{default:a(()=>[t(j),t(p,{color:"secondary",variant:"tonal",onClick:e[13]||(e[13]=l=>x.value=!1)},{default:a(()=>e[27]||(e[27]=[u(" Cancel ")])),_:1,__:[27]}),t(p,{color:"error",onClick:ce},{default:a(()=>e[28]||(e[28]=[u(" Delete ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Le,{"is-dialog-visible":s(N),"onUpdate:isDialogVisible":e[15]||(e[15]=l=>m(N)?N.value=l:null),"lead-id":s(O)||0,onNoteAdded:ye},null,8,["is-dialog-visible","lead-id"])])}}});export{Jl as default};
