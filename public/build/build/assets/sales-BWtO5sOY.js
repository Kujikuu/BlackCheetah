import{V as be,_ as we}from"./VDataTableServer-BWxyP1dG.js";import{_ as Ve}from"./AppTextField.vue_vue_type_script_setup_true_lang-DNHIefB9.js";import{_ as Ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-BXcpWyT4.js";import{_ as he}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-DPyxkZx2.js";import{_ as ke,a as Se}from"./ResetPasswordDialog.vue_vue_type_script_setup_true_lang-brppREYr.js";import{_ as Ue}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-BEUne6WM.js";import{d as De,r as i,P as Ee,G as $e,c as z,b as t,f as a,m as o,aR as f,b5 as h,o as b,e as r,F as Pe,i as Te,g as F,v as u,x as Fe,ax as v,l as W,t as c,a9 as D}from"./main-ZX0RELSf.js";import{V as B,a as I}from"./VRow-Cqbjxu10.js";import{V as q,a as Ae,b as Ne}from"./VCard-BPtOKe4P.js";import{V as O}from"./VCardText-DO_FRZge.js";import{V as J}from"./VAvatar-Dwbi0l9K.js";import{V as R}from"./VDivider-DRORfMXN.js";import{V as Le}from"./VSpacer-DBsXqXW-.js";import{V as Q}from"./VMenu-CFk79Z2P.js";import{V as H,a as k,b as S}from"./VList-lm2yDhsx.js";import{V as ze}from"./VAlert-DtX8sKY_.js";import{V as Be}from"./VChip-BX1klc4g.js";import{V as Ie}from"./VImg-BhWA0TmX.js";import"./VDataTable-CHmbGzQf.js";import"./VSelect-CM_Ce6Fz.js";import"./VTextField-vxp1RpFW.js";import"./VField-D__vLB60.js";import"./form-BPJFMOHG.js";import"./forwardRefs--KQCZfKO.js";import"./VInput-CMh6ZUdK.js";import"./dialog-transition-DDagBWdU.js";import"./VOverlay-B0AA_Njd.js";import"./scopeId-B6sKQhYQ.js";import"./VCheckboxBtn-CZL42UAA.js";import"./VSelectionControl-6Sm4Tpt1.js";import"./VTable-BRZOEiHP.js";import"./validators-BHkKs9Dp.js";import"./VNavigationDrawer-BGzA-gtD.js";import"./VForm-CMcQHaRk.js";import"./VDialog-Dnb-q-MU.js";import"./VTooltip-BqTXI_Ub.js";import"./formatters--UtN2sCw.js";/* empty css              */import"./VSlideGroup-D2CZ4fkn.js";const Oe={class:"d-flex justify-space-between"},Re={class:"d-flex flex-column gap-y-1"},je={class:"text-body-1 text-high-emphasis"},Me={class:"d-flex gap-x-2 align-center"},Ge={class:"text-h4"},We={class:"text-sm"},qe={class:"me-3 d-flex gap-3"},Je={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Qe={style:{"inline-size":"15.625rem"}},He={class:"text-center pa-8"},Ke={class:"d-flex align-center gap-x-4"},Xe={key:1},Ye={class:"d-flex flex-column"},Ze={class:"text-base font-weight-medium"},es={class:"text-sm text-medium-emphasis"},ss={class:"text-body-1 text-high-emphasis"},ts={class:"text-body-1"},ls={class:"text-body-1"},as={class:"d-flex gap-1"},Ws=De({__name:"sales",setup(os){const g=i(""),w=i(),_=i(10),y=i(1),A=i([{key:"created_at",order:"desc"}]),K=i("desc"),d=i([]),X=s=>{var e;s.sortBy&&s.sortBy.length>0&&(A.value=s.sortBy,K.value=(e=s.sortBy[0])==null?void 0:e.order)},Y=[{title:"User",key:"user"},{title:"City",key:"city"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],V=i([]),N=i(!1),n=i(""),L=i(0),E=async()=>{var s,e;N.value=!0,n.value="";try{const m=await h("/v1/admin/users/sales",{method:"GET",query:{search:g.value,status:w.value,sort_by:((s=A.value[0])==null?void 0:s.key)||"created_at",sort_direction:((e=A.value[0])==null?void 0:e.order)||"desc",page:y.value,per_page:_.value}});m.success?(V.value=m.data.data||[],L.value=m.data.total||0):n.value=m.message||"Failed to fetch sales users"}catch(m){console.error("Error fetching sales users:",m),n.value="Failed to fetch sales users"}finally{N.value=!1}},Z=Ee(()=>{let s=V.value;return g.value&&(s=s.filter(e=>e.fullName.toLowerCase().includes(g.value.toLowerCase())||e.email.toLowerCase().includes(g.value.toLowerCase())||e.city.toLowerCase().includes(g.value.toLowerCase()))),w.value&&(s=s.filter(e=>e.status===w.value)),s}),ee=[{title:"Pending",value:"pending"},{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],se=s=>{const e=s.toLowerCase();return e==="pending"?"warning":e==="active"?"success":e==="inactive"?"secondary":"primary"},x=i(!1),$=i(!1),P=i(!1),T=i(!1),p=i(null),C=i(null),te=s=>s>0?`+${s}`:s,le=s=>{if(!s||typeof s!="string")return"U";const e=s.split(" ");return e.length>1?`${e[0][0]}${e[1][0]}`:s.slice(0,2)},ae=async s=>{try{const e=await h("/v1/admin/users",{method:"POST",body:{...s,role:"sales"}});e.success?await E():n.value=e.message||"Failed to create sales user"}catch(e){console.error("Error creating sales user:",e),n.value="Failed to create sales user"}},oe=s=>{p.value={...s},x.value=!0},re=async s=>{try{const e=await h(`/v1/admin/users/${s.id}`,{method:"PUT",body:s});e.success?(await E(),p.value=null):n.value=e.message||"Failed to update sales user"}catch(e){console.error("Error updating sales user:",e),n.value="Failed to update sales user"}},ie=async s=>{s.id?await re(s):await ae(s)},ne=s=>{C.value=s,$.value=!0},ue=async()=>{if(C.value){try{const s=await h(`/v1/admin/users/${C.value.id}`,{method:"DELETE"});if(s.success){await E();const e=d.value.findIndex(m=>m===C.value.id);e!==-1&&d.value.splice(e,1)}else n.value=s.message||"Failed to delete sales user"}catch(s){console.error("Error deleting sales user:",s),n.value="Failed to delete sales user"}C.value=null}},de=s=>{p.value=s,P.value=!0},ce=async s=>{if(p.value){try{const e=await h(`/v1/admin/users/${p.value.id}/reset-password`,{method:"POST",body:{password:s}});e.success?console.log("Password reset successfully for:",p.value.fullName):n.value=e.message||"Failed to reset password"}catch(e){console.error("Error resetting password:",e),n.value="Failed to reset password"}p.value=null}},pe=()=>{p.value=null},j=i([{title:"Total Sales Users",value:"0",change:0,desc:"All sales team members",icon:"tabler-chart-line",iconColor:"primary"},{title:"Active Sales",value:"0",change:0,desc:"Currently active",icon:"tabler-user-check",iconColor:"success"},{title:"Pending Approval",value:"0",change:0,desc:"Awaiting verification",icon:"tabler-clock",iconColor:"warning"}]),me=async()=>{try{const s=await h("/v1/admin/users/sales/stats");s.success&&(j.value=s.data)}catch(s){console.error("Error fetching sales stats:",s)}},ve=s=>{p.value=s,T.value=!0},fe=()=>{x.value=!0},ge=()=>{const s=d.value.length>0?V.value.filter(e=>d.value.includes(e.id)):V.value;console.log("Exporting to CSV:",s)},_e=()=>{const s=d.value.length>0?V.value.filter(e=>d.value.includes(e.id)):V.value;console.log("Exporting to PDF:",s)};return $e(()=>{E(),me()}),(s,e)=>{var M,G;const m=Ce,ye=Ve,xe=we;return b(),z("section",null,[t(B,{class:"mb-6"},{default:a(()=>[t(I,{cols:"12"},{default:a(()=>e[14]||(e[14]=[r("div",{class:"d-flex align-center justify-space-between"},[r("div",null,[r("h2",{class:"text-h2 mb-1"}," Sales Team Management "),r("p",{class:"text-body-1 text-medium-emphasis"}," Manage and monitor all sales team members ")])],-1)])),_:1,__:[14]})]),_:1}),t(B,{class:"mb-6"},{default:a(()=>[(b(!0),z(Pe,null,Te(o(j),(l,U)=>(b(),F(I,{key:U,cols:"12",md:"4",sm:"6"},{default:a(()=>[t(q,null,{default:a(()=>[t(O,null,{default:a(()=>[r("div",Oe,[r("div",Re,[r("div",je,u(l.title),1),r("div",Me,[r("h4",Ge,u(l.value),1),r("div",{class:Fe(["text-base",l.change>0?"text-success":"text-error"])}," ("+u(te(l.change))+"%) ",3)]),r("div",We,u(l.desc),1)]),t(J,{color:l.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[t(v,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(q,{class:"mb-6"},{default:a(()=>[t(Ae,{class:"pb-4"},{default:a(()=>[t(Ne,null,{default:a(()=>e[15]||(e[15]=[c("Filters")])),_:1,__:[15]})]),_:1}),t(O,null,{default:a(()=>[t(B,null,{default:a(()=>[t(I,{cols:"12",sm:"4"},{default:a(()=>[t(m,{modelValue:o(w),"onUpdate:modelValue":e[0]||(e[0]=l=>f(w)?w.value=l:null),placeholder:"Select Status",items:ee,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(R),t(O,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[r("div",qe,[t(m,{"model-value":o(_),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=parseInt(l,10))},null,8,["model-value"]),o(d).length>0?(b(),F(D,{key:0,variant:"tonal",color:"error",onClick:s.bulkDelete},{default:a(()=>[t(v,{icon:"tabler-trash",class:"me-2"}),c(" Delete Selected ("+u(o(d).length)+") ",1)]),_:1},8,["onClick"])):W("",!0)]),t(Le),r("div",Je,[r("div",Qe,[t(ye,{modelValue:o(g),"onUpdate:modelValue":e[2]||(e[2]=l=>f(g)?g.value=l:null),placeholder:"Search Sales User"},null,8,["modelValue"])]),t(D,{variant:"tonal",color:"secondary"},{default:a(()=>[t(v,{icon:"tabler-upload",class:"me-2"}),c(" Export "+u(o(d).length>0?`(${o(d).length})`:"All")+" ",1),t(Q,{activator:"parent"},{default:a(()=>[t(H,null,{default:a(()=>[t(k,{onClick:ge},{prepend:a(()=>[t(v,{icon:"tabler-file-type-csv"})]),default:a(()=>[t(S,null,{default:a(()=>e[16]||(e[16]=[c("Export to CSV")])),_:1,__:[16]})]),_:1}),t(k,{onClick:_e},{prepend:a(()=>[t(v,{icon:"tabler-file-type-pdf"})]),default:a(()=>[t(S,null,{default:a(()=>e[17]||(e[17]=[c("Export to PDF")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1}),t(D,{"prepend-icon":"tabler-plus",onClick:e[3]||(e[3]=l=>x.value=!0)},{default:a(()=>e[18]||(e[18]=[c(" Add New Sales User ")])),_:1,__:[18]})])]),_:1}),t(R),o(n)?(b(),F(ze,{key:0,type:"error",class:"ma-4",closable:"","onClick:close":e[4]||(e[4]=l=>n.value=null)},{default:a(()=>[c(u(o(n)),1)]),_:1})):W("",!0),t(be,{"items-per-page":o(_),"onUpdate:itemsPerPage":e[7]||(e[7]=l=>f(_)?_.value=l:null),"model-value":o(d),"onUpdate:modelValue":e[8]||(e[8]=l=>f(d)?d.value=l:null),page:o(y),"onUpdate:page":e[9]||(e[9]=l=>f(y)?y.value=l:null),items:o(Z),"item-value":"id","items-length":o(L),headers:Y,class:"text-no-wrap","show-select":"",loading:o(N),"onUpdate:options":X},{"no-data":a(()=>[r("div",He,[t(v,{icon:"tabler-users-off",size:"64",class:"mb-4 text-disabled"}),e[20]||(e[20]=r("h3",{class:"text-h5 mb-2"}," No Sales Users Found ",-1)),e[21]||(e[21]=r("p",{class:"text-body-1 text-medium-emphasis mb-4"}," No sales users match your search criteria. Try adjusting your filters. ",-1)),t(D,{color:"primary",onClick:e[5]||(e[5]=l=>x.value=!0)},{default:a(()=>e[19]||(e[19]=[c(" Add First Sales User ")])),_:1,__:[19]})])]),"item.user":a(({item:l})=>[r("div",Ke,[t(J,{size:"34",variant:l.avatar?void 0:"tonal",color:"warning"},{default:a(()=>[l.avatar?(b(),F(Ie,{key:0,src:l.avatar},null,8,["src"])):(b(),z("span",Xe,u(le(l.fullName)),1))]),_:2},1032,["variant"]),r("div",Ye,[r("h6",Ze,u(l.fullName),1),r("div",es," Joined: "+u(l.joinedDate),1)])])]),"item.city":a(({item:l})=>[r("div",ss,u(l.city),1)]),"item.email":a(({item:l})=>[r("div",ts,u(l.email),1)]),"item.phone":a(({item:l})=>[r("div",ls,u(l.phone),1)]),"item.status":a(({item:l})=>[t(Be,{color:se(l.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[c(u(l.status),1)]),_:2},1032,["color"])]),"item.actions":a(({item:l})=>[r("div",as,[t(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small"},{default:a(()=>[t(v,{icon:"tabler-dots-vertical",size:"22"}),t(Q,{activator:"parent"},{default:a(()=>[t(H,null,{default:a(()=>[t(k,{onClick:U=>ve(l)},{prepend:a(()=>[t(v,{icon:"tabler-eye"})]),default:a(()=>[t(S,null,{default:a(()=>e[22]||(e[22]=[c("View")])),_:1,__:[22]})]),_:2},1032,["onClick"]),t(k,{onClick:U=>oe(l)},{prepend:a(()=>[t(v,{icon:"tabler-pencil"})]),default:a(()=>[t(S,null,{default:a(()=>e[23]||(e[23]=[c("Edit")])),_:1,__:[23]})]),_:2},1032,["onClick"]),t(k,{onClick:U=>de(l)},{prepend:a(()=>[t(v,{icon:"tabler-key"})]),default:a(()=>[t(S,null,{default:a(()=>e[24]||(e[24]=[c("Reset Password")])),_:1,__:[24]})]),_:2},1032,["onClick"]),t(R,{class:"my-2"}),t(k,{onClick:U=>ne(l)},{prepend:a(()=>[t(v,{icon:"tabler-trash",color:"error"})]),default:a(()=>[t(S,{class:"text-error"},{default:a(()=>e[25]||(e[25]=[c(" Delete ")])),_:1,__:[25]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),bottom:a(()=>[t(xe,{page:o(y),"onUpdate:page":e[6]||(e[6]=l=>f(y)?y.value=l:null),"items-per-page":o(_),"total-items":o(L)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),t(he,{"is-drawer-open":o(x),"onUpdate:isDrawerOpen":[e[10]||(e[10]=l=>f(x)?x.value=l:null),pe],"sales-user":o(p),onSalesUserData:ie},null,8,["is-drawer-open","sales-user"]),t(ke,{"is-dialog-open":o($),"onUpdate:isDialogOpen":e[11]||(e[11]=l=>f($)?$.value=l:null),"user-name":(M=o(C))==null?void 0:M.fullName,"user-type":"Sales User",onConfirm:ue},null,8,["is-dialog-open","user-name"]),t(Se,{"is-dialog-open":o(P),"onUpdate:isDialogOpen":e[12]||(e[12]=l=>f(P)?P.value=l:null),"user-name":(G=o(p))==null?void 0:G.fullName,onConfirm:ce},null,8,["is-dialog-open","user-name"]),t(Ue,{"is-dialog-open":o(T),"onUpdate:isDialogOpen":e[13]||(e[13]=l=>f(T)?T.value=l:null),user:o(p),"user-type":"Sales User",onEdit:fe},null,8,["is-dialog-open","user"])])}}});export{Ws as default};
