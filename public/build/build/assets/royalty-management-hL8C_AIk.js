import{d as Fe,r as d,P as de,G as Pe,c as Me,b as a,f as l,aO as K,o as A,e as s,a3 as p,t as u,aa as v,v as i,g as j,l as z,aM as me}from"./main-BFHJN9nb.js";import{r as F}from"./royalty-BgnnRZ0Z.js";import{V as h,a as n}from"./VRow-CkpL0RVO.js";import{V as I}from"./VDialog-V4gnLJrB.js";import{V}from"./VSelect-DRqAennZ.js";import{V as g,a as P,b as M,c as qe,d as B}from"./VCard-DX1TBmaJ.js";import{V as w}from"./VCardText-DaLxJsvL.js";import{V as ce}from"./VAvatar-0YR6k8GC.js";import{V as q}from"./VDivider-BkXgjbRp.js";import{q as Te}from"./VDataTable-KEGIK6KG.js";import{V as ye}from"./VTooltip-Css5-rqo.js";import{V as W}from"./VChip-YDiTWgu4.js";import{V as Oe}from"./VAlert-CRQ1c4tT.js";import{V as N}from"./VSpacer-CCpGOsVL.js";import{V as pe}from"./VForm-Bn7tXzHN.js";import{V as f}from"./VTextField-cuhL7eKu.js";import{V as ve}from"./VTextarea-Bsvjwuux.js";import{V as Ee}from"./VFileInput-BP_SWKAb.js";import{V as Le}from"./VTable-C9ODUf_b.js";/* empty css              */import"./VOverlay-CCjswVhh.js";import"./easing-Bybner-F.js";import"./lazy-CMH8XMVs.js";import"./scopeId-u705bwh2.js";import"./VImg-CUvr5mlE.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-BI7rMvXb.js";import"./form-CRnOu3kV.js";import"./VList-BQIhB7WP.js";import"./ssrBoot-BnhyewLe.js";import"./VMenu-S7-3kIyf.js";import"./VCheckboxBtn-B9nMFPWY.js";import"./VSelectionControl-CRxaOcuF.js";import"./VPagination-C9KFFG-O.js";import"./filter-B0dGONQA.js";import"./VSlideGroup-Crru8FDw.js";/* empty css                   */import"./VCounter-Cd8lIrDY.js";import"./VField-5Oc1eDZT.js";import"./VInput-C8j_k2yQ.js";const je={class:"d-flex justify-space-between align-center flex-wrap gap-4"},ze={class:"d-flex gap-3 align-center flex-wrap"},Ie={class:"d-flex align-center justify-space-between"},Be={class:"text-h4 text-success"},Ne={class:"d-flex align-center justify-space-between"},$e={class:"text-h4 text-warning"},Ge={class:"font-weight-medium"},Ye={class:"font-weight-medium text-primary"},He={class:"text-body-2 text-medium-emphasis"},Je={class:"text-body-2"},Qe={class:"font-weight-medium text-info"},Xe={class:"font-weight-medium text-success"},Ke={class:"d-flex gap-2"},We={class:"text-body-2"},Ze={class:"mb-4"},et={class:"font-weight-medium"},tt={class:"mb-4"},at={class:"font-weight-medium"},lt={class:"mb-4"},ot={class:"font-weight-medium text-primary"},st={class:"mb-4"},rt={class:"font-weight-medium"},nt={class:"text-center"},it={class:"text-h6 font-weight-bold"},ut={class:"text-center"},dt={class:"text-h6 font-weight-bold"},mt={class:"text-center"},ct={class:"text-h6 font-weight-bold"},yt={class:"mb-4"},pt={class:"mb-4"},vt={class:"font-weight-medium"},ft={class:"text-end"},_t={class:"text-end"},gt={class:"text-end"},bt={class:"bg-primary-lighten-5"},Vt={class:"text-end font-weight-bold text-primary"},ia=Fe({__name:"royalty-management",setup(xt){const Z=d(!1),ee=d(!1),T=d(!1),b=d("monthly"),k=d(!1),R=d(!1),C=d(!1),S=d(!1),O=d(null),m=d(null),D=d("csv"),E=d("all"),r=d({franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}),$=d([]),G=d([]),L=d([]),_=d({amount_paid:0,payment_date:"",payment_type:"",attachment:null}),te=d([]),Y=d({royalty_collected_till_date:0,upcoming_royalties:0,total_royalties:0,pending_amount:0,paid_amount:0,overdue_amount:0,overdue_count:0}),fe=de(()=>{var t;return((t=Y.value)==null?void 0:t.royalty_collected_till_date)||0}),_e=de(()=>{var t;return((t=Y.value)==null?void 0:t.upcoming_royalties)||0}),ae=[{title:"Monthly",value:"monthly"},{title:"Quarterly",value:"quarterly"},{title:"Annual",value:"annual"},{title:"Special",value:"special"}],ge=[{title:"CSV",value:"csv"},{title:"Excel",value:"excel"}],le=[{title:"All Royalties",value:"all"},{title:"Paid Only",value:"paid"},{title:"Pending Only",value:"pending"},{title:"Overdue Only",value:"overdue"}],be=[{title:"Bank Transfer",value:"bank_transfer"},{title:"Credit Card",value:"credit_card"},{title:"Mada",value:"mada"},{title:"STC Pay",value:"stc_pay"},{title:"SADAD",value:"sadad"},{title:"Check",value:"check"},{title:"Cash",value:"cash"},{title:"Online Payment",value:"online_payment"}],Ve=[{title:"Billing Period",key:"billingPeriod",sortable:!0},{title:"Franchisee Name",key:"franchiseeName",sortable:!0},{title:"Store Location",key:"storeLocation",sortable:!0},{title:"Due Date",key:"dueDate",sortable:!0},{title:"Gross Sales (SAR)",key:"grossSales",sortable:!0},{title:"Royalty %",key:"royaltyPercentage",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],H=async()=>{try{Z.value=!0;const t=await F.getRoyalties({period:b.value});te.value=t.data.data}catch(t){console.error("Error fetching royalties:",t)}finally{Z.value=!1}},J=async()=>{try{ee.value=!0;const t=await F.getStatistics({period:b.value});Y.value=t.data}catch(t){console.error("Error fetching statistics:",t)}finally{ee.value=!1}},xe=()=>{k.value=!0},he=async()=>{try{const t=await F.exportRoyalties({format:D.value,data_type:E.value,period:b.value}),e=window.URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download=`royalty-data-${b.value}-${new Date().toISOString().split("T")[0]}.${D.value==="csv"?"csv":"xlsx"}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e),k.value=!1}catch(t){console.error("Error exporting royalties:",t)}},we=t=>{m.value=t,C.value=!0},oe=t=>{O.value=t,_.value={amount_paid:t.amount,payment_date:new Date().toISOString().split("T")[0],payment_type:"",attachment:null},R.value=!0},se=async()=>{if(O.value)try{await F.markAsPaid(O.value.id,_.value),await H(),await J(),R.value=!1,O.value=null,_.value={amount_paid:0,payment_date:"",payment_type:"",attachment:null}}catch(t){console.error("Error marking royalty as paid:",t)}},ke=t=>{const e=t.target;e.files&&e.files[0]&&(_.value.attachment=e.files[0])},re=t=>{switch(t){case"paid":return"success";case"pending":return"warning";case"overdue":return"error";default:return"default"}},ne=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Re=async()=>{try{const t=await K("/api/v1/franchisor/franchise");console.log("Franchises response:",t),t.success&&t.data&&($.value=[t.data],console.log("Franchises loaded:",$.value))}catch(t){console.error("Error fetching franchises:",t)}},Ce=async()=>{try{const t=await K("/api/v1/franchisor/units");console.log("Units response:",t),t.success&&t.data&&(G.value=t.data.data||[],console.log("Units loaded:",G.value))}catch(t){console.error("Error fetching units:",t)}},Se=async()=>{var t;try{const e=await K("/api/v1/franchisor/franchisees");console.log("Franchisees response:",e),console.log("Franchisees response.data:",e.data),console.log("Franchisees response.data.data:",(t=e.data)==null?void 0:t.data),e.success&&e.data&&(L.value=e.data.data||[],console.log("Franchisees loaded:",L.value),console.log("Franchisees count:",L.value.length))}catch(e){console.error("Error fetching franchisees:",e)}},x=()=>{const t=r.value.base_revenue;r.value.royalty_amount=t*r.value.royalty_rate/100,r.value.marketing_fee_amount=t*r.value.marketing_fee_rate/100,r.value.technology_fee_rate>0&&(r.value.technology_fee_amount=t*r.value.technology_fee_rate/100),r.value.total_amount=r.value.royalty_amount+r.value.marketing_fee_amount+r.value.technology_fee_amount+r.value.other_fees+r.value.adjustments},ie=async()=>{try{if(T.value=!0,Ae(),!await Ue()){console.error("Form validation failed");return}x(),console.log("Creating royalty with data:",r.value);const e={...r.value,franchise_id:r.value.franchise_id||void 0,unit_id:r.value.unit_id||void 0,franchisee_id:r.value.franchisee_id||void 0};(await F.createRoyalty(e)).success&&(ue(),S.value=!1,await H(),await J(),console.log("Royalty created successfully"))}catch(t){console.error("Error creating royalty:",t)}finally{T.value=!1}},ue=()=>{r.value={franchise_id:null,unit_id:null,franchisee_id:null,type:"monthly",period_year:new Date().getFullYear(),period_month:new Date().getMonth()+1,period_quarter:null,base_revenue:0,royalty_rate:8.5,royalty_amount:0,marketing_fee_rate:2,marketing_fee_amount:0,technology_fee_rate:0,technology_fee_amount:50,other_fees:0,adjustments:0,total_amount:0,due_date:"",status:"pending",description:"",notes:"",is_auto_generated:!1}},De=()=>{ue(),S.value=!0};Pe(()=>{H(),J(),Re(),Ce(),Se()});const c=d({}),y={franchise_id:[t=>!!t||"Franchise selection is required"],franchisee_id:[t=>!!t||"Franchisee selection is required"],type:[t=>!!t||"Royalty type is required",t=>["monthly","quarterly"].includes(t)||"Invalid royalty type"],period_year:[t=>!!t||"Period year is required",t=>t>=2020||"Period year must be at least 2020",t=>t<=new Date().getFullYear()+1||"Period year cannot be more than next year"],period_month:[t=>r.value.type==="monthly"?!!t||"Period month is required for monthly royalties":!0,t=>t&&(t<1||t>12)?"Period month must be between 1 and 12":!0],period_quarter:[t=>r.value.type==="quarterly"?!!t||"Period quarter is required for quarterly royalties":!0,t=>t&&(t<1||t>4)?"Period quarter must be between 1 and 4":!0],base_revenue:[t=>t!=null&&t!==""||"Base revenue is required",t=>t>=0||"Base revenue cannot be negative",t=>t<=99999999999e-2||"Base revenue is too large"],royalty_rate:[t=>t!=null&&t!==""||"Royalty rate is required",t=>t>=0||"Royalty rate cannot be negative",t=>t<=100||"Royalty rate cannot exceed 100%"],marketing_fee_rate:[t=>t!=null&&t!==""||"Marketing fee rate is required",t=>t>=0||"Marketing fee rate cannot be negative",t=>t<=100||"Marketing fee rate cannot exceed 100%"],due_date:[t=>!!t||"Due date is required",t=>{if(t){const e=new Date().toISOString().split("T")[0];return t>=e||"Due date cannot be in the past"}return!0}],technology_fee_amount:[t=>t==null||t===""||t>=0||"Technology fee cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Technology fee is too large"],other_fees:[t=>t==null||t===""||t>=0||"Other fees cannot be negative",t=>t==null||t===""||t<=99999999999e-2||"Other fees is too large"],adjustments:[t=>t==null||t===""||t>=-99999999999e-2||"Adjustments value is too low",t=>t==null||t===""||t<=99999999999e-2||"Adjustments value is too high"],description:[t=>!t||t.length<=1e3||"Description cannot exceed 1000 characters"],notes:[t=>!t||t.length<=2e3||"Notes cannot exceed 2000 characters"]},Q=d(!1),U=d(),Ue=async()=>{if(U.value){const{valid:t}=await U.value.validate();return Q.value=t,t}return!1},Ae=()=>{c.value={},U.value&&U.value.resetValidation()};return(t,e)=>(A(),Me("section",null,[a(h,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[s("div",je,[e[33]||(e[33]=s("div",null,[s("h4",{class:"text-h4 mb-1"}," Royalty Management "),s("p",{class:"text-body-1 text-medium-emphasis"}," Track and manage royalty payments from all franchise units ")],-1)),s("div",ze,[a(V,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o),items:ae,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"]),a(p,{color:"success",variant:"elevated",onClick:De},{default:l(()=>[a(v,{icon:"tabler-plus",class:"me-2"}),e[31]||(e[31]=u(" Create Royalty "))]),_:1,__:[31]}),a(p,{color:"primary",variant:"elevated",onClick:xe},{default:l(()=>[a(v,{icon:"tabler-download",class:"me-2"}),e[32]||(e[32]=u(" Export "))]),_:1,__:[32]})])])]),_:1})]),_:1}),a(h,{class:"mb-6"},{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(g,null,{default:l(()=>[a(w,null,{default:l(()=>[s("div",Ie,[s("div",null,[e[34]||(e[34]=s("h6",{class:"text-h6 mb-1"}," Royalty Collected Till Date ",-1)),e[35]||(e[35]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Total payments received ",-1)),s("h4",Be,i(fe.value.toLocaleString())+" SAR ",1)]),a(ce,{color:"success",variant:"tonal",size:"56"},{default:l(()=>[a(v,{icon:"tabler-currency-riyal",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(g,null,{default:l(()=>[a(w,null,{default:l(()=>[s("div",Ne,[s("div",null,[e[36]||(e[36]=s("h6",{class:"text-h6 mb-1"}," Upcoming Royalties ",-1)),e[37]||(e[37]=s("div",{class:"text-body-2 text-medium-emphasis mb-3"}," Pending payments due ",-1)),s("h4",$e,i(_e.value.toLocaleString())+" SAR ",1)]),a(ce,{color:"warning",variant:"tonal",size:"56"},{default:l(()=>[a(v,{icon:"tabler-clock",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(g,null,{default:l(()=>[a(P,{class:"pb-4"},{default:l(()=>[a(M,{class:"text-h6"},{default:l(()=>e[38]||(e[38]=[u(" Royalty Records ")])),_:1,__:[38]}),a(qe,{class:"text-body-2"},{default:l(()=>e[39]||(e[39]=[u(" Manage royalty payments and track collection status ")])),_:1,__:[39]})]),_:1}),a(q),a(Te,{headers:Ve,items:te.value,"items-per-page":10,class:"text-no-wrap"},{"item.billingPeriod":l(({item:o})=>[s("div",Ge,i(o.billing_period),1)]),"item.franchiseeName":l(({item:o})=>[s("div",Ye,i(o.franchisee_name),1)]),"item.storeLocation":l(({item:o})=>[s("div",He,i(o.store_location),1)]),"item.dueDate":l(({item:o})=>[s("div",Je,i(ne(o.due_date)),1)]),"item.grossSales":l(({item:o})=>[s("div",Qe,i((o.gross_sales||0).toLocaleString()),1)]),"item.royaltyPercentage":l(({item:o})=>[a(W,{size:"small",variant:"tonal",color:"primary"},{default:l(()=>[u(i(o.royalty_percentage)+"% ",1)]),_:2},1024)]),"item.amount":l(({item:o})=>[s("div",Xe,i((o.amount||0).toLocaleString()),1)]),"item.status":l(({item:o})=>[a(W,{color:re(o.status),size:"small",variant:"tonal",class:"text-capitalize"},{default:l(()=>[u(i(o.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[s("div",Ke,[a(p,{icon:"",size:"small",color:"info",variant:"text",onClick:X=>we(o)},{default:l(()=>[a(v,{icon:"tabler-eye",size:"20"}),a(ye,{activator:"parent",location:"top"},{default:l(()=>e[40]||(e[40]=[u(" View Details ")])),_:1,__:[40]})]),_:2},1032,["onClick"]),o.status!=="paid"?(A(),j(p,{key:0,icon:"",size:"small",color:"success",variant:"text",onClick:X=>oe(o)},{default:l(()=>[a(v,{icon:"tabler-check",size:"20"}),a(ye,{activator:"parent",location:"top"},{default:l(()=>e[41]||(e[41]=[u(" Mark as Completed ")])),_:1,__:[41]})]),_:2},1032,["onClick"])):z("",!0)])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),a(I,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),"max-width":"500"},{default:l(()=>[a(g,null,{default:l(()=>[a(P,null,{default:l(()=>[a(M,null,{default:l(()=>e[42]||(e[42]=[u("Export Royalty Data")])),_:1,__:[42]})]),_:1}),a(w,null,{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:E.value,"onUpdate:modelValue":e[1]||(e[1]=o=>E.value=o),items:le,"item-title":"title","item-value":"value",label:"Data Type",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=o=>D.value=o),items:ge,"item-title":"title","item-value":"value",label:"Export Format",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),a(Oe,{type:"info",variant:"tonal",class:"mt-4"},{default:l(()=>{var o;return[s("div",We,[e[43]||(e[43]=s("strong",null,"Current Selection:",-1)),e[44]||(e[44]=s("br",null,null,-1)),u(" Period: "+i(b.value.charAt(0).toUpperCase()+b.value.slice(1)),1),e[45]||(e[45]=s("br",null,null,-1)),u(" Data Type: "+i((o=le.find(X=>X.value===E.value))==null?void 0:o.title),1),e[46]||(e[46]=s("br",null,null,-1)),u(" Format: "+i(D.value.toUpperCase()),1)])]}),_:1})]),_:1}),a(B,null,{default:l(()=>[a(N),a(p,{color:"secondary",variant:"tonal",onClick:e[3]||(e[3]=o=>k.value=!1)},{default:l(()=>e[47]||(e[47]=[u(" Cancel ")])),_:1,__:[47]}),a(p,{color:"primary",onClick:he},{default:l(()=>e[48]||(e[48]=[u(" Export Data ")])),_:1,__:[48]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:S.value,"onUpdate:modelValue":e[22]||(e[22]=o=>S.value=o),"max-width":"800",persistent:""},{default:l(()=>[a(g,null,{default:l(()=>[a(P,null,{default:l(()=>[a(M,null,{default:l(()=>e[49]||(e[49]=[u("Create New Royalty Record")])),_:1,__:[49]})]),_:1}),a(w,null,{default:l(()=>[a(pe,{ref_key:"formRef",ref:U,modelValue:Q.value,"onUpdate:modelValue":e[20]||(e[20]=o=>Q.value=o),onSubmit:me(ie,["prevent"])},{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.franchise_id,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.franchise_id=o),items:$.value,"item-title":"business_name","item-value":"id",label:"Franchise *",variant:"outlined",density:"compact",required:"",clearable:"",rules:y.franchise_id,"error-messages":c.value.franchise_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.unit_id,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.unit_id=o),items:G.value,"item-title":"unit_name","item-value":"id",label:"Unit",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.franchisee_id,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.franchisee_id=o),items:L.value,"item-title":"name","item-value":"id",label:"Franchisee *",variant:"outlined",density:"compact",required:"",clearable:"",rules:y.franchisee_id,"error-messages":c.value.franchisee_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(V,{modelValue:r.value.type,"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.type=o),items:ae,"item-title":"title","item-value":"value",label:"Royalty Type *",variant:"outlined",density:"compact",required:"",rules:y.type,"error-messages":c.value.type},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.period_year,"onUpdate:modelValue":e[9]||(e[9]=o=>r.value.period_year=o),modelModifiers:{number:!0},label:"Period Year *",type:"number",variant:"outlined",density:"compact",required:"",rules:y.period_year,"error-messages":c.value.period_year},null,8,["modelValue","rules","error-messages"])]),_:1}),r.value.type==="monthly"?(A(),j(n,{key:0,cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.period_month,"onUpdate:modelValue":e[10]||(e[10]=o=>r.value.period_month=o),modelModifiers:{number:!0},label:"Period Month *",type:"number",min:"1",max:"12",variant:"outlined",density:"compact",required:"",rules:y.period_month,"error-messages":c.value.period_month},null,8,["modelValue","rules","error-messages"])]),_:1})):z("",!0),a(n,{cols:"12",md:"4"},{default:l(()=>[a(f,{modelValue:r.value.due_date,"onUpdate:modelValue":e[11]||(e[11]=o=>r.value.due_date=o),label:"Due Date *",type:"date",variant:"outlined",density:"compact",required:"",rules:y.due_date,"error-messages":c.value.due_date},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.base_revenue,"onUpdate:modelValue":e[12]||(e[12]=o=>r.value.base_revenue=o),modelModifiers:{number:!0},label:"Base Revenue (SAR) *",type:"number",step:"0.01",variant:"outlined",density:"compact",required:"",onInput:x,rules:y.base_revenue,"error-messages":c.value.base_revenue},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.royalty_rate,"onUpdate:modelValue":e[13]||(e[13]=o=>r.value.royalty_rate=o),modelModifiers:{number:!0},label:"Royalty Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",onInput:x,rules:y.royalty_rate,"error-messages":c.value.royalty_rate},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.marketing_fee_rate,"onUpdate:modelValue":e[14]||(e[14]=o=>r.value.marketing_fee_rate=o),modelModifiers:{number:!0},label:"Marketing Fee Rate (%)",type:"number",step:"0.1",variant:"outlined",density:"compact",onInput:x,rules:y.marketing_fee_rate,"error-messages":c.value.marketing_fee_rate},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.technology_fee_amount,"onUpdate:modelValue":e[15]||(e[15]=o=>r.value.technology_fee_amount=o),modelModifiers:{number:!0},label:"Technology Fee (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.technology_fee_amount,"error-messages":c.value.technology_fee_amount},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.other_fees,"onUpdate:modelValue":e[16]||(e[16]=o=>r.value.other_fees=o),modelModifiers:{number:!0},label:"Other Fees (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.other_fees,"error-messages":c.value.other_fees},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:r.value.adjustments,"onUpdate:modelValue":e[17]||(e[17]=o=>r.value.adjustments=o),modelModifiers:{number:!0},label:"Adjustments (SAR)",type:"number",step:"0.01",variant:"outlined",density:"compact",onInput:x,rules:y.adjustments,"error-messages":c.value.adjustments},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(ve,{modelValue:r.value.description,"onUpdate:modelValue":e[18]||(e[18]=o=>r.value.description=o),label:"Description",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(ve,{modelValue:r.value.notes,"onUpdate:modelValue":e[19]||(e[19]=o=>r.value.notes=o),label:"Notes",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(B,null,{default:l(()=>[a(N),a(p,{color:"secondary",variant:"tonal",disabled:T.value,onClick:e[21]||(e[21]=o=>S.value=!1)},{default:l(()=>e[50]||(e[50]=[u(" Cancel ")])),_:1,__:[50]},8,["disabled"]),a(p,{color:"primary",loading:T.value,onClick:ie},{default:l(()=>e[51]||(e[51]=[u(" Create Royalty ")])),_:1,__:[51]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:R.value,"onUpdate:modelValue":e[27]||(e[27]=o=>R.value=o),"max-width":"600"},{default:l(()=>[a(g,null,{default:l(()=>[a(P,null,{default:l(()=>[a(M,null,{default:l(()=>e[52]||(e[52]=[u("Mark Royalty as Completed")])),_:1,__:[52]})]),_:1}),a(w,null,{default:l(()=>[a(pe,{onSubmit:me(se,["prevent"])},{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:_.value.amount_paid,"onUpdate:modelValue":e[23]||(e[23]=o=>_.value.amount_paid=o),modelModifiers:{number:!0},label:"Amount Paid (SAR)",type:"number",variant:"outlined",density:"compact",rules:[o=>!!o||"Amount is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[a(f,{modelValue:_.value.payment_date,"onUpdate:modelValue":e[24]||(e[24]=o=>_.value.payment_date=o),label:"Payment Date",type:"date",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment date is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(V,{modelValue:_.value.payment_type,"onUpdate:modelValue":e[25]||(e[25]=o=>_.value.payment_type=o),items:be,"item-title":"title","item-value":"value",label:"Payment Type",variant:"outlined",density:"compact",rules:[o=>!!o||"Payment type is required"]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(Ee,{label:"Attachment (Optional)",variant:"outlined",density:"compact",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:ke}),e[53]||(e[53]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Supported formats: PDF, JPG, PNG, DOC, DOCX ",-1))]),_:1,__:[53]})]),_:1})]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(N),a(p,{color:"secondary",variant:"tonal",onClick:e[26]||(e[26]=o=>R.value=!1)},{default:l(()=>e[54]||(e[54]=[u(" Cancel ")])),_:1,__:[54]}),a(p,{color:"primary",onClick:se},{default:l(()=>e[55]||(e[55]=[u(" Mark as Completed ")])),_:1,__:[55]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:C.value,"onUpdate:modelValue":e[30]||(e[30]=o=>C.value=o),"max-width":"700"},{default:l(()=>[m.value?(A(),j(g,{key:0},{default:l(()=>[a(P,null,{default:l(()=>[a(M,null,{default:l(()=>e[56]||(e[56]=[u("Royalty Details")])),_:1,__:[56]})]),_:1}),a(q,{class:"mb-4"}),a(w,null,{default:l(()=>[a(h,null,{default:l(()=>[a(n,{cols:"12"},{default:l(()=>e[57]||(e[57]=[s("h6",{class:"text-h6 mb-4 text-primary"}," Basic Information ",-1)])),_:1,__:[57]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",Ze,[e[58]||(e[58]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Billing Period ",-1)),s("div",et,i(m.value.billing_period),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",tt,[e[59]||(e[59]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Due Date ",-1)),s("div",at,i(ne(m.value.due_date)),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",lt,[e[60]||(e[60]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Franchisee Name ",-1)),s("div",ot,i(m.value.franchisee_name),1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",st,[e[61]||(e[61]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Store Location ",-1)),s("div",rt,i(m.value.store_location),1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[62]||(e[62]=s("h6",{class:"text-h6 mb-4 text-primary"}," Financial Details ",-1))]),_:1,__:[62]}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"info",class:"pa-4"},{default:l(()=>[s("div",nt,[a(v,{icon:"tabler-chart-line",size:"32",class:"mb-2"}),e[63]||(e[63]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Gross Sales ",-1)),s("div",it,i((m.value.gross_sales||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"primary",class:"pa-4"},{default:l(()=>[s("div",ut,[a(v,{icon:"tabler-percentage",size:"32",class:"mb-2"}),e[64]||(e[64]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Rate ",-1)),s("div",dt,i(m.value.royalty_percentage)+"% ",1)])]),_:1})]),_:1}),a(n,{cols:"12",md:"4"},{default:l(()=>[a(g,{variant:"tonal",color:"success",class:"pa-4"},{default:l(()=>[s("div",mt,[a(v,{icon:"tabler-coins",size:"32",class:"mb-2"}),e[65]||(e[65]=s("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Royalty Amount ",-1)),s("div",ct,i((m.value.amount||0).toLocaleString())+" SAR ",1)])]),_:1})]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[66]||(e[66]=s("h6",{class:"text-h6 mb-4 text-primary"}," Status Information ",-1))]),_:1,__:[66]}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",yt,[e[67]||(e[67]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Payment Status ",-1)),a(W,{color:re(m.value.status),size:"large",variant:"tonal",class:"text-capitalize"},{default:l(()=>[a(v,{icon:m.value.status==="paid"?"tabler-check":m.value.status==="pending"?"tabler-clock":"tabler-alert-triangle",class:"me-2"},null,8,["icon"]),u(" "+i(m.value.status),1)]),_:1},8,["color"])])]),_:1}),a(n,{cols:"12",md:"6"},{default:l(()=>[s("div",pt,[e[68]||(e[68]=s("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Days Until Due ",-1)),s("div",vt,i(Math.ceil((new Date(m.value.due_date).getTime()-new Date().getTime())/(1e3*60*60*24)))+" days ",1)])]),_:1}),a(n,{cols:"12"},{default:l(()=>[a(q,{class:"my-4"}),e[69]||(e[69]=s("h6",{class:"text-h6 mb-4 text-primary"}," Calculation Breakdown ",-1))]),_:1,__:[69]}),a(n,{cols:"12"},{default:l(()=>[a(Le,{density:"compact"},{default:l(()=>[s("tbody",null,[s("tr",null,[e[70]||(e[70]=s("td",{class:"font-weight-medium"}," Gross Sales: ",-1)),s("td",ft,i((m.value.gross_sales||0).toLocaleString())+" SAR ",1)]),s("tr",null,[e[71]||(e[71]=s("td",{class:"font-weight-medium"}," Royalty Rate: ",-1)),s("td",_t,i(m.value.royalty_percentage)+"% ",1)]),s("tr",null,[e[72]||(e[72]=s("td",{class:"font-weight-medium"}," Calculation: ",-1)),s("td",gt,i((m.value.gross_sales||0).toLocaleString())+" Ã— "+i(m.value.royalty_percentage)+"% ",1)]),s("tr",bt,[e[73]||(e[73]=s("td",{class:"font-weight-bold text-primary"}," Total Royalty Amount: ",-1)),s("td",Vt,i((m.value.amount||0).toLocaleString())+" SAR ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),a(B,null,{default:l(()=>[a(N),a(p,{color:"secondary",variant:"tonal",onClick:e[28]||(e[28]=o=>C.value=!1)},{default:l(()=>e[74]||(e[74]=[u(" Close ")])),_:1,__:[74]}),m.value.status!=="paid"?(A(),j(p,{key:0,color:"primary",onClick:e[29]||(e[29]=o=>{oe(m.value),C.value=!1})},{default:l(()=>[a(v,{icon:"tabler-check",class:"me-2"}),e[75]||(e[75]=u(" Mark as Completed "))]),_:1,__:[75]})):z("",!0)]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"])]))}});export{ia as default};
