import{K as W,L as Z,bd as J,P as X,a$ as Y,O as T,g as V,az as ee,aa as g,w as I,M as ae,Q as te,y as l,F as le,n as N,be as se,bf as oe,bg as ne,bh as L,ae as ue,d as ie,b9 as re,e as de,aZ as x,bc as ce,aQ as fe,c as me,o as O,l as m,aR as j,i as u,k as i,G as M,t as q,b5 as pe,a as ve,h as be,q as z,aI as ye,a7 as he,s as ge}from"./main-Ji38qWNq.js";import{a as Ve,b as _e}from"./auth-v1-top-shape-gPxasD3d.js";import{V as B}from"./VNodeRenderer-d5ciiUKv.js";import{a as ke}from"./auth-KMIvUmPS.js";import{a as we,d as xe,f as K,V as Ce}from"./VCard-CawK-7Mk.js";import{V as Re}from"./VForm-DP38Bcc1.js";import{V as Ae,a as C}from"./VRow-DmXcz54G.js";import{V as De}from"./VAlert-DjmlpEYh.js";import{V as Fe,m as Pe}from"./VField-DLyvN9w7.js";import{V as Te}from"./VOverlay--ReuNc3x.js";import{u as Be,m as Se}from"./form-C8-wVyzB.js";import"./forwardRefs-B931MWyl.js";/* empty css              */import"./scopeId-DFtxLKrN.js";const Ie=Z({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...ne(),...Se(),...oe(Pe({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),Ne=W()({name:"VOtpInput",props:Ie(),emits:{finish:a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,R){let{attrs:b,emit:_,slots:r}=R;const{dimensionStyles:p}=J(a),{isFocused:w,focus:A,blur:D}=Be(a),n=X(a,"modelValue","",e=>e==null?[]:String(e).split(""),e=>e.join("")),{t}=Y(),v=T(()=>Number(a.length)),y=T(()=>Array(v.value).fill(0)),f=V(-1),F=V(),h=V([]),P=T(()=>h.value[f.value]);function E(){if(S(P.value.value)){P.value.value="";return}const e=n.value.slice(),s=P.value.value;e[f.value]=s;let d=null;f.value>n.value.length?d=n.value.length+1:f.value+1!==v.value&&(d="next"),n.value=e,d&&L(F.value,d)}function H(e){const s=n.value.slice(),d=f.value;let c=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(e.key)&&(e.preventDefault(),e.key==="ArrowLeft"?c="prev":e.key==="ArrowRight"?c="next":["Backspace","Delete"].includes(e.key)&&(s[f.value]="",n.value=s,f.value>0&&e.key==="Backspace"?c="prev":requestAnimationFrame(()=>{var o;(o=h.value[d])==null||o.select()})),requestAnimationFrame(()=>{c!=null&&L(F.value,c)}))}function Q(e,s){var c,o;s.preventDefault(),s.stopPropagation();const d=((c=s==null?void 0:s.clipboardData)==null?void 0:c.getData("Text").slice(0,v.value))??"";S(d)||(n.value=d.split(""),(o=h.value)==null||o[e].blur())}function U(){n.value=[]}function $(e,s){A(),f.value=s}function G(){D(),f.value=-1}function S(e){return a.type==="number"&&/[^0-9]/g.test(e)}return ee({VField:{color:g(()=>a.color),bgColor:g(()=>a.color),baseColor:g(()=>a.baseColor),disabled:g(()=>a.disabled),error:g(()=>a.error),variant:g(()=>a.variant)}},{scoped:!0}),I(n,e=>{e.length===v.value&&_("finish",e.join(""))},{deep:!0}),I(f,e=>{e<0||ue(()=>{var s;(s=h.value[e])==null||s.select()})}),ae(()=>{var d;const[e,s]=te(b);return l("div",N({class:["v-otp-input",{"v-otp-input--divided":!!a.divider},a.class],style:[a.style]},e),[l("div",{ref:F,class:"v-otp-input__content",style:[p.value]},[y.value.map((c,o)=>l(le,null,[a.divider&&o!==0&&l("span",{class:"v-otp-input__divider"},[a.divider]),l(Fe,{focused:w.value&&a.focusAll||f.value===o,key:o},{...r,loader:void 0,default:()=>l("input",{ref:k=>h.value[o]=k,"aria-label":t(a.label,o+1),autofocus:o===0&&a.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:a.disabled,inputmode:a.type==="number"?"numeric":"text",min:a.type==="number"?0:void 0,maxlength:o===0?v.value:"1",placeholder:a.placeholder,type:a.type==="number"?"text":a.type,value:n.value[o],onInput:E,onFocus:k=>$(k,o),onBlur:G,onKeydown:H,onPaste:k=>Q(o,k)},null)})])),l("input",N({class:"v-otp-input-input",type:"hidden"},s,{value:n.value.join("")}),null),l(Te,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!a.loading,persistent:!0},{default:()=>{var c;return[((c=r.loader)==null?void 0:c.call(r))??l(se,{color:typeof a.loading=="boolean"?void 0:a.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(d=r.default)==null?void 0:d.call(r)])])}),{blur:()=>{var e;(e=h.value)==null||e.some(s=>s.blur())},focus:()=>{var e;(e=h.value)==null||e[0].focus()},reset:U,isFocused:w}}}),Le={class:"auth-wrapper d-flex align-center justify-center pa-4"},Oe={class:"position-relative my-sm-16"},je={class:"app-logo"},Me={class:"app-logo-title"},ea=ie({__name:"two-steps",setup(a){const{smAndUp:R}=re(),b=de(),_=V(""),r=V(!1),p=V(null),w=x("userData"),{updateAbility:A}=ce(),D=async()=>{var n;r.value=!0,p.value="Verifying code...";try{await new Promise(y=>setTimeout(y,800));const t=await ke.login({email:((n=w.value)==null?void 0:n.email)||"",password:"password"});switch(t.success&&t.data&&(x("accessToken").value=t.data.access_token,x("userData").value={id:t.data.user.id,fullName:t.data.user.name,username:t.data.user.email,avatar:t.data.user.avatar,email:t.data.user.email,role:t.data.user.role},x("userAbilityRules").value=[],A([])),p.value="Code verified successfully. Redirecting...",await new Promise(y=>setTimeout(y,1200)),p.value=null,t.success&&t.data?t.data.user.role:"franchisor"){case"admin":b.push("/admin/dashboard");break;case"franchisor":b.push("/franchisor");break;case"franchisee":b.push("/franchisee/dashboard/sales");break;case"broker":b.push("/brokers/lead-management");break;default:b.push("/")}}catch{p.value="Verification failed. Please try again.",r.value=!1}};return(n,t)=>{const v=fe("RouterLink");return O(),me("div",Le,[m("div",Oe,[l(u(B),{nodes:j("div",{innerHTML:u(Ve)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),l(u(B),{nodes:j("div",{innerHTML:u(_e)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),l(Ce,{class:ge(["auth-card",u(R)?"pa-6":"pa-0"]),"max-width":"600"},{default:i(()=>[l(we,{class:"justify-center"},{default:i(()=>[l(xe,null,{default:i(()=>[l(v,{to:"/"},{default:i(()=>[m("div",je,[l(u(B),{nodes:u(M).app.logo},null,8,["nodes"]),m("h1",Me,q(u(M).app.title),1)])]),_:1})]),_:1})]),_:1}),l(K,null,{default:i(()=>t[1]||(t[1]=[m("h4",{class:"text-h4 mb-1"}," Two Step Verification ðŸ’¬ ",-1),m("p",{class:"mb-1"}," We sent a verification code to your mobile. Enter the code from the mobile in the field below. ",-1),m("h6",{class:"text-h6"}," ******1234 ",-1)])),_:1,__:[1]}),l(K,null,{default:i(()=>[l(Re,{onSubmit:pe(()=>{},["prevent"])},{default:i(()=>[l(Ae,null,{default:i(()=>[l(C,{cols:"12"},{default:i(()=>[u(p)?(O(),ve(De,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:i(()=>[z(q(u(p)),1)]),_:1})):be("",!0)]),_:1}),l(C,{cols:"12"},{default:i(()=>[t[2]||(t[2]=m("h6",{class:"text-body-1"}," Type your 6 digit security code ",-1)),l(Ne,{modelValue:u(_),"onUpdate:modelValue":t[0]||(t[0]=y=>ye(_)?_.value=y:null),disabled:u(r),type:"number",class:"pa-0",onFinish:D},null,8,["modelValue","disabled"])]),_:1,__:[2]}),l(C,{cols:"12"},{default:i(()=>[l(he,{loading:u(r),disabled:u(r),block:"",type:"submit"},{default:i(()=>t[3]||(t[3]=[z(" Verify my account ")])),_:1,__:[3]},8,["loading","disabled"])]),_:1}),l(C,{cols:"12"},{default:i(()=>t[4]||(t[4]=[m("div",{class:"d-flex justify-center align-center flex-wrap"},[m("span",{class:"me-1"},"Didn't get the code?"),m("a",{href:"#"},"Resend")],-1)])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{ea as default};
