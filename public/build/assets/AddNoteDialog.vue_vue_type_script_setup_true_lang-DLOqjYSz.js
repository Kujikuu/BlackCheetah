import{_ as B}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DJ9yPu0I.js";import{_ as C}from"./AppTextField.vue_vue_type_script_setup_true_lang-CrhyYF4c.js";import{_ as E,V as T}from"./VDialog-CpdD25yY.js";import{b2 as i,d as F,g as p,O as x,a as k,o as y,k as s,y as a,bb as S,aM as f,i as h,a7 as b,q as D}from"./main-BYpBSAj5.js";import{V as I,f as O,h as P}from"./VCard-Ca_zP91K.js";import{V as q}from"./VForm-BOJkEg2X.js";import{V as L,a as V}from"./VRow-BqYOgTz2.js";import{V as M}from"./VFileInput-C7r6RRJp.js";import{V as R}from"./VSpacer-DHG0No5I.js";class z{getBaseUrl(){return"/v1/notes"}async getNotes(e){return await i(this.getBaseUrl(),{method:"GET",query:e})}async getNote(e){return await i(`${this.getBaseUrl()}/${e}`)}async createNote(e){const t=new FormData;return t.append("title",e.title),t.append("description",e.description),e.lead_id&&t.append("lead_id",e.lead_id.toString()),e.attachments&&e.attachments.length>0&&e.attachments.forEach((r,l)=>{t.append(`attachments[${l}]`,r)}),await i(this.getBaseUrl(),{method:"POST",body:t})}async updateNote(e){const t=new FormData;return e.title&&t.append("title",e.title),e.description&&t.append("description",e.description),e.attachments&&e.attachments.length>0&&e.attachments.forEach((r,l)=>{t.append(`attachments[${l}]`,r)}),await i(`${this.getBaseUrl()}/${e.id}`,{method:"PUT",body:t})}async deleteNote(e){return await i(`${this.getBaseUrl()}/${e}`,{method:"DELETE"})}async deleteNoteAttachment(e,t){return await i(`${this.getBaseUrl()}/${e}/attachments/${t}`,{method:"DELETE"})}async updateNoteWithFormData(e,t){return await i(`${this.getBaseUrl()}/${e}`,{method:"POST",body:t})}}const G=new z,ee=F({__name:"AddNoteDialog",props:{isDialogVisible:{type:Boolean},leadId:{}},emits:["update:isDialogVisible","noteAdded"],setup(_,{emit:e}){const t=_,r=e,l=p(""),d=p(""),u=p([]),c=x({get:()=>t.isDialogVisible,set:n=>r("update:isDialogVisible",n)}),g=()=>{l.value="",d.value="",u.value=[]},v=n=>{const o=n.target;o.files&&(u.value=Array.from(o.files))},w=async()=>{try{const n=await G.createNote({title:l.value,description:d.value,lead_id:t.leadId,attachments:u.value});n.success?(console.log("Note added successfully:",n.data),r("noteAdded"),c.value=!1,g()):console.error("Failed to add note:",n.message)}catch(n){console.error("Error adding note:",n)}},$=()=>{c.value=!1,g()};return(n,o)=>{const N=E,U=C,A=B;return y(),k(T,{modelValue:h(c),"onUpdate:modelValue":o[2]||(o[2]=m=>f(c)?c.value=m:null),"max-width":"600"},{default:s(()=>[a(N,{onClick:$}),a(I,{title:"Add Note"},{default:s(()=>[a(O,null,{default:s(()=>[a(q,{onSubmit:S(w,["prevent"])},{default:s(()=>[a(L,null,{default:s(()=>[a(V,{cols:"12"},{default:s(()=>[a(U,{modelValue:h(l),"onUpdate:modelValue":o[0]||(o[0]=m=>f(l)?l.value=m:null),label:"Title",placeholder:"Enter note title"},null,8,["modelValue"])]),_:1}),a(V,{cols:"12"},{default:s(()=>[a(A,{modelValue:h(d),"onUpdate:modelValue":o[1]||(o[1]=m=>f(d)?d.value=m:null),label:"Description",placeholder:"Enter note description...",rows:"6"},null,8,["modelValue"])]),_:1}),a(V,{cols:"12"},{default:s(()=>[a(M,{label:"Attachments",multiple:"","prepend-icon":"tabler-paperclip",placeholder:"Upload files",chips:"","show-size":"",onChange:v})]),_:1})]),_:1})]),_:1})]),_:1}),a(P,null,{default:s(()=>[a(R),a(b,{color:"secondary",variant:"tonal",onClick:$},{default:s(()=>o[3]||(o[3]=[D(" Cancel ")])),_:1,__:[3]}),a(b,{color:"primary",onClick:w},{default:s(()=>o[4]||(o[4]=[D(" Add Note ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{ee as _,G as n};
