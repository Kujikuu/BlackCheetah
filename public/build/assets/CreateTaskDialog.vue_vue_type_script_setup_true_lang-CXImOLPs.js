import{_ as x,V as _}from"./VDialog-z6AiDkdm.js";import{d as O,g as D,O as B,w as k,a as c,o as g,k as o,y as l,b5 as I,aI as P,i as a,a7 as C,q as S}from"./main-CaTcLKNL.js";import{u as R,a as E,P as N,S as M}from"./EditTaskDialog.vue_vue_type_script_setup_true_lang-1jtovmT_.js";import{V as Y,f as $,g as z}from"./VCard-CS_ziklW.js";import{V as G}from"./VForm-C3QLM41t.js";import{V as K,a as d}from"./VRow-DYWQ7lCi.js";import{V as n}from"./VTextField-CvCFH6P5.js";import{V as L}from"./VTextarea-B3zF-AXj.js";import{V}from"./VSelect-DxDkvyke.js";import{V as j}from"./VDivider-BQAl4UcD.js";import{V as J}from"./VSpacer-gpOajNGi.js";const ie=O({__name:"CreateTaskDialog",props:{isDialogVisible:{type:Boolean},currentTab:{},defaultAssignedTo:{},unitId:{},disableAssignedTo:{type:Boolean},isFranchisee:{type:Boolean}},emits:["update:isDialogVisible","taskCreated"],setup(U,{emit:v}){const r=U,T=v,{getUsersForSelect:A,initializeUsers:b,loading:q}=R(),t=D({title:"",description:"",category:"",assignedTo:"",startDate:"",dueDate:"",priority:"medium",status:"pending",estimatedHours:0,actualHours:0,completionPercentage:0}),m=D(!1),w=B(()=>{const i=r.currentTab||"franchisee";return A(i)}),u=i=>!!i||"This field is required",p=i=>{T("update:isDialogVisible",i)},f=()=>{t.value={title:"",description:"",category:"",assignedTo:"",startDate:"",dueDate:"",priority:"medium",status:"pending",estimatedHours:0,actualHours:0,completionPercentage:0}},y=()=>{if(m.value){const i={id:Date.now(),...t.value};T("taskCreated",i),f(),p(!1)}},F=()=>{f(),p(!1)};return k(()=>r.isDialogVisible,async i=>{if(i){const e=r.currentTab||"franchisee";await b(e),r.defaultAssignedTo&&(t.value.assignedTo=r.defaultAssignedTo)}else f()}),k(()=>r.currentTab,async i=>{r.isDialogVisible&&i&&(await b(i),t.value.assignedTo="")}),(i,e)=>{const H=x;return g(),c(_,{"model-value":r.isDialogVisible,"max-width":"600",persistent:"","onUpdate:modelValue":p},{default:o(()=>[l(H,{onClick:e[0]||(e[0]=s=>p(!1))}),l(Y,{title:"Create New Task"},{default:o(()=>[l($,{class:"pa-6"},{default:o(()=>[l(G,{modelValue:a(m),"onUpdate:modelValue":e[11]||(e[11]=s=>P(m)?m.value=s:null),onSubmit:I(y,["prevent"])},{default:o(()=>[l(K,null,{default:o(()=>[l(d,{cols:"12"},{default:o(()=>[l(n,{modelValue:a(t).title,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).title=s),label:"Task Title",placeholder:"Enter task title",rules:[u],required:""},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"12"},{default:o(()=>[l(L,{modelValue:a(t).description,"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).description=s),label:"Description",placeholder:"Enter task description",rows:"3",rules:[u],required:""},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(V,{modelValue:a(t).category,"onUpdate:modelValue":e[3]||(e[3]=s=>a(t).category=s),label:"Category",placeholder:"Select category",items:a(E),rules:[u],required:""},null,8,["modelValue","items","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[r.isFranchisee?(g(),c(n,{key:0,label:"Assigned To","model-value":"Your Franchisor (Automatic)",readonly:"",disabled:"","persistent-hint":"",hint:"Tasks are automatically assigned to your franchisor"})):(g(),c(V,{key:1,modelValue:a(t).assignedTo,"onUpdate:modelValue":e[4]||(e[4]=s=>a(t).assignedTo=s),label:"Assigned To",placeholder:"Select user",items:a(w),loading:a(q),rules:r.isFranchisee?[]:[u],"item-title":"title","item-value":"value",disabled:r.disableAssignedTo,required:!r.isFranchisee},null,8,["modelValue","items","loading","rules","disabled","required"]))]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(n,{modelValue:a(t).startDate,"onUpdate:modelValue":e[5]||(e[5]=s=>a(t).startDate=s),label:"Start Date",type:"date",rules:[u],required:""},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(n,{modelValue:a(t).dueDate,"onUpdate:modelValue":e[6]||(e[6]=s=>a(t).dueDate=s),label:"Due Date",type:"date",rules:[u],required:""},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(V,{modelValue:a(t).priority,"onUpdate:modelValue":e[7]||(e[7]=s=>a(t).priority=s),label:"Priority",placeholder:"Select priority",items:a(N),rules:[u],required:""},null,8,["modelValue","items","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(V,{modelValue:a(t).status,"onUpdate:modelValue":e[8]||(e[8]=s=>a(t).status=s),label:"Status",placeholder:"Select status",items:a(M),rules:[u],required:""},null,8,["modelValue","items","rules"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(n,{modelValue:a(t).estimatedHours,"onUpdate:modelValue":e[9]||(e[9]=s=>a(t).estimatedHours=s),label:"Estimated Hours",type:"number",min:"0"},null,8,["modelValue"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(n,{modelValue:a(t).actualHours,"onUpdate:modelValue":e[10]||(e[10]=s=>a(t).actualHours=s),label:"Actual Hours",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(j),l(z,{class:"pa-6"},{default:o(()=>[l(J),l(C,{color:"error",variant:"text",onClick:F},{default:o(()=>e[12]||(e[12]=[S(" Cancel ")])),_:1,__:[12]}),l(C,{color:"primary",disabled:!a(m),onClick:y},{default:o(()=>e[13]||(e[13]=[S(" Create Task ")])),_:1,__:[13]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}});export{ie as _};
