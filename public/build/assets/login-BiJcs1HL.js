import{_ as B}from"./AppTextField.vue_vue_type_script_setup_true_lang-BtYmKqoH.js";import{d as D,g,e as L,bb as N,be as P,aQ as U,c as S,o as k,l as i,y as s,aR as x,i as a,k as t,G as y,t as V,q as p,b7 as F,a as M,h as $,a7 as j,s as E,a_ as q,aZ as h}from"./main-Cv9YYIc_.js";import{_ as z}from"./AuthProvider.vue_vue_type_script_setup_true_lang-DC2zmv9x.js";import{a as H,b as I}from"./auth-v1-top-shape-gPxasD3d.js";import{V as v}from"./VNodeRenderer-CUWt_8fo.js";import{a as G,d as O,f as w,V as Q}from"./VCard-BzCAkRO7.js";import{V as W}from"./VForm-C-dasJkp.js";import{V as Y,a as c}from"./VRow-BEiqwRCB.js";import{V as Z}from"./VAlert-KmFQIs37.js";import{V as J}from"./VCheckbox-BBNXBl-o.js";import{V as C}from"./VDivider-DT1g3bUq.js";import"./form-4Ew858sR.js";import"./VTextField-C5rooSv7.js";import"./VField-nvY4EMEJ.js";import"./VInput-BKmeTauw.js";import"./VCheckboxBtn-ClkQAZzU.js";import"./VSelectionControl-D-T6fXGu.js";const K={class:"auth-wrapper d-flex align-center justify-center pa-4"},X={class:"position-relative my-sm-16"},ee={class:"app-logo"},se={class:"app-logo-title"},ae={class:"text-h4 mb-1"},oe={class:"text-capitalize"},te={class:"d-flex align-center justify-space-between flex-wrap my-6"},xe=D({__name:"login",setup(re){const l=g({email:"",password:"",remember:!1}),f=g(!1),b=g(!1),d=g(null),u=L(),{smAndUp:R}=N(),{updateAbility:T}=P(),A=async()=>{var _,e;b.value=!0,d.value=null;try{const o=await q("/v1/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password,remember:l.value.remember}});if(h("accessToken").value=o.accessToken,h("userData").value=o.userData,h("userAbilityRules").value=o.userAbilityRules,T(o.userAbilityRules),o.requiresFranchiseRegistration===!0){u.push("/franchisor/franchise-registration");return}switch(o.userData.role){case"admin":u.push("/admin/dashboard");break;case"franchisor":u.push("/franchisor");break;case"franchisee":u.push("/franchisee/dashboard/sales");break;case"broker":u.push("/brokers/lead-management");break;default:u.push("/")}}catch(o){const r=(o==null?void 0:o.data)||((_=o==null?void 0:o.response)==null?void 0:_._data)||null;(o==null?void 0:o.status)===429||((e=o==null?void 0:o.response)==null?void 0:e.status)===429?d.value={general:(r==null?void 0:r.message)||"Too many login attempts. Your account has been temporarily locked."}:r!=null&&r.errors?d.value={email:r.errors.email,password:r.errors.password,general:r.message}:d.value={general:(r==null?void 0:r.message)||"Login failed. Please check your credentials and try again."}}finally{b.value=!1}};return(_,e)=>{const o=U("RouterLink"),r=B;return k(),S("div",K,[i("div",X,[s(a(v),{nodes:x("div",{innerHTML:a(H)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),s(a(v),{nodes:x("div",{innerHTML:a(I)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),s(Q,{class:E(["auth-card",a(R)?"pa-6":"pa-0"]),"max-width":"600"},{default:t(()=>[s(G,{class:"justify-center"},{default:t(()=>[s(O,null,{default:t(()=>[s(o,{to:"/"},{default:t(()=>[i("div",ee,[s(a(v),{nodes:a(y).app.logo},null,8,["nodes"]),i("h1",se,V(a(y).app.title),1)])]),_:1})]),_:1})]),_:1}),s(w,null,{default:t(()=>[i("h4",ae,[e[4]||(e[4]=p(" Welcome to ")),i("span",oe,V(a(y).app.title),1),e[5]||(e[5]=p("! 👋🏻 "))]),e[6]||(e[6]=i("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1))]),_:1,__:[6]}),s(w,null,{default:t(()=>[s(W,{onSubmit:F(A,["prevent"])},{default:t(()=>[s(Y,null,{default:t(()=>[s(c,{cols:"12"},{default:t(()=>{var m;return[(m=a(d))!=null&&m.general?(k(),M(Z,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>{var n;return[p(V((n=a(d))==null?void 0:n.general),1)]}),_:1})):$("",!0)]}),_:1}),s(c,{cols:"12"},{default:t(()=>{var m;return[s(r,{modelValue:a(l).email,"onUpdate:modelValue":e[0]||(e[0]=n=>a(l).email=n),autofocus:"",label:"Email or Username",type:"email","error-messages":(m=a(d))==null?void 0:m.email,placeholder:"Email or Username"},null,8,["modelValue","error-messages"])]}),_:1}),s(c,{cols:"12"},{default:t(()=>{var m;return[s(r,{modelValue:a(l).password,"onUpdate:modelValue":e[1]||(e[1]=n=>a(l).password=n),label:"Password",placeholder:"············",type:a(f)?"text":"password",autocomplete:"password","error-messages":(m=a(d))==null?void 0:m.password,"append-inner-icon":a(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=n=>f.value=!a(f))},null,8,["modelValue","type","error-messages","append-inner-icon"]),i("div",te,[s(J,{modelValue:a(l).remember,"onUpdate:modelValue":e[3]||(e[3]=n=>a(l).remember=n),label:"Remember me"},null,8,["modelValue"]),s(o,{class:"text-primary",to:{name:"forgot-password"}},{default:t(()=>e[7]||(e[7]=[p(" Forgot Password? ")])),_:1,__:[7]})]),s(j,{block:"",type:"submit",loading:a(b),disabled:a(b)},{default:t(()=>e[8]||(e[8]=[p(" Login ")])),_:1,__:[8]},8,["loading","disabled"])]}),_:1}),s(c,{cols:"12",class:"text-body-1 text-center"},{default:t(()=>[e[10]||(e[10]=i("span",{class:"d-inline-block"}," New on our platform? ",-1)),s(o,{class:"text-primary ms-1 d-inline-block text-body-1",to:{name:"register"}},{default:t(()=>e[9]||(e[9]=[p(" Create an account ")])),_:1,__:[9]})]),_:1,__:[10]}),s(c,{cols:"12",class:"d-flex align-center"},{default:t(()=>[s(C),e[11]||(e[11]=i("span",{class:"mx-4 text-high-emphasis"},"or",-1)),s(C)]),_:1,__:[11]}),s(c,{cols:"12",class:"text-center"},{default:t(()=>[s(z)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{xe as default};
