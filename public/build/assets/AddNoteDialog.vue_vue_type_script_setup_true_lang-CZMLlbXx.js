import{_ as B}from"./AppTextarea.vue_vue_type_script_setup_true_lang-G8eTildI.js";import{_ as C}from"./AppTextField.vue_vue_type_script_setup_true_lang-DQMalJbq.js";import{_ as E}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CarmOyZu.js";import{a_ as i,d as T,g as p,O as F,a as x,o as k,k as s,y as a,b5 as y,aI as f,i as h,a7 as D,q as v}from"./main-DTJHMfaq.js";import{V as S,f as I,g as O}from"./VCard-BEgq0Zx7.js";import{V as P}from"./VForm-eNmP1NWV.js";import{V as q,a as V}from"./VRow-vWSGPnzR.js";import{V as L}from"./VFileInput-uStUNFcH.js";import{V as R}from"./VSpacer-C41_h5hf.js";import{V as z}from"./VDialog-DAi3BTyw.js";class G{getBaseUrl(){return"/v1/notes"}async getNotes(e){return await i(this.getBaseUrl(),{method:"GET",query:e})}async getNote(e){return await i(`${this.getBaseUrl()}/${e}`)}async createNote(e){const t=new FormData;return t.append("title",e.title),t.append("description",e.description),e.lead_id&&t.append("lead_id",e.lead_id.toString()),e.attachments&&e.attachments.length>0&&e.attachments.forEach((r,l)=>{t.append(`attachments[${l}]`,r)}),await i(this.getBaseUrl(),{method:"POST",body:t})}async updateNote(e){const t=new FormData;return e.title&&t.append("title",e.title),e.description&&t.append("description",e.description),e.attachments&&e.attachments.length>0&&e.attachments.forEach((r,l)=>{t.append(`attachments[${l}]`,r)}),await i(`${this.getBaseUrl()}/${e.id}`,{method:"PUT",body:t})}async deleteNote(e){return await i(`${this.getBaseUrl()}/${e}`,{method:"DELETE"})}async deleteNoteAttachment(e,t){return await i(`${this.getBaseUrl()}/${e}/attachments/${t}`,{method:"DELETE"})}async updateNoteWithFormData(e,t){return await i(`${this.getBaseUrl()}/${e}`,{method:"POST",body:t})}}const M=new G,te=T({__name:"AddNoteDialog",props:{isDialogVisible:{type:Boolean},leadId:{}},emits:["update:isDialogVisible","noteAdded"],setup(_,{emit:e}){const t=_,r=e,l=p(""),d=p(""),u=p([]),c=F({get:()=>t.isDialogVisible,set:n=>r("update:isDialogVisible",n)}),g=()=>{l.value="",d.value="",u.value=[]},N=n=>{const o=n.target;o.files&&(u.value=Array.from(o.files))},w=async()=>{try{const n=await M.createNote({title:l.value,description:d.value,lead_id:t.leadId,attachments:u.value});n.success?(console.log("Note added successfully:",n.data),r("noteAdded"),c.value=!1,g()):console.error("Failed to add note:",n.message)}catch(n){console.error("Error adding note:",n)}},$=()=>{c.value=!1,g()};return(n,o)=>{const b=E,U=C,A=B;return k(),x(z,{modelValue:h(c),"onUpdate:modelValue":o[2]||(o[2]=m=>f(c)?c.value=m:null),"max-width":"600"},{default:s(()=>[a(b,{onClick:$}),a(S,{title:"Add Note"},{default:s(()=>[a(I,null,{default:s(()=>[a(P,{onSubmit:y(w,["prevent"])},{default:s(()=>[a(q,null,{default:s(()=>[a(V,{cols:"12"},{default:s(()=>[a(U,{modelValue:h(l),"onUpdate:modelValue":o[0]||(o[0]=m=>f(l)?l.value=m:null),label:"Title",placeholder:"Enter note title"},null,8,["modelValue"])]),_:1}),a(V,{cols:"12"},{default:s(()=>[a(A,{modelValue:h(d),"onUpdate:modelValue":o[1]||(o[1]=m=>f(d)?d.value=m:null),label:"Description",placeholder:"Enter note description...",rows:"6"},null,8,["modelValue"])]),_:1}),a(V,{cols:"12"},{default:s(()=>[a(L,{label:"Attachments",multiple:"","prepend-icon":"tabler-paperclip",placeholder:"Upload files",chips:"","show-size":"",onChange:N})]),_:1})]),_:1})]),_:1})]),_:1}),a(O,null,{default:s(()=>[a(R),a(D,{color:"secondary",variant:"tonal",onClick:$},{default:s(()=>o[3]||(o[3]=[v(" Cancel ")])),_:1,__:[3]}),a(D,{color:"primary",onClick:w},{default:s(()=>o[4]||(o[4]=[v(" Add Note ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{te as _,M as n};
