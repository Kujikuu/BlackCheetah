import{V as Ve,_ as xe}from"./VDataTableServer-DNcN2A-R.js";import{_ as me}from"./AppTextField.vue_vue_type_script_setup_true_lang-OO0j41lk.js";import{_ as ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-BPfLoqzx.js";import{_ as Ce}from"./DeleteLeadDialog.vue_vue_type_script_setup_true_lang-1IsNc79y.js";import{_ as pe,V as ve}from"./VDialog-ezJwpJqC.js";import{V as X,f as q,g as fe,b as de,a as Le,d as he}from"./VCard-DVi6PJvG.js";import{V as Y,a as u}from"./VRow-DGHOvSAD.js";import{V as te}from"./VChip-DIkTAQw-.js";import{V as se}from"./VSpacer-BI04G-8-.js";import{d as oe,O as Q,a as N,o as C,k as a,y as t,h as P,l as s,t as p,q as h,a7 as I,av as W,aI as L,i as l,g as f,w as le,b7 as we,E as ne,aQ as $e,c as re,F as Se,r as Ne,s as De}from"./main-DgBHKuti.js";import{_ as ke}from"./AppTextarea.vue_vue_type_script_setup_true_lang-Ca4fTMXo.js";import{l as ae}from"./lead-EjtNCbjj.js";import{u as Ue,a as Ee}from"./useSaudiProvinces-DZXxRXfL.js";import{u as Te}from"./useValidationRules-Bd5D7Ytp.js";import{b as Ae}from"./leadsValidation-znp6EEdO.js";import{V as Pe}from"./VForm-CVDY5Y_H.js";import{f as je}from"./franchise-D70twOXJ.js";import{V as ue}from"./VDivider-BxPq45VT.js";import{V as Be}from"./VMenu-BZrTr3PO.js";import{V as Ie,a as Re,b as ze}from"./VList-GaJZ0aKs.js";import"./VPagination-Mzs-1YwL.js";import"./VDataTable-Dmn8NPnQ.js";import"./VSelect-Cvwflwlf.js";import"./VTextField-BE7e03Iq.js";import"./VField-D5C47MaZ.js";import"./form-DwIkDiBQ.js";import"./VInput-DmiY3qNu.js";import"./VCheckboxBtn-dXM9W6qw.js";import"./VSelectionControl-QXfrxDwN.js";import"./VTable-C3tJcVv6.js";import"./VSlideGroup-BvA3YSJG.js";import"./VTextarea-BIzeImqm.js";import"./api-router-vIGOsR04.js";const Me={class:"mb-4"},Fe={class:"text-body-1 font-weight-medium"},Oe={class:"mb-4"},We={class:"text-body-1 font-weight-medium"},qe={class:"mb-4"},Qe={class:"text-body-1"},Je=["href"],He={class:"mb-4"},Ge={class:"text-body-1"},Ke=["href"],Xe={class:"mb-4"},Ye={class:"text-body-1"},Ze={class:"mb-4"},et={class:"text-body-1"},tt={class:"mb-4"},lt={class:"text-body-1"},at={class:"mb-4"},st={class:"text-body-1"},ot={class:"mb-4"},it={class:"text-body-1"},dt={class:"mb-4"},nt={class:"text-body-1"},rt={class:"mb-4"},ut={class:"mb-4"},mt={class:"mb-4"},ct={class:"text-body-1"},pt={class:"mb-4"},vt={class:"text-body-1"},ft={class:"mb-4"},bt={class:"text-body-1"},gt={class:"mb-4"},yt={class:"text-body-1"},_t=oe({__name:"ViewLeadDialog",props:{isDialogVisible:{type:Boolean},lead:{}},emits:["update:isDialogVisible","editLead"],setup(J,{emit:j}){const w=J,k=j,_=Q({get:()=>w.isDialogVisible,set:d=>k("update:isDialogVisible",d)}),$=d=>{const e=d.toLowerCase();return e==="new"?"info":e==="contacted"?"primary":e==="qualified"||e==="closed_won"?"success":e==="closed_lost"?"error":"primary"},E=d=>{const e=d.toLowerCase();return e==="low"?"success":e==="medium"?"warning":e==="high"||e==="urgent"?"error":"secondary"},b=d=>d.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),D=()=>{w.lead&&(k("editLead",w.lead),_.value=!1)},V=()=>{_.value=!1};return(d,e)=>{const z=pe;return C(),N(ve,{modelValue:l(_),"onUpdate:modelValue":e[0]||(e[0]=M=>L(_)?_.value=M:null),"max-width":"900",scrollable:""},{default:a(()=>[t(z,{onClick:V}),d.lead?(C(),N(X,{key:0,title:"Lead Details"},{default:a(()=>[t(q,null,{default:a(()=>[t(Y,null,{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",Me,[e[1]||(e[1]=s("div",{class:"text-sm text-disabled mb-1"}," First Name ",-1)),s("div",Fe,p(d.lead.firstName),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",Oe,[e[2]||(e[2]=s("div",{class:"text-sm text-disabled mb-1"}," Last Name ",-1)),s("div",We,p(d.lead.lastName),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",qe,[e[3]||(e[3]=s("div",{class:"text-sm text-disabled mb-1"}," Email ",-1)),s("div",Qe,[s("a",{href:`mailto:${d.lead.email}`},p(d.lead.email),9,Je)])])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",He,[e[4]||(e[4]=s("div",{class:"text-sm text-disabled mb-1"}," Phone ",-1)),s("div",Ge,[s("a",{href:`tel:${d.lead.phone}`},p(d.lead.phone),9,Ke)])])]),_:1}),d.lead.company?(C(),N(u,{key:0,cols:"12",md:"6"},{default:a(()=>[s("div",Xe,[e[5]||(e[5]=s("div",{class:"text-sm text-disabled mb-1"}," Company ",-1)),s("div",Ye,p(d.lead.company),1)])]),_:1})):P("",!0),d.lead.jobTitle?(C(),N(u,{key:1,cols:"12",md:"6"},{default:a(()=>[s("div",Ze,[e[6]||(e[6]=s("div",{class:"text-sm text-disabled mb-1"}," Job Title ",-1)),s("div",et,p(d.lead.jobTitle),1)])]),_:1})):P("",!0),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",tt,[e[7]||(e[7]=s("div",{class:"text-sm text-disabled mb-1"}," Nationality ",-1)),s("div",lt,p(d.lead.nationality||"N/A"),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",at,[e[8]||(e[8]=s("div",{class:"text-sm text-disabled mb-1"}," Province ",-1)),s("div",st,p(d.lead.state||"N/A"),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",ot,[e[9]||(e[9]=s("div",{class:"text-sm text-disabled mb-1"}," City ",-1)),s("div",it,p(d.lead.city),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",dt,[e[10]||(e[10]=s("div",{class:"text-sm text-disabled mb-1"}," Lead Source ",-1)),s("div",nt,p(b(d.lead.source)),1)])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",rt,[e[11]||(e[11]=s("div",{class:"text-sm text-disabled mb-1"}," Status ",-1)),t(te,{color:$(d.lead.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[h(p(d.lead.status.replace(/_/g," ")),1)]),_:1},8,["color"])])]),_:1}),d.lead.priority?(C(),N(u,{key:2,cols:"12",md:"6"},{default:a(()=>[s("div",ut,[e[12]||(e[12]=s("div",{class:"text-sm text-disabled mb-1"}," Priority ",-1)),t(te,{color:E(d.lead.priority),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[h(p(d.lead.priority),1)]),_:1},8,["color"])])]),_:1})):P("",!0),t(u,{cols:"12",md:"6"},{default:a(()=>[s("div",mt,[e[13]||(e[13]=s("div",{class:"text-sm text-disabled mb-1"}," Assigned To ",-1)),s("div",ct,p(d.lead.owner),1)])]),_:1}),d.lead.lastContacted?(C(),N(u,{key:3,cols:"12",md:"6"},{default:a(()=>[s("div",pt,[e[14]||(e[14]=s("div",{class:"text-sm text-disabled mb-1"}," Last Contacted ",-1)),s("div",vt,p(d.lead.lastContacted),1)])]),_:1})):P("",!0),d.lead.scheduledMeeting?(C(),N(u,{key:4,cols:"12",md:"6"},{default:a(()=>[s("div",ft,[e[15]||(e[15]=s("div",{class:"text-sm text-disabled mb-1"}," Scheduled Meeting ",-1)),s("div",bt,p(d.lead.scheduledMeeting),1)])]),_:1})):P("",!0),d.lead.note?(C(),N(u,{key:5,cols:"12"},{default:a(()=>[s("div",gt,[e[16]||(e[16]=s("div",{class:"text-sm text-disabled mb-1"}," Notes ",-1)),s("div",yt,p(d.lead.note),1)])]),_:1})):P("",!0)]),_:1})]),_:1}),t(fe,null,{default:a(()=>[t(se),t(I,{color:"secondary",variant:"tonal",onClick:V},{default:a(()=>e[17]||(e[17]=[h(" Close ")])),_:1,__:[17]}),t(I,{color:"primary",onClick:D},{default:a(()=>[t(W,{icon:"tabler-edit",class:"me-1"}),e[18]||(e[18]=h(" Edit "))]),_:1,__:[18]})]),_:1})]),_:1})):P("",!0)]),_:1},8,["modelValue"])}}}),Vt=oe({__name:"EditLeadDialog",props:{isDialogVisible:{type:Boolean},lead:{}},emits:["update:isDialogVisible","leadUpdated"],setup(J,{emit:j}){const w=J,k=j,_=Q({get:()=>w.isDialogVisible,set:v=>k("update:isDialogVisible",v)}),$=f(!1),E=f(),{backendErrors:b,setBackendErrors:D,clearError:V}=Te(),d=Ae(),e=f({firstName:"",lastName:"",email:"",phone:"",company:"",jobTitle:"",nationality:"",state:"",city:"",source:"",status:"",priority:"",note:""}),{countries:z,isLoading:M}=Ue(),{provinces:U,getCitiesForProvince:F,isLoading:O}=Ee(),H=Q(()=>F(e.value.state||""));le(()=>e.value.state,(v,o)=>{if(o!==void 0&&o!==v){const B=F(v||""),S=e.value.city;S&&!B.includes(S)&&(e.value.city="")}});const G=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],K=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Proposal Sent",value:"proposal_sent"},{title:"Negotiating",value:"negotiating"},{title:"Closed Won",value:"closed_won"},{title:"Closed Lost",value:"closed_lost"}],Z=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];le(()=>w.lead,v=>{v&&(e.value={firstName:v.firstName||"",lastName:v.lastName||"",email:v.email||"",phone:v.phone||"",company:v.company||"",jobTitle:v.jobTitle||"",nationality:v.nationality||"",state:v.state||"",city:v.city||"",source:v.source||"",status:v.status||"",priority:v.priority||"medium",note:v.note||""})},{immediate:!0});const R=async()=>{if(!w.lead)return;const{valid:v}=await E.value.validate();if(v)try{$.value=!0,(await ae.updateLead(w.lead.id,{firstName:e.value.firstName,lastName:e.value.lastName,email:e.value.email,phone:e.value.phone,company:e.value.company||void 0,jobTitle:e.value.jobTitle||void 0,nationality:e.value.nationality||void 0,state:e.value.state||void 0,city:e.value.city||void 0,source:e.value.source||void 0,status:e.value.status,priority:e.value.priority||void 0,note:e.value.note||void 0})).success&&(k("leadUpdated"),_.value=!1)}catch(o){console.error("Error updating lead:",o),D(o)}finally{$.value=!1}},T=()=>{_.value=!1};return(v,o)=>{const B=pe,S=me,A=ce,ee=ke;return C(),N(ve,{modelValue:l(_),"onUpdate:modelValue":o[23]||(o[23]=r=>L(_)?_.value=r:null),"max-width":"900",scrollable:""},{default:a(()=>[t(B,{onClick:T}),t(X,{title:"Edit Lead"},{default:a(()=>[t(q,null,{default:a(()=>[t(Pe,{ref_key:"formRef",ref:E,onSubmit:we(R,["prevent"])},{default:a(()=>[t(Y,null,{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).firstName,"onUpdate:modelValue":o[0]||(o[0]=r=>l(e).firstName=r),label:"First Name",placeholder:"Enter first name",rules:l(d).firstName,"error-messages":l(b).firstName,onInput:o[1]||(o[1]=r=>l(V)("firstName"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).lastName,"onUpdate:modelValue":o[2]||(o[2]=r=>l(e).lastName=r),label:"Last Name",placeholder:"Enter last name",rules:l(d).lastName,"error-messages":l(b).lastName,onInput:o[3]||(o[3]=r=>l(V)("lastName"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).email,"onUpdate:modelValue":o[4]||(o[4]=r=>l(e).email=r),label:"Email",type:"email",placeholder:"Enter email address",rules:l(d).email,"error-messages":l(b).email,onInput:o[5]||(o[5]=r=>l(V)("email"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).phone,"onUpdate:modelValue":o[6]||(o[6]=r=>l(e).phone=r),label:"Phone",placeholder:"+966 50 123 4567",rules:l(d).phone,"error-messages":l(b).phone,onInput:o[7]||(o[7]=r=>l(V)("phone"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).company,"onUpdate:modelValue":o[8]||(o[8]=r=>l(e).company=r),label:"Company Name",placeholder:"Enter company name"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(S,{modelValue:l(e).jobTitle,"onUpdate:modelValue":o[9]||(o[9]=r=>l(e).jobTitle=r),label:"Job Title",placeholder:"Enter job title"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).nationality,"onUpdate:modelValue":[o[10]||(o[10]=r=>l(e).nationality=r),o[11]||(o[11]=r=>l(V)("nationality"))],label:"Nationality",placeholder:"Select nationality",items:l(z),loading:l(M),rules:l(d).nationality,"error-messages":l(b).nationality,clearable:""},null,8,["modelValue","items","loading","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).state,"onUpdate:modelValue":[o[12]||(o[12]=r=>l(e).state=r),o[13]||(o[13]=r=>l(V)("state"))],label:"Province",placeholder:"Select province",items:l(U),loading:l(O),"error-messages":l(b).state,clearable:""},null,8,["modelValue","items","loading","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).city,"onUpdate:modelValue":[o[14]||(o[14]=r=>l(e).city=r),o[15]||(o[15]=r=>l(V)("city"))],label:"City",placeholder:"Select city",items:l(H),disabled:!l(e).state,rules:l(d).city,"error-messages":l(b).city,clearable:""},null,8,["modelValue","items","disabled","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).source,"onUpdate:modelValue":[o[16]||(o[16]=r=>l(e).source=r),o[17]||(o[17]=r=>l(V)("source"))],label:"Lead Source",items:G,placeholder:"Select source",rules:l(d).source,"error-messages":l(b).source},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).status,"onUpdate:modelValue":[o[18]||(o[18]=r=>l(e).status=r),o[19]||(o[19]=r=>l(V)("status"))],label:"Status",items:K,placeholder:"Select status",rules:l(d).status,"error-messages":l(b).status},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(A,{modelValue:l(e).priority,"onUpdate:modelValue":[o[20]||(o[20]=r=>l(e).priority=r),o[21]||(o[21]=r=>l(V)("priority"))],label:"Priority",items:Z,placeholder:"Select priority",rules:l(d).priority,"error-messages":l(b).priority},null,8,["modelValue","rules","error-messages"])]),_:1}),t(u,{cols:"12"},{default:a(()=>[t(ee,{modelValue:l(e).note,"onUpdate:modelValue":o[22]||(o[22]=r=>l(e).note=r),label:"Notes",placeholder:"Add notes about this lead",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(fe,null,{default:a(()=>[t(se),t(I,{color:"secondary",variant:"tonal",disabled:l($),onClick:T},{default:a(()=>o[24]||(o[24]=[h(" Cancel ")])),_:1,__:[24]},8,["disabled"]),t(I,{color:"primary",loading:l($),disabled:l($),onClick:R},{default:a(()=>o[25]||(o[25]=[h(" Save Changes ")])),_:1,__:[25]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),xt={class:"d-flex mb-6"},Ct={class:"d-flex justify-space-between"},Lt={class:"d-flex flex-column gap-y-1"},ht={class:"text-body-1 text-high-emphasis"},wt={class:"d-flex gap-x-2 align-center"},$t={class:"text-h4"},St={class:"text-sm"},Nt={class:"me-3 d-flex gap-3"},Dt={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},kt={style:{"inline-size":"15.625rem"}},Ut={class:"d-flex align-center gap-x-4"},Et={class:"d-flex flex-column"},Tt={class:"text-base font-weight-medium"},At={class:"text-body-1"},Pt={class:"text-body-1"},jt={class:"text-body-1 text-capitalize"},Bt={class:"text-body-1"},gl=oe({__name:"leads",setup(J){const j=f(null),w=f(!1),k=async()=>{w.value=!0;try{const m=await je.getDashboardLeads();j.value=m}catch(m){console.error("Error fetching leads data:",m),j.value=null}finally{w.value=!1}},_=f(""),$=f(),E=f(),b=f(10),D=f(1),V=f(),d=f(),e=f([]),z=m=>{var i,g;V.value=(i=m.sortBy[0])==null?void 0:i.key,d.value=(g=m.sortBy[0])==null?void 0:g.order},M=[{title:"Lead Name",key:"name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Source",key:"source"},{title:"Status",key:"status"},{title:"Created Date",key:"createdDate"},{title:"Actions",key:"actions",sortable:!1}],U=f({leads:[],totalLeads:0}),F=f([{title:"Total Leads",value:"0",change:0,desc:"All time leads",icon:"tabler-users",iconColor:"primary"},{title:"Closed and Won",value:"0",change:0,desc:"Converted leads",icon:"tabler-trophy",iconColor:"success"},{title:"Closed and Lost",value:"0",change:0,desc:"Lost opportunities",icon:"tabler-x",iconColor:"error"},{title:"Pending Leads",value:"0",change:0,desc:"Active leads",icon:"tabler-clock",iconColor:"warning"}]);le(j,m=>{var g;const i=m;if(i!=null&&i.success&&(i!=null&&i.data)){const x=i.data;U.value={leads:Array.isArray(x.leads)?x.leads.map(c=>({id:c.id,name:`${c.first_name||""} ${c.last_name||""}`.trim(),email:c.email,phone:c.phone,source:c.lead_source,status:c.status,createdDate:new Date(c.created_at).toLocaleDateString()})):[],totalLeads:((g=x.pagination)==null?void 0:g.total)||(Array.isArray(x.leads)?x.leads.length:0)};const y=x.stats||{total_leads:0,total_leads_change:0,won_leads:0,won_leads_change:0,lost_leads:0,lost_leads_change:0,pending_leads:0,pending_leads_change:0};F.value=[{title:"Total Leads",value:y.total_leads.toLocaleString(),change:y.total_leads_change,desc:"All time leads",icon:"tabler-users",iconColor:"primary"},{title:"Closed and Won",value:y.won_leads.toLocaleString(),change:y.won_leads_change,desc:"Converted leads",icon:"tabler-trophy",iconColor:"success"},{title:"Closed and Lost",value:y.lost_leads.toLocaleString(),change:y.lost_leads_change,desc:"Lost opportunities",icon:"tabler-x",iconColor:"error"},{title:"Pending Leads",value:y.pending_leads.toLocaleString(),change:y.pending_leads_change,desc:"Active leads",icon:"tabler-clock",iconColor:"warning"}]}},{immediate:!0});const O=Q(()=>U.value.leads),H=Q(()=>U.value.totalLeads);ne(()=>{k()});const G=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Email Campaign",value:"email"}],K=[{title:"Pending",value:"pending"},{title:"Won",value:"won"},{title:"Lost",value:"lost"}],Z=m=>{const i=m.toLowerCase();return i==="pending"?"warning":i==="won"?"success":i==="lost"?"error":"primary"},R=f(!1),T=f(!1),v=f(!1),o=f(null),B=f(null),S=m=>{o.value={...m},T.value=!0},A=m=>{B.value=m,v.value=!0},ee=async()=>{if(e.value.length!==0)try{for(const m of e.value)await ae.deleteLead(m);e.value.forEach(m=>{const i=U.value.leads.findIndex(g=>g.id===m);i!==-1&&U.value.leads.splice(i,1)}),e.value=[]}catch(m){console.error("Error bulk deleting leads:",m)}},r=async m=>{const i=m||o.value;if(i){try{const g={firstName:i.name.split(" ")[0]||"",lastName:i.name.split(" ").slice(1).join(" ")||"",email:i.email,phone:i.phone,source:i.source,status:i.status},x=await ae.updateLead(i.id,g);if(x.success&&x.data){const y=U.value.leads.findIndex(c=>c.id===i.id);if(y!==-1){const c=x.data;U.value.leads[y]={id:c.id,name:`${c.firstName} ${c.lastName}`.trim(),email:c.email,phone:c.phone,source:c.source,status:c.status,createdDate:i.createdDate}}}}catch(g){console.error("Error updating lead:",g)}T.value=!1,o.value=null}},be=()=>{const i=["Name,Email,Phone,Source,Status,Created Date",...(e.value.length>0?O.value.filter(c=>e.value.includes(c.id)):O.value).map(c=>`"${c.name}","${c.email}","${c.phone}","${c.source}","${c.status}","${c.createdDate}"`)].join(`
`),g=new Blob([i],{type:"text/csv"}),x=window.URL.createObjectURL(g),y=document.createElement("a");y.href=x,y.download=`leads_${e.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,y.click(),window.URL.revokeObjectURL(x)},ge=m=>m>0?`+${m}`:`${m}`,ye=m=>m.split(" ").map(i=>i[0]).join("").toUpperCase(),_e=async()=>{await k(),v.value=!1,B.value=null};return ne(()=>{k()}),(m,i)=>{const g=ce,x=me,y=$e("RouterLink"),c=xe;return C(),re("section",null,[s("div",xt,[t(Y,null,{default:a(()=>[(C(!0),re(Se,null,Ne(l(F),(n,ie)=>(C(),N(u,{key:ie,cols:"12",md:"3",sm:"6"},{default:a(()=>[t(X,null,{default:a(()=>[t(q,null,{default:a(()=>[s("div",Ct,[s("div",Lt,[s("div",ht,p(n.title),1),s("div",wt,[s("h4",$t,p(n.value),1),s("div",{class:De(["text-base",n.change>0?"text-success":"text-error"])}," ("+p(ge(n.change))+"%) ",3)]),s("div",St,p(n.desc),1)]),t(de,{color:n.iconColor,variant:"tonal",rounded:"",size:"42"},{default:a(()=>[t(W,{icon:n.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(X,{class:"mb-6"},{default:a(()=>[t(Le,{class:"pb-4"},{default:a(()=>[t(he,null,{default:a(()=>i[11]||(i[11]=[h("Filters")])),_:1,__:[11]})]),_:1}),t(q,null,{default:a(()=>[t(Y,null,{default:a(()=>[t(u,{cols:"12",sm:"6"},{default:a(()=>[t(g,{modelValue:l(E),"onUpdate:modelValue":i[0]||(i[0]=n=>L(E)?E.value=n:null),placeholder:"Select Source",items:G,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:a(()=>[t(g,{modelValue:l($),"onUpdate:modelValue":i[1]||(i[1]=n=>L($)?$.value=n:null),placeholder:"Select Status",items:K,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ue),t(q,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[s("div",Nt,[t(g,{"model-value":l(b),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":i[2]||(i[2]=n=>b.value=parseInt(String(n),10))},null,8,["model-value"]),l(e).length>0?(C(),N(I,{key:0,variant:"tonal",color:"error",onClick:ee},{default:a(()=>[t(W,{icon:"tabler-trash",class:"me-2"}),h(" Delete Selected ("+p(l(e).length)+") ",1)]),_:1})):P("",!0)]),t(se),s("div",Dt,[s("div",kt,[t(x,{modelValue:l(_),"onUpdate:modelValue":i[3]||(i[3]=n=>L(_)?_.value=n:null),placeholder:"Search Lead"},null,8,["modelValue"])]),t(I,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload",onClick:be},{default:a(()=>[h(" Export "+p(l(e).length>0?`(${l(e).length})`:"All"),1)]),_:1})])]),_:1}),t(ue),t(Ve,{"items-per-page":l(b),"onUpdate:itemsPerPage":i[5]||(i[5]=n=>L(b)?b.value=n:null),"model-value":l(e),"onUpdate:modelValue":i[6]||(i[6]=n=>L(e)?e.value=n:null),page:l(D),"onUpdate:page":i[7]||(i[7]=n=>L(D)?D.value=n:null),items:l(O),"item-value":"id","items-length":l(H),headers:M,class:"text-no-wrap","show-select":"","onUpdate:options":z},{"item.name":a(({item:n})=>[s("div",Ut,[t(de,{size:"34",variant:"tonal",color:"primary"},{default:a(()=>[s("span",null,p(ye(n.name)),1)]),_:2},1024),s("div",Et,[s("h6",Tt,[t(y,{to:{name:"franchisor-leads-id",params:{id:n.id}},class:"text-link"},{default:a(()=>[h(p(n.name),1)]),_:2},1032,["to"])])])])]),"item.email":a(({item:n})=>[s("div",At,p(n.email),1)]),"item.phone":a(({item:n})=>[s("div",Pt,p(n.phone),1)]),"item.source":a(({item:n})=>[s("div",jt,p(n.source),1)]),"item.status":a(({item:n})=>[t(te,{color:Z(n.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[h(p(n.status),1)]),_:2},1032,["color"])]),"item.createdDate":a(({item:n})=>[s("div",Bt,p(n.createdDate),1)]),"item.actions":a(({item:n})=>[t(I,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[t(W,{icon:"tabler-dots-vertical"}),t(Be,{activator:"parent"},{default:a(()=>[t(Ie,null,{default:a(()=>[t(Re,{onClick:ie=>A(n.id)},{prepend:a(()=>[t(W,{icon:"tabler-trash"})]),default:a(()=>[t(ze,null,{default:a(()=>i[12]||(i[12]=[h("Delete")])),_:1,__:[12]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[t(c,{page:l(D),"onUpdate:page":i[4]||(i[4]=n=>L(D)?D.value=n:null),"items-per-page":l(b),"total-items":l(H)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),t(_t,{"is-dialog-visible":l(R),"onUpdate:isDialogVisible":i[8]||(i[8]=n=>L(R)?R.value=n:null),"selected-lead":l(o),onEditLead:S},null,8,["is-dialog-visible","selected-lead"]),t(Vt,{"is-dialog-visible":l(T),"onUpdate:isDialogVisible":i[9]||(i[9]=n=>L(T)?T.value=n:null),"selected-lead":l(o),sources:G,statuses:K,onSaveLead:r},null,8,["is-dialog-visible","selected-lead"]),t(Ce,{"is-dialog-visible":l(v),"onUpdate:isDialogVisible":i[10]||(i[10]=n=>L(v)?v.value=n:null),"lead-id":l(B),onLeadDeleted:_e},null,8,["is-dialog-visible","lead-id"])])}}});export{gl as default};
