var pe=Object.defineProperty;var me=(P,i,u)=>i in P?pe(P,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):P[i]=u;var ae=(P,i,u)=>me(P,typeof i!="symbol"?i+"":i,u);import{_ as ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-D7xQ4Hmd.js";import{_ as le}from"./AppTextField.vue_vue_type_script_setup_true_lang-DaZorL-F.js";import{b2 as E,d as z,g as y,O as te,w as fe,E as se,a as C,o as w,k as t,y as e,i as a,l as m,h as q,c as I,t as U,aD as ve,a7 as T,av as H,q as x,bb as oe,b1 as W,F as Q,r as X,aM as L,u as ye}from"./main-CEM1QI86.js";import{u as ge,a as be}from"./useSaudiProvinces-RrPRYxvk.js";import{a as g,V as $}from"./VRow-DQylzCgd.js";import{V as Z,f as D,b as Ve,e as _e,a as we,d as he}from"./VCard-BQn_ZwHQ.js";import{V as O,a as xe}from"./VAlert-D7jBKg4h.js";import{V as K}from"./VDivider-MM1jTXpn.js";import{V as re}from"./VForm-B8cle4sK.js";import{V as Pe}from"./VTable-VxcjIzlK.js";import{V as Y}from"./VCheckbox-CVpTSw5R.js";import{V as ke,a as Ae}from"./VTabs-Bxes0duv.js";import{a as J,V as Ce}from"./VWindowItem-DfjmoSwF.js";import"./form-ChweRA-D.js";import"./VSelect-DAbGf17D.js";import"./VTextField-C2dTSwqb.js";import"./VField-sdCO7WAE.js";import"./forwardRefs-B931MWyl.js";import"./VInput-BhhwivIT.js";import"./VList-DLC3F4tN.js";import"./VMenu-Dj8Drxav.js";import"./VOverlay-DGzNmcTF.js";import"./scopeId-DY8qXCsp.js";import"./VCheckboxBtn-BXdbbINE.js";import"./VSelectionControl-DcY1Vt5D.js";import"./VChip-BShyV8jA.js";import"./VSlideGroup-Cc3zlOOJ.js";/* empty css              */const Ue="/v1/account";class Se{constructor(){ae(this,"baseUrl",Ue)}async getProfile(){return await E(`${this.baseUrl}/profile`,{method:"GET"})}async updateProfile(i){return await E(`${this.baseUrl}/profile`,{method:"PUT",body:i})}async updatePassword(i){return await E(`${this.baseUrl}/password`,{method:"PUT",body:i})}async uploadAvatar(i){const u=new FormData;return u.append("avatar",i),await E(`${this.baseUrl}/avatar`,{method:"POST",body:u})}async deleteAvatar(){return await E(`${this.baseUrl}/avatar`,{method:"DELETE"})}async updateNotificationPreferences(i){return await E(`${this.baseUrl}/notifications`,{method:"PUT",body:{notifications:i}})}}const F=new Se,Ne={class:"d-flex align-center"},Te={class:"position-relative me-6"},Fe={key:1,class:"text-5xl font-weight-medium"},Ie={key:0,class:"position-absolute top-0 start-0 w-100 h-100 d-flex align-center justify-center",style:{background:"rgba(0,0,0,0.5)","border-radius":"8px"}},Ee={class:"d-flex flex-column justify-center gap-4"},$e={class:"d-flex flex-wrap gap-2"},De=z({__name:"AccountSettingsAccount",setup(P){const i=y(),u=y(!1),b=y(!1),v=y(!1),o=y(null),l=y({avatarImg:"",name:"",email:"",role:"",phone:"",dateOfBirth:"",gender:"",nationality:"",state:"",city:"",address:""}),n=y({type:null,message:""}),{countries:r,isLoading:c}=ge(),{provinces:h,getCitiesForProvince:A,isLoading:j}=be(),M=te(()=>A(l.value.state||""));fe(()=>l.value.state,()=>{l.value.city=""});const d=["Male","Female"],k=p=>({admin:"Administrator",franchisor:"Franchisor",franchisee:"Franchisee",unit_manager:"Unit Manager",sales_associate:"Sales Associate",employee:"Employee"})[p]||p,_=async()=>{try{u.value=!0;const p=await F.getProfile();p.success&&(o.value=p.data,l.value={avatarImg:p.data.avatar||"",name:p.data.name,email:p.data.email,role:k(p.data.role),phone:p.data.phone||"",dateOfBirth:p.data.date_of_birth||"",gender:p.data.gender||"",nationality:p.data.nationality||"",state:p.data.state||"",city:p.data.city||"",address:p.data.address||""})}catch(p){console.error("Error loading profile:",p)}finally{u.value=!1}},ne=()=>{o.value&&(l.value={avatarImg:o.value.avatar||"",name:o.value.name,email:o.value.email,role:k(o.value.role),phone:o.value.phone||"",dateOfBirth:o.value.date_of_birth||"",gender:o.value.gender||"",nationality:o.value.nationality||"",state:o.value.state||"",city:o.value.city||"",address:o.value.address||""})},ie=async p=>{var V,S,f;const{files:s}=p.target;if(s&&s.length){const N=s[0];if(N.size>800*1024){n.value={type:"error",message:"File size must be less than 800KB"},setTimeout(()=>n.value={type:null,message:""},5e3);return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(N.type)){n.value={type:"error",message:"Only JPG, PNG, and GIF files are allowed"},setTimeout(()=>n.value={type:null,message:""},5e3);return}try{const R=new FileReader;R.onload=B=>{var ee;l.value.avatarImg=(ee=B.target)==null?void 0:ee.result},R.readAsDataURL(N),v.value=!0,n.value={type:null,message:"Uploading..."};const G=await F.uploadAvatar(N);if(G.success){l.value.avatarImg=G.data.avatar,o.value&&(o.value.avatar=G.data.avatar);const B=W("userData");B.value&&(B.value={...B.value,avatar:G.data.avatar}),n.value={type:"success",message:"Avatar uploaded successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}}catch(R){console.error("Error uploading avatar:",R),n.value={type:"error",message:((S=(V=R.response)==null?void 0:V.data)==null?void 0:S.message)||"Failed to upload avatar"},(f=o.value)!=null&&f.avatar&&(l.value.avatarImg=o.value.avatar),setTimeout(()=>n.value={type:null,message:""},5e3)}finally{v.value=!1}}},ue=async()=>{var p,s;try{v.value=!0,n.value={type:null,message:"Removing avatar..."},await F.deleteAvatar(),l.value.avatarImg="",o.value&&(o.value.avatar=null);const V=W("userData");V.value&&(V.value={...V.value,avatar:null}),n.value={type:"success",message:"Avatar removed successfully!"},setTimeout(()=>n.value={type:null,message:""},3e3)}catch(V){console.error("Error deleting avatar:",V),n.value={type:"error",message:((s=(p=V.response)==null?void 0:p.data)==null?void 0:s.message)||"Failed to remove avatar"},setTimeout(()=>n.value={type:null,message:""},5e3)}finally{v.value=!1}},de=async()=>{try{b.value=!0;const p=await F.updateProfile({name:l.value.name,phone:l.value.phone,date_of_birth:l.value.dateOfBirth||null,gender:l.value.gender||null,nationality:l.value.nationality||null,state:l.value.state||null,city:l.value.city||null,address:l.value.address||null});if(p.success){o.value=p.data;const s=W("userData");s.value&&(s.value={...s.value,name:p.data.name,fullName:p.data.name})}}catch(p){console.error("Error updating profile:",p)}finally{b.value=!1}};return se(()=>{_()}),(p,s)=>{const V=le,S=ce;return w(),C($,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Z,{title:"Profile Details",loading:a(u)},{default:t(()=>[e(D,{class:"d-flex flex-column gap-4"},{default:t(()=>[m("div",Ne,[m("div",Te,[e(Ve,{rounded:"",size:"100"},{default:t(()=>[a(l).avatarImg?(w(),C(_e,{key:0,src:a(l).avatarImg},null,8,["src"])):(w(),I("span",Fe,U(a(l).name.charAt(0).toUpperCase()),1))]),_:1}),a(v)?(w(),I("div",Ie,[e(ve,{indeterminate:"",color:"white",size:"32"})])):q("",!0)]),m("div",Ee,[m("div",$e,[e(T,{color:"primary",loading:a(v),disabled:a(u)||a(v),onClick:s[0]||(s[0]=f=>{var N;return(N=a(i))==null?void 0:N.click()})},{default:t(()=>[e(H,{icon:"tabler-cloud-upload",class:"d-sm-none"}),s[12]||(s[12]=m("span",{class:"d-none d-sm-block"},"Upload new photo",-1))]),_:1,__:[12]},8,["loading","disabled"]),m("input",{ref_key:"refInputEl",ref:i,type:"file",name:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:ie},null,544),e(T,{type:"reset",color:"secondary",variant:"outlined",loading:a(v),disabled:a(u)||a(v)||!a(l).avatarImg,onClick:ue},{default:t(()=>s[13]||(s[13]=[x(" Reset ")])),_:1,__:[13]},8,["loading","disabled"])]),s[14]||(s[14]=m("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1))])]),a(n).message?(w(),C(O,{key:0,type:a(n).type||"info",variant:"tonal",closable:"","onClick:close":s[1]||(s[1]=f=>n.value={type:null,message:""})},{default:t(()=>[x(U(a(n).message),1)]),_:1},8,["type"])):q("",!0)]),_:1}),e(K),e(D,null,{default:t(()=>[e(re,{class:"mt-6"},{default:t(()=>[e($,null,{default:t(()=>[e(g,{cols:"12",md:"12"},{default:t(()=>[e(V,{modelValue:a(l).name,"onUpdate:modelValue":s[2]||(s[2]=f=>a(l).name=f),label:"Full Name",placeholder:"Name"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a(l).email,"onUpdate:modelValue":s[3]||(s[3]=f=>a(l).email=f),label:"Email",type:"email",placeholder:"admin@example.com",readonly:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a(l).role,"onUpdate:modelValue":s[4]||(s[4]=f=>a(l).role=f),label:"Role",placeholder:"Administrator",readonly:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a(l).phone,"onUpdate:modelValue":s[5]||(s[5]=f=>a(l).phone=f),label:"Phone Number",placeholder:"+966 50 123 4567"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a(l).dateOfBirth,"onUpdate:modelValue":s[6]||(s[6]=f=>a(l).dateOfBirth=f),label:"Date of Birth",type:"date",placeholder:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a(l).gender,"onUpdate:modelValue":s[7]||(s[7]=f=>a(l).gender=f),label:"Gender",items:d,placeholder:"Select Gender",clearable:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a(l).nationality,"onUpdate:modelValue":s[8]||(s[8]=f=>a(l).nationality=f),label:"Nationality",items:a(r),placeholder:"Select Nationality",clearable:"",loading:a(c)},null,8,["modelValue","items","loading"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a(l).state,"onUpdate:modelValue":s[9]||(s[9]=f=>a(l).state=f),label:"Province",placeholder:"Select Province",items:a(h),loading:a(j),clearable:""},null,8,["modelValue","items","loading"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a(l).city,"onUpdate:modelValue":s[10]||(s[10]=f=>a(l).city=f),label:"City",placeholder:"Select City",items:a(M),disabled:!a(l).state,clearable:""},null,8,["modelValue","items","disabled"])]),_:1}),e(g,{cols:"12",md:"12"},{default:t(()=>[e(V,{modelValue:a(l).address,"onUpdate:modelValue":s[11]||(s[11]=f=>a(l).address=f),label:"Address",placeholder:"Enter Full Address"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:t(()=>[e(T,{loading:a(b),disabled:a(u),onClick:de},{default:t(()=>s[15]||(s[15]=[x(" Save changes ")])),_:1,__:[15]},8,["loading","disabled"]),e(T,{color:"secondary",variant:"outlined",type:"reset",disabled:a(u)||a(b),onClick:oe(ne,["prevent"])},{default:t(()=>s[16]||(s[16]=[x(" Reset ")])),_:1,__:[16]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}}),Me={class:"text-body-1 text-high-emphasis"},Re=z({__name:"AccountSettingsNotification",setup(P){const i=y(!1),u=y(!1),b=y(""),v=y([{key:"new_user_registration",type:"New user registration",email:!0,browser:!0,app:!0},{key:"new_technical_request",type:"New technical request",email:!0,browser:!0,app:!0},{key:"technical_request_status_change",type:"Technical request status change",email:!0,browser:!1,app:!0},{key:"new_franchisor_application",type:"New franchisor application",email:!0,browser:!0,app:!1},{key:"payment_received",type:"Payment received",email:!0,browser:!1,app:!1},{key:"system_alerts",type:"System alerts",email:!0,browser:!0,app:!0}]),o=async()=>{var n;try{i.value=!0;const r=await F.getProfile();if(r.success&&((n=r.data.preferences)!=null&&n.notifications)){const c=r.data.preferences.notifications;v.value.forEach(h=>{const A=h.key;c[A]&&(h.email=c[A].email,h.browser=c[A].browser,h.app=c[A].app)})}}catch(r){console.error("Error loading notifications:",r)}finally{i.value=!1}},l=async()=>{try{u.value=!0,b.value="";const n={};v.value.forEach(r=>{const c=r.key;n[c]={email:r.email,browser:r.browser,app:r.app}}),await F.updateNotificationPreferences(n),b.value="Notification preferences saved successfully",setTimeout(()=>{b.value=""},3e3)}catch(n){console.error("Error saving notifications:",n)}finally{u.value=!1}};return se(()=>{o()}),(n,r)=>(w(),C($,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Z,{loading:a(i)},{default:t(()=>[e(we,null,{default:t(()=>[e(he,null,{default:t(()=>r[1]||(r[1]=[x("Notification Preferences")])),_:1,__:[1]}),r[2]||(r[2]=m("p",{class:"text-body-1 mb-0"},[x(" Choose how you want to receive notifications. We need permission from your browser to show notifications. "),m("span",{class:"text-primary cursor-pointer"},"Request Permission")],-1))]),_:1,__:[2]}),a(b)?(w(),C(D,{key:0},{default:t(()=>[e(O,{variant:"tonal",color:"success",closable:"","onClick:close":r[0]||(r[0]=c=>b.value="")},{default:t(()=>[x(U(a(b)),1)]),_:1})]),_:1})):q("",!0),e(D,{class:"px-0"},{default:t(()=>[e(K),e(Pe,{class:"text-no-wrap rounded"},{default:t(()=>[r[3]||(r[3]=m("thead",null,[m("tr",null,[m("th",{scope:"col"}," Type "),m("th",{scope:"col"}," EMAIL "),m("th",{scope:"col"}," BROWSER "),m("th",{scope:"col"}," APP ")])],-1)),m("tbody",null,[(w(!0),I(Q,null,X(a(v),c=>(w(),I("tr",{key:c.type},[m("td",Me,U(c.type),1),m("td",null,[e(Y,{modelValue:c.email,"onUpdate:modelValue":h=>c.email=h},null,8,["modelValue","onUpdate:modelValue"])]),m("td",null,[e(Y,{modelValue:c.browser,"onUpdate:modelValue":h=>c.browser=h},null,8,["modelValue","onUpdate:modelValue"])]),m("td",null,[e(Y,{modelValue:c.app,"onUpdate:modelValue":h=>c.app=h},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1,__:[3]})]),_:1}),e(K),e(D,null,{default:t(()=>[e(T,{loading:a(u),disabled:a(i),onClick:l},{default:t(()=>r[4]||(r[4]=[x(" Save Changes ")])),_:1,__:[4]},8,["loading","disabled"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}}),Be={class:"d-flex flex-column gap-y-2"},Le={class:"text-base"},Oe=z({__name:"AccountSettingsSecurity",setup(P){const i=y(!1),u=y(!1),b=y(!1),v=y(""),o=y(""),l=y(""),n=y(!1),r=y(""),c=y(""),h=["Minimum 8 characters long - the more, the better","At least one lowercase character","At least one uppercase character","At least one number, symbol, or whitespace character"],A=async()=>{var M,d;if(r.value="",c.value="",o.value!==l.value){r.value="New passwords do not match";return}if(o.value.length<8){r.value="Password must be at least 8 characters long";return}try{n.value=!0,await F.updatePassword({current_password:v.value,password:o.value,password_confirmation:l.value}),c.value="Password updated successfully",v.value="",o.value="",l.value=""}catch(k){(d=(M=k.response)==null?void 0:M.data)!=null&&d.message?r.value=k.response.data.message:r.value="Failed to update password. Please try again.",console.error("Error updating password:",k)}finally{n.value=!1}},j=()=>{v.value="",o.value="",l.value="",r.value="",c.value=""};return(M,d)=>{const k=le;return w(),C($,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Z,{title:"Change Password"},{default:t(()=>[e(D,null,{default:t(()=>[a(c)?(w(),C(O,{key:0,variant:"tonal",color:"success",class:"mb-6",closable:"","onClick:close":d[0]||(d[0]=_=>c.value="")},{default:t(()=>[x(U(a(c)),1)]),_:1})):q("",!0),a(r)?(w(),C(O,{key:1,variant:"tonal",color:"error",class:"mb-6",closable:"","onClick:close":d[1]||(d[1]=_=>r.value="")},{default:t(()=>[x(U(a(r)),1)]),_:1})):q("",!0),e(O,{variant:"tonal",color:"warning",class:"mb-6"},{default:t(()=>[e(xe,{class:"mb-1"},{default:t(()=>d[8]||(d[8]=[x(" Ensure that these requirements are met ")])),_:1,__:[8]}),d[9]||(d[9]=m("span",null,"Minimum 8 characters long, uppercase & symbol",-1))]),_:1,__:[9]}),e(re,{onSubmit:oe(A,["prevent"])},{default:t(()=>[e($,null,{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(k,{modelValue:a(v),"onUpdate:modelValue":d[2]||(d[2]=_=>L(v)?v.value=_:null),type:a(i)?"text":"password","append-inner-icon":a(i)?"tabler-eye-off":"tabler-eye",label:"Current Password",placeholder:"············","onClick:appendInner":d[3]||(d[3]=_=>i.value=!a(i))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),e($,null,{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(k,{modelValue:a(o),"onUpdate:modelValue":d[4]||(d[4]=_=>L(o)?o.value=_:null),type:a(u)?"text":"password","append-inner-icon":a(u)?"tabler-eye-off":"tabler-eye",label:"New Password",placeholder:"············","onClick:appendInner":d[5]||(d[5]=_=>u.value=!a(u))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(k,{modelValue:a(l),"onUpdate:modelValue":d[6]||(d[6]=_=>L(l)?l.value=_:null),type:a(b)?"text":"password","append-inner-icon":a(b)?"tabler-eye-off":"tabler-eye",label:"Confirm New Password",placeholder:"············","onClick:appendInner":d[7]||(d[7]=_=>b.value=!a(b))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[d[10]||(d[10]=m("h6",{class:"text-h6 text-medium-emphasis mb-4"}," Password Requirements: ",-1)),m("ul",Be,[(w(),I(Q,null,X(h,_=>m("li",{key:_,class:"d-flex align-center"},[m("div",null,[e(H,{size:"8",icon:"tabler-circle",class:"me-2"}),m("span",Le,U(_),1)])])),64))])]),_:1,__:[10]}),e(g,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:t(()=>[e(T,{type:"submit",loading:a(n)},{default:t(()=>d[11]||(d[11]=[x(" Save changes ")])),_:1,__:[11]},8,["loading"]),e(T,{type:"reset",color:"secondary",variant:"outlined",disabled:a(n),onClick:j},{default:t(()=>d[12]||(d[12]=[x(" Reset ")])),_:1,__:[12]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ba=z({__name:"[tab]",setup(P){const i=ye(),u=te({get:()=>i.params.tab,set:()=>i.params.tab}),b=[{title:"Account",icon:"tabler-user",tab:"account"},{title:"Security",icon:"tabler-lock",tab:"security"},{title:"Notifications",icon:"tabler-bell",tab:"notifications"}];return(v,o)=>(w(),I("div",null,[o[2]||(o[2]=m("div",{class:"mb-6"},[m("h2",{class:"text-h2 mb-1"}," Account Settings "),m("p",{class:"text-body-1 text-medium-emphasis"}," Manage your account preferences and settings ")],-1)),e(Ae,{modelValue:a(u),"onUpdate:modelValue":o[0]||(o[0]=l=>L(u)?u.value=l:null),class:"v-tabs-pill"},{default:t(()=>[(w(),I(Q,null,X(b,l=>e(ke,{key:l.icon,value:l.tab,to:{name:"pages-account-settings-tab",params:{tab:l.tab}}},{default:t(()=>[e(H,{size:"20",start:"",icon:l.icon},null,8,["icon"]),x(" "+U(l.title),1)]),_:2},1032,["value","to"])),64))]),_:1},8,["modelValue"]),e(Ce,{modelValue:a(u),"onUpdate:modelValue":o[1]||(o[1]=l=>L(u)?u.value=l:null),class:"mt-6 disable-tab-transition",touch:!1},{default:t(()=>[e(J,{value:"account"},{default:t(()=>[e(De)]),_:1}),e(J,{value:"security"},{default:t(()=>[e(Oe)]),_:1}),e(J,{value:"notifications"},{default:t(()=>[e(Re)]),_:1})]),_:1},8,["modelValue"])]))}});export{ba as default};
