import{L as ee,K as ie,a$ as Ne,M as oe,y as e,ax as Se,a7 as D,ag as Me,bD as Le,O as P,I as We,al as Ee,bJ as qe,av as B,bE as Oe,R as Z,ah as je,P as Ge,n as _e,S as Ye,bF as He,bb as Ke,bK as Je,bL as ke,az as Qe,bu as Xe,bG as Ze,bC as et,F as ce,d as Ve,g as w,w as me,a as k,o as g,k as t,l as o,h as pe,i as l,q as x,t as V,aI as J,e as tt,E as at,c as Q,br as le,r as we,b5 as Ue}from"./main-BPhS35rw.js";import{f as lt}from"./formatters--UtN2sCw.js";import{_ as st}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang--A2-xRD-.js";import{_ as nt}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DMxLwUYy.js";import{_ as it}from"./AppSelect.vue_vue_type_script_setup_true_lang-CE7wmRc8.js";import{_ as ot}from"./AppTextField.vue_vue_type_script_setup_true_lang-D9b5yA1O.js";import{r as K,e as dt}from"./validators-BHkKs9Dp.js";import{f as ne}from"./franchise-BPXueY0Z.js";import{u as rt,a as ut}from"./useSaudiProvinces-D7JrVjMi.js";import{c as ct,b as te,V as O,d as ve,f as N,h as xe,a as Ce}from"./VCard-BzA-_fsU.js";import{V as fe}from"./VAlert-CiCDJoow.js";import{V as ye,m as mt,a as de,b as pt}from"./VWindowItem-B3EKE9OE.js";import{V as Pe,m as vt}from"./VSheet-CFea6ca6.js";import{V as re}from"./VDivider-D5TM1l_v.js";import{V as De}from"./VForm-DfkEz1YK.js";import{V as X,a as S}from"./VRow-BBpj0UHg.js";import{V as Ae}from"./VSpacer-BZoddywn.js";import{V as ze,_ as ft}from"./VDialog-DKkWp4GN.js";import{V as Fe}from"./VSelect-CMXFgzzc.js";import{V as Ie,a as yt}from"./VTabs-BmRwQEIl.js";import{S as bt}from"./saudi-riyal-DymAW43Z.js";import{V as se}from"./VSkeletonLoader-hxQXft4v.js";import{V as ue}from"./VChip-D4pF-Hih.js";import{V as gt,a as _t}from"./VDataTable-CpPkgXjX.js";import{V as Re}from"./VTooltip-2YE7Xj5j.js";import"./VField-Cw0SCwyI.js";import"./form-DOPuC2wB.js";import"./forwardRefs-B931MWyl.js";import"./VInput-ChEAXyAR.js";import"./VTextarea-BMZlRSe-.js";import"./VTextField-DVYvDh-5.js";import"./api-router-DNaOhggD.js";import"./scopeId-CVHpW26W.js";import"./VList-BOGntWk4.js";/* empty css              */import"./VOverlay-DT_ig7Kx.js";import"./VMenu-BFWVwuN9.js";import"./VCheckboxBtn-C2M95TWh.js";import"./VSelectionControl-BCX0I6pt.js";import"./VSlideGroup-DN13h1yr.js";import"./VTable-CjdTM1xT.js";const he=Symbol.for("vuetify:v-stepper"),Te=ee({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),Vt=ie()({name:"VStepperActions",props:Te(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(n,I){let{emit:d,slots:c}=I;const{t:r}=Ne();function m(){d("click:prev")}function v(){d("click:next")}return oe(()=>{const i={onClick:m},f={onClick:v};return e("div",{class:"v-stepper-actions"},[e(Se,{defaults:{VBtn:{disabled:["prev",!0].includes(n.disabled),text:r(n.prevText),variant:"text"}}},{default:()=>{var b;return[((b=c.prev)==null?void 0:b.call(c,{props:i}))??e(D,i,null)]}}),e(Se,{defaults:{VBtn:{color:n.color,disabled:["next",!0].includes(n.disabled),text:r(n.nextText),variant:"tonal"}}},{default:()=>{var b;return[((b=c.next)==null?void 0:b.call(c,{props:f}))??e(D,f,null)]}})])}),{}}}),$e=ct("v-stepper-header"),xt=ee({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:Z,default:"$complete"},editable:Boolean,editIcon:{type:Z,default:"$edit"},error:Boolean,errorIcon:{type:Z,default:"$error"},icon:Z,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),ht=ee({...xt(),...Oe()},"VStepperItem"),be=ie()({name:"VStepperItem",directives:{Ripple:Me},props:ht(),emits:{"group:selected":n=>!0},setup(n,I){let{slots:d}=I;const c=Le(n,he,!0),r=P(()=>(c==null?void 0:c.value.value)??n.value),m=P(()=>n.rules.every(F=>F()===!0)),v=P(()=>!n.disabled&&n.editable),i=P(()=>!n.disabled&&n.editable),f=P(()=>n.error||!m.value),b=P(()=>n.complete||n.rules.length>0&&m.value),$=P(()=>f.value?n.errorIcon:b.value?n.completeIcon:c.isSelected.value&&n.editable?n.editIcon:n.icon),z=P(()=>({canEdit:i.value,hasError:f.value,hasCompleted:b.value,title:n.title,subtitle:n.subtitle,step:r.value,value:n.value}));return oe(()=>{var W,j,Y;const F=(!c||c.isSelected.value||b.value||i.value)&&!f.value&&!n.disabled,M=!!(n.title!=null||d.title),G=!!(n.subtitle!=null||d.subtitle);function L(){c==null||c.toggle()}return We(e("button",{class:["v-stepper-item",{"v-stepper-item--complete":b.value,"v-stepper-item--disabled":n.disabled,"v-stepper-item--error":f.value},c==null?void 0:c.selectedClass.value],disabled:!n.editable,type:"button",onClick:L},[v.value&&qe(!0,"v-stepper-item"),e(te,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:F?n.color:void 0,size:24},{default:()=>{var R;return[((R=d.icon)==null?void 0:R.call(d,z.value))??($.value?e(B,{icon:$.value},null):r.value)]}}),e("div",{class:"v-stepper-item__content"},[M&&e("div",{key:"title",class:"v-stepper-item__title"},[((W=d.title)==null?void 0:W.call(d,z.value))??n.title]),G&&e("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((j=d.subtitle)==null?void 0:j.call(d,z.value))??n.subtitle]),(Y=d.default)==null?void 0:Y.call(d,z.value)])]),[[Ee("ripple"),n.ripple&&n.editable,null]])}),{}}}),St=ee({...Ye(mt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),Be=ie()({name:"VStepperWindow",props:St(),emits:{"update:modelValue":n=>!0},setup(n,I){let{slots:d}=I;const c=je(he,null),r=Ge(n,"modelValue"),m=P({get(){var v;return r.value!=null||!c?r.value:(v=c.items.value.find(i=>c.selected.value.includes(i.id)))==null?void 0:v.value},set(v){r.value=v}});return oe(()=>{const v=ye.filterProps(n);return e(ye,_e({_as:"VStepperWindow"},v,{modelValue:m.value,"onUpdate:modelValue":i=>m.value=i,class:["v-stepper-window",n.class],style:n.style,mandatory:!1,touch:!1}),d)}),{}}}),kt=ee({...pt()},"VStepperWindowItem"),ge=ie()({name:"VStepperWindowItem",props:kt(),setup(n,I){let{slots:d}=I;return oe(()=>{const c=de.filterProps(n);return e(de,_e({_as:"VStepperWindowItem"},c,{class:["v-stepper-window-item",n.class],style:n.style}),d)}),{}}}),wt=ee({altLabels:Boolean,bgColor:String,completeIcon:Z,editIcon:Z,editable:Boolean,errorIcon:Z,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...et()},"Stepper"),Ut=ee({...wt(),...Ze({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...vt(),...Xe(Te(),["prevText","nextText"])},"VStepper"),Ct=ie()({name:"VStepper",props:Ut(),emits:{"update:modelValue":n=>!0},setup(n,I){let{slots:d}=I;const{items:c,next:r,prev:m,selected:v}=He(n,he),{displayClasses:i,mobile:f}=Ke(n),{completeIcon:b,editIcon:$,errorIcon:z,color:F,editable:M,prevText:G,nextText:L}=Je(n),W=P(()=>n.items.map((R,H)=>{const U=ke(R,n.itemTitle,R),u=ke(R,n.itemValue,H+1);return{title:U,value:u,raw:R}})),j=P(()=>c.value.findIndex(R=>v.value.includes(R.id))),Y=P(()=>n.disabled?n.disabled:j.value===0?"prev":j.value===c.value.length-1?"next":!1);return Qe({VStepperItem:{editable:M,errorIcon:z,completeIcon:b,editIcon:$,prevText:G,nextText:L},VStepperActions:{color:F,disabled:Y,prevText:G,nextText:L}}),oe(()=>{const R=Pe.filterProps(n),H=!!(d.header||n.items.length),U=n.items.length>0,u=!n.hideActions&&!!(U||d.actions);return e(Pe,_e(R,{color:n.bgColor,class:["v-stepper",{"v-stepper--alt-labels":n.altLabels,"v-stepper--flat":n.flat,"v-stepper--non-linear":n.nonLinear,"v-stepper--mobile":f.value},i.value,n.class],style:n.style}),{default:()=>{var A,T;return[H&&e($e,{key:"stepper-header"},{default:()=>[W.value.map((C,E)=>{let{raw:p,...h}=C;return e(ce,null,[!!E&&e(re,null,null),e(be,h,{default:d[`header-item.${h.value}`]??d.header,icon:d.icon,title:d.title,subtitle:d.subtitle})])})]}),U&&e(Be,{key:"stepper-window"},{default:()=>[W.value.map(C=>e(ge,{value:C.value},{default:()=>{var E,p;return((E=d[`item.${C.value}`])==null?void 0:E.call(d,C))??((p=d.item)==null?void 0:p.call(d,C))}}))]}),(A=d.default)==null?void 0:A.call(d,{prev:m,next:r}),u&&(((T=d.actions)==null?void 0:T.call(d,{next:r,prev:m}))??e(Vt,{key:"stepper-actions","onClick:prev":m,"onClick:next":r},d))]}})}),{prev:m,next:r}}}),Pt={class:"d-flex gap-3"},Dt=Ve({__name:"AddFranchiseeDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","franchiseeAdded"],setup(n,{emit:I}){const d=n,c=I,r=w(1),m=w(!1),v=w(null),i=w({name:"",email:"",phone:"",nationality:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}),{countries:f,isLoading:b}=rt(),{provinces:$,getCitiesForProvince:z,isLoading:F}=ut(),M=P(()=>z(i.value.state||""));me(()=>i.value.state,()=>{i.value.city=""});const G=[{title:"Store",value:"store"},{title:"Kiosk",value:"kiosk"},{title:"Mobile",value:"mobile"},{title:"Online",value:"online"},{title:"Warehouse",value:"warehouse"},{title:"Office",value:"office"}],L=()=>{r.value=1,v.value=null,i.value={name:"",email:"",phone:"",nationality:"",state:"",city:"",address:"",postalCode:"",type:"store",sizeSqft:"",capacity:"",openingDate:"",monthlyRent:""}},W=U=>{c("update:isDialogVisible",U)},j=()=>{r.value<2&&(r.value++,v.value=null)},Y=()=>{r.value>1&&(r.value--,v.value=null)};me(()=>d.isDialogVisible,U=>{U&&L()});const R=async()=>{var U,u,A,T;if(!i.value.name||!i.value.email||!i.value.phone){v.value="Please fill in all required fields";return}m.value=!0,v.value=null;try{const E=((u=(U=(await ne.getFranchises()).data)==null?void 0:U[0])==null?void 0:u.id)||null,p={name:i.value.name,email:i.value.email,phone:i.value.phone,unit_name:i.value.name,franchise_id:E,unit_type:i.value.type||"store",address:i.value.address,city:i.value.city,state_province:i.value.state,postal_code:i.value.postalCode,nationality:i.value.nationality,size_sqft:i.value.sizeSqft,monthly_rent:i.value.monthlyRent,opening_date:i.value.openingDate,status:"planning"},h=await ne.createFranchiseeWithUnit(p);if(h.success){const y={id:h.data.unit.id,name:h.data.unit.unit_name,email:h.data.franchisee.email,phone:h.data.franchisee.phone,type:h.data.unit.unit_type,sizeSqft:h.data.unit.size_sqft,capacity:null,openingDate:h.data.unit.opening_date,monthlyRent:h.data.unit.monthly_rent,managerId:h.data.unit.franchisee_id,managerName:h.data.franchisee.name,nationality:h.data.unit.nationality,state:h.data.unit.state_province,city:h.data.unit.city,address:h.data.unit.address,postalCode:h.data.unit.postal_code};c("franchiseeAdded",y),W(!1),L()}}catch(C){console.error("Error creating franchisee with unit:",C),v.value=((T=(A=C.response)==null?void 0:A.data)==null?void 0:T.message)||"Failed to create franchisee and unit. Please try again."}finally{m.value=!1}},H=U=>{c("update:isDialogVisible",U),U||L()};return(U,u)=>{const A=ot,T=it,C=nt,E=st;return g(),k(ze,{"model-value":d.isDialogVisible,"max-width":"800","onUpdate:modelValue":H},{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{class:"text-center"},{default:t(()=>u[15]||(u[15]=[o("span",{class:"text-h5"},"Add New Franchisee",-1)])),_:1,__:[15]}),e(N,null,{default:t(()=>[l(v)?(g(),k(fe,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":u[0]||(u[0]=p=>v.value=null)},{default:t(()=>[x(V(l(v)),1)]),_:1})):pe("",!0),e(Ct,{modelValue:l(r),"onUpdate:modelValue":u[13]||(u[13]=p=>J(r)?r.value=p:null),"alt-labels":""},{default:t(()=>[e($e,null,{default:t(()=>[e(be,{complete:l(r)>1,value:1,title:"Basic Info"},null,8,["complete"]),e(re),e(be,{value:2,title:"Unit Details"})]),_:1}),e(Be,null,{default:t(()=>[e(ge,{value:1},{default:t(()=>[e(De,null,{default:t(()=>[e(X,null,{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[e(A,{modelValue:l(i).name,"onUpdate:modelValue":u[1]||(u[1]=p=>l(i).name=p),label:"Branch Name",placeholder:"Enter Branch name",rules:[l(K)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:l(i).email,"onUpdate:modelValue":u[2]||(u[2]=p=>l(i).email=p),label:"Email Address",placeholder:"Enter email address",rules:[l(K),l(dt)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:l(i).phone,"onUpdate:modelValue":u[3]||(u[3]=p=>l(i).phone=p),label:"Contact Number",placeholder:"Enter contact number",rules:[l(K)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:l(i).nationality,"onUpdate:modelValue":u[4]||(u[4]=p=>l(i).nationality=p),items:l(f),loading:l(b),label:"Nationality",placeholder:"Select Nationality",rules:[l(K)],clearable:""},null,8,["modelValue","items","loading","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:l(i).state,"onUpdate:modelValue":u[5]||(u[5]=p=>l(i).state=p),label:"Province",placeholder:"Select Province",items:l($),loading:l(F),rules:[l(K)],clearable:""},null,8,["modelValue","items","loading","rules"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:l(i).city,"onUpdate:modelValue":u[6]||(u[6]=p=>l(i).city=p),label:"City",placeholder:"Select City",items:l(M),disabled:!l(i).state,rules:[l(K)],clearable:""},null,8,["modelValue","items","disabled","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(C,{modelValue:l(i).address,"onUpdate:modelValue":u[7]||(u[7]=p=>l(i).address=p),label:"Address",placeholder:"Enter full address",rules:[l(K)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12"},{default:t(()=>[e(fe,{type:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[o("strong",null,V(l(i).name||"New franchisee"),1),u[16]||(u[16]=x(" will be automatically assigned as the unit manager. "))]),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1}),e(ge,{value:2},{default:t(()=>[e(De,null,{default:t(()=>[e(X,null,{default:t(()=>[e(S,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:l(i).type,"onUpdate:modelValue":u[8]||(u[8]=p=>l(i).type=p),items:G,label:"Unit Type",placeholder:"Select unit type",rules:[l(K)]},null,8,["modelValue","rules"])]),_:1}),e(S,{cols:"12",md:"6"},{default:t(()=>[e(E,{modelValue:l(i).openingDate,"onUpdate:modelValue":u[9]||(u[9]=p=>l(i).openingDate=p),label:"Opening Date",placeholder:"Select opening date"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:l(i).sizeSqft,"onUpdate:modelValue":u[10]||(u[10]=p=>l(i).sizeSqft=p),label:"Size (sq ft)",placeholder:"Enter size in square feet",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:l(i).capacity,"onUpdate:modelValue":u[11]||(u[11]=p=>l(i).capacity=p),label:"Capacity",placeholder:"Enter capacity",type:"number"},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:l(i).monthlyRent,"onUpdate:modelValue":u[12]||(u[12]=p=>l(i).monthlyRent=p),label:"Monthly Rent",placeholder:"Enter monthly rent",type:"number",prefix:"SAR"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(xe,{class:"justify-space-between pa-6"},{default:t(()=>[l(r)>1?(g(),k(D,{key:0,variant:"outlined",disabled:l(m),onClick:Y},{default:t(()=>u[17]||(u[17]=[x(" Previous ")])),_:1,__:[17]},8,["disabled"])):(g(),k(Ae,{key:1})),o("div",Pt,[e(D,{variant:"outlined",disabled:l(m),onClick:u[14]||(u[14]=p=>W(!1))},{default:t(()=>u[18]||(u[18]=[x(" Cancel ")])),_:1,__:[18]},8,["disabled"]),l(r)<2?(g(),k(D,{key:0,color:"primary",disabled:l(m),onClick:j},{default:t(()=>u[19]||(u[19]=[x(" Next ")])),_:1,__:[19]},8,["disabled"])):(g(),k(D,{key:1,color:"primary",loading:l(m),disabled:l(m),onClick:R},{default:t(()=>u[20]||(u[20]=[x(" Create Unit ")])),_:1,__:[20]},8,["loading","disabled"]))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),It=Ve({__name:"ChangeStatusDialog",props:{isDialogVisible:{type:Boolean},unitId:{},currentStatus:{},statusOptions:{}},emits:["update:isDialogVisible","status-updated"],setup(n,{emit:I}){const d=n,c=I,r=w(d.currentStatus),m=w(!1);me(()=>d.currentStatus,f=>{r.value=f},{immediate:!0});const v=async()=>{if(!(!d.unitId||!r.value||r.value===d.currentStatus))try{m.value=!0,(await ne.updateUnitStatus(d.unitId,r.value)).success&&(c("status-updated",{unitId:d.unitId,newStatus:r.value}),c("update:isDialogVisible",!1))}catch(f){console.error("Failed to change unit status:",f)}finally{m.value=!1}},i=()=>{r.value=d.currentStatus,c("update:isDialogVisible",!1)};return(f,b)=>{const $=ft;return g(),k(ze,{"model-value":f.isDialogVisible,"max-width":"600","onUpdate:modelValue":b[1]||(b[1]=z=>c("update:isDialogVisible",z))},{default:t(()=>[e($,{onClick:i}),e(O,{title:"Change Unit Status"},{default:t(()=>[e(N,null,{default:t(()=>[e(Fe,{modelValue:l(r),"onUpdate:modelValue":b[0]||(b[0]=z=>J(r)?r.value=z:null),label:"Status",items:f.statusOptions,placeholder:"Select Status"},null,8,["modelValue","items"])]),_:1}),e(xe,null,{default:t(()=>[e(Ae),e(D,{color:"secondary",variant:"tonal",onClick:i},{default:t(()=>b[2]||(b[2]=[x(" Cancel ")])),_:1,__:[2]}),e(D,{color:"primary",disabled:!l(r)||l(r)===f.currentStatus,loading:l(m),onClick:v},{default:t(()=>b[3]||(b[3]=[x(" Update Status ")])),_:1,__:[3]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Rt={class:"d-flex align-center justify-space-between"},At={class:"ms-4"},zt={class:"text-h4"},Ft={key:1},Tt={class:"ms-4"},$t={class:"text-h4"},Bt={key:1},Nt={class:"ms-4"},Mt={class:"text-h4"},Lt={key:1},Wt={class:"ms-4"},Et={class:"text-h4"},qt={key:1},Ot={class:"text-center py-8"},jt={class:"d-flex align-center justify-space-between mb-3"},Gt={class:"text-h6"},Yt={class:"mb-2"},Ht={class:"text-body-1"},Kt={class:"mb-2"},Jt={class:"text-body-2"},Qt={class:"mb-3"},Xt={class:"text-body-1 font-weight-medium"},Zt={class:"text-center"},ea={class:"text-center"},ta={class:"d-flex align-center gap-x-3"},aa={class:"text-base font-weight-medium"},la={class:"text-body-2 text-disabled"},sa={class:"text-body-1 font-weight-medium"},na={class:"text-body-2 text-disabled"},ia={class:"text-body-1"},oa={class:"text-body-2 text-disabled"},da={class:"text-body-2 text-disabled"},ra={class:"text-body-2 text-disabled"},ua={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},ca={class:"text-sm text-disabled mb-0"},ma={class:"d-flex align-center",style:{"inline-size":"8rem"}},el=Ve({__name:"my-units",setup(n){const I=(y,a,_)=>{const q=(y-1)*a+1,s=Math.min(y*a,_);return`Showing ${q} to ${s} of ${_} entries`},d=tt(),c=w("overview"),r=w([]),m=w(!1),v=w(null),i=w(1),f=w(10);w(0);const b=w(!1),$=w(null),z=w(""),F=w({totalUnits:0,activeUnits:0,pendingUnits:0,inactiveUnits:0,totalRevenue:0,monthlyRoyalty:0,avgRevenuePerUnit:0,revenueChange:0,royaltyRate:8.5,taskStats:{total:0,completed:0,pending:0,completionRate:0}}),M=w(!1),G=P(()=>F.value.totalUnits||r.value.length),L=P(()=>F.value.activeUnits||r.value.filter(y=>y.status==="active").length),W=P(()=>F.value.pendingUnits||r.value.filter(y=>y.status==="pending").length),j=P(()=>F.value.monthlyRoyalty),Y=[{title:"Branch Info",key:"branchInfo"},{title:"Unit Manager (Franchisee)",key:"franchisee"},{title:"Location",key:"location"},{title:"Royalty %",key:"royaltyPercentage"},{title:"Contract Period",key:"contractPeriod"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],R=[{title:"Planning",value:"planning"},{title:"Construction",value:"construction"},{title:"Training",value:"training"},{title:"Active",value:"active"},{title:"Pending",value:"pending"},{title:"Temporarily Closed",value:"temporarily_closed"},{title:"Permanently Closed",value:"permanently_closed"}],H=y=>y==="active"?"success":y==="pending"?"warning":y==="inactive"?"error":"secondary",U=async()=>{var y;m.value=!0,v.value=null;try{const a=await ne.getUnits();a.success&&a.data.data?r.value=a.data.data.map(_=>{var q,s,ae;return{id:_.id,branchName:_.unit_name||"Unnamed Unit",franchiseeName:((q=_.franchisee)==null?void 0:q.name)||"Unassigned",email:((s=_.franchisee)==null?void 0:s.email)||_.email||"unassigned@example.com",contactNumber:((ae=_.franchisee)==null?void 0:ae.phone)||_.phone||"Not available",address:_.address||"Address not available",city:_.city||"Unknown",state:_.state_province||"Unknown",country:_.country||"Unknown",royaltyPercentage:8.5,contractStartDate:_.lease_start_date||"2024-01-01",renewalDate:_.lease_end_date||"2027-01-01",status:_.status||"inactive",totalTasks:0,completedTasks:0,totalStaff:_.employee_count||0,totalProducts:0,avgRating:0}}):r.value=[]}catch(a){console.error("Failed to load units data:",a),v.value=((y=a==null?void 0:a.data)==null?void 0:y.message)||"Failed to load units data",r.value=[]}finally{m.value=!1}},u=async()=>{var y,a,_,q;try{const s=await ne.getUnitsStatistics();s.success&&s.data&&(F.value={totalUnits:s.data.totalUnits||0,activeUnits:s.data.activeUnits||0,pendingUnits:s.data.pendingUnits||0,inactiveUnits:s.data.inactiveUnits||0,totalRevenue:s.data.totalRevenue||0,monthlyRoyalty:s.data.monthlyRoyalty||0,avgRevenuePerUnit:s.data.avgRevenuePerUnit||0,revenueChange:s.data.revenueChange||0,royaltyRate:s.data.royaltyRate||8.5,taskStats:{total:((y=s.data.taskStats)==null?void 0:y.total)||0,completed:((a=s.data.taskStats)==null?void 0:a.completed)||0,pending:((_=s.data.taskStats)==null?void 0:_.pending)||0,completionRate:((q=s.data.taskStats)==null?void 0:q.completionRate)||0}})}catch(s){console.error("Failed to load statistics data:",s)}},A=async()=>{await Promise.all([U(),u()])},T=y=>{d.push(`/franchisor/units/${y}`)},C=()=>{M.value=!0},E=y=>{A()};at(()=>{A()});const p=y=>{$.value=y,z.value=y.status,b.value=!0},h=y=>{const a=r.value.findIndex(_=>_.id===y.unitId);a!==-1&&(r.value[a].status=y.newStatus),u()};return(y,a)=>{var _,q;return g(),Q("section",null,[e(X,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",Rt,[a[11]||(a[11]=o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Units "),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage your franchise units and their franchisee managers ")],-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",loading:l(m),onClick:C},{default:t(()=>a[10]||(a[10]=[x(" Add Franchisee ")])),_:1,__:[10]},8,["loading"])])]),_:1})]),_:1}),l(v)?(g(),k(fe,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":a[0]||(a[0]=s=>v.value=null)},{default:t(()=>[x(V(l(v)),1)]),_:1})):pe("",!0),e(yt,{modelValue:l(c),"onUpdate:modelValue":a[1]||(a[1]=s=>J(c)?c.value=s:null),class:"mb-6"},{default:t(()=>[e(Ie,{value:"overview"},{default:t(()=>[e(B,{icon:"tabler-dashboard",start:""}),a[12]||(a[12]=x(" Overview "))]),_:1,__:[12]}),e(Ie,{value:"units"},{default:t(()=>[e(B,{icon:"tabler-building-store",start:""}),a[13]||(a[13]=x(" All Units "))]),_:1,__:[13]})]),_:1},8,["modelValue"]),e(ye,{modelValue:l(c),"onUpdate:modelValue":a[7]||(a[7]=s=>J(c)?c.value=s:null),class:"disable-tab-transition"},{default:t(()=>[e(de,{value:"overview"},{default:t(()=>[e(X,{class:"mb-6"},{default:t(()=>[e(S,{cols:"12",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(te,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-building-store",size:"26"})]),_:1}),o("div",At,[a[14]||(a[14]=o("div",{class:"text-body-2 text-disabled"}," Total Units ",-1)),o("h4",zt,[l(m)?(g(),k(le,{key:0,indeterminate:"",size:"20"})):(g(),Q("span",Ft,V(l(G)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(te,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-check",size:"26"})]),_:1}),o("div",Tt,[a[15]||(a[15]=o("div",{class:"text-body-2 text-disabled"}," Active Units ",-1)),o("h4",$t,[l(m)?(g(),k(le,{key:0,indeterminate:"",size:"20"})):(g(),Q("span",Bt,V(l(L)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(te,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",Nt,[a[16]||(a[16]=o("div",{class:"text-body-2 text-disabled"}," Pending Units ",-1)),o("h4",Mt,[l(m)?(g(),k(le,{key:0,indeterminate:"",size:"20"})):(g(),Q("span",Lt,V(l(W)),1))])])]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(N,{class:"d-flex align-center"},{default:t(()=>[e(te,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:t(()=>[e(l(bt),{size:"26"})]),_:1}),o("div",Wt,[a[17]||(a[17]=o("div",{class:"text-body-2 text-disabled"}," Monthly Royalty ",-1)),o("h4",Et,[l(m)?(g(),k(le,{key:0,indeterminate:"",size:"20"})):(g(),Q("span",qt,V(l(lt)(l(j))),1))])])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(Ce,{class:"pb-4"},{append:t(()=>[e(D,{variant:"text",color:"primary",onClick:a[2]||(a[2]=s=>c.value="units")},{default:t(()=>a[19]||(a[19]=[x(" View All ")])),_:1,__:[19]})]),default:t(()=>[e(ve,null,{default:t(()=>a[18]||(a[18]=[x("Recent Units")])),_:1,__:[18]})]),_:1}),e(N,null,{default:t(()=>[l(m)?(g(),k(X,{key:0},{default:t(()=>[(g(),Q(ce,null,we(3,s=>e(S,{key:s,cols:"12",md:"4"},{default:t(()=>[e(O,{variant:"outlined"},{default:t(()=>[e(N,null,{default:t(()=>[e(se,{type:"text",class:"mb-3"}),e(se,{type:"text",class:"mb-2"}),e(se,{type:"text",class:"mb-2"}),e(se,{type:"text",class:"mb-3"}),e(se,{type:"button"})]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})):l(r).length===0?(g(),k(X,{key:1},{default:t(()=>[e(S,{cols:"12"},{default:t(()=>[o("div",Ot,[e(B,{icon:"tabler-building-store",size:"48",class:"text-disabled mb-4"}),a[21]||(a[21]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[22]||(a[22]=o("p",{class:"text-body-1 text-medium-emphasis mb-4"},` You haven't added any franchise units yet. Click "Add Franchisee" to get started. `,-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",onClick:C},{default:t(()=>a[20]||(a[20]=[x(" Add Your First Unit ")])),_:1,__:[20]})])]),_:1})]),_:1})):(g(),k(X,{key:2},{default:t(()=>[(g(!0),Q(ce,null,we(l(r).slice(0,3),s=>(g(),k(S,{key:s.id,cols:"12",md:"4"},{default:t(()=>[e(O,{variant:"outlined"},{default:t(()=>[e(N,null,{default:t(()=>[o("div",jt,[o("h6",Gt,V(s.branchName),1),e(ue,{color:H(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(V(s.status),1)]),_:2},1032,["color"])]),o("div",Yt,[a[23]||(a[23]=o("div",{class:"text-body-2 text-disabled"}," Franchisee ",-1)),o("div",Ht,V(s.franchiseeName),1)]),o("div",Kt,[a[24]||(a[24]=o("div",{class:"text-body-2 text-disabled"}," Location ",-1)),o("div",Jt,V(s.city)+", "+V(s.state),1)]),o("div",Qt,[a[25]||(a[25]=o("div",{class:"text-body-2 text-disabled"}," Royalty ",-1)),o("div",Xt,V(s.royaltyPercentage)+"% ",1)])]),_:2},1024),e(xe,null,{default:t(()=>[e(D,{variant:"text",color:"primary",onClick:ae=>T(s.id)},{default:t(()=>a[26]||(a[26]=[x(" View Details ")])),_:2,__:[26]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(de,{value:"units"},{default:t(()=>[e(O,null,{default:t(()=>[e(Ce,{class:"pb-4"},{append:t(()=>[e(D,{color:"primary","prepend-icon":"tabler-plus",loading:l(m),onClick:C},{default:t(()=>a[28]||(a[28]=[x(" Add Franchisee ")])),_:1,__:[28]},8,["loading"])]),default:t(()=>[e(ve,null,{default:t(()=>a[27]||(a[27]=[x("All Franchise Units")])),_:1,__:[27]})]),_:1}),e(re),l(m)?(g(),k(N,{key:0,class:"py-8"},{default:t(()=>[o("div",Zt,[e(le,{indeterminate:"",size:"48",class:"mb-4"}),a[29]||(a[29]=o("h4",{class:"text-h4 mb-2"}," Loading Units... ",-1)),a[30]||(a[30]=o("p",{class:"text-body-1 text-medium-emphasis"}," Please wait while we fetch your franchise units. ",-1))])]),_:1})):l(r).length===0?(g(),k(N,{key:1,class:"py-8"},{default:t(()=>[o("div",ea,[e(B,{icon:"tabler-building-store",size:"64",class:"text-disabled mb-4"}),a[32]||(a[32]=o("h4",{class:"text-h4 mb-2"}," No Units Found ",-1)),a[33]||(a[33]=o("p",{class:"text-body-1 text-medium-emphasis mb-6"}," You haven't added any franchise units yet. Start by adding your first franchisee and their unit. ",-1)),e(D,{color:"primary","prepend-icon":"tabler-plus",size:"large",onClick:C},{default:t(()=>a[31]||(a[31]=[x(" Add Your First Franchisee & Unit ")])),_:1,__:[31]})])]),_:1})):(g(),k(gt,{key:2,items:l(r),headers:Y,class:"text-no-wrap","item-value":"id","items-per-page":l(f),page:l(i),"onUpdate:itemsPerPage":a[5]||(a[5]=s=>f.value=s),"onUpdate:page":a[6]||(a[6]=s=>i.value=s)},{"item.branchInfo":t(({item:s})=>[o("div",ta,[e(te,{size:"34",color:"primary",variant:"tonal"},{default:t(()=>[e(B,{icon:"tabler-building-store",size:"20"})]),_:1}),o("div",null,[o("h6",aa,V(s.branchName),1),o("div",la,V(s.email),1)])])]),"item.franchisee":t(({item:s})=>[o("div",null,[o("div",sa,V(s.franchiseeName),1),o("div",na,[e(B,{icon:"tabler-user-check",size:"14",class:"me-1"}),x(" Unit Manager • "+V(s.contactNumber),1)])])]),"item.location":t(({item:s})=>[o("div",null,[o("div",ia,V(s.city)+", "+V(s.state),1),o("div",oa,V(s.country),1)])]),"item.royaltyPercentage":t(({item:s})=>[s.royaltyPercentage>0?(g(),k(ue,{key:0,color:"primary",size:"small",class:"mt-1"},{default:t(()=>[x(V(s.royaltyPercentage)+"% Royalty ",1)]),_:2},1024)):pe("",!0)]),"item.contractPeriod":t(({item:s})=>[o("div",null,[o("div",da," Start: "+V(s.contractStartDate),1),o("div",ra," Renewal: "+V(s.renewalDate),1)])]),"item.status":t(({item:s})=>[e(ue,{color:H(s.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[x(V(s.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:s})=>[e(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:Ue(ae=>T(s.id),["stop"])},{default:t(()=>[e(B,{icon:"tabler-eye"}),e(Re,{activator:"parent"},{default:t(()=>a[34]||(a[34]=[x(" View Unit Details ")])),_:1,__:[34]})]),_:2},1032,["onClick"]),e(D,{icon:"",variant:"text",color:"medium-emphasis",size:"small",onClick:Ue(ae=>p(s),["stop"])},{default:t(()=>[e(B,{icon:"tabler-edit"}),e(Re,{activator:"parent"},{default:t(()=>a[35]||(a[35]=[x(" Change Status ")])),_:1,__:[35]})]),_:2},1032,["onClick"])]),bottom:t(()=>[e(re),o("div",ua,[o("p",ca,V(I(l(i),l(f),l(r).length)),1),e(_t,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=s=>J(i)?i.value=s:null),length:Math.ceil(l(r).length/l(f)),"total-visible":y.$vuetify.display.xs?1:Math.min(Math.ceil(l(r).length/l(f)),5)},null,8,["modelValue","length","total-visible"]),o("div",ma,[a[36]||(a[36]=o("span",{class:"text-no-wrap me-3"},"Rows per page:",-1)),e(Fe,{modelValue:l(f),"onUpdate:modelValue":a[4]||(a[4]=s=>J(f)?f.value=s:null),density:"compact",variant:"outlined",items:[5,10,25,50,100]},null,8,["modelValue"])])])]),_:1},8,["items","items-per-page","page"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Dt,{"is-dialog-visible":l(M),"onUpdate:isDialogVisible":a[8]||(a[8]=s=>J(M)?M.value=s:null),onFranchiseeAdded:E},null,8,["is-dialog-visible"]),e(It,{"is-dialog-visible":l(b),"onUpdate:isDialogVisible":a[9]||(a[9]=s=>J(b)?b.value=s:null),"unit-id":((_=l($))==null?void 0:_.id)||null,"current-status":((q=l($))==null?void 0:q.status)||"","status-options":R,onStatusUpdated:h},null,8,["is-dialog-visible","unit-id","current-status"])])}}});export{el as default};
