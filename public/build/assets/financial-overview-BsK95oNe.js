import{m as He}from"./vue3-apexcharts-BkNTKjv_.js";import{V as Qe,_ as Ge}from"./VDataTableServer-CKmfsbUj.js";import{_ as We}from"./AppTextField.vue_vue_type_script_setup_true_lang-DQMalJbq.js";import{_ as Xe}from"./AppSelect.vue_vue_type_script_setup_true_lang-D4JkpZOU.js";import{a_ as k,d as j,O as E,a as N,o as T,k as t,y as e,h as L,q as f,t as p,l as a,av as C,i as b,a7 as B,g as u,c as xe,aB as Ye,w as ce,E as Je,b8 as Ke}from"./main-DTJHMfaq.js";import{g as Ze}from"./api-router-zf5lUZNn.js";import{f as g}from"./formatters--UtN2sCw.js";import{_ as K}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CarmOyZu.js";import{V as $,f as P,g as Z,b as ve}from"./VCard-BEgq0Zx7.js";import{V as q}from"./VChip-DCBBAlzy.js";import{V as I}from"./VDivider-zvRfNiVO.js";import{V as J,a as _}from"./VRow-vWSGPnzR.js";import{V as et}from"./VTable-v4njjhfr.js";import{V as H}from"./VSpacer-C41_h5hf.js";import{V as ee}from"./VDialog-DAi3BTyw.js";import{S as Ce}from"./saudi-riyal-D7scO9iM.js";import{V as ge}from"./VSelect-DcsiMjZB.js";import{V as O}from"./VTextField-DW79TKGE.js";import{V as tt}from"./VFileInput-uStUNFcH.js";import{a as fe,V as at}from"./VTabs-Bayg_NbT.js";import{V as ye}from"./VTooltip-Di4IVwgn.js";import{V as lt}from"./VDataTable-g1AsGRIG.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VPagination-DOW_yVym.js";import"./form-BTCRKuvE.js";import"./VSlideGroup-D88xb4kb.js";/* empty css              */import"./VOverlay-Cl5-0R4l.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-Do09yNC1.js";import"./VMenu-AaevCT9J.js";import"./VList-Ep_DohB9.js";import"./VCheckboxBtn-g4un3INl.js";import"./VSelectionControl-C7u8c___.js";import"./VField-BTPv3jI0.js";import"./VInput-DnyuMNdn.js";import"./VWindowItem-CGc5GUTV.js";class st{getBaseUrl(){return Ze("financial")}async getCharts(m){return await k(`${this.getBaseUrl()}/charts`,{params:m})}async getStatistics(m){return await k(`${this.getBaseUrl()}/statistics`,{params:m})}async getSales(m){return await k(`${this.getBaseUrl()}/sales`,{params:m})}async createSale(m){return await k(`${this.getBaseUrl()}/sales`,{method:"POST",body:m})}async updateSale(m,n){return await k(`${this.getBaseUrl()}/sales/${m}`,{method:"PUT",body:n})}async deleteSale(m){await k(`${this.getBaseUrl()}/sales/${m}`,{method:"DELETE"})}async getExpenses(m){return await k(`${this.getBaseUrl()}/expenses`,{params:m})}async createExpense(m){return await k(`${this.getBaseUrl()}/expenses`,{method:"POST",body:m})}async updateExpense(m,n){return await k(`${this.getBaseUrl()}/expenses/${m}`,{method:"PUT",body:n})}async deleteExpense(m){await k(`${this.getBaseUrl()}/expenses/${m}`,{method:"DELETE"})}async getProfit(m){return await k(`${this.getBaseUrl()}/profit`,{params:m})}async getUnitPerformance(m){return await k(`${this.getBaseUrl()}/unit-performance`,{params:m})}async importData(m,n){const y=new FormData;y.append("file",m),y.append("category",n),await k(`${this.getBaseUrl()}/import`,{method:"POST",body:y})}async exportData(m,n){return await k(`${this.getBaseUrl()}/export`,{params:{...n,category:m},parseResponse:y=>y})}}const R=new st,ot={class:"text-h6 mb-4 text-primary"},it={class:"mb-4"},nt={class:"font-weight-medium text-h6"},rt={class:"mb-4"},dt={class:"font-weight-medium"},ut={class:"text-h6 mb-4 text-primary"},mt={class:"text-center"},pt={class:"text-h6 font-weight-bold"},ct={class:"text-center"},vt={class:"text-h6 font-weight-bold"},ft={class:"text-center"},yt={class:"text-h6 font-weight-bold"},bt={class:"text-h6 mb-4 text-primary"},xt={class:"text-end"},gt={class:"text-end"},_t={class:"bg-success-lighten-5"},Vt={class:"text-end font-weight-bold text-success"},ht=j({__name:"ViewSaleDetailsDialog",props:{isDialogVisible:{type:Boolean},saleData:{}},emits:["update:isDialogVisible"],setup(z,{emit:m}){const n=z,y=m,x=E({get:()=>n.isDialogVisible,set:i=>y("update:isDialogVisible",i)}),w=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(i,l)=>{const V=K;return T(),N(ee,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=r=>x.value=r),"max-width":"600"},{default:t(()=>[e(V,{onClick:l[0]||(l[0]=r=>x.value=!1)}),n.saleData?(T(),N($,{key:0,title:"Sale Details"},{default:t(()=>[e(P,null,{default:t(()=>[e(q,{color:"success",size:"small",variant:"tonal"},{default:t(()=>[f(p(n.saleData.referenceNumber||`REV-${String(n.saleData.id).padStart(6,"0")}`),1)]),_:1})]),_:1}),e(I,{class:"mb-4"}),e(P,null,{default:t(()=>[e(J,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[a("h6",ot,[e(C,{icon:"tabler-shopping-cart",class:"me-2"}),l[3]||(l[3]=f(" Product Information "))])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[a("div",it,[l[4]||(l[4]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Product Name ",-1)),a("div",nt,p(n.saleData.product),1)])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[a("div",rt,[l[5]||(l[5]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Sale Date ",-1)),a("div",dt,p(w(n.saleData.date)),1)])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(I,{class:"my-4"}),a("h6",ut,[e(C,{icon:"tabler-report-money",class:"me-2"}),l[6]||(l[6]=f(" Financial Details "))])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($,{variant:"tonal",color:"info",class:"pa-4"},{default:t(()=>[a("div",mt,[e(C,{icon:"tabler-tag",size:"32",class:"mb-2"}),l[7]||(l[7]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Unit Price ",-1)),a("div",pt,p(b(g)(n.saleData.unitPrice)),1)])]),_:1})]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($,{variant:"tonal",color:"warning",class:"pa-4"},{default:t(()=>[a("div",ct,[e(C,{icon:"tabler-stack",size:"32",class:"mb-2"}),l[8]||(l[8]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Quantity ",-1)),a("div",vt,p(n.saleData.quantity),1)])]),_:1})]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($,{variant:"tonal",color:"success",class:"pa-4"},{default:t(()=>[a("div",ft,[e(C,{icon:"tabler-coins",size:"32",class:"mb-2"}),l[9]||(l[9]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Total Sale ",-1)),a("div",yt,p(b(g)(n.saleData.sale)),1)])]),_:1})]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(I,{class:"my-4"}),a("h6",bt,[e(C,{icon:"tabler-calculator",class:"me-2"}),l[10]||(l[10]=f(" Calculation "))])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(et,{density:"compact"},{default:t(()=>[a("tbody",null,[a("tr",null,[l[11]||(l[11]=a("td",{class:"font-weight-medium"}," Unit Price: ",-1)),a("td",xt,p(b(g)(n.saleData.unitPrice)),1)]),a("tr",null,[l[12]||(l[12]=a("td",{class:"font-weight-medium"}," Quantity: ",-1)),a("td",gt," Ã— "+p(n.saleData.quantity),1)]),a("tr",_t,[l[13]||(l[13]=a("td",{class:"font-weight-bold text-success"}," Total Amount: ",-1)),a("td",Vt,p(b(g)(n.saleData.sale)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,null,{default:t(()=>[e(H),e(B,{color:"secondary",variant:"tonal",onClick:l[1]||(l[1]=r=>x.value=!1)},{default:t(()=>l[14]||(l[14]=[f(" Close ")])),_:1,__:[14]})]),_:1})]),_:1})):L("",!0)]),_:1},8,["modelValue"])}}}),Dt={class:"text-h6 mb-4 text-primary"},wt={class:"mb-4"},St={class:"mb-4"},kt={class:"font-weight-medium"},Ct={class:"mb-4"},$t={class:"font-weight-medium"},Ut={class:"mb-4"},Et={class:"font-weight-medium"},Pt={class:"text-h6 mb-4 text-primary"},At={class:"text-center"},Rt={class:"text-h4 font-weight-bold"},Bt=j({__name:"ViewExpenseDetailsDialog",props:{isDialogVisible:{type:Boolean},expenseData:{}},emits:["update:isDialogVisible"],setup(z,{emit:m}){const n=z,y=m,x=E({get:()=>n.isDialogVisible,set:i=>y("update:isDialogVisible",i)}),w=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(i,l)=>{const V=K;return T(),N(ee,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=r=>x.value=r),"max-width":"600"},{default:t(()=>[e(V,{onClick:l[0]||(l[0]=r=>x.value=!1)}),n.expenseData?(T(),N($,{key:0,title:"Expense Details"},{default:t(()=>[e(P,null,{default:t(()=>[e(q,{color:"error",size:"small",variant:"tonal"},{default:t(()=>[f(p(n.expenseData.referenceNumber||`EXP-${String(n.expenseData.id).padStart(6,"0")}`),1)]),_:1})]),_:1}),e(I,{class:"mb-4"}),e(P,null,{default:t(()=>[e(J,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[a("h6",Dt,[e(C,{icon:"tabler-receipt",class:"me-2"}),l[3]||(l[3]=f(" Expense Information "))])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[a("div",wt,[l[4]||(l[4]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Category ",-1)),e(q,{color:"error",size:"small",variant:"tonal",class:"text-capitalize"},{default:t(()=>[f(p(n.expenseData.expenseCategory),1)]),_:1})])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[a("div",St,[l[5]||(l[5]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Expense Date ",-1)),a("div",kt,p(w(n.expenseData.date)),1)])]),_:1}),n.expenseData.vendorName?(T(),N(_,{key:0,cols:"12"},{default:t(()=>[a("div",Ct,[l[6]||(l[6]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Vendor ",-1)),a("div",$t,p(n.expenseData.vendorName),1)])]),_:1})):L("",!0),e(_,{cols:"12"},{default:t(()=>[a("div",Ut,[l[7]||(l[7]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Description ",-1)),a("div",Et,p(n.expenseData.description||"No description provided"),1)])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(I,{class:"my-4"}),a("h6",Pt,[e(C,{icon:"tabler-report-money",class:"me-2"}),l[8]||(l[8]=f(" Amount "))])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e($,{variant:"tonal",color:"error",class:"pa-6"},{default:t(()=>[a("div",At,[e(C,{icon:b(Ce),size:"48",class:"mb-3"},null,8,["icon"]),l[9]||(l[9]=a("div",{class:"text-body-1 text-medium-emphasis mb-2"}," Expense Amount ",-1)),a("div",Rt,p(b(g)(n.expenseData.amount)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,null,{default:t(()=>[e(H),e(B,{color:"secondary",variant:"tonal",onClick:l[1]||(l[1]=r=>x.value=!1)},{default:t(()=>l[10]||(l[10]=[f(" Close ")])),_:1,__:[10]})]),_:1})]),_:1})):L("",!0)]),_:1},8,["modelValue"])}}}),Tt={key:0},zt={key:1},Ot=j({__name:"AddDataDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","dataAdded"],setup(z,{emit:m}){const n=z,y=m,x=u(!1),w=u("sales"),i=u({product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""}),l=E({get:()=>n.isDialogVisible,set:U=>y("update:isDialogVisible",U)}),V=async()=>{x.value=!0;try{w.value==="sales"?await R.createSale({product:i.value.product,unit_price:i.value.unitPrice,quantity:i.value.quantitySold,date:i.value.dateOfSale,customer_name:"Walk-in Customer",customer_email:"customer@example.com",franchise_id:1,unit_id:1}):await R.createExpense({expense_category:i.value.expenseCategory,amount:i.value.amount,description:i.value.description,date:i.value.dateOfExpense}),i.value={product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""},w.value="sales",y("dataAdded"),l.value=!1}catch(U){console.error("Error adding data:",U)}finally{x.value=!1}},r=()=>{l.value=!1};return(U,d)=>{const F=K;return T(),N(ee,{modelValue:l.value,"onUpdate:modelValue":d[9]||(d[9]=v=>l.value=v),"max-width":"600"},{default:t(()=>[e(F,{onClick:r}),e($,{title:"Add New Data"},{default:t(()=>[e(P,null,{default:t(()=>[e(ge,{modelValue:w.value,"onUpdate:modelValue":d[0]||(d[0]=v=>w.value=v),items:[{title:"Sales",value:"sales"},{title:"Expense",value:"expense"}],label:"Category",class:"mb-4"},null,8,["modelValue"]),w.value==="sales"?(T(),xe("div",Tt,[e(O,{modelValue:i.value.product,"onUpdate:modelValue":d[1]||(d[1]=v=>i.value.product=v),label:"Product",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.dateOfSale,"onUpdate:modelValue":d[2]||(d[2]=v=>i.value.dateOfSale=v),label:"Date of Sale",type:"date",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.unitPrice,"onUpdate:modelValue":d[3]||(d[3]=v=>i.value.unitPrice=v),label:"Unit Price",type:"number",prefix:"SAR",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.quantitySold,"onUpdate:modelValue":d[4]||(d[4]=v=>i.value.quantitySold=v),label:"Quantity Sold",type:"number",class:"mb-4"},null,8,["modelValue"])])):L("",!0),w.value==="expense"?(T(),xe("div",zt,[e(O,{modelValue:i.value.expenseCategory,"onUpdate:modelValue":d[5]||(d[5]=v=>i.value.expenseCategory=v),label:"Expense Category",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.dateOfExpense,"onUpdate:modelValue":d[6]||(d[6]=v=>i.value.dateOfExpense=v),label:"Date of Expense",type:"date",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.amount,"onUpdate:modelValue":d[7]||(d[7]=v=>i.value.amount=v),label:"Amount",type:"number",prefix:"SAR",class:"mb-4"},null,8,["modelValue"]),e(O,{modelValue:i.value.description,"onUpdate:modelValue":d[8]||(d[8]=v=>i.value.description=v),label:"Description",class:"mb-4"},null,8,["modelValue"])])):L("",!0)]),_:1}),e(Z,null,{default:t(()=>[e(H),e(B,{variant:"outlined",onClick:r},{default:t(()=>d[10]||(d[10]=[f(" Cancel ")])),_:1,__:[10]}),e(B,{color:"primary",loading:x.value,onClick:V},{default:t(()=>d[11]||(d[11]=[f(" Add Data ")])),_:1,__:[11]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Ft=j({__name:"ImportFinancialDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","dataImported"],setup(z,{emit:m}){const n=z,y=m,x=u(!1),w=u("sales"),i=u(null),l=E({get:()=>n.isDialogVisible,set:U=>y("update:isDialogVisible",U)}),V=async()=>{if(i.value){x.value=!0;try{await R.importData(i.value,w.value),i.value=null,w.value="sales",y("dataImported"),l.value=!1}catch(U){console.error("Error importing data:",U)}finally{x.value=!1}}},r=()=>{l.value=!1};return(U,d)=>{const F=K;return T(),N(ee,{modelValue:l.value,"onUpdate:modelValue":d[2]||(d[2]=v=>l.value=v),"max-width":"600"},{default:t(()=>[e(F,{onClick:r}),e($,{title:"Import Data"},{default:t(()=>[e(P,null,{default:t(()=>[e(ge,{modelValue:w.value,"onUpdate:modelValue":d[0]||(d[0]=v=>w.value=v),items:[{value:"sales",title:"Sales"},{value:"expenses",title:"Expense"}],label:"Category",variant:"outlined",class:"mb-4"},null,8,["modelValue"]),e(tt,{modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=v=>i.value=v),label:"Choose file",accept:".csv,.xlsx",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(Z,null,{default:t(()=>[e(H),e(B,{variant:"outlined",onClick:r},{default:t(()=>d[3]||(d[3]=[f(" Cancel ")])),_:1,__:[3]}),e(B,{color:"primary",loading:x.value,disabled:!i.value,onClick:V},{default:t(()=>d[4]||(d[4]=[f(" Import ")])),_:1,__:[4]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Nt={class:"me-3 d-flex gap-3 align-center"},It={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Mt={style:{"inline-size":"15.625rem"}},Lt={class:"font-weight-medium"},qt={class:"text-success font-weight-medium"},jt={class:"text-error font-weight-medium"},Ht={class:"font-weight-medium"},Qt={class:"text-error"},Gt={class:"text-success font-weight-medium"},Wt={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Xt={class:"d-flex gap-3 align-center flex-wrap"},Yt={class:"d-flex align-center justify-space-between"},Jt={class:"text-body-2 text-medium-emphasis mb-3"},Kt={class:"text-h4 text-success"},Zt={class:"d-flex align-center justify-space-between"},ea={class:"text-body-2 text-medium-emphasis mb-3"},ta={class:"text-h4 text-error"},aa={class:"d-flex align-center justify-space-between"},la={class:"text-body-2 text-medium-emphasis mb-3"},sa={class:"text-h4 text-primary"},oa={class:"text-body-1 text-high-emphasis"},ia={class:"text-body-1 text-high-emphasis"},na={class:"text-body-1 text-high-emphasis"},ra={class:"text-body-1 text-high-emphasis"},da={class:"text-body-1 text-high-emphasis"},be="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",ua="rgba(var(--v-border-color), var(--v-border-opacity))",Wa=j({__name:"financial-overview",setup(z){const m=Ye(),n=u(10),y=u(1),x=u(),w=u(),i=async c=>{var s,h;x.value=(s=c.sortBy[0])==null?void 0:s.key,w.value=(h=c.sortBy[0])==null?void 0:h.order,await me()},l=u("monthly"),V=u("all"),r=u("sales"),U=u([]),d=u([]),F=u([]);E(()=>r.value==="sales"?U.value:r.value==="expense"?d.value:r.value==="profit"?F.value:[]);const v=u(!1),te=u(!1),_e=u(!1),ae=u(!1),le=u(!1),se=u(!1),oe=u(!1),Ve=u(null),he=u(null),ie=u({categories:[],series:[]}),Q=u({totalSales:0,totalExpenses:0,totalProfit:0,totalRoyalties:0,salesGrowth:0,profitMargin:0}),ne=u([]),re=u([]),de=u([]),ue=u([]),G=u(0),W=u(""),De=E(()=>{switch(r.value){case"sales":return U.value;case"expense":return d.value;case"profit":return F.value;default:return[]}}),X={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},$e=E(()=>(m.current.value.colors,{chart:{type:"line",height:400,toolbar:{show:!1},zoom:{enabled:!1},parentHeightOffset:0},stroke:{curve:"smooth",width:3},xaxis:{categories:ie.value.categories,labels:{style:{colors:be,fontSize:"13px"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:be,fontSize:"13px"},formatter:c=>`${(c/1e3).toFixed(0)}k SAR`}},legend:{show:!0,position:"top",horizontalAlign:"left",labels:{colors:be}},colors:[X.success,X.error,X.warning,X.primary],grid:{borderColor:ua,strokeDashArray:5,padding:{top:-20,bottom:-10,left:0,right:0}},tooltip:{theme:m.current.value.dark?"dark":"light",y:{formatter:c=>g(c)}}})),Ue=E(()=>Q.value.totalSales),Ee=E(()=>Q.value.totalExpenses),Pe=E(()=>Q.value.totalProfit),Ae=[{title:"Daily",value:"daily"},{title:"Monthly",value:"monthly"},{title:"Yearly",value:"yearly"}],Re=[{title:"Franchisee Name",key:"name",sortable:!0},{title:"Location",key:"location",sortable:!0},{title:"Sales (SAR)",key:"sales",sortable:!0},{title:"Expenses (SAR)",key:"expenses",sortable:!0},{title:"Royalties (SAR)",key:"royalties",sortable:!0},{title:"Net Sales (SAR)",key:"netSales",sortable:!0},{title:"Profit (SAR)",key:"profit",sortable:!0},{title:"Profit Margin (%)",key:"profitMargin",sortable:!0}],Be=[{title:"Product",key:"product",sortable:!0},{title:"Date of Sale",key:"date",sortable:!0},{title:"Unit Price (SAR)",key:"unitPrice",sortable:!0},{title:"Quantity Sold",key:"quantity",sortable:!0},{title:"Sale (SAR)",key:"sale",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],Te=[{title:"Expense Category",key:"expenseCategory",sortable:!0},{title:"Date of Expense",key:"date",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Description",key:"description",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],ze=[{title:"Date",key:"date",sortable:!0},{title:"Total Sales (SAR)",key:"totalSales",sortable:!0},{title:"Total Expenses (SAR)",key:"totalExpenses",sortable:!0},{title:"Profit (SAR)",key:"profit",sortable:!0}],Oe=E(()=>{switch(r.value){case"sales":return ne.value;case"expense":return re.value;case"profit":return de.value;default:return[]}}),Fe=E(()=>{switch(r.value){case"sales":return Be;case"expense":return Te;case"profit":return ze;default:return[]}}),we=E(()=>G.value),Se=u(!1),ke=u(!1);u("sales"),u("sales"),u(null),u({product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""});const Ne=async()=>{te.value=!0;try{const c={period:l.value,unit:V.value==="all"?void 0:V.value},s=await R.getCharts(c);ie.value=s.data||{categories:[],series:[]}}catch(c){console.error("Error loading chart data:",c)}finally{te.value=!1}},Ie=async()=>{_e.value=!0;try{const c={period:l.value,unit:V.value==="all"?void 0:V.value},s=await R.getStatistics(c);Q.value=s.data||{totalSales:0,totalExpenses:0,totalProfit:0,totalRoyalties:0,salesGrowth:0,profitMargin:0}}catch(c){console.error("Error loading statistics:",c)}finally{_e.value=!1}},M=async()=>{var c,s,h,D,S,Y;ae.value=!0;try{const o={search:W.value||void 0,page:y.value,per_page:n.value,sortBy:x.value,sortOrder:w.value,period:l.value,unit_id:V.value==="all"?void 0:V.value};switch(r.value){case"sales":{const A=await R.getSales(o);ne.value=((c=A.data)==null?void 0:c.data)||[],G.value=((s=A.data)==null?void 0:s.total)||0;break}case"expense":{const A=await R.getExpenses(o);re.value=((h=A.data)==null?void 0:h.data)||[],G.value=((D=A.data)==null?void 0:D.total)||0;break}case"profit":{const A=await R.getProfit(o);de.value=((S=A.data)==null?void 0:S.data)||[],G.value=((Y=A.data)==null?void 0:Y.total)||0;break}}}catch(o){console.error("Error loading table data:",o)}finally{ae.value=!1}},Me=async()=>{var c;le.value=!0;try{const s={period:l.value,unit:V.value==="all"?void 0:V.value},D=((c=(await R.getUnitPerformance(s)).data)==null?void 0:c.data)||[];Array.isArray(D)?ue.value=D.map(S=>({id:S.id,name:S.name,location:S.location,sales:S.sales||0,expenses:S.expenses||0,royalties:S.royalties||0,netSales:(S.sales||0)-(S.royalties||0),profit:S.profit||0,profitMargin:S.profitMargin||0})):ue.value=[]}catch(s){console.error("Error loading units data:",s)}finally{le.value=!1}},me=async()=>{v.value=!0;try{await Promise.all([Ne(),Ie(),M(),Me()])}finally{v.value=!1}},Le=async()=>{try{const c={period:l.value,unit:V.value==="all"?void 0:V.value},s=await R.exportData(r.value,c),h=window.URL.createObjectURL(s),D=document.createElement("a");D.href=h,D.download=`${r.value}-data-${l.value}.csv`,document.body.appendChild(D),D.click(),document.body.removeChild(D),window.URL.revokeObjectURL(h)}catch(c){console.error("Error exporting data:",c)}},qe=async()=>{await M()},je=async()=>{await M()},pe=c=>{const s=typeof c=="string"?Number.parseInt(c,10):c;let h;switch(r.value){case"sales":h=ne.value.find(D=>D.id===s);break;case"expense":h=re.value.find(D=>D.id===s);break;case"profit":h=de.value.find(D=>D.id===s);break}if(h)switch(r.value){case"sales":Ve.value=h,se.value=!0;break;case"expense":he.value=h,oe.value=!0;break;case"profit":console.log("Viewing profit item:",h);break}};return ce([l,V],()=>{me()}),ce(r,()=>{M()}),ce(W,()=>{y.value=1,M()}),Je(()=>{me()}),(c,s)=>{const h=Xe,D=We,S=Ge,Y=He;return T(),xe("section",null,[s[26]||(s[26]=a("div",{class:"d-flex justify-space-between align-center mb-6"},[a("div",null,[a("h4",{class:"text-h4 mb-1"}," Financial Overview "),a("p",{class:"text-body-1 mb-0"}," Manage your financial data across sales, expenses, and profit ")])],-1)),e(at,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=o=>r.value=o),class:"mb-6"},{default:t(()=>[e(fe,{value:"sales"},{default:t(()=>s[12]||(s[12]=[f(" Sales ")])),_:1,__:[12]}),e(fe,{value:"expense"},{default:t(()=>s[13]||(s[13]=[f(" Expense ")])),_:1,__:[13]}),e(fe,{value:"profit"},{default:t(()=>s[14]||(s[14]=[f(" Profit ")])),_:1,__:[14]})]),_:1},8,["modelValue"]),e($,{class:"mb-6"},{default:t(()=>[e(P,{class:"d-flex flex-wrap gap-4"},{default:t(()=>[a("div",Nt,[s[15]||(s[15]=a("span",{class:"text-body-2 text-disabled"},"Show:",-1)),e(h,{"model-value":n.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":s[1]||(s[1]=o=>n.value=parseInt(o,10))},null,8,["model-value"])]),e(H),a("div",It,[a("div",Mt,[e(D,{modelValue:W.value,"onUpdate:modelValue":s[2]||(s[2]=o=>W.value=o),placeholder:`Search ${r.value}...`,"prepend-inner-icon":"tabler-search"},null,8,["modelValue","placeholder"])]),e(B,{variant:"tonal",color:"secondary","prepend-icon":"tabler-download",disabled:!De.value.length,onClick:Le},{default:t(()=>s[16]||(s[16]=[f(" Export Selected ")])),_:1,__:[16]},8,["disabled"])])]),_:1}),e(I),e(Qe,{"items-per-page":n.value,"onUpdate:itemsPerPage":s[4]||(s[4]=o=>n.value=o),page:y.value,"onUpdate:page":s[5]||(s[5]=o=>y.value=o),"model-value":De.value,items:Oe.value,"item-value":"id","items-length":we.value,headers:Fe.value,class:"text-no-wrap","show-select":"",loading:ae.value,"onUpdate:options":i,"onUpdate:modelValue":s[6]||(s[6]=o=>{switch(r.value){case"sales":U.value=o;break;case"expense":d.value=o;break;case"profit":F.value=o;break}})},Ke({bottom:t(()=>[e(S,{page:y.value,"onUpdate:page":s[3]||(s[3]=o=>y.value=o),"items-per-page":n.value,"total-items":we.value},null,8,["page","items-per-page","total-items"])]),_:2},[r.value==="sales"?{name:"item.unitPrice",fn:t(({item:o})=>[a("span",Lt,p(b(g)(Number(o.unitPrice))),1)]),key:"0"}:void 0,r.value==="sales"?{name:"item.sale",fn:t(({item:o})=>[a("span",qt,p(b(g)(Number(o.sale))),1)]),key:"1"}:void 0,r.value==="expense"?{name:"item.amount",fn:t(({item:o})=>[a("span",jt,p(b(g)(Number(o.amount))),1)]),key:"2"}:void 0,r.value==="expense"?{name:"item.expenseCategory",fn:t(({item:o})=>[e(q,{size:"small",variant:"tonal",color:"primary"},{default:t(()=>[f(p(o.expenseCategory),1)]),_:2},1024)]),key:"3"}:void 0,r.value==="profit"?{name:"item.totalSales",fn:t(({item:o})=>[a("span",Ht,p(b(g)(Number(o.totalSales))),1)]),key:"4"}:void 0,r.value==="profit"?{name:"item.totalExpenses",fn:t(({item:o})=>[a("span",Qt,p(b(g)(Number(o.totalExpenses))),1)]),key:"5"}:void 0,r.value==="profit"?{name:"item.profit",fn:t(({item:o})=>[a("span",Gt,p(b(g)(Number(o.profit))),1)]),key:"6"}:void 0,r.value==="sales"?{name:"item.actions",fn:t(({item:o})=>[e(B,{icon:"",variant:"text",color:"primary",size:"small",onClick:A=>pe(o.id)},{default:t(()=>[e(C,{icon:"tabler-eye"}),e(ye,{activator:"parent",location:"top"},{default:t(()=>s[17]||(s[17]=[f(" View Sale Details ")])),_:1,__:[17]})]),_:2},1032,["onClick"])]),key:"7"}:void 0,r.value==="expense"?{name:"item.actions",fn:t(({item:o})=>[e(B,{icon:"",variant:"text",color:"primary",size:"small",onClick:A=>pe(o.id)},{default:t(()=>[e(C,{icon:"tabler-eye"}),e(ye,{activator:"parent",location:"top"},{default:t(()=>s[18]||(s[18]=[f(" View Expense Details ")])),_:1,__:[18]})]),_:2},1032,["onClick"])]),key:"8"}:void 0,r.value==="profit"?{name:"item.actions",fn:t(({item:o})=>[e(B,{icon:"",variant:"text",color:"primary",size:"small",onClick:A=>pe(o.id)},{default:t(()=>[e(C,{icon:"tabler-eye"}),e(ye,{activator:"parent",location:"top"},{default:t(()=>s[19]||(s[19]=[f(" View Profit Details ")])),_:1,__:[19]})]),_:2},1032,["onClick"])]),key:"9"}:void 0]),1032,["items-per-page","page","model-value","items","items-length","headers","loading"])]),_:1}),e(J,{class:"mb-6"},{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[a("div",Wt,[s[20]||(s[20]=a("div",null,[a("h4",{class:"text-h4 mb-1"}," Financial Overview "),a("p",{class:"text-body-1 text-medium-emphasis"}," Comprehensive financial analysis and performance tracking across all franchise units ")],-1)),a("div",Xt,[e(ge,{modelValue:l.value,"onUpdate:modelValue":s[7]||(s[7]=o=>l.value=o),items:Ae,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"])])])]),_:1})]),_:1}),e(J,{class:"mb-6"},{default:t(()=>[e(_,{cols:"12",md:"4"},{default:t(()=>[e($,null,{default:t(()=>[e(P,null,{default:t(()=>[a("div",Yt,[a("div",null,[s[21]||(s[21]=a("h6",{class:"text-h6 mb-1"}," Total Sales ",-1)),a("div",Jt,p(l.value==="yearly"?"Annual":l.value==="monthly"?"Monthly":"Daily")+" Revenue ",1),a("h4",Kt,p(b(g)(Ue.value||0,"SAR",!1)),1)]),e(ve,{color:"success",variant:"tonal",size:"56"},{default:t(()=>[e(C,{icon:"tabler-trending-up",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($,null,{default:t(()=>[e(P,null,{default:t(()=>[a("div",Zt,[a("div",null,[s[22]||(s[22]=a("h6",{class:"text-h6 mb-1"}," Total Expenses ",-1)),a("div",ea,p(l.value==="yearly"?"Annual":l.value==="monthly"?"Monthly":"Daily")+" Costs ",1),a("h4",ta,p(b(g)(Ee.value||0,"SAR",!1)),1)]),e(ve,{color:"error",variant:"tonal",size:"56"},{default:t(()=>[e(C,{icon:"tabler-trending-down",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($,null,{default:t(()=>[e(P,null,{default:t(()=>[a("div",aa,[a("div",null,[s[23]||(s[23]=a("h6",{class:"text-h6 mb-1"}," Total Profit ",-1)),a("div",la,p(l.value==="yearly"?"Annual":l.value==="monthly"?"Monthly":"Daily")+" Earnings ",1),a("h4",sa,p(b(g)(Pe.value||0,"SAR",!1)),1)]),e(ve,{color:"primary",variant:"tonal",size:"56"},{default:t(()=>[e(b(Ce),{size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e($,{class:"mb-6"},{default:t(()=>[e(P,null,{default:t(()=>{var o;return[s[24]||(s[24]=a("h6",{class:"text-h6 mb-4"}," Financial Performance ",-1)),e(Y,{type:"line",height:"400",options:$e.value,series:((o=ie.value)==null?void 0:o.series)||[],loading:te.value},null,8,["options","series","loading"])]}),_:1,__:[24]})]),_:1}),e($,null,{default:t(()=>[e(P,null,{default:t(()=>[s[25]||(s[25]=a("h6",{class:"text-h6 mb-4"}," Units Performance ",-1)),e(lt,{headers:Re,items:ue.value,loading:le.value,class:"text-no-wrap"},{"item.sales":t(({item:o})=>[a("div",oa,p(b(g)(o.sales||0)),1)]),"item.expenses":t(({item:o})=>[a("div",ia,p(b(g)(o.expenses||0)),1)]),"item.royalties":t(({item:o})=>[a("div",na,p(b(g)(o.royalties||0)),1)]),"item.netSales":t(({item:o})=>[a("div",ra,p(b(g)(o.netSales||0)),1)]),"item.profit":t(({item:o})=>[a("div",da,p(b(g)(o.profit||0)),1)]),"item.profitMargin":t(({item:o})=>[e(q,{color:(o.profitMargin||0)>0?"success":"error",size:"small",label:""},{default:t(()=>[f(p((o.profitMargin||0).toFixed(1))+"% ",1)]),_:2},1032,["color"])]),_:1},8,["items","loading"])]),_:1,__:[25]})]),_:1}),e(Ot,{"is-dialog-visible":Se.value,"onUpdate:isDialogVisible":s[8]||(s[8]=o=>Se.value=o),onDataAdded:qe},null,8,["is-dialog-visible"]),e(Ft,{"is-dialog-visible":ke.value,"onUpdate:isDialogVisible":s[9]||(s[9]=o=>ke.value=o),onDataImported:je},null,8,["is-dialog-visible"]),e(ht,{"is-dialog-visible":se.value,"onUpdate:isDialogVisible":s[10]||(s[10]=o=>se.value=o),"sale-data":Ve.value},null,8,["is-dialog-visible","sale-data"]),e(Bt,{"is-dialog-visible":oe.value,"onUpdate:isDialogVisible":s[11]||(s[11]=o=>oe.value=o),"expense-data":he.value},null,8,["is-dialog-visible","expense-data"])])}}});export{Wa as default};
