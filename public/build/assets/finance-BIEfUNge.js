import{m as K}from"./vue3-apexcharts-DV_O-zbU.js";import{f as m}from"./formatters--UtN2sCw.js";import{d as Q,g as n,aF as Y,w as Z,O as p,E as ee,c as N,o as z,y as o,k as s,F as te,r as ae,i as u,a as oe,l as i,av as se,t as d,a7 as $,q as _}from"./main-BYpBSAj5.js";import{f as re}from"./franchise-Br-lDrzK.js";import{S as E}from"./saudi-riyal-LHXlLwHP.js";import{a as y,V as v}from"./VRow-BqYOgTz2.js";import{V as g,f as b,b as le,a as T,d as ne,g as ie}from"./VCard-Ca_zP91K.js";import{V as ce}from"./VDivider-DekgMQwS.js";import{V as de}from"./VDataTable-BtxFyHeU.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-CqkleIqs.js";import"./api-router-DcsSUdgO.js";/* empty css              */import"./VSelect-B4XFvlOB.js";import"./VTextField-DyLIUBXh.js";import"./VField-eqPlPWcK.js";import"./form-3qejRGpX.js";import"./forwardRefs-B931MWyl.js";import"./VInput-DSHxIYJN.js";import"./VList-CIyV_jON.js";import"./VMenu-BmvlNcnX.js";import"./VOverlay-fzIdOlHt.js";import"./scopeId-DntWhGWm.js";import"./VCheckboxBtn-BGrXAimH.js";import"./VSelectionControl-BOWDk1vX.js";import"./VChip-CIWZSwOd.js";import"./VSlideGroup-BvgzkMEi.js";import"./VTable-B2PHCaSR.js";const fe={class:"d-flex align-center gap-x-4 mb-1"},me={class:"text-h4"},pe={class:"text-body-1 mb-1"},he={class:"d-flex gap-x-2 align-center"},ye={class:"text-h6"},ge={class:"text-body-1 font-weight-medium"},_e={class:"text-body-1 text-success font-weight-medium"},ve={class:"text-body-1 text-error font-weight-medium"},be={class:"text-body-1 text-warning font-weight-medium"},xe={class:"text-body-1 text-primary font-weight-medium"},Se="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",h="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",x="rgba(var(--v-border-color), var(--v-border-opacity))",we=Q({__name:"finance",setup(ke){const S=n(null),H=n(!1),L=async()=>{H.value=!0;try{const t=await re.getDashboardFinance();S.value=t}catch(t){console.error("Error fetching finance data:",t),S.value=null}finally{H.value=!1}},w=Y(),c={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},k=n([]),M=n([{name:"Sales",data:[]}]),B=n([{name:"Royalty",data:[]}]),f=n([]),R=n([{name:"Sales",data:[]}]),C=n([{name:"Expenses",data:[]}]),A=n([{name:"Profit",data:[]}]),F=n([{name:"Royalty",data:[]}]),V=n([]),D=n([]),l=t=>typeof t=="number"?t:Number.parseFloat(t)||0;Z(S,t=>{const r=t;if(r!=null&&r.success&&(r!=null&&r.data)){const a=r.data;k.value=[{icon:E,color:"primary",title:"Total Sales",value:m(l(a.stats.total_sales)),change:a.stats.sales_change,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:m(l(a.stats.total_expenses)),change:a.stats.expenses_change,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:m(l(a.stats.net_profit)),change:a.stats.profit_change,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:`${l(a.stats.profit_margin).toFixed(2)}%`,change:a.stats.margin_change,isHover:!1}],a.top_stores_sales&&a.top_stores_sales.length>0&&(M.value=[{name:"Sales",data:a.top_stores_sales.map(e=>l(e.sales))}],f.value=a.top_stores_sales.map(e=>e.name||"Unknown Store")),a.top_stores_royalty&&a.top_stores_royalty.length>0&&(B.value=[{name:"Royalty",data:a.top_stores_royalty.map(e=>l(e.royalty))}],f.value.length===0&&(f.value=a.top_stores_royalty.map(e=>e.name||"Unknown Store"))),a.sales_chart&&a.sales_chart.length>0&&(R.value=[{name:"Sales",data:a.sales_chart.map(e=>l(e.amount))}],V.value=a.sales_chart.map(e=>e.month)),a.expenses_chart&&(C.value=[{name:"Expenses",data:a.expenses_chart.map(e=>l(e.amount))}]),a.profit_chart&&(A.value=[{name:"Profit",data:a.profit_chart.map(e=>l(e.amount))}]),a.royalty_chart&&(F.value=[{name:"Royalty",data:a.royalty_chart.map(e=>l(e.amount))}]),a.monthly_breakdown&&(D.value=a.monthly_breakdown)}});const P=[{icon:E,color:"primary",title:"Total Sales",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-receipt",color:"error",title:"Total Expenses",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-chart-line",color:"success",title:"Net Profit",value:"SAR 0",change:0,isHover:!1},{icon:"tabler-percentage",color:"warning",title:"Profit Margin",value:"0%",change:0,isHover:!1}],O=p(()=>k.value.length>0?k.value:P),W=p(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(t){return`${(t/1e3).toFixed(0)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[c.primary],xaxis:{categories:f.value.length>0?f.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(t){return`${(t/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:x,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{theme:w.current.value.dark?"dark":"light",y:{formatter(t){return`${t.toLocaleString()} SAR`}}}})),I=p(()=>({chart:{type:"bar",toolbar:{show:!1},parentHeightOffset:0},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%"}},dataLabels:{enabled:!0,formatter(t){return`${(t/1e3).toFixed(1)}k SAR`},style:{colors:["#fff"],fontSize:"13px",fontWeight:500}},colors:[c.warning],xaxis:{categories:f.value.length>0?f.value:["No data available"],labels:{style:{colors:h,fontSize:"13px"},formatter(t){return`${(t/1e3).toFixed(0)}k SAR`}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px"}}},grid:{strokeDashArray:8,borderColor:x,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-18,left:21,right:25,bottom:10}},tooltip:{theme:w.current.value.dark?"dark":"light",y:{formatter(t){return`${t.toLocaleString()} SAR`}}}})),J=p(()=>[{name:"Sales",data:R.value.length>0?R.value[0].data:[]},{name:"Expenses",data:C.value.length>0?C.value[0].data:[]},{name:"Royalties",data:F.value.length>0?F.value[0].data:[]},{name:"Profit",data:A.value.length>0?A.value[0].data:[]}]),U=p(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:4,colors:"#fff",strokeColors:[c.primary,c.error,c.warning,c.success],hover:{size:5},borderRadius:4},stroke:{curve:"smooth",width:3,lineCap:"round"},legend:{show:!0,position:"top",horizontalAlign:"left",markers:{width:10,height:10,offsetX:-3},fontSize:"14px",fontWeight:400,labels:{colors:Se},itemMargin:{horizontal:12,vertical:8}},grid:{strokeDashArray:8,borderColor:x},colors:[c.primary,c.error,c.warning,c.success],dataLabels:{enabled:!1},xaxis:{categories:V.value.length>0?V.value:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:h,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:h,fontSize:"13px",fontWeight:400},formatter(t){return`${(t/1e3).toFixed(0)}k SAR`}}},tooltip:{theme:w.current.value.dark?"dark":"light",y:{formatter(t){return`${t.toLocaleString()} SAR`}}}})),q=p(()=>D.value.map(t=>({month:t.month,sales:m(l(t.sales)),expenses:m(l(t.expenses)),royalties:m(l(t.royalties)),profit:m(l(t.profit))}))),X=[{title:"Month",key:"month"},{title:"Sales",key:"sales",align:"end"},{title:"Expenses",key:"expenses",align:"end"},{title:"Royalties",key:"royalties",align:"end"},{title:"Profit",key:"profit",align:"end"}];return ee(()=>{L()}),(t,r)=>{const a=K;return z(),N("section",null,[o(v,{class:"mb-6"},{default:s(()=>[(z(!0),N(te,null,ae(u(O),(e,j)=>(z(),oe(y,{key:j,cols:"12",md:"3",sm:"6"},{default:s(()=>[o(g,{class:"finance-card-statistics cursor-pointer",style:x,onMouseenter:G=>e.isHover=!0,onMouseleave:G=>e.isHover=!1},{default:s(()=>[o(b,null,{default:s(()=>[i("div",fe,[o(le,{variant:"tonal",color:e.color,rounded:""},{default:s(()=>[o(se,{icon:e.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),i("h4",me,d(e.value),1)]),i("div",pe,d(e.title),1),i("div",he,[i("h6",ye,d(e.change>0?"+":"")+" "+d(e.change)+"% ",1),r[0]||(r[0]=i("div",{class:"text-sm text-disabled"}," than last month ",-1))])]),_:2},1024)]),_:2},1032,["onMouseenter","onMouseleave"])]),_:2},1024))),128))]),_:1}),o(v,{class:"mb-6"},{default:s(()=>[o(y,{cols:"12",md:"6"},{default:s(()=>[o(g,null,{default:s(()=>[o(T,{title:"Top 5 Stores by Monthly Sales",subtitle:"Performance comparison"},{append:s(()=>[o($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:s(()=>r[1]||(r[1]=[_(" This Month ")])),_:1,__:[1]})]),_:1}),o(b,null,{default:s(()=>[o(a,{type:"bar",height:"320",options:u(W),series:u(M)},null,8,["options","series"])]),_:1})]),_:1})]),_:1}),o(y,{cols:"12",md:"6"},{default:s(()=>[o(g,null,{default:s(()=>[o(T,{title:"Top 5 Stores by Monthly Royalty",subtitle:"Royalty contributions"},{append:s(()=>[o($,{variant:"tonal",size:"small","append-icon":"tabler-chevron-down"},{default:s(()=>r[2]||(r[2]=[_(" This Month ")])),_:1,__:[2]})]),_:1}),o(b,null,{default:s(()=>[o(a,{type:"bar",height:"320",options:u(I),series:u(B)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),o(v,{class:"mb-6"},{default:s(()=>[o(y,{cols:"12"},{default:s(()=>[o(g,null,{default:s(()=>[o(b,null,{default:s(()=>[o(a,{type:"line",height:"400",options:u(U),series:u(J)},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),o(v,null,{default:s(()=>[o(y,{cols:"12"},{default:s(()=>[o(g,null,{default:s(()=>[o(T,{class:"pb-4"},{default:s(()=>[o(ne,null,{default:s(()=>r[3]||(r[3]=[_("Monthly Financial Breakdown")])),_:1,__:[3]}),o(ie,null,{default:s(()=>r[4]||(r[4]=[_("Detailed monthly statistics")])),_:1,__:[4]})]),_:1}),o(ce),o(de,{headers:X,items:u(q),"hide-default-footer":"",class:"text-no-wrap"},{"item.month":s(({item:e})=>[i("div",ge,d(e.month),1)]),"item.sales":s(({item:e})=>[i("div",_e,d(e.sales),1)]),"item.expenses":s(({item:e})=>[i("div",ve,d(e.expenses),1)]),"item.royalties":s(({item:e})=>[i("div",be,d(e.royalties),1)]),"item.profit":s(({item:e})=>[i("div",xe,d(e.profit),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})])}}}),Ze=ue(we,[["__scopeId","data-v-db4d7c09"]]);export{Ze as default};
