import{_ as H}from"./AppTextField.vue_vue_type_script_setup_true_lang-BtYmKqoH.js";import{d as q,g as p,e as G,bb as J,be as Q,aQ as Y,c as R,o as c,l as r,y as s,aR as B,i as a,k as t,a as h,h as f,G as I,t as A,s as b,av as F,a7 as L,q as g,b7 as Z,aZ as v}from"./main-Cv9YYIc_.js";import{_ as K}from"./AuthProvider.vue_vue_type_script_setup_true_lang-DC2zmv9x.js";import{a as O,b as W}from"./auth-v1-top-shape-gPxasD3d.js";import{V as P}from"./VNodeRenderer-CUWt_8fo.js";import{a as U}from"./auth-C7UHTTgo.js";import{a as X,d as ee,f as V,V as T}from"./VCard-BzCAkRO7.js";import{V as $,a as u}from"./VRow-BEiqwRCB.js";import{V as ae}from"./VForm-C-dasJkp.js";import{V as se}from"./VAlert-KmFQIs37.js";import{V as te}from"./VCheckbox-BBNXBl-o.js";import{V as oe}from"./form-4Ew858sR.js";import{V as j}from"./VDivider-DT1g3bUq.js";import"./VTextField-C5rooSv7.js";import"./VField-nvY4EMEJ.js";import"./VInput-BKmeTauw.js";import"./VCheckboxBtn-ClkQAZzU.js";import"./VSelectionControl-D-T6fXGu.js";const re={class:"auth-wrapper d-flex align-center justify-center pa-4"},le={class:"position-relative my-sm-16"},ie={class:"app-logo"},ne={class:"app-logo-title"},de={class:"d-flex justify-space-between align-start mb-4"},ue={class:"role-radio"},me={key:0,class:"radio-inner"},pe={class:"d-flex justify-space-between align-start mb-4"},ce={class:"role-radio"},fe={key:0,class:"radio-inner"},ve={class:"text-center text-base mt-6"},ye={class:"text-h4 mb-1"},_e={class:"d-flex align-center my-6"},$e=q({__name:"register",setup(be){const w=p(1),d=p(""),l=p({name:"",email:"",password:"",password_confirmation:"",role:"",privacyPolicies:!1}),x=p(!1),k=p(!1),C=p(!1),m=p(null),D=G(),{smAndUp:z}=J(),{updateAbility:N}=Q(),S=y=>{d.value=y},M=()=>{d.value&&(l.value.role=d.value,w.value=2)},E=async()=>{var y;if(!l.value.privacyPolicies){m.value={general:"Please agree to the privacy policy & terms to continue."};return}C.value=!0,m.value=null;try{const e=await U.register({name:l.value.name,email:l.value.email,password:l.value.password,password_confirmation:l.value.password_confirmation,role:l.value.role});e.success&&e.data&&(v("accessToken").value=e.data.token,v("userData").value={id:e.data.user.id,fullName:e.data.user.name,username:e.data.user.email,avatar:void 0,email:e.data.user.email,role:e.data.user.role,status:e.data.user.status});let o;try{o=await U.login({email:l.value.email,password:l.value.password}),o.success&&o.data&&(v("accessToken").value=o.data.access_token,v("userData").value={id:o.data.user.id,fullName:o.data.user.name,username:o.data.user.email,avatar:o.data.user.avatar,email:o.data.user.email,role:o.data.user.role},v("userAbilityRules").value=[],N([]))}catch{v("userAbilityRules").value=[],N([])}D.push({name:"verify-email"})}catch(e){const o=(e==null?void 0:e.data)||((y=e==null?void 0:e.response)==null?void 0:y._data)||null;o!=null&&o.errors?m.value={name:o.errors.name,email:o.errors.email,password:o.errors.password,password_confirmation:o.errors.password_confirmation,role:o.errors.role,general:o.message}:m.value={general:(o==null?void 0:o.message)||"Registration failed. Please check your details and try again."}}finally{C.value=!1}};return(y,e)=>{const o=Y("RouterLink"),_=H;return c(),R("div",re,[r("div",le,[s(a(P),{nodes:B("div",{innerHTML:a(O)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),s(a(P),{nodes:B("div",{innerHTML:a(W)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),s(T,{class:b(["auth-card",a(z)?"pa-6":"pa-0"]),"max-width":"600"},{default:t(()=>[s(X,{class:"justify-center"},{default:t(()=>[s(ee,null,{default:t(()=>[s(o,{to:"/"},{default:t(()=>[r("div",ie,[s(a(P),{nodes:a(I).app.logo},null,8,["nodes"]),r("h1",ne,A(a(I).app.title),1)])]),_:1})]),_:1})]),_:1}),a(w)===1?(c(),h(V,{key:0},{default:t(()=>[e[14]||(e[14]=r("h4",{class:"text-h4 mb-1 text-center"}," Join as a Broker or Franchisor ",-1)),e[15]||(e[15]=r("p",{class:"mb-6 text-center"}," Select your role to get started ",-1)),s($,{class:"role-selection-cards mb-6"},{default:t(()=>[s(u,{cols:"12",sm:"6"},{default:t(()=>[s(T,{class:b(["role-card cursor-pointer",{"role-card-selected":a(d)==="franchisor"}]),variant:"outlined",onClick:e[0]||(e[0]=i=>S("franchisor"))},{default:t(()=>[s(V,{class:"pa-6"},{default:t(()=>[r("div",de,[s(F,{icon:"tabler-briefcase",size:"48",class:"text-primary"}),r("div",ue,[r("div",{class:b(["radio-outer",{"radio-selected":a(d)==="franchisor"}])},[a(d)==="franchisor"?(c(),R("div",me)):f("",!0)],2)])]),e[9]||(e[9]=r("div",{class:"text-body-1 font-weight-medium"}," I'm a franchisor, managing franchises ",-1))]),_:1,__:[9]})]),_:1},8,["class"])]),_:1}),s(u,{cols:"12",sm:"6"},{default:t(()=>[s(T,{class:b(["role-card cursor-pointer",{"role-card-selected":a(d)==="broker"}]),variant:"outlined",onClick:e[1]||(e[1]=i=>S("broker"))},{default:t(()=>[s(V,{class:"pa-6"},{default:t(()=>[r("div",pe,[s(F,{icon:"tabler-users",size:"48",class:"text-primary"}),r("div",ce,[r("div",{class:b(["radio-outer",{"radio-selected":a(d)==="broker"}])},[a(d)==="broker"?(c(),R("div",fe)):f("",!0)],2)])]),e[10]||(e[10]=r("div",{class:"text-body-1 font-weight-medium"}," I'm a broker, connecting opportunities ",-1))]),_:1,__:[10]})]),_:1},8,["class"])]),_:1})]),_:1}),s(L,{block:"",size:"large",disabled:!a(d),onClick:M},{default:t(()=>e[11]||(e[11]=[g(" Create Account ")])),_:1,__:[11]},8,["disabled"]),r("div",ve,[e[13]||(e[13]=r("span",null,"Already have an account?",-1)),s(o,{class:"text-primary ms-1",to:{name:"login"}},{default:t(()=>e[12]||(e[12]=[g(" Log In ")])),_:1,__:[12]})])]),_:1,__:[14,15]})):f("",!0),a(w)===2?(c(),h(V,{key:1},{default:t(()=>[r("h4",ye," Complete Your Registration as "+A(a(d)==="franchisor"?"Franchisor":"Broker"),1),e[16]||(e[16]=r("p",{class:"mb-0"}," Fill in your details to create your account ",-1))]),_:1,__:[16]})):f("",!0),a(w)===2?(c(),h(V,{key:2},{default:t(()=>[s(ae,{onSubmit:Z(E,["prevent"])},{default:t(()=>[s($,null,{default:t(()=>[s(u,{cols:"12"},{default:t(()=>{var i;return[(i=a(m))!=null&&i.general?(c(),h(se,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>{var n;return[g(A((n=a(m))==null?void 0:n.general),1)]}),_:1})):f("",!0)]}),_:1}),s(u,{cols:"12"},{default:t(()=>{var i;return[s(_,{modelValue:a(l).name,"onUpdate:modelValue":e[2]||(e[2]=n=>a(l).name=n),autofocus:"",label:"Full Name",placeholder:"Name","error-messages":(i=a(m))==null?void 0:i.name},null,8,["modelValue","error-messages"])]}),_:1}),s(u,{cols:"12"},{default:t(()=>{var i;return[s(_,{modelValue:a(l).email,"onUpdate:modelValue":e[3]||(e[3]=n=>a(l).email=n),label:"Email",type:"email",placeholder:"Email","error-messages":(i=a(m))==null?void 0:i.email},null,8,["modelValue","error-messages"])]}),_:1}),s(u,{cols:"12"},{default:t(()=>{var i;return[s(_,{modelValue:a(l).password,"onUpdate:modelValue":e[4]||(e[4]=n=>a(l).password=n),label:"Password",placeholder:"············",type:a(x)?"text":"password",autocomplete:"new-password","error-messages":(i=a(m))==null?void 0:i.password,"append-inner-icon":a(x)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[5]||(e[5]=n=>x.value=!a(x))},null,8,["modelValue","type","error-messages","append-inner-icon"]),e[17]||(e[17]=r("p",{class:"text-caption text-disabled mt-1"}," Password must be at least 8 characters and contain uppercase, lowercase, number, and special character. ",-1))]}),_:1,__:[17]}),s(u,{cols:"12"},{default:t(()=>{var i;return[s(_,{modelValue:a(l).password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=n=>a(l).password_confirmation=n),label:"Confirm Password",autocomplete:"new-password",placeholder:"············",type:a(k)?"text":"password","error-messages":(i=a(m))==null?void 0:i.password_confirmation,"append-inner-icon":a(k)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[7]||(e[7]=n=>k.value=!a(k))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),s(u,{cols:"12"},{default:t(()=>[r("div",_e,[s(te,{id:"privacy-policy",modelValue:a(l).privacyPolicies,"onUpdate:modelValue":e[8]||(e[8]=i=>a(l).privacyPolicies=i),inline:""},null,8,["modelValue"]),s(oe,{for:"privacy-policy",style:{opacity:"1"}},{default:t(()=>e[18]||(e[18]=[r("span",{class:"me-1 text-high-emphasis"},"I agree to",-1),r("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1,__:[18]})]),s(L,{block:"",type:"submit",loading:a(C),disabled:a(C)},{default:t(()=>e[19]||(e[19]=[g(" Sign up ")])),_:1,__:[19]},8,["loading","disabled"])]),_:1}),s(u,{cols:"12",class:"text-center text-base"},{default:t(()=>[e[21]||(e[21]=r("span",null,"Already have an account?",-1)),s(o,{class:"text-primary ms-1",to:{name:"login"}},{default:t(()=>e[20]||(e[20]=[g(" Sign in instead ")])),_:1,__:[20]})]),_:1,__:[21]}),s(u,{cols:"12",class:"d-flex align-center"},{default:t(()=>[s(j),e[22]||(e[22]=r("span",{class:"mx-4"},"or",-1)),s(j)]),_:1,__:[22]}),s(u,{cols:"12",class:"text-center"},{default:t(()=>[s(K)]),_:1})]),_:1})]),_:1})]),_:1})):f("",!0)]),_:1},8,["class"])])])}}});export{$e as default};
