import{_ as ke}from"./AppTextarea.vue_vue_type_script_setup_true_lang-ozlWohdM.js";import{_ as Ne}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BKjMP7yK.js";import{_ as Ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-D7xQ4Hmd.js";import{_ as Ue}from"./AppTextField.vue_vue_type_script_setup_true_lang-DaZorL-F.js";import{_ as we,n as De}from"./AddNoteDialog.vue_vue_type_script_setup_true_lang-B0R0vveL.js";import{V as xe,_ as Se,a as Ae}from"./DeleteNoteDialog.vue_vue_type_script_setup_true_lang-BzRrjgJa.js";import{d as Le,u as Ee,O as G,g as p,E as J,w as K,c as F,o as i,a as n,h as A,y as t,i as l,k as o,l as f,aD as Te,t as V,q as c,a7 as _,F as B,r as X,av as R,aM as D}from"./main-CEM1QI86.js";import{l as Y}from"./lead-19XSzGsM.js";import{u as $e}from"./users-BkQDqnPe.js";import{a as Pe}from"./formatters--UtN2sCw.js";import{u as Fe,a as Me}from"./useSaudiProvinces-RrPRYxvk.js";import{f as v,V as y,b as ze,a as k,d as N}from"./VCard-BQn_ZwHQ.js";import{V as Ie}from"./VChip-BShyV8jA.js";import{V as Be,a as Re}from"./VTabs-Bxes0duv.js";import{a as Z,V as qe}from"./VWindowItem-DfjmoSwF.js";import{V as C,a as m}from"./VRow-DQylzCgd.js";import{V as U}from"./VDivider-MM1jTXpn.js";import"./form-ChweRA-D.js";import"./VTextarea-l7amS_Zr.js";import"./VTextField-C2dTSwqb.js";import"./VField-sdCO7WAE.js";import"./forwardRefs-B931MWyl.js";import"./VInput-BhhwivIT.js";import"./VSelect-DAbGf17D.js";import"./VList-DLC3F4tN.js";import"./VMenu-Dj8Drxav.js";import"./VOverlay-DGzNmcTF.js";import"./scopeId-DY8qXCsp.js";import"./VCheckboxBtn-BXdbbINE.js";import"./VSelectionControl-DcY1Vt5D.js";import"./VDialog-B7W_OT1M.js";import"./VForm-B8cle4sK.js";import"./VFileInput-B-0XvL7-.js";import"./VSpacer-CWg-Jdgc.js";/* empty css              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ConfirmDeleteDialog.vue_vue_type_script_setup_true_lang-D3PEdT_K.js";import"./api-router-Bcbe8RlT.js";import"./VSlideGroup-Cc3zlOOJ.js";const Oe={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Qe={class:"d-flex align-center gap-4"},We={class:"text-h4"},je={class:"text-h4 mb-1"},He={class:"text-body-1 mb-1"},Ge={class:"d-flex gap-2"},Je={class:"d-flex justify-space-between align-start mb-2"},Ke={class:"text-caption text-disabled mb-1"},Xe={class:"text-h6 mb-2"},Ye={class:"d-flex gap-2"},Ze={class:"text-body-2 mb-2"},Bl=Le({__name:"[id]",setup(he){const h=Ee(),b=G(()=>Number(h.params.id)),w=p("overview"),L=p(!1),E=p(!1),x=p(!1),S=p(!1),T=p(null),M=p(null),u=p(!1),s=p(null),z=p(!1),q=async()=>{try{z.value=!0;const d=await Y.getLead(b.value);d.success&&d.data&&(s.value=d.data)}catch(d){console.error("Error fetching lead data:",d)}finally{z.value=!1}};J(()=>{q()});const O=p([]),Q=p(!1),$=async()=>{if(b.value)try{Q.value=!0;const d=await De.getNotes({lead_id:b.value});d.success&&(O.value=d.data.map(e=>{var r;return{id:e.id,title:e.title,description:e.description,createdBy:((r=e.user)==null?void 0:r.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(d){console.error("Error fetching notes:",d)}finally{Q.value=!1}};K(b,()=>{b.value&&$()},{immediate:!0});const ee=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],le=d=>new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),te=(d,e=150)=>d.length<=e?d:`${d.substring(0,e)}...`,ae=d=>{T.value=d,E.value=!0},oe=d=>{T.value={...d},x.value=!0},se=d=>{M.value=d,S.value=!0},de=async()=>{await $(),x.value=!1,console.log("Note updated successfully")},ie=async()=>{await $(),console.log("Note added successfully")},ne=async()=>{await $(),S.value=!1,M.value=null,console.log("Note deleted successfully")},W=()=>{u.value=!u.value},P=p(!1),ue=async()=>{if(s.value)try{P.value=!0,(await Y.updateLead(b.value,s.value)).success&&(await q(),u.value=!1,console.log("Lead updated successfully"))}catch(d){console.error("Error updating lead:",d)}finally{P.value=!1}},j=p([]),re=async()=>{try{const d=await $e.getSalesAssociates();if(d.success){const e=Array.isArray(d.data)?d.data:d.data.data||[];j.value=e.map(r=>({title:r.name,value:r.name}))}}catch(d){console.error("Error fetching sales associates:",d)}};J(()=>{re()});const{countries:me,isLoading:pe}=Fe(),{provinces:fe,getCitiesForProvince:ce,isLoading:Ve}=Me(),ve=G(()=>s.value?ce(s.value.state||""):[]);K(()=>{var d;return(d=s.value)==null?void 0:d.state},()=>{s.value&&(s.value.city="")});const ye=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],be=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],ge=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];return(d,e)=>{const r=Ue,g=Ce,I=Ne,_e=ke;return i(),F("section",null,[l(z)?(i(),n(y,{key:0,class:"mb-6"},{default:o(()=>[t(v,{class:"text-center py-10"},{default:o(()=>[t(Te,{indeterminate:"",color:"primary"}),e[36]||(e[36]=f("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[36]})]),_:1})):l(s)?(i(),n(y,{key:1,class:"mb-6"},{default:o(()=>[t(v,null,{default:o(()=>[f("div",Oe,[f("div",Qe,[t(ze,{size:"80",variant:"tonal",color:"primary"},{default:o(()=>[f("span",We,V(l(Pe)(`${l(s).firstName} ${l(s).lastName}`)),1)]),_:1}),f("div",null,[f("h4",je,V(l(s).firstName)+" "+V(l(s).lastName),1),f("div",He,V(l(s).company),1),t(Ie,{color:l(s).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:o(()=>[c(V(l(s).status),1)]),_:1},8,["color"])])]),f("div",Ge,[l(u)?A("",!0):(i(),n(_,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:W},{default:o(()=>e[37]||(e[37]=[c(" Edit ")])),_:1,__:[37]})),l(u)?(i(),n(_,{key:1,color:"success","prepend-icon":"tabler-check",loading:l(P),disabled:l(P),onClick:ue},{default:o(()=>e[38]||(e[38]=[c(" Save ")])),_:1,__:[38]},8,["loading","disabled"])):A("",!0),l(u)?(i(),n(_,{key:2,color:"secondary",variant:"tonal",onClick:W},{default:o(()=>e[39]||(e[39]=[c(" Cancel ")])),_:1,__:[39]})):A("",!0)])])]),_:1})]),_:1})):A("",!0),l(s)?(i(),F(B,{key:2},[t(Re,{modelValue:l(w),"onUpdate:modelValue":e[0]||(e[0]=a=>D(w)?w.value=a:null),class:"mb-6"},{default:o(()=>[(i(),F(B,null,X(ee,a=>t(Be,{key:a.value,value:a.value},{default:o(()=>[t(R,{icon:a.icon,start:""},null,8,["icon"]),c(" "+V(a.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(qe,{modelValue:l(w),"onUpdate:modelValue":e[31]||(e[31]=a=>D(w)?w.value=a:null),class:"disable-tab-transition"},{default:o(()=>[t(Z,{value:"overview"},{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12",lg:"8"},{default:o(()=>[t(y,{class:"mb-6"},{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[40]||(e[40]=[c("Personal & Contact Information")])),_:1,__:[40]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).firstName,"onUpdate:modelValue":e[1]||(e[1]=a=>l(s).firstName=a),label:"First Name",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).lastName,"onUpdate:modelValue":e[2]||(e[2]=a=>l(s).lastName=a),label:"Last Name",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).email,"onUpdate:modelValue":e[3]||(e[3]=a=>l(s).email=a),label:"Email",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:o(()=>[t(r,{modelValue:l(s).phone,"onUpdate:modelValue":e[4]||(e[4]=a=>l(s).phone=a),label:"Phone",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(r,{modelValue:l(s).company,"onUpdate:modelValue":e[5]||(e[5]=a=>l(s).company=a),label:"Company",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{class:"mb-6"},{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[41]||(e[41]=[c("Location")])),_:1,__:[41]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12",md:"4"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).nationality,"onUpdate:modelValue":e[6]||(e[6]=a=>l(s).nationality=a),label:"Nationality",placeholder:"Select Nationality",items:l(me),loading:l(pe),clearable:""},null,8,["modelValue","items","loading"])):(i(),n(r,{key:1,modelValue:l(s).nationality,"onUpdate:modelValue":e[7]||(e[7]=a=>l(s).nationality=a),label:"Nationality",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).state,"onUpdate:modelValue":e[8]||(e[8]=a=>l(s).state=a),label:"Province",placeholder:"Select Province",items:l(fe),loading:l(Ve),clearable:""},null,8,["modelValue","items","loading"])):(i(),n(r,{key:1,modelValue:l(s).state,"onUpdate:modelValue":e[9]||(e[9]=a=>l(s).state=a),label:"Province",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).city,"onUpdate:modelValue":e[10]||(e[10]=a=>l(s).city=a),label:"City",placeholder:"Select City",items:l(ve),disabled:!l(s).state,clearable:""},null,8,["modelValue","items","disabled"])):(i(),n(r,{key:1,modelValue:l(s).city,"onUpdate:modelValue":e[11]||(e[11]=a=>l(s).city=a),label:"City",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{class:"mb-6"},{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[42]||(e[42]=[c("Financial Details")])),_:1,__:[42]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12",md:"4"},{default:o(()=>[t(r,{modelValue:l(s).estimatedInvestment,"onUpdate:modelValue":e[12]||(e[12]=a=>l(s).estimatedInvestment=a),label:"Estimated Investment",type:"number",prefix:"SAR",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[t(r,{modelValue:l(s).franchiseFeeQuoted,"onUpdate:modelValue":e[13]||(e[13]=a=>l(s).franchiseFeeQuoted=a),label:"Franchise Fee Quoted",type:"number",prefix:"SAR",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:o(()=>[l(u)?(i(),n(I,{key:0,modelValue:l(s).expectedDecisionDate,"onUpdate:modelValue":e[14]||(e[14]=a=>l(s).expectedDecisionDate=a),label:"Expected Decision Date",placeholder:"Select Date"},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).expectedDecisionDate,"onUpdate:modelValue":e[15]||(e[15]=a=>l(s).expectedDecisionDate=a),label:"Expected Decision Date",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[43]||(e[43]=[c("Additional Notes")])),_:1,__:[43]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(_e,{modelValue:l(s).note,"onUpdate:modelValue":e[16]||(e[16]=a=>l(s).note=a),label:"Notes",placeholder:"Add any additional notes about this lead...",rows:"4",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1}),t(m,{cols:"12",lg:"4"},{default:o(()=>[t(y,{class:"mb-6"},{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[44]||(e[44]=[c("Lead Management")])),_:1,__:[44]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).status,"onUpdate:modelValue":e[17]||(e[17]=a=>l(s).status=a),label:"Status",placeholder:"Select Status",items:be},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).status,"onUpdate:modelValue":e[18]||(e[18]=a=>l(s).status=a),label:"Status",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).priority,"onUpdate:modelValue":e[19]||(e[19]=a=>l(s).priority=a),label:"Priority",placeholder:"Select Priority",items:ge},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).priority,"onUpdate:modelValue":e[20]||(e[20]=a=>l(s).priority=a),label:"Priority",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).source,"onUpdate:modelValue":e[21]||(e[21]=a=>l(s).source=a),label:"Source",placeholder:"Select Source",items:ye},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).source,"onUpdate:modelValue":e[22]||(e[22]=a=>l(s).source=a),label:"Source",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(g,{key:0,modelValue:l(s).owner,"onUpdate:modelValue":e[23]||(e[23]=a=>l(s).owner=a),label:"Assigned To",placeholder:"Select Owner",items:l(j)},null,8,["modelValue","items"])):(i(),n(r,{key:1,modelValue:l(s).owner,"onUpdate:modelValue":e[24]||(e[24]=a=>l(s).owner=a),label:"Assigned To",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(k,null,{default:o(()=>[t(N,null,{default:o(()=>e[45]||(e[45]=[c("Timeline & Engagement")])),_:1,__:[45]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(I,{key:0,modelValue:l(s).lastContacted,"onUpdate:modelValue":e[25]||(e[25]=a=>l(s).lastContacted=a),label:"Last Contacted",placeholder:"Select Date"},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).lastContacted,"onUpdate:modelValue":e[26]||(e[26]=a=>l(s).lastContacted=a),label:"Last Contacted",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[l(u)?(i(),n(I,{key:0,modelValue:l(s).scheduledMeeting,"onUpdate:modelValue":e[27]||(e[27]=a=>l(s).scheduledMeeting=a),label:"Next Follow-up",placeholder:"Select Date"},null,8,["modelValue"])):(i(),n(r,{key:1,modelValue:l(s).scheduledMeeting,"onUpdate:modelValue":e[28]||(e[28]=a=>l(s).scheduledMeeting=a),label:"Next Follow-up",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(r,{modelValue:l(s).contactAttempts,"onUpdate:modelValue":e[29]||(e[29]=a=>l(s).contactAttempts=a),label:"Contact Attempts",type:"number",readonly:!l(u)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Z,{value:"notes"},{default:o(()=>[t(y,null,{default:o(()=>[t(k,{class:"pb-4"},{append:o(()=>[t(_,{color:"primary","prepend-icon":"tabler-plus",onClick:e[30]||(e[30]=a=>L.value=!0)},{default:o(()=>e[47]||(e[47]=[c(" Add Note ")])),_:1,__:[47]})]),default:o(()=>[t(N,null,{default:o(()=>e[46]||(e[46]=[c("Notes")])),_:1,__:[46]})]),_:1}),t(U),t(v,null,{default:o(()=>[t(C,null,{default:o(()=>[(i(!0),F(B,null,X(l(O),a=>(i(),n(m,{key:a.id,cols:"12"},{default:o(()=>[t(y,{variant:"tonal",class:"mb-4"},{default:o(()=>[t(v,null,{default:o(()=>[f("div",Je,[f("div",null,[f("div",Ke," Created by "+V(a.createdBy)+" at "+V(le(a.createdAt)),1),f("h6",Xe,V(a.title),1)]),f("div",Ye,[t(_,{icon:"",size:"small",variant:"text",onClick:H=>oe(a)},{default:o(()=>[t(R,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),t(_,{icon:"",size:"small",variant:"text",color:"error",onClick:H=>se(a.id)},{default:o(()=>[t(R,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),f("p",Ze,V(te(a.description)),1),t(_,{variant:"text",size:"small",onClick:H=>ae(a)},{default:o(()=>e[48]||(e[48]=[c(" Read More ")])),_:2,__:[48]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):A("",!0),t(we,{"is-dialog-visible":l(L),"onUpdate:isDialogVisible":e[32]||(e[32]=a=>D(L)?L.value=a:null),"lead-id":l(b),onNoteAdded:ie},null,8,["is-dialog-visible","lead-id"]),t(xe,{"is-dialog-visible":l(E),"onUpdate:isDialogVisible":e[33]||(e[33]=a=>D(E)?E.value=a:null),note:l(T)},null,8,["is-dialog-visible","note"]),t(Se,{"is-dialog-visible":l(x),"onUpdate:isDialogVisible":e[34]||(e[34]=a=>D(x)?x.value=a:null),note:l(T),onNoteUpdated:de},null,8,["is-dialog-visible","note"]),t(Ae,{"is-dialog-visible":l(S),"onUpdate:isDialogVisible":e[35]||(e[35]=a=>D(S)?S.value=a:null),"note-id":l(M),onNoteDeleted:ne},null,8,["is-dialog-visible","note-id"])])}}});export{Bl as default};
