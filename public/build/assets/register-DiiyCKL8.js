import{_ as U}from"./AppTextField.vue_vue_type_script_setup_true_lang-CrhyYF4c.js";import{d as B,g as f,e as S,bf as D,bg as L,aU as M,c as I,o as h,l as d,y as r,aV as k,i as s,k as o,G as x,t as C,bb as $,a as j,h as E,q as b,a7 as F,s as H,b1 as u}from"./main-BYpBSAj5.js";import{_ as q}from"./AuthProvider.vue_vue_type_script_setup_true_lang-FpVmEYMX.js";import{a as z,b as G}from"./auth-v1-top-shape-Be0n9vOV.js";import{V as g}from"./VNodeRenderer-DD_4D426.js";import{a as A}from"./auth-CtUCYGOJ.js";import{a as J,d as K,f as P,V as O}from"./VCard-Ca_zP91K.js";import{V as Q}from"./VForm-BOJkEg2X.js";import{V as W,a as m}from"./VRow-BqYOgTz2.js";import{V as X}from"./VAlert-BdnW2TdI.js";import{V as Y}from"./VCheckbox-D4PLss06.js";import{V as Z}from"./form-3qejRGpX.js";import{V as N}from"./VDivider-DekgMQwS.js";import"./VTextField-DyLIUBXh.js";import"./VField-eqPlPWcK.js";import"./forwardRefs-B931MWyl.js";import"./VInput-DSHxIYJN.js";/* empty css              */import"./VCheckboxBtn-BGrXAimH.js";import"./VSelectionControl-BOWDk1vX.js";const ee={class:"auth-wrapper d-flex align-center justify-center pa-4"},ae={class:"position-relative my-sm-16"},se={class:"app-logo"},re={class:"app-logo-title"},oe={class:"d-flex align-center my-6"},Ae=B({__name:"register",setup(le){const l=f({name:"",email:"",password:"",password_confirmation:"",role:"franchisor",privacyPolicies:!1}),v=f(!1),y=f(!1),V=f(!1),i=f(null),p=S(),{smAndUp:T}=D(),{updateAbility:w}=L(),R=async()=>{var _;if(!l.value.privacyPolicies){i.value={general:"Please agree to the privacy policy & terms to continue."};return}V.value=!0,i.value=null;try{const e=await A.register({name:l.value.name,email:l.value.email,password:l.value.password,password_confirmation:l.value.password_confirmation});e.success&&e.data&&(u("accessToken").value=e.data.token,u("userData").value={id:e.data.user.id,fullName:e.data.user.name,username:e.data.user.email,avatar:void 0,email:e.data.user.email,role:e.data.user.role,status:e.data.user.status});let a;try{a=await A.login({email:l.value.email,password:l.value.password}),a.success&&a.data&&(u("accessToken").value=a.data.access_token,u("userData").value={id:a.data.user.id,fullName:a.data.user.name,username:a.data.user.email,avatar:a.data.user.avatar,email:a.data.user.email,role:a.data.user.role},u("userAbilityRules").value=[],w([]))}catch{u("userAbilityRules").value=[],w([])}switch(a!=null&&a.success&&(a!=null&&a.data)?a.data.user.role:l.value.role||"franchisor"){case"admin":p.push("/admin/dashboard");break;case"franchisor":p.push("/franchisor");break;case"franchisee":p.push("/franchisee/dashboard/sales");break;case"sales":p.push("/sales/lead-management");break;default:p.push("/")}}catch(e){const a=(e==null?void 0:e.data)||((_=e==null?void 0:e.response)==null?void 0:_._data)||null;a!=null&&a.errors?i.value={name:a.errors.name,email:a.errors.email,password:a.errors.password,password_confirmation:a.errors.password_confirmation,role:a.errors.role,general:a.message}:i.value={general:(a==null?void 0:a.message)||"Registration failed. Please check your details and try again."}}finally{V.value=!1}};return(_,e)=>{const a=M("RouterLink"),c=U;return h(),I("div",ee,[d("div",ae,[r(s(g),{nodes:k("div",{innerHTML:s(z)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),r(s(g),{nodes:k("div",{innerHTML:s(G)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),r(O,{class:H(["auth-card",s(T)?"pa-6":"pa-0"]),"max-width":"600"},{default:o(()=>[r(J,{class:"justify-center"},{default:o(()=>[r(K,null,{default:o(()=>[r(a,{to:"/"},{default:o(()=>[d("div",se,[r(s(g),{nodes:s(x).app.logo},null,8,["nodes"]),d("h1",re,C(s(x).app.title),1)])]),_:1})]),_:1})]),_:1}),r(P,null,{default:o(()=>e[7]||(e[7]=[d("h4",{class:"text-h4 mb-1"}," Adventure starts here 🚀 ",-1),d("p",{class:"mb-0"}," Make your app management easy and fun! ",-1)])),_:1,__:[7]}),r(P,null,{default:o(()=>[r(Q,{onSubmit:$(R,["prevent"])},{default:o(()=>[r(W,null,{default:o(()=>[r(m,{cols:"12"},{default:o(()=>{var t;return[(t=s(i))!=null&&t.general?(h(),j(X,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:o(()=>{var n;return[b(C((n=s(i))==null?void 0:n.general),1)]}),_:1})):E("",!0)]}),_:1}),r(m,{cols:"12"},{default:o(()=>{var t;return[r(c,{modelValue:s(l).name,"onUpdate:modelValue":e[0]||(e[0]=n=>s(l).name=n),autofocus:"",label:"Full Name",placeholder:"Name","error-messages":(t=s(i))==null?void 0:t.name},null,8,["modelValue","error-messages"])]}),_:1}),r(m,{cols:"12"},{default:o(()=>{var t;return[r(c,{modelValue:s(l).email,"onUpdate:modelValue":e[1]||(e[1]=n=>s(l).email=n),label:"Email",type:"email",placeholder:"Email","error-messages":(t=s(i))==null?void 0:t.email},null,8,["modelValue","error-messages"])]}),_:1}),r(m,{cols:"12"},{default:o(()=>{var t;return[r(c,{modelValue:s(l).password,"onUpdate:modelValue":e[2]||(e[2]=n=>s(l).password=n),label:"Password",placeholder:"············",type:s(v)?"text":"password",autocomplete:"new-password","error-messages":(t=s(i))==null?void 0:t.password,"append-inner-icon":s(v)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=n=>v.value=!s(v))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),r(m,{cols:"12"},{default:o(()=>{var t;return[r(c,{modelValue:s(l).password_confirmation,"onUpdate:modelValue":e[4]||(e[4]=n=>s(l).password_confirmation=n),label:"Confirm Password",autocomplete:"new-password",placeholder:"············",type:s(y)?"text":"password","error-messages":(t=s(i))==null?void 0:t.password_confirmation,"append-inner-icon":s(y)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[5]||(e[5]=n=>y.value=!s(y))},null,8,["modelValue","type","error-messages","append-inner-icon"])]}),_:1}),r(m,{cols:"12"},{default:o(()=>[d("div",oe,[r(Y,{id:"privacy-policy",modelValue:s(l).privacyPolicies,"onUpdate:modelValue":e[6]||(e[6]=t=>s(l).privacyPolicies=t),inline:""},null,8,["modelValue"]),r(Z,{for:"privacy-policy",style:{opacity:"1"}},{default:o(()=>e[8]||(e[8]=[d("span",{class:"me-1 text-high-emphasis"},"I agree to",-1),d("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1,__:[8]})]),r(F,{block:"",type:"submit",loading:s(V),disabled:s(V)},{default:o(()=>e[9]||(e[9]=[b(" Sign up ")])),_:1,__:[9]},8,["loading","disabled"])]),_:1}),r(m,{cols:"12",class:"text-center text-base"},{default:o(()=>[e[11]||(e[11]=d("span",null,"Already have an account?",-1)),r(a,{class:"text-primary ms-1",to:{name:"login"}},{default:o(()=>e[10]||(e[10]=[b(" Sign in instead ")])),_:1,__:[10]})]),_:1,__:[11]}),r(m,{cols:"12",class:"d-flex align-center"},{default:o(()=>[r(N),e[12]||(e[12]=d("span",{class:"mx-4"},"or",-1)),r(N)]),_:1,__:[12]}),r(m,{cols:"12",class:"text-center"},{default:o(()=>[r(q)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{Ae as default};
