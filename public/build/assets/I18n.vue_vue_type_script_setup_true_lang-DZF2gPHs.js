var re=Object.defineProperty;var le=(t,o,l)=>o in t?re(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l;var G=(t,o,l)=>le(t,typeof o!="symbol"?o+"":o,l);import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b2 as S,d as $,g as T,w as W,E as Q,b3 as ce,b4 as de,a as v,o as f,k as n,x as ue,b as me,K as Z,L as ee,ao as fe,an as pe,b5 as he,aj as _e,aF as ve,b6 as ge,M as te,b7 as ye,y as s,n as z,b8 as be,b9 as ae,ad as ke,ba as xe,$ as se,R as we,I as R,J as I,av as w,c as N,l as x,t as b,O as K,aU as X,q as C,i as d,r as F,F as U,h as L,bb as Ce,s as Se,bc as O,b1 as E,aE as Ae,aM as Ne,bd as Ve,a7 as $e,e as Te,be as Ue,aL as Be}from"./main-CEM1QI86.js";import{V as D}from"./VMenu-Dj8Drxav.js";import{m as Pe,M as Le,V as Re,a as Ie,d as Ee,b as Y,e as J}from"./VCard-BQn_ZwHQ.js";import{V as Me}from"./VChip-BShyV8jA.js";import{V as oe}from"./VTooltip-9XZVOdYq.js";import{V as q}from"./VDivider-MM1jTXpn.js";import{V as H,a as B,b as j,c as ze}from"./VList-DLC3F4tN.js";import{V as Fe}from"./VSpacer-CWg-Jdgc.js";import{a as De}from"./auth-CerfOIKq.js";class He{constructor(){G(this,"baseUrl","/v1/notifications")}async getNotifications(o){return await S(this.baseUrl,{method:"GET",query:o})}async getStats(){return await S(`${this.baseUrl}/stats`)}async markAsRead(o){return await S(`${this.baseUrl}/${o}/read`,{method:"PATCH"})}async markAsUnread(o){return await S(`${this.baseUrl}/${o}/unread`,{method:"PATCH"})}async markMultipleAsRead(o){return await S(`${this.baseUrl}/mark-multiple-read`,{method:"PATCH",body:o})}async markMultipleAsUnread(o){return await S(`${this.baseUrl}/mark-multiple-unread`,{method:"PATCH",body:o})}async markAllAsRead(){return await S(`${this.baseUrl}/mark-all-read`,{method:"PATCH"})}async deleteNotification(o){return await S(`${this.baseUrl}/${o}`,{method:"DELETE"})}}const A=new He,ne=$({__name:"PerfectScrollbar",props:{tag:{default:"div"},options:{default:()=>({})}},emits:["scroll","ps-scroll-y","ps-scroll-x","ps-scroll-up","ps-scroll-down","ps-scroll-left","ps-scroll-right","ps-y-reach-start","ps-y-reach-end","ps-x-reach-start","ps-x-reach-end"],setup(t,{expose:o,emit:l}){const r=t,g=l,h=T(null),c=T(null);W(()=>r.options,()=>{m(),_()},{deep:!0}),Q(()=>{h.value&&_()}),ce(()=>{m()});function _(){h.value&&(c.value=new de(h.value,r.options),k())}function m(){c.value&&(k(!1),c.value.destroy(),c.value=null)}const p={scroll:i("scroll"),"ps-scroll-y":i("ps-scroll-y"),"ps-scroll-x":i("ps-scroll-x"),"ps-scroll-up":i("ps-scroll-up"),"ps-scroll-down":i("ps-scroll-down"),"ps-scroll-left":i("ps-scroll-left"),"ps-scroll-right":i("ps-scroll-right"),"ps-y-reach-start":i("ps-y-reach-start"),"ps-y-reach-end":i("ps-y-reach-end"),"ps-x-reach-start":i("ps-x-reach-start"),"ps-x-reach-end":i("ps-x-reach-end")};function i(e){return function(a){g(e,a)}}function k(e=!0){var a;(a=c.value)!=null&&a.element&&Object.entries(p).forEach(([u,y])=>{var V,P;e?(V=c.value)==null||V.element.addEventListener(u,y):(P=c.value)==null||P.element.removeEventListener(u,y)})}return o({ps:c}),(e,a)=>(f(),v(me(e.tag),{ref_key:"scrollbar",ref:h,class:"ps"},{default:n(()=>[ue(e.$slots,"default")]),_:3},512))}}),je=ee({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:we,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...se(),...xe({location:"top end"}),...ke(),...ae(),...be(),...Pe({transition:"scale-rotate-transition"})},"VBadge"),M=Z()({name:"VBadge",inheritAttrs:!1,props:je(),setup(t,o){const{backgroundColorClasses:l,backgroundColorStyles:r}=fe(()=>t.color),{roundedClasses:g}=pe(t),{t:h}=he(),{textColorClasses:c,textColorStyles:_}=_e(()=>t.textColor),{themeClasses:m}=ve(),{locationStyles:p}=ge(t,!0,i=>(t.floating?t.dot?2:4:t.dot?8:12)+(["top","bottom"].includes(i)?Number(t.offsetY??0):["left","right"].includes(i)?Number(t.offsetX??0):0));return te(()=>{const i=Number(t.content),k=!t.max||isNaN(i)?t.content:i<=Number(t.max)?i:`${t.max}+`,[e,a]=ye(o.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return s(t.tag,z({class:["v-badge",{"v-badge--bordered":t.bordered,"v-badge--dot":t.dot,"v-badge--floating":t.floating,"v-badge--inline":t.inline},t.class]},a,{style:t.style}),{default:()=>{var u,y;return[s("div",{class:"v-badge__wrapper"},[(y=(u=o.slots).default)==null?void 0:y.call(u),s(Le,{transition:t.transition},{default:()=>{var V,P;return[R(s("span",z({class:["v-badge__badge",m.value,l.value,g.value,c.value],style:[r.value,_.value,t.inline?{}:p.value],"aria-atomic":"true","aria-label":h(t.label,i),"aria-live":"polite",role:"status"},e),[t.dot?void 0:o.slots.badge?(P=(V=o.slots).badge)==null?void 0:P.call(V):t.icon?s(w,{icon:t.icon},null):k]),[[I,t.modelValue]])]}})])]}})}),{}}}),Oe=ee({start:Boolean,end:Boolean,...se(),...ae()},"VListItemAction"),Ye=Z()({name:"VListItemAction",props:Oe(),setup(t,o){let{slots:l}=o;return te(()=>s(t.tag,{class:["v-list-item-action",{"v-list-item-action--start":t.start,"v-list-item-action--end":t.end},t.class],style:t.style},l)),{}}}),Je={},qe={class:"h-100 d-flex align-center justify-md-space-between justify-center"},Xe={class:"d-flex align-center text-medium-emphasis"};function Ge(t,o){return f(),N("div",qe,[x("span",Xe," Copyright Â© BlackCheetah "+b(new Date().getFullYear())+". ",1)])}const kt=ie(Je,[["render",Ge]]),Ke={class:"d-flex align-start gap-3"},We={key:0},Qe={class:"text-sm font-weight-medium mb-1"},Ze={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},et={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},tt={class:"d-flex flex-column align-end"},at=$({__name:"Notifications",props:{notifications:{},badgeProps:{default:void 0},location:{default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(t,{emit:o}){const l=t,r=o;function g(p){return p?p.split(" ").map(i=>i[0]).join("").toUpperCase():""}const h=K(()=>l.notifications.some(p=>p.isSeen===!1)),c=()=>{const p=l.notifications.map(i=>i.id);h.value?r("read",p):r("unread",p)},_=K(()=>l.notifications.filter(p=>p.isSeen===!1).length),m=(p,i)=>{p?r("unread",[i]):r("read",[i])};return(p,i)=>{const k=X("IconBtn");return f(),v(k,{id:"notification-btn"},{default:n(()=>[s(M,z(l.badgeProps,{"model-value":l.notifications.some(e=>!e.isSeen),color:"error",dot:"","offset-x":"2","offset-y":"3"}),{default:n(()=>[s(w,{icon:"tabler-bell"})]),_:1},16,["model-value"]),s(D,{activator:"parent",width:"380px",location:l.location,offset:"12px","close-on-content-click":!1},{default:n(()=>[s(Re,{class:"d-flex flex-column"},{default:n(()=>[s(Ie,{class:"notification-section"},{append:n(()=>[R(s(Me,{size:"small",color:"primary",class:"me-2"},{default:n(()=>[C(b(d(_))+" New ",1)]),_:1},512),[[I,l.notifications.some(e=>!e.isSeen)]]),R(s(k,{size:"34",onClick:c},{default:n(()=>[s(w,{size:"20",color:"high-emphasis",icon:d(h)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),s(oe,{activator:"parent",location:"start"},{default:n(()=>[C(b(d(h)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[I,l.notifications.length]])]),default:n(()=>[s(Ee,{class:"text-h6"},{default:n(()=>i[0]||(i[0]=[C(" Notifications ")])),_:1,__:[0]})]),_:1}),s(q),s(d(ne),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:n(()=>[s(H,{class:"notification-list rounded-0 py-0"},{default:n(()=>[(f(!0),N(U,null,F(l.notifications,(e,a)=>(f(),N(U,{key:e.id},[a>0?(f(),v(q,{key:0})):L("",!0),s(B,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:u=>p.$emit("click:notification",e)},{default:n(()=>{var u,y;return[x("div",Ke,[s(Y,{color:e.color&&!e.img?e.color:void 0,variant:e.img?void 0:"tonal"},{default:n(()=>[e.text?(f(),N("span",We,b(g(e.text)),1)):L("",!0),e.img?(f(),v(J,{key:1,src:e.img},null,8,["src"])):L("",!0),e.icon?(f(),v(w,{key:2,icon:e.icon},null,8,["icon"])):L("",!0)]),_:2},1032,["color","variant"]),x("div",null,[x("p",Qe,b((u=e.data)==null?void 0:u.title),1),x("p",Ze,b((y=e.data)==null?void 0:y.message),1),x("p",et,b(e.created_at?new Date(e.created_at).toLocaleString():""),1)]),s(Fe),x("div",tt,[s(w,{size:"10",icon:"tabler-circle-filled",color:e.isSeen?"#a8aaae":"primary",class:Se([`${e.isSeen?"visible-in-hover":""}`,"mb-2"]),onClick:Ce(V=>m(e.isSeen,e.id),["stop"])},null,8,["color","class","onClick"]),s(w,{size:"20",icon:"tabler-x",class:"visible-in-hover",onClick:V=>p.$emit("remove",e.id)},null,8,["onClick"])])])]}),_:2},1032,["onClick"])],64))),128)),R(s(B,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:n(()=>[s(j,null,{default:n(()=>i[1]||(i[1]=[C("No Notification Found!")])),_:1,__:[1]})]),_:1},512),[[I,!l.notifications.length]])]),_:1})]),_:1})]),_:1})]),_:1},8,["location"])]),_:1})}}}),st=()=>{const t=T([]),o=T(!1),l=T({total:0,unread:0,read:0}),r=e=>{const a=new Date(e),y=Math.floor((new Date().getTime()-a.getTime())/(1e3*60*60));return y<1?"Just now":y<24?`${y}h ago`:y<48?"Yesterday":a.toLocaleDateString()},g=e=>{let a=e.data;if(typeof a=="string")try{a=JSON.parse(a)}catch(y){console.error("Failed to parse notification data:",y),a={}}const u=a||{};return{id:e.id,title:u.title||"Notification",subtitle:u.message||u.subtitle||"",time:r(e.created_at),color:u.color||"primary",isSeen:!!e.read_at,icon:u.icon||"tabler-bell",img:u.img,text:u.text,data:u,created_at:e.created_at,read_at:e.read_at}},h=async(e=!1)=>{try{o.value=!0;const a=e?{unread_only:!0}:{},u=await A.getNotifications(a);return u.success&&u.data?(t.value=u.data.data.map(g),u.data):null}catch(a){throw console.error("Error fetching notifications:",a),a}finally{o.value=!1}},c=async()=>{try{const e=await A.getStats();return e.success&&e.data?(l.value=e.data,e.data):null}catch(e){throw console.error("Error fetching notification stats:",e),e}},_=async e=>{try{e.length===1?await A.markAsRead(e[0]):await A.markMultipleAsRead({notification_ids:e}),t.value.forEach(a=>{e.includes(a.id)&&(a.isSeen=!0)}),await c()}catch(a){throw console.error("Error marking notifications as read:",a),a}},m=async e=>{try{e.length===1?await A.markAsUnread(e[0]):await A.markMultipleAsUnread({notification_ids:e}),t.value.forEach(a=>{e.includes(a.id)&&(a.isSeen=!1)}),await c()}catch(a){throw console.error("Error marking notifications as unread:",a),a}},p=async()=>{try{await A.markAllAsRead(),t.value.forEach(e=>{e.isSeen=!0}),await c()}catch(e){throw console.error("Error marking all notifications as read:",e),e}},i=async e=>{try{await A.deleteNotification(e);const a=t.value.findIndex(u=>u.id===e);a>-1&&t.value.splice(a,1),await c()}catch(a){throw console.error("Error removing notification:",a),a}},k=async e=>{e.isSeen||await _([e.id])};return{notifications:O(t),loading:O(o),stats:O(l),fetchNotifications:h,fetchStats:c,markAsRead:_,markAsUnread:m,markAllAsRead:p,removeNotification:i,handleNotificationClick:k}},xt=$({__name:"NavBarNotifications",setup(t){const{notifications:o,fetchNotifications:l,fetchStats:r,markAsRead:g,markAsUnread:h,removeNotification:c,handleNotificationClick:_}=st();Q(async()=>{try{if(!E("accessToken").value){console.warn("No access token available, skipping notification fetch");return}await l(),await r()}catch(e){if((e==null?void 0:e.status)===401||(e==null?void 0:e._statusCode)===401){console.warn("User not authenticated, skipping notification fetch");return}console.error("Failed to load notifications:",e)}});const m=async e=>{try{await c(e)}catch(a){console.error("Failed to remove notification:",a)}},p=async e=>{try{await g(e)}catch(a){console.error("Failed to mark notifications as read:",a)}},i=async e=>{try{await h(e)}catch(a){console.error("Failed to mark notifications as unread:",a)}},k=async e=>{try{await _(e)}catch(a){console.error("Failed to handle notification click:",a)}};return(e,a)=>{const u=at;return f(),v(u,{notifications:d(o),onRemove:m,onRead:p,onUnread:i,"onClick:notification":k},null,8,["notifications"])}}}),ot={class:"text-capitalize"},nt=$({__name:"ThemeSwitcher",props:{themes:{}},setup(t){const o=t,l=Ae(),r=T([l.theme]);return W(()=>l.theme,()=>{r.value=[l.theme]},{deep:!0}),(g,h)=>{const c=X("IconBtn");return f(),v(c,{color:"rgba(var(--v-theme-on-surface), var(--v-high-emphasis-opacity))"},{default:n(()=>{var _;return[s(w,{icon:(_=o.themes.find(m=>m.name===d(l).theme))==null?void 0:_.icon},null,8,["icon"]),s(oe,{activator:"parent","open-delay":"1000","scroll-strategy":"close"},{default:n(()=>[x("span",ot,b(d(l).theme),1)]),_:1}),s(D,{activator:"parent",offset:"12px",width:180},{default:n(()=>[s(H,{selected:d(r),"onUpdate:selected":h[0]||(h[0]=m=>Ne(r)?r.value=m:null),mandatory:""},{default:n(()=>[(f(!0),N(U,null,F(o.themes,({name:m,icon:p})=>(f(),v(B,{key:m,value:m,"prepend-icon":p,color:"primary",onClick:()=>{d(l).theme=m}},{default:n(()=>[s(j,{class:"text-capitalize"},{default:n(()=>[C(b(m),1)]),_:2},1024)]),_:2},1032,["value","prepend-icon","onClick"]))),128))]),_:1},8,["selected"])]),_:1})]}),_:1})}}}),wt=$({__name:"NavbarThemeSwitcher",setup(t){const o=[{name:"light",icon:"tabler-sun-high"},{name:"dark",icon:"tabler-moon-stars"},{name:"system",icon:"tabler-device-desktop-analytics"}];return(l,r)=>{const g=nt;return f(),v(g,{themes:o})}}}),rt=()=>Ve(),lt={class:"d-flex gap-2 align-center"},it={class:"text-h6 font-weight-medium"},ct={class:"px-4 py-2"},Ct=$({__name:"UserProfile",setup(t){const o=Te(),l=rt(),r=E("userData"),g=async()=>{try{await De.logout()}catch(c){console.error("Logout API error:",c)}finally{E("accessToken").value=null,r.value=null,E("userAbilityRules").value=null,l.update([]),await o.push("/login")}},h=[{type:"divider"},{type:"navItem",icon:"tabler-user",title:"Profile",to:{name:"pages-account-settings-tab",params:{tab:"account"}}},{type:"navItem",icon:"tabler-settings",title:"Settings",to:{name:"pages-account-settings-tab",params:{tab:"security"}}},{type:"divider"}];return(c,_)=>d(r)?(f(),v(M,{key:0,dot:"",bordered:"",location:"bottom right","offset-x":"1","offset-y":"2",color:"success"},{default:n(()=>[s(Y,{size:"38",class:"cursor-pointer",color:d(r)&&d(r).avatar?void 0:"primary",variant:d(r)&&d(r).avatar?void 0:"tonal"},{default:n(()=>[d(r)&&d(r).avatar?(f(),v(J,{key:0,src:d(r).avatar},null,8,["src"])):(f(),v(w,{key:1,icon:"tabler-user"})),s(D,{activator:"parent",width:"240",location:"bottom end",offset:"12px"},{default:n(()=>[s(H,null,{default:n(()=>[s(B,null,{default:n(()=>[x("div",lt,[s(Ye,null,{default:n(()=>[s(M,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",color:"success",bordered:""},{default:n(()=>[s(Y,{color:d(r)&&d(r).avatar?void 0:"primary",variant:d(r)&&d(r).avatar?void 0:"tonal"},{default:n(()=>[d(r)&&d(r).avatar?(f(),v(J,{key:0,src:d(r).avatar},null,8,["src"])):(f(),v(w,{key:1,icon:"tabler-user"}))]),_:1},8,["color","variant"])]),_:1})]),_:1}),x("div",null,[x("h6",it,b(d(r).fullName||d(r).name||d(r).username||"User"),1),s(ze,{class:"text-capitalize text-disabled"},{default:n(()=>[C(b(d(r).role),1)]),_:1})])])]),_:1}),s(d(ne),{options:{wheelPropagation:!1}},{default:n(()=>[(f(),N(U,null,F(h,m=>(f(),N(U,{key:m.title},[m.type==="navItem"?(f(),v(B,{key:0,to:m.to},Ue({prepend:n(()=>[s(w,{icon:m.icon,size:"22"},null,8,["icon"])]),default:n(()=>[s(j,null,{default:n(()=>[C(b(m.title),1)]),_:2},1024)]),_:2},[m.badgeProps?{name:"append",fn:n(()=>[s(M,z({rounded:"sm",class:"me-3",ref_for:!0},m.badgeProps),null,16)]),key:"0"}:void 0]),1032,["to"])):(f(),v(q,{key:1,class:"my-2"}))],64))),64)),x("div",ct,[s($e,{block:"",size:"small",color:"error","append-icon":"tabler-logout",onClick:g},{default:n(()=>_[0]||(_[0]=[C(" Logout ")])),_:1,__:[0]})])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","variant"])]),_:1})):L("",!0)}}),St=$({__name:"I18n",props:{languages:{},location:{default:"bottom end"}},setup(t){const o=t,{locale:l}=Be({useScope:"global"});return(r,g)=>{const h=X("IconBtn");return f(),v(h,null,{default:n(()=>[s(w,{icon:"tabler-language"}),s(D,{activator:"parent",location:o.location,offset:"12px",width:"175"},{default:n(()=>[s(H,{selected:[d(l)],color:"primary"},{default:n(()=>[(f(!0),N(U,null,F(o.languages,c=>(f(),v(B,{key:c.i18nLang,value:c.i18nLang,onClick:_=>l.value=c.i18nLang},{default:n(()=>[s(j,null,{default:n(()=>[C(b(c.label),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["selected"])]),_:1},8,["location"])]),_:1})}}});export{ne as C,kt as F,M as V,St as _,wt as a,xt as b,Ct as c};
