import{m as $}from"./vue3-apexcharts-19n9sM1T.js";import{f as V}from"./franchisee-dashboard-BlnVxaGW.js";import{g as G}from"./apexCharConfig-CiCrUToc.js";import{a as _,V as b}from"./VRow-CVtl2tku.js";import{V as g,f as h,b as w,a as C,d as P,g as S}from"./VCard-opPv-9ln.js";import{d as H,aB as K,g as u,O as R,E as Q,c as m,o as i,a as c,k as e,y as t,l as o,br as F,q as d,t as n,a7 as X,av as M,F as k,r as A,s as Y,i as Z}from"./main-5DrSmzmz.js";import{V as ee}from"./VAlert-BkXl8kTI.js";import{V as B,a as q,b as E,c as J}from"./VList-B3tldTtO.js";import{V as O}from"./VChip-DCvUjgS6.js";import{S as te}from"./saudi-riyal-BQ4hqXTs.js";import"./_commonjsHelpers-CqkleIqs.js";import"./api-router-Biy3fPQb.js";/* empty css              */import"./VDivider-D0eTowY_.js";import"./VSlideGroup-8-bpGeqw.js";const ae={key:2},se={class:"d-flex mb-6"},le={class:"d-flex justify-space-between"},oe={class:"d-flex flex-column gap-y-1"},re={class:"text-body-1 text-high-emphasis"},ne={class:"d-flex gap-x-2 align-center"},ie={class:"text-h4"},de={class:"text-sm"},ue={class:"text-sm font-weight-medium"},me={class:"text-body-2 font-weight-medium text-high-emphasis"},ce={class:"text-sm font-weight-medium"},fe={class:"text-body-2 font-weight-medium text-high-emphasis"},pe={key:1,class:"text-center py-8"},De=H({__name:"sales",setup(_e){const I=K(),y=u(!1),v=u(null),T=u(!1),U=l=>l>0?`+${l}`:l.toString(),D=u([]),L=u([]),z=u([]),x=u([{name:"Top Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Low Performing Items",data:[0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Average Performance",data:[0,0,0,0,0,0,0,0,0,0,0,0]}]),j=R(()=>G(I.current.value)),W=R(()=>!y.value&&T.value&&x.value.length>0&&x.value.every(l=>l.data&&Array.isArray(l.data)&&l.data.length>0&&l.data.every(a=>typeof a=="number"&&!Number.isNaN(a)))),f=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"SAR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),N=async()=>{y.value=!0,v.value=null;try{const l=await V.getSalesStatistics();if(l.success&&l.data){const s=l.data;D.value=[{title:"Total Sales",value:f(s.totalSales),change:s.salesChange,desc:"This month sales",icon:te,iconColor:"primary"},{title:"Total Profit",value:f(s.totalProfit),change:s.profitChange,desc:"This month profit",icon:"tabler-trending-up",iconColor:"success"}]}const a=await V.getProductSales();a.success&&a.data&&(L.value=a.data.mostSelling,z.value=a.data.lowSelling);const p=await V.getMonthlyPerformance();if(p.success&&p.data){const s=p.data;x.value=[{name:"Top Performing Items",data:s.topPerforming},{name:"Low Performing Items",data:s.lowPerforming},{name:"Average Performance",data:s.averagePerformance}],T.value=!0}}catch(l){v.value="Failed to load dashboard data. Please try again.",console.error("Error loading dashboard data:",l)}finally{y.value=!1}};return Q(()=>{N()}),(l,a)=>{const p=$;return i(),m("section",null,[y.value?(i(),c(b,{key:0,class:"mb-6"},{default:e(()=>[t(_,{cols:"12"},{default:e(()=>[t(g,null,{default:e(()=>[t(h,{class:"text-center py-8"},{default:e(()=>[t(F,{indeterminate:"",color:"primary",size:"64"}),a[0]||(a[0]=o("div",{class:"mt-4 text-body-1"}," Loading dashboard data... ",-1))]),_:1,__:[0]})]),_:1})]),_:1})]),_:1})):v.value?(i(),c(b,{key:1,class:"mb-6"},{default:e(()=>[t(_,{cols:"12"},{default:e(()=>[t(ee,{type:"error",variant:"tonal",class:"mb-0"},{prepend:e(()=>[t(M,{icon:"tabler-alert-circle"})]),append:e(()=>[t(X,{color:"error",variant:"text",size:"small",onClick:N},{default:e(()=>a[1]||(a[1]=[d(" Retry ")])),_:1,__:[1]})]),default:e(()=>[d(" "+n(v.value)+" ",1)]),_:1})]),_:1})]),_:1})):(i(),m("div",ae,[o("div",se,[t(b,null,{default:e(()=>[(i(!0),m(k,null,A(D.value,(s,r)=>(i(),c(_,{key:r,cols:"12",md:"6",sm:"6"},{default:e(()=>[t(g,null,{default:e(()=>[t(h,null,{default:e(()=>[o("div",le,[o("div",oe,[o("div",re,n(s.title),1),o("div",ne,[o("h4",ie,n(s.value),1),o("div",{class:Y(["text-base",s.change>0?"text-success":"text-error"])}," ("+n(U(s.change))+"%) ",3)]),o("div",de,n(s.desc),1)]),t(w,{color:s.iconColor,variant:"tonal",rounded:"",size:"42"},{default:e(()=>[t(M,{icon:s.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(b,{class:"mb-6"},{default:e(()=>[t(_,{cols:"12",md:"6"},{default:e(()=>[t(g,null,{default:e(()=>[t(C,null,{default:e(()=>[t(P,null,{default:e(()=>a[2]||(a[2]=[d("Most Selling Items")])),_:1,__:[2]}),t(S,null,{default:e(()=>a[3]||(a[3]=[d("Top performing products")])),_:1,__:[3]})]),_:1}),t(h,null,{default:e(()=>[t(B,{class:"py-0"},{default:e(()=>[(i(!0),m(k,null,A(L.value,(s,r)=>(i(),c(q,{key:r,class:"px-0"},{prepend:e(()=>[t(w,{color:r===0?"success":r===1?"primary":r===2?"warning":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",ue,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(E,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(J,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(O,{size:"small",color:"success",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[4]||(a[4]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",me,n(s.avgPrice?f(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[4]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{cols:"12",md:"6"},{default:e(()=>[t(g,null,{default:e(()=>[t(C,null,{default:e(()=>[t(P,null,{default:e(()=>a[5]||(a[5]=[d("Low Selling Items")])),_:1,__:[5]}),t(S,null,{default:e(()=>a[6]||(a[6]=[d("Underperforming products")])),_:1,__:[6]})]),_:1}),t(h,null,{default:e(()=>[t(B,{class:"py-0"},{default:e(()=>[(i(!0),m(k,null,A(z.value,(s,r)=>(i(),c(q,{key:r,class:"px-0"},{prepend:e(()=>[t(w,{color:r===0?"error":r===1?"warning":r===2?"info":"secondary",size:"40",class:"me-3"},{default:e(()=>[o("span",ce,n(r+1),1)]),_:2},1032,["color"])]),default:e(()=>[t(E,{class:"font-weight-medium text-high-emphasis"},{default:e(()=>[d(n(s.name),1)]),_:2},1024),t(J,{class:"d-flex align-center gap-2 mt-1"},{default:e(()=>[t(O,{size:"small",color:"error",variant:"tonal"},{default:e(()=>[d(n(s.quantity)+" sold ",1)]),_:2},1024),a[7]||(a[7]=o("span",{class:"text-body-2 text-medium-emphasis"},"•",-1)),o("span",fe,n(s.avgPrice?f(s.avgPrice):s.price||"N/A"),1)]),_:2,__:[7]},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(g,{class:"mb-6"},{default:e(()=>[t(C,null,{default:e(()=>[t(P,null,{default:e(()=>a[8]||(a[8]=[d("Month wise Top and Low Performing Items")])),_:1,__:[8]}),t(S,null,{default:e(()=>a[9]||(a[9]=[d("Monthly performance comparison")])),_:1,__:[9]})]),_:1}),t(h,null,{default:e(()=>[W.value?(i(),c(p,{key:0,type:"area",height:"350",options:{...j.value,xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},tooltip:{theme:Z(I).current.value.dark?"dark":"light",y:{formatter:s=>f(s)}}},series:x.value},null,8,["options","series"])):(i(),m("div",pe,[t(F,{indeterminate:"",color:"primary",size:"32"}),a[10]||(a[10]=o("div",{class:"mt-4 text-body-2 text-medium-emphasis"}," Loading chart data... ",-1))]))]),_:1})]),_:1})]))])}}});export{De as default};
