import{m as B}from"./vue3-apexcharts-DV_O-zbU.js";import{f as E,b as X,V as S,a as G,d as P,g as J,e as oe}from"./VCard-Ca_zP91K.js";import{d as A,a as D,o as d,k as t,y as e,h as W,l as a,av as O,t as m,g as p,E as j,O as Y,q as C,c as v,i as s,s as Z,aD as re,aU as le,F as I,r as N,n as ne,a7 as ie,aM as q}from"./main-BYpBSAj5.js";import{a as T,_ as ce}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-Dy5fDIWO.js";import{V}from"./VSkeletonLoader-BLv6EzYS.js";import{V as H}from"./VChip-CIWZSwOd.js";import{_ as de}from"./AddEditFranchiseeDrawer.vue_vue_type_script_setup_true_lang-UxNoAUXu.js";import{_ as ue}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-D8gxbgja.js";import{_ as pe}from"./AddEditSalesDrawer.vue_vue_type_script_setup_true_lang-g-KQPBDj.js";import{a as U,V as L}from"./VRow-BqYOgTz2.js";import{V as he}from"./VAlert-BdnW2TdI.js";import{V as fe}from"./VDivider-DekgMQwS.js";import{V as me}from"./VTable-B2PHCaSR.js";import{V as Q}from"./VTooltip-DAjDDCy4.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VSpacer-DHG0No5I.js";/* empty css              */import"./formatters--UtN2sCw.js";import"./VDialog-CpdD25yY.js";import"./VOverlay-fzIdOlHt.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-DntWhGWm.js";import"./VMenu-BmvlNcnX.js";import"./VSlideGroup-BvgzkMEi.js";import"./validators-BHkKs9Dp.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-Bz4_qTpH.js";import"./form-3qejRGpX.js";import"./VSelect-B4XFvlOB.js";import"./VTextField-DyLIUBXh.js";import"./VField-eqPlPWcK.js";import"./VInput-DSHxIYJN.js";import"./VList-CIyV_jON.js";import"./VCheckboxBtn-BGrXAimH.js";import"./VSelectionControl-BOWDk1vX.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-CrhyYF4c.js";import"./VForm-BOJkEg2X.js";import"./VNavigationDrawer-CE_n64ZO.js";const _e={class:"text-h5"},ve={class:"text-sm"},xe=A({__name:"CardStatisticsVertical",props:{title:{},color:{default:"primary"},icon:{},stats:{},height:{},series:{},chartOptions:{}},setup(F){const u=F;return(_,y)=>{const c=B;return d(),D(S,null,{default:t(()=>[e(E,{class:"d-flex flex-column pb-0"},{default:t(()=>[u.icon?(d(),D(X,{key:0,size:"42",variant:"tonal",color:u.color,rounded:"",class:"mb-2"},{default:t(()=>[e(O,{icon:u.icon,size:"26"},null,8,["icon"])]),_:1},8,["color"])):W("",!0),a("h5",_e,m(u.stats),1),a("div",ve,m(u.title),1)]),_:1}),e(c,{series:u.series,options:u.chartOptions,height:u.height},null,8,["series","options","height"])]),_:1})}}}),ge={key:0,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},be={key:1,class:"text-center text-error text-sm mt-3"},ye={key:2,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},we={class:"text-h4 text-center"},Ce=A({__name:"AdminRequestsChart",setup(F){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{name:"Requests",data:[0,0,0,0,0,0,0]}]),$=async()=>{try{u.value=!0;const l=await T.getDashboardChartData();if(l.success&&l.data.requests){const i=l.data.requests.slice(-7),h=i.map(f=>f.requests);k.value=[{name:"Requests",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,R)=>f+R.requests,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching requests chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{$()});const w={warning:"#FFB400"},x=Y(()=>({chart:{height:90,parentHeightOffset:0,type:"bar",toolbar:{show:!1}},tooltip:{enabled:!1},plotOptions:{bar:{barHeight:"100%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4,colors:{backgroundBarColors:[w.warning,w.warning,w.warning,w.warning,w.warning,w.warning,w.warning],backgroundBarRadius:4}}},colors:[w.warning],grid:{show:!1,padding:{top:-30,left:-16,bottom:0,right:-6}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},yaxis:{labels:{show:!1}},responsive:[{breakpoint:1264,options:{plotOptions:{bar:{borderRadius:6,columnWidth:"30%",colors:{backgroundBarRadius:6}}}}}]}));return(l,i)=>{const h=B;return d(),D(S,null,{default:t(()=>[e(G,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[C("Technical Requests")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[C("Last Week")])),_:1,__:[1]})]),_:1}),e(E,null,{default:t(()=>[e(h,{options:s(x),series:s(k),height:62},null,8,["options","series"]),s(u)?(d(),v("div",ge,[e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"40px"})])):s(_)?(d(),v("div",be,m(s(_)),1)):(d(),v("div",ye,[a("h4",we,m(s(y).toLocaleString()),1),a("div",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),ke={class:"d-flex flex-column"},Ve={key:0},De={key:1},Ue={key:2},$e={class:"text-h3 mb-2"},Se={key:1,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Fe={key:2,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Re=A({__name:"AdminRevenueGrowth",setup(F){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{data:[0,0,0,0,0,0,0]}]),$=async()=>{try{u.value=!0;const x=await T.getDashboardChartData();if(x.success&&x.data.revenue){const l=x.data.revenue.slice(-7),i=l.map(g=>g.revenue);k.value=[{data:i}];const h=i[i.length-1]||0,b=i[i.length-2]||0;y.value=l.reduce((g,f)=>g+f.revenue,0),b>0?c.value=(h-b)/b*100:c.value=h>0?100:0}}catch(x){console.error("Error fetching revenue chart data:",x),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{$()});const w=Y(()=>{const x="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",l={success:"#56CA00"};return{chart:{height:162,type:"bar",parentHeightOffset:0,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"80%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:6,distributed:!0}},tooltip:{enabled:!1},grid:{show:!1,padding:{top:-20,bottom:-12,left:-10,right:0}},colors:[l.success,l.success,l.success,l.success,l.success,l.success,l.success],dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:x,fontSize:"13px"}}},yaxis:{labels:{show:!1}},states:{hover:{filter:{type:"none"}}},responsive:[{breakpoint:1640,options:{plotOptions:{bar:{columnWidth:"40%",borderRadius:6}}}}]}});return(x,l)=>{const i=B;return d(),D(S,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between"},{default:t(()=>[a("div",ke,[l[2]||(l[2]=a("div",{class:"mb-auto"},[a("h5",{class:"text-h5 text-no-wrap mb-2"}," Revenue Growth "),a("div",{class:"text-body-1"}," Last 7 Months ")],-1)),s(u)?(d(),v("div",Ve,[e(V,{type:"text",width:"100px",height:"32px",class:"mb-2"}),e(V,{type:"chip",width:"60px",height:"24px"})])):s(_)?(d(),v("div",De,[l[1]||(l[1]=a("h5",{class:"text-h3 mb-2 text-error"}," Error ",-1)),e(H,{label:"",color:"error",size:"small"},{default:t(()=>l[0]||(l[0]=[C(" Failed to load ")])),_:1,__:[0]})])):(d(),v("div",Ue,[a("h5",$e," SAR "+m(s(y).toLocaleString()),1),e(H,{label:"",color:s(c)>=0?"success":"error",size:"small"},{default:t(()=>[C(m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",1)]),_:1},8,["color"])]))]),a("div",null,[!s(u)&&!s(_)?(d(),D(i,{key:0,options:s(w),series:s(k),height:162},null,8,["options","series"])):s(u)?(d(),v("div",Se,[e(re,{indeterminate:"",color:"primary",size:"40"})])):(d(),v("div",Fe,[e(O,{icon:"tabler-alert-circle",color:"error",size:"40"})]))])]),_:1})]),_:1})}}}),Le={key:0,class:"d-flex align-center justify-space-between gap-x-2"},Oe={key:1,class:"text-center text-error text-sm"},Te={key:2,class:"d-flex align-center justify-space-between gap-x-2"},Ee={class:"text-h4 text-center"},Ae=A({__name:"AdminUsersChart",setup(F){const u=p(!0),_=p(""),y=p(0),c=p(0),k=p([{name:"Users",data:[0,0,0,0,0,0,0]}]),$=async()=>{try{u.value=!0;const l=await T.getDashboardChartData();if(l.success&&l.data.users){const i=l.data.users.slice(-7),h=i.map(f=>f.users);k.value=[{name:"Users",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,R)=>f+R.users,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{$()});const x={chart:{type:"area",parentHeightOffset:0,toolbar:{show:!1},sparkline:{enabled:!0}},markers:{colors:"transparent",strokeColors:"transparent"},grid:{show:!1},colors:[{primary:"#9155FD"}.primary],fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.5,opacityTo:.07,stops:[0,80,100]}},dataLabels:{enabled:!1},stroke:{width:2,curve:"smooth"},xaxis:{show:!0,lines:{show:!1},labels:{show:!1},stroke:{width:0},axisBorder:{show:!1}},yaxis:{stroke:{width:0},show:!1},tooltip:{enabled:!1}};return(l,i)=>{const h=B;return d(),D(S,null,{default:t(()=>[e(G,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[C(" Total Users ")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[C(" Last 7 Days ")])),_:1,__:[1]})]),_:1}),e(h,{options:x,series:s(k),height:68},null,8,["series"]),e(E,{class:"pt-1"},{default:t(()=>[s(u)?(d(),v("div",Le,[e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"40px"})])):s(_)?(d(),v("div",Oe,m(s(_)),1)):(d(),v("div",Te,[a("h4",Ee,m(s(y).toLocaleString()),1),a("span",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),ze={class:"d-flex justify-space-between"},qe={class:"d-flex flex-column gap-y-1"},Be={class:"d-flex align-center gap-x-4"},je={key:1},Me={class:"d-flex flex-column"},Ie={class:"text-base font-weight-medium"},Ne={class:"text-sm text-medium-emphasis"},We={class:"d-flex align-center gap-x-2"},He={class:"text-capitalize text-high-emphasis text-body-1"},Ge={class:"text-body-1"},Pe={class:"d-flex gap-1"},Rt=A({__name:"dashboard",setup(F){const u=p([]),_=p([]),y=p(!0),c=p(""),k=async()=>{try{const r=await T.getDashboardStats();r.success&&(u.value=r.data)}catch(r){console.error("Error fetching stats:",r),c.value="Failed to load dashboard statistics"}},$=async()=>{try{const r=await T.getRecentUsers();r.success&&(_.value=r.data)}catch(r){console.error("Error fetching recent users:",r),c.value="Failed to load recent users"}},w=async()=>{y.value=!0,c.value="";try{await Promise.all([k(),$()])}catch(r){console.error("Error loading dashboard data:",r),c.value="Failed to load dashboard data"}finally{y.value=!1}};j(()=>{w()});const x=r=>{const o=r.toLowerCase();return o==="franchisor"?{color:"success",icon:"tabler-building-store"}:o==="franchisee"?{color:"info",icon:"tabler-user-check"}:o==="sales"?{color:"warning",icon:"tabler-chart-line"}:{color:"primary",icon:"tabler-user"}},l=r=>{const o=r.toLowerCase();return o==="pending"?"warning":o==="active"?"success":o==="inactive"?"secondary":"primary"},i=p(!1),h=p(!1),b=p(!1),g=p(!1),f=p(null),R=r=>{f.value=r,i.value=!0},K=r=>{f.value={...r},r.role==="franchisor"?h.value=!0:r.role==="franchisee"?b.value=!0:r.role==="sales"&&(g.value=!0)},ee=()=>{f.value&&K(f.value)},M=r=>{const o=_.value.findIndex(z=>z.id===r.id);o!==-1&&(_.value[o]={..._.value[o],...r}),f.value=null},te=r=>r==="franchisor"?"Franchisor":r==="franchisee"?"Franchisee":r==="sales"?"Sales User":"User",se=r=>!r||typeof r!="string"?"U":r.split(" ").map(o=>o.charAt(0)).join("").toUpperCase();return(r,o)=>{const z=le("IconBtn");return d(),v("section",null,[e(L,{class:"mb-6"},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>o[5]||(o[5]=[a("div",{class:"d-flex align-center justify-space-between"},[a("div",null,[a("h2",{class:"text-h2 mb-1"}," Admin Dashboard "),a("p",{class:"text-body-1 text-medium-emphasis"}," Welcome back! Here's what's happening with your platform today. ")])],-1)])),_:1,__:[5]})]),_:1}),s(c)?(d(),D(L,{key:0,class:"mb-6"},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[e(he,{type:"error",variant:"tonal",closable:"","onClick:close":o[0]||(o[0]=n=>c.value="")},{default:t(()=>[C(m(s(c)),1)]),_:1})]),_:1})]),_:1})):W("",!0),e(L,{class:"mb-6"},{default:t(()=>[s(y)?(d(),v(I,{key:0},N(4,n=>e(U,{key:n,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(S,null,{default:t(()=>[e(E,null,{default:t(()=>[a("div",ze,[a("div",qe,[e(V,{type:"text",width:"80px"}),e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"120px"})]),e(V,{type:"avatar",size:"42"})])]),_:1})]),_:1})]),_:2},1024)),64)):W("",!0),(d(!0),v(I,null,N(s(u),n=>(d(),D(U,{key:n.title,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(xe,ne({ref_for:!0},n),null,16)]),_:2},1024))),128))]),_:1}),e(L,{class:"mb-6"},{default:t(()=>[e(U,{cols:"12",md:"4"},{default:t(()=>[e(Ae)]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(Re)]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(Ce)]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[e(S,null,{default:t(()=>[e(G,{class:"pb-4"},{append:t(()=>[e(ie,{variant:"outlined",color:"primary",size:"small",to:{name:"admin-users-franchisors"}},{default:t(()=>o[8]||(o[8]=[C(" View All ")])),_:1,__:[8]})]),default:t(()=>[e(P,null,{default:t(()=>o[6]||(o[6]=[C("Recent Users")])),_:1,__:[6]}),e(J,null,{default:t(()=>o[7]||(o[7]=[C("Latest registered users")])),_:1,__:[7]})]),_:1}),e(fe),e(me,{class:"text-no-wrap"},{default:t(()=>[o[11]||(o[11]=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," USER "),a("th",{scope:"col"}," ROLE "),a("th",{scope:"col"}," STATUS "),a("th",{scope:"col"}," JOINED DATE "),a("th",{scope:"col"}," ACTIONS ")])],-1)),a("tbody",null,[(d(!0),v(I,null,N(s(_),n=>(d(),v("tr",{key:n.id},[a("td",null,[a("div",Be,[e(X,{size:"34",variant:n.avatar?void 0:"tonal",color:n.avatar?void 0:x(n.role).color},{default:t(()=>[n.avatar?(d(),D(oe,{key:0,src:n.avatar},null,8,["src"])):(d(),v("span",je,m(se(n.fullName)),1))]),_:2},1032,["variant","color"]),a("div",Me,[a("h6",Ie,m(n.fullName),1),a("div",Ne,m(n.email),1)])])]),a("td",null,[a("div",We,[e(O,{size:22,icon:x(n.role).icon,color:x(n.role).color},null,8,["icon","color"]),a("div",He,m(n.role),1)])]),a("td",null,[e(H,{color:l(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[C(m(n.status),1)]),_:2},1032,["color"])]),a("td",null,[a("div",Ge,m(n.joinedDate),1)]),a("td",null,[a("div",Pe,[e(z,{size:"small",onClick:ae=>R(n)},{default:t(()=>[e(O,{icon:"tabler-eye"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>o[9]||(o[9]=[C(" View ")])),_:1,__:[9]})]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:ae=>K(n)},{default:t(()=>[e(O,{icon:"tabler-edit"}),e(Q,{activator:"parent",location:"top"},{default:t(()=>o[10]||(o[10]=[C(" Edit ")])),_:1,__:[10]})]),_:2},1032,["onClick"])])])]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),e(ce,{"is-dialog-open":s(i),"onUpdate:isDialogOpen":o[1]||(o[1]=n=>q(i)?i.value=n:null),user:s(f),"user-type":s(f)?te(s(f).role):"User",onEdit:ee},null,8,["is-dialog-open","user","user-type"]),e(ue,{"is-drawer-open":s(h),"onUpdate:isDrawerOpen":o[2]||(o[2]=n=>q(h)?h.value=n:null),franchisor:s(f),onFranchisorData:M},null,8,["is-drawer-open","franchisor"]),e(de,{"is-drawer-open":s(b),"onUpdate:isDrawerOpen":o[3]||(o[3]=n=>q(b)?b.value=n:null),franchisee:s(f),onFranchiseeData:M},null,8,["is-drawer-open","franchisee"]),e(pe,{"is-drawer-open":s(g),"onUpdate:isDrawerOpen":o[4]||(o[4]=n=>q(g)?g.value=n:null),"sales-user":s(f),onSalesUserData:M},null,8,["is-drawer-open","sales-user"])])}}});export{Rt as default};
