import{d as O,g as k,O as T,w as K,a as $,o as D,k as e,y as t,h as q,l as o,t as c,q as p,aI as h,i as n,a7 as P,e as Q,E as W,c as X,av as V}from"./main-Ji38qWNq.js";import{t as A}from"./task-CjuMqg9v.js";import{_ as Y}from"./ViewTaskDialog.vue_vue_type_script_setup_true_lang-Bslm5aS7.js";import{_ as Z,V as tt}from"./VDialog-BQITKorr.js";import{V as y,f as C,g as et,b as S,a as st,d as at}from"./VCard-CawK-7Mk.js";import{V as B}from"./VDivider-Dc_kOOhx.js";import{V as M}from"./VChip-Bbjrr1Q2.js";import{V as lt}from"./VSelect-Dx19yBS5.js";import{V as ot}from"./VSpacer-Ds6NJ338.js";import{a as x,V as N}from"./VRow-DmXcz54G.js";import{V as it}from"./VAlert-DjmlpEYh.js";import{V as rt}from"./VDataTable-Beg_0ktT.js";import{V as nt}from"./VMenu-CbHzsIir.js";import{V as dt,a as R,b as E}from"./VList-DR2sl0cr.js";import"./api-router-DYQAS8f8.js";import"./VOverlay--ReuNc3x.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-DFtxLKrN.js";import"./VSlideGroup-CeSXpsO9.js";import"./VTextField-Dd7MzrQd.js";import"./VField-DLyvN9w7.js";import"./form-C8-wVyzB.js";import"./VInput-N-MuRR1n.js";import"./VCheckboxBtn-BkETQGEw.js";import"./VSelectionControl-5ebt7RiB.js";/* empty css              */import"./VPagination-0nuZepHR.js";import"./VTable-C4xv__rq.js";const ut={class:"mb-4"},ct={class:"text-base font-weight-medium mb-2"},mt={class:"text-body-2 text-disabled"},ft=O({__name:"StatusChangeTaskDialog",props:{isDialogVisible:{type:Boolean},task:{}},emits:["update:isDialogVisible","status-updated"],setup(U,{emit:b}){const d=U,_=b,u=k(""),m=k(!1),f=T({get:()=>d.isDialogVisible,set:l=>{_("update:isDialogVisible",l),l||(u.value="")}});K(()=>{var l;return(l=d.task)==null?void 0:l.status},l=>{l&&(u.value=l)},{immediate:!0});const g=[{title:"Pending",value:"pending"},{title:"In Progress",value:"in_progress"},{title:"Completed",value:"completed"},{title:"Cancelled",value:"cancelled"},{title:"On Hold",value:"on_hold"}],z=l=>l==="completed"?"success":l==="in_progress"?"warning":l==="pending"?"info":l==="cancelled"?"error":"secondary",I=async()=>{if(!(!d.task||!u.value)){m.value=!0;try{const l=await A.updateTaskStatus(d.task.id,u.value);if(l.success){const i={...d.task,status:u.value};_("status-updated",i),f.value=!1}else console.error("Failed to update task status:",l.message)}catch(l){console.error("Error updating task status:",l)}finally{m.value=!1}}};return(l,i)=>{const w=Z;return D(),$(tt,{modelValue:n(f),"onUpdate:modelValue":i[3]||(i[3]=v=>h(f)?f.value=v:null),"max-width":"600"},{default:e(()=>[t(w,{onClick:i[0]||(i[0]=v=>f.value=!1)}),t(y,{title:"Change Task Status"},{default:e(()=>[t(B),d.task?(D(),$(C,{key:0,class:"pa-6"},{default:e(()=>[o("div",ut,[o("h6",ct,c(d.task.title),1),o("div",mt,[i[4]||(i[4]=p(" Current Status: ")),t(M,{color:z(d.task.status),size:"small",label:"",class:"text-capitalize ml-2"},{default:e(()=>[p(c(d.task.status),1)]),_:1},8,["color"])])]),t(lt,{modelValue:n(u),"onUpdate:modelValue":i[1]||(i[1]=v=>h(u)?u.value=v:null),label:"New Status",items:g,"item-title":"title","item-value":"value",required:""},null,8,["modelValue"])]),_:1})):q("",!0),t(B),t(et,{class:"pa-6"},{default:e(()=>{var v;return[t(ot),t(P,{color:"secondary",variant:"tonal",onClick:i[2]||(i[2]=L=>f.value=!1)},{default:e(()=>i[5]||(i[5]=[p(" Cancel ")])),_:1,__:[5]}),t(P,{color:"primary",disabled:!n(u)||n(u)===((v=d.task)==null?void 0:v.status)||n(m),loading:n(m),onClick:I},{default:e(()=>i[6]||(i[6]=[p(" Update Status ")])),_:1,__:[6]},8,["disabled","loading"])]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),pt={class:"ms-4"},vt={class:"text-h4"},kt={class:"ms-4"},_t={class:"text-h4"},gt={class:"ms-4"},Vt={class:"text-h4"},bt={class:"ms-4"},yt={class:"text-h4"},xt={class:"text-base font-weight-medium"},Tt={class:"text-body-2 text-disabled"},Yt=O({__name:"my-tasks",setup(U){Q();const b=k(!1),d=k(!1),_=k(null),u=k([]),m=k({totalTasks:0,completedTasks:0,inProgressTasks:0,dueTasks:0}),f=k(!1),g=k(null),z=T(()=>m.value.totalTasks),I=T(()=>m.value.completedTasks),l=T(()=>m.value.inProgressTasks),i=T(()=>m.value.dueTasks),w=async()=>{try{f.value=!0,g.value=null;const[a,s]=await Promise.all([A.getMyTasks(),A.getStatistics()]);a.success&&a.data&&(u.value=Array.isArray(a.data)?a.data:a.data.data||[]),s.success&&s.data&&(m.value=s.data)}catch(a){console.error("Error fetching tasks:",a),g.value=a.message||"Failed to load tasks",u.value=[]}finally{f.value=!1}};W(()=>{w()});const v=a=>a==="completed"?"success":a==="in_progress"?"warning":a==="pending"?"info":"secondary",L=a=>a==="high"?"error":a==="medium"?"warning":a==="low"?"info":"secondary",F=[{title:"Task Info",key:"taskInfo"},{title:"Category",key:"category"},{title:"Start Date",key:"startDate"},{title:"Due Date",key:"dueDate"},{title:"Priority",key:"priority"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],H=a=>{_.value=a,b.value=!0},j=a=>{_.value={...a},d.value=!0},G=a=>{const s=u.value.findIndex(r=>r.id===a.id);s!==-1&&(u.value[s]=a),w(),d.value=!1,_.value=null};return(a,s)=>(D(),X("section",null,[t(N,{class:"mb-6"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>s[3]||(s[3]=[o("div",null,[o("h2",{class:"text-h2 mb-1"}," My Tasks "),o("p",{class:"text-body-1 text-medium-emphasis"}," Track and manage tasks assigned to you ")],-1)])),_:1,__:[3]})]),_:1}),t(N,{class:"mb-6"},{default:e(()=>[t(x,{cols:"12",md:"3"},{default:e(()=>[t(y,null,{default:e(()=>[t(C,{class:"d-flex align-center"},{default:e(()=>[t(S,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:e(()=>[t(V,{icon:"tabler-checklist",size:"26"})]),_:1}),o("div",pt,[s[4]||(s[4]=o("div",{class:"text-body-2 text-disabled"}," Total Tasks ",-1)),o("h4",vt,c(n(z)),1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"3"},{default:e(()=>[t(y,null,{default:e(()=>[t(C,{class:"d-flex align-center"},{default:e(()=>[t(S,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:e(()=>[t(V,{icon:"tabler-check",size:"26"})]),_:1}),o("div",kt,[s[5]||(s[5]=o("div",{class:"text-body-2 text-disabled"}," Completed ",-1)),o("h4",_t,c(n(I)),1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"3"},{default:e(()=>[t(y,null,{default:e(()=>[t(C,{class:"d-flex align-center"},{default:e(()=>[t(S,{size:"44",rounded:"",color:"warning",variant:"tonal"},{default:e(()=>[t(V,{icon:"tabler-clock",size:"26"})]),_:1}),o("div",gt,[s[6]||(s[6]=o("div",{class:"text-body-2 text-disabled"}," In Progress ",-1)),o("h4",Vt,c(n(l)),1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"3"},{default:e(()=>[t(y,null,{default:e(()=>[t(C,{class:"d-flex align-center"},{default:e(()=>[t(S,{size:"44",rounded:"",color:"error",variant:"tonal"},{default:e(()=>[t(V,{icon:"tabler-alert-circle",size:"26"})]),_:1}),o("div",bt,[s[7]||(s[7]=o("div",{class:"text-body-2 text-disabled"}," Due ",-1)),o("h4",yt,c(n(i)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),n(g)?(D(),$(it,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-6","onClick:close":s[0]||(s[0]=r=>g.value=null)},{default:e(()=>[p(c(n(g)),1)]),_:1})):q("",!0),t(y,null,{default:e(()=>[t(st,{class:"pb-4"},{default:e(()=>[t(at,null,{default:e(()=>s[8]||(s[8]=[p("My Tasks")])),_:1,__:[8]})]),_:1}),t(B),t(rt,{items:n(u),headers:F,loading:n(f),class:"text-no-wrap","item-value":"id"},{"item.taskInfo":e(({item:r})=>[o("div",null,[o("h6",xt,c(r.title),1),o("div",Tt,c(r.description),1)])]),"item.priority":e(({item:r})=>[t(M,{color:L(r.priority),size:"small",label:"",class:"text-capitalize"},{default:e(()=>[p(c(r.priority),1)]),_:2},1032,["color"])]),"item.status":e(({item:r})=>[t(M,{color:v(r.status),size:"small",label:"",class:"text-capitalize"},{default:e(()=>[p(c(r.status),1)]),_:2},1032,["color"])]),"item.actions":e(({item:r})=>[t(P,{icon:"",variant:"text",color:"medium-emphasis",size:"small"},{default:e(()=>[t(V,{icon:"tabler-dots-vertical"}),t(nt,{activator:"parent"},{default:e(()=>[t(dt,null,{default:e(()=>[t(R,{onClick:J=>H(r)},{prepend:e(()=>[t(V,{icon:"tabler-eye"})]),default:e(()=>[t(E,null,{default:e(()=>s[9]||(s[9]=[p("View")])),_:1,__:[9]})]),_:2},1032,["onClick"]),t(R,{onClick:J=>j(r)},{prepend:e(()=>[t(V,{icon:"tabler-refresh"})]),default:e(()=>[t(E,null,{default:e(()=>s[10]||(s[10]=[p("Change Status")])),_:1,__:[10]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["items","loading"])]),_:1}),t(Y,{"is-dialog-visible":n(b),"onUpdate:isDialogVisible":s[1]||(s[1]=r=>h(b)?b.value=r:null),task:n(_)},null,8,["is-dialog-visible","task"]),t(ft,{"is-dialog-visible":n(d),"onUpdate:isDialogVisible":s[2]||(s[2]=r=>h(d)?d.value=r:null),task:n(_),onStatusUpdated:G},null,8,["is-dialog-visible","task"])]))}});export{Yt as default};
