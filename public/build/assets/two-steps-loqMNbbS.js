import{K as W,L as Z,bg as J,P as X,a$ as Y,O as T,g as V,az as ee,aa as g,w as I,M as ae,Q as te,y as l,F as le,n as N,bh as se,bf as oe,bi as ne,bj as ue,bk as L,ae as ie,d as re,bb as de,e as ce,aZ as x,be as fe,aQ as me,c as ve,o as j,l as m,aR as O,i as u,k as i,G as M,t as q,b7 as pe,a as be,h as ye,q as z,aI as he,a7 as ge,s as Ve}from"./main-C_m4DwnX.js";import{a as _e,b as ke}from"./auth-v1-top-shape-gPxasD3d.js";import{V as B}from"./VNodeRenderer-DnjIsvNv.js";import{a as we}from"./auth-Bn0kXdn0.js";import{a as xe,d as Ce,f as K,V as Re}from"./VCard-SlzzMb5H.js";import{V as Ae}from"./VForm-D4l7pbSV.js";import{V as De,a as C}from"./VRow-CiO-FbWu.js";import{V as Fe}from"./VAlert-HZNsvzFR.js";import{V as Pe,m as Te}from"./VField-DvEiP886.js";import{u as Be,m as Se}from"./form-DYCB4Gfc.js";const Ie=Z({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...ue(),...Se(),...ne(Te({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),Ne=W()({name:"VOtpInput",props:Ie(),emits:{finish:a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,R){let{attrs:b,emit:_,slots:r}=R;const{dimensionStyles:v}=J(a),{isFocused:w,focus:A,blur:D}=Be(a),n=X(a,"modelValue","",e=>e==null?[]:String(e).split(""),e=>e.join("")),{t}=Y(),p=T(()=>Number(a.length)),y=T(()=>Array(p.value).fill(0)),f=V(-1),F=V(),h=V([]),P=T(()=>h.value[f.value]);function E(){if(S(P.value.value)){P.value.value="";return}const e=n.value.slice(),s=P.value.value;e[f.value]=s;let d=null;f.value>n.value.length?d=n.value.length+1:f.value+1!==p.value&&(d="next"),n.value=e,d&&L(F.value,d)}function H(e){const s=n.value.slice(),d=f.value;let c=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(e.key)&&(e.preventDefault(),e.key==="ArrowLeft"?c="prev":e.key==="ArrowRight"?c="next":["Backspace","Delete"].includes(e.key)&&(s[f.value]="",n.value=s,f.value>0&&e.key==="Backspace"?c="prev":requestAnimationFrame(()=>{var o;(o=h.value[d])==null||o.select()})),requestAnimationFrame(()=>{c!=null&&L(F.value,c)}))}function Q(e,s){var c,o;s.preventDefault(),s.stopPropagation();const d=((c=s==null?void 0:s.clipboardData)==null?void 0:c.getData("Text").slice(0,p.value))??"";S(d)||(n.value=d.split(""),(o=h.value)==null||o[e].blur())}function U(){n.value=[]}function $(e,s){A(),f.value=s}function G(){D(),f.value=-1}function S(e){return a.type==="number"&&/[^0-9]/g.test(e)}return ee({VField:{color:g(()=>a.color),bgColor:g(()=>a.color),baseColor:g(()=>a.baseColor),disabled:g(()=>a.disabled),error:g(()=>a.error),variant:g(()=>a.variant)}},{scoped:!0}),I(n,e=>{e.length===p.value&&_("finish",e.join(""))},{deep:!0}),I(f,e=>{e<0||ie(()=>{var s;(s=h.value[e])==null||s.select()})}),ae(()=>{var d;const[e,s]=te(b);return l("div",N({class:["v-otp-input",{"v-otp-input--divided":!!a.divider},a.class],style:[a.style]},e),[l("div",{ref:F,class:"v-otp-input__content",style:[v.value]},[y.value.map((c,o)=>l(le,null,[a.divider&&o!==0&&l("span",{class:"v-otp-input__divider"},[a.divider]),l(Pe,{focused:w.value&&a.focusAll||f.value===o,key:o},{...r,loader:void 0,default:()=>l("input",{ref:k=>h.value[o]=k,"aria-label":t(a.label,o+1),autofocus:o===0&&a.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:a.disabled,inputmode:a.type==="number"?"numeric":"text",min:a.type==="number"?0:void 0,maxlength:o===0?p.value:"1",placeholder:a.placeholder,type:a.type==="number"?"text":a.type,value:n.value[o],onInput:E,onFocus:k=>$(k,o),onBlur:G,onKeydown:H,onPaste:k=>Q(o,k)},null)})])),l("input",N({class:"v-otp-input-input",type:"hidden"},s,{value:n.value.join("")}),null),l(se,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!a.loading,persistent:!0},{default:()=>{var c;return[((c=r.loader)==null?void 0:c.call(r))??l(oe,{color:typeof a.loading=="boolean"?void 0:a.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(d=r.default)==null?void 0:d.call(r)])])}),{blur:()=>{var e;(e=h.value)==null||e.some(s=>s.blur())},focus:()=>{var e;(e=h.value)==null||e[0].focus()},reset:U,isFocused:w}}}),Le={class:"auth-wrapper d-flex align-center justify-center pa-4"},je={class:"position-relative my-sm-16"},Oe={class:"app-logo"},Me={class:"app-logo-title"},Ze=re({__name:"two-steps",setup(a){const{smAndUp:R}=de(),b=ce(),_=V(""),r=V(!1),v=V(null),w=x("userData"),{updateAbility:A}=fe(),D=async()=>{var n;r.value=!0,v.value="Verifying code...";try{await new Promise(y=>setTimeout(y,800));const t=await we.login({email:((n=w.value)==null?void 0:n.email)||"",password:"password"});switch(t.success&&t.data&&(x("accessToken").value=t.data.access_token,x("userData").value={id:t.data.user.id,fullName:t.data.user.name,username:t.data.user.email,avatar:t.data.user.avatar,email:t.data.user.email,role:t.data.user.role},x("userAbilityRules").value=[],A([])),v.value="Code verified successfully. Redirecting...",await new Promise(y=>setTimeout(y,1200)),v.value=null,t.success&&t.data?t.data.user.role:"franchisor"){case"admin":b.push("/admin/dashboard");break;case"franchisor":b.push("/franchisor");break;case"franchisee":b.push("/franchisee/dashboard/sales");break;case"broker":b.push("/brokers/lead-management");break;default:b.push("/")}}catch{v.value="Verification failed. Please try again.",r.value=!1}};return(n,t)=>{const p=me("RouterLink");return j(),ve("div",Le,[m("div",je,[l(u(B),{nodes:O("div",{innerHTML:u(_e)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),l(u(B),{nodes:O("div",{innerHTML:u(ke)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),l(Re,{class:Ve(["auth-card",u(R)?"pa-6":"pa-0"]),"max-width":"600"},{default:i(()=>[l(xe,{class:"justify-center"},{default:i(()=>[l(Ce,null,{default:i(()=>[l(p,{to:"/"},{default:i(()=>[m("div",Oe,[l(u(B),{nodes:u(M).app.logo},null,8,["nodes"]),m("h1",Me,q(u(M).app.title),1)])]),_:1})]),_:1})]),_:1}),l(K,null,{default:i(()=>t[1]||(t[1]=[m("h4",{class:"text-h4 mb-1"}," Two Step Verification ðŸ’¬ ",-1),m("p",{class:"mb-1"}," We sent a verification code to your mobile. Enter the code from the mobile in the field below. ",-1),m("h6",{class:"text-h6"}," ******1234 ",-1)])),_:1,__:[1]}),l(K,null,{default:i(()=>[l(Ae,{onSubmit:pe(()=>{},["prevent"])},{default:i(()=>[l(De,null,{default:i(()=>[l(C,{cols:"12"},{default:i(()=>[u(v)?(j(),be(Fe,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:i(()=>[z(q(u(v)),1)]),_:1})):ye("",!0)]),_:1}),l(C,{cols:"12"},{default:i(()=>[t[2]||(t[2]=m("h6",{class:"text-body-1"}," Type your 6 digit security code ",-1)),l(Ne,{modelValue:u(_),"onUpdate:modelValue":t[0]||(t[0]=y=>he(_)?_.value=y:null),disabled:u(r),type:"number",class:"pa-0",onFinish:D},null,8,["modelValue","disabled"])]),_:1,__:[2]}),l(C,{cols:"12"},{default:i(()=>[l(ge,{loading:u(r),disabled:u(r),block:"",type:"submit"},{default:i(()=>t[3]||(t[3]=[z(" Verify my account ")])),_:1,__:[3]},8,["loading","disabled"])]),_:1}),l(C,{cols:"12"},{default:i(()=>t[4]||(t[4]=[m("div",{class:"d-flex justify-center align-center flex-wrap"},[m("span",{class:"me-1"},"Didn't get the code?"),m("a",{href:"#"},"Resend")],-1)])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])])])}}});export{Ze as default};
