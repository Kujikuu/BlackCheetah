import{V as ke,_ as he}from"./VDataTableServer-v0xDWn-L.js";import{_ as me}from"./AppTextField.vue_vue_type_script_setup_true_lang-BiafB3D_.js";import{_ as pe}from"./AppSelect.vue_vue_type_script_setup_true_lang-Bxp2islL.js";import{a_ as M,d as se,g as _,O as le,a as q,o as S,k as l,y as t,b7 as ye,h as Z,i as e,l as P,t as h,c as ee,F as ae,r as oe,a7 as R,av as O,q as $,aI as I,w as _e,E as Se}from"./main-CrqE58uP.js";import{g as De}from"./api-router-Bz2EkdfU.js";import{f as $e}from"./formatters-aoHiJebZ.js";import{_ as be}from"./AppTextarea.vue_vue_type_script_setup_true_lang-C7-0t7FV.js";import{_ as Ve}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-tIPcQsM3.js";import{u as Ee,a as Ae}from"./useSaudiProvinces-359s5H10.js";import{a as Te,u as Ce}from"./useValidationRules-PeLbHKqm.js";import{V as G,f as H,e as ue,g as ce,d as Pe,b as Ie,a as ze}from"./VCard-CZdMCf39.js";import{V as we}from"./VForm-CFw85RGO.js";import{V as K,a as p}from"./VRow-CpsRAF9x.js";import{V as xe}from"./VFileInput-B05nNJKM.js";import{V as re}from"./VSpacer-aXcnQPec.js";import{V as ge}from"./VDialog-B-G_-ykr.js";import{V as fe}from"./VDivider-CI--kmsf.js";import{V as qe}from"./VMenu-DgtDpKbJ.js";import{V as Re,a as ne,b as de}from"./VList-lIvAURjR.js";import{V as ve}from"./VChip-DAJCEXh0.js";import"./VPagination-DOpeEva-.js";import"./VDataTable-GjxH-5h4.js";import"./VSelect-Di3OJX7Y.js";import"./VTextField-D8j7WlPL.js";import"./VField-B7JFJ89s.js";import"./form-B3cvC5mg.js";import"./VInput-DSx6x9Bd.js";import"./VCheckboxBtn-CG-S7hsL.js";import"./VSelectionControl-DN2C_DWa.js";import"./VTable-B-UYDmW2.js";import"./VTextarea-DM0Hm3il.js";import"./VSlideGroup-0oZ-DmCO.js";class Be{getBaseUrl(){return De("properties")}async getProperties(y){return await M(this.getBaseUrl(),{method:"GET",query:y})}async getProperty(y){return await M(`${this.getBaseUrl()}/${y}`)}async createProperty(y,b){if(b&&b.length>0){const V=new FormData;return Object.entries(y).forEach(([f,u])=>{u!=null&&(Array.isArray(u)?V.append(f,JSON.stringify(u)):V.append(f,String(u)))}),b.forEach(f=>{V.append("property_images[]",f)}),await M(this.getBaseUrl(),{method:"POST",body:V})}return await M(this.getBaseUrl(),{method:"POST",body:y})}async updateProperty(y,b,V){if(V&&V.length>0){const f=new FormData;return f.append("_method","PUT"),Object.entries(b).forEach(([u,D])=>{D!=null&&(Array.isArray(D)?f.append(u,JSON.stringify(D)):f.append(u,String(D)))}),V.forEach(u=>{f.append("property_images[]",u)}),await M(`${this.getBaseUrl()}/${y}`,{method:"POST",body:f})}return await M(`${this.getBaseUrl()}/${y}`,{method:"PUT",body:b})}async deleteProperty(y){return await M(`${this.getBaseUrl()}/${y}`,{method:"DELETE"})}async bulkDelete(y){return await M(`${this.getBaseUrl()}/bulk-delete`,{method:"POST",body:{ids:y}})}async markLeased(y){return await M(`${this.getBaseUrl()}/${y}/mark-leased`,{method:"PATCH"})}}const Q=new Be,m=Te(),Le=["retail","office","kiosk","food_court","standalone"],Fe=["available","under_negotiation","leased","unavailable"];function Ue(){return{title:[m.required("Property title is required"),m.string(),m.maxLength(255)],description:[m.required("Property description is required"),m.string(),m.maxLength(5e3)],propertyType:[m.required("Property type is required"),m.string(),m.inArray(Le,"Invalid property type selected")],sizeSqm:[m.required("Property size is required"),m.numeric(),m.min(0)],stateProvince:[m.required("State/Province is required"),m.string(),m.maxLength(255)],city:[m.required("City is required"),m.string(),m.maxLength(255)],address:[m.required("Address is required"),m.string(),m.maxLength(500)],postalCode:[m.string(),m.maxLength(20)],latitude:[m.numeric(),m.between(-90,90)],longitude:[m.numeric(),m.between(-180,180)],monthlyRent:[m.required("Monthly rent is required"),m.numeric(),m.min(0)],depositAmount:[m.numeric(),m.min(0)],leaseTermMonths:[m.integer(),m.min(1)],availableFrom:[m.date()],contactInfo:[m.string(),m.maxLength(1e3)],status:[m.string(),m.inArray(Fe,"Invalid status selected")]}}function Oe(){return Ue()}const Ne={class:"text-body-2 font-weight-medium mb-3"},Me=se({__name:"CreatePropertyDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","propertyCreated"],setup(Y,{emit:y}){const b=Y,V=y,f=_(),{backendErrors:u,setBackendErrors:D,clearError:C}=Ce(),c=Ue(),a=_({title:"",description:"",property_type:"retail",size_sqm:0,state_province:"",city:"",address:"",postal_code:"11111",monthly_rent:0,deposit_amount:0,lease_term_months:12,available_from:"",status:"available",amenities:[],images:[],contact_info:""}),w=_(!1),k=_([]),x=_([]),U=le({get:()=>b.isDialogVisible,set:v=>V("update:isDialogVisible",v)}),E=()=>{a.value={title:"",description:"",property_type:"retail",size_sqm:0,state_province:"",city:"",address:"",postal_code:"11111",monthly_rent:0,deposit_amount:0,lease_term_months:12,available_from:"",status:"available",amenities:[],images:[],contact_info:""},k.value=[],x.value=[]},j=v=>{const o=v.target,z=o.files;if(z){if(k.value.length+z.length>10){alert("You can upload a maximum of 10 images");return}Array.from(z).forEach(i=>{if(i.size>5*1024*1024){alert(`${i.name} exceeds the 5MB size limit`);return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(i.type)){alert(`${i.name} is not a valid image format`);return}k.value.push(i);const T=new FileReader;T.onload=F=>{var s;x.value.push((s=F.target)==null?void 0:s.result)},T.readAsDataURL(i)})}o&&(o.value="")},X=v=>{k.value.splice(v,1),x.value.splice(v,1)};Ee();const{provinces:W,getCitiesForProvince:A,isLoading:B}=Ae(),g=le(()=>A(a.value.state_province||"")),r=async()=>{const{valid:v}=await f.value.validate();if(v)try{w.value=!0,(await Q.createProperty(a.value,k.value)).success&&(V("propertyCreated"),U.value=!1,E())}catch(o){console.error("Error creating property:",o),D(o)}finally{w.value=!1}},L=()=>{U.value=!1,E()};return(v,o)=>{const z=Ve,i=me,T=be,F=pe;return S(),q(ge,{modelValue:e(U),"onUpdate:modelValue":o[21]||(o[21]=s=>I(U)?U.value=s:null),"max-width":"900",persistent:""},{default:l(()=>[t(z,{onClick:L}),t(G,{title:"Add New Property"},{default:l(()=>[t(H,null,{default:l(()=>[t(we,{ref_key:"formRef",ref:f,onSubmit:ye(r,["prevent"])},{default:l(()=>[t(K,null,{default:l(()=>[t(p,{cols:"12"},{default:l(()=>[t(i,{modelValue:e(a).title,"onUpdate:modelValue":o[0]||(o[0]=s=>e(a).title=s),label:"Property Title",placeholder:"Enter property title",rules:e(c).title,"error-messages":e(u).title,onInput:o[1]||(o[1]=s=>e(C)("title"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(T,{modelValue:e(a).description,"onUpdate:modelValue":o[2]||(o[2]=s=>e(a).description=s),label:"Description",placeholder:"Enter property description",rows:"3",rules:e(c).description,"error-messages":e(u).description,onInput:o[3]||(o[3]=s=>e(C)("description"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(F,{modelValue:e(a).property_type,"onUpdate:modelValue":[o[4]||(o[4]=s=>e(a).property_type=s),o[5]||(o[5]=s=>e(C)("propertyType"))],label:"Property Type",items:[{title:"Retail",value:"retail"},{title:"Office",value:"office"},{title:"Kiosk",value:"kiosk"},{title:"Food Court",value:"food_court"},{title:"Standalone",value:"standalone"}],rules:e(c).propertyType,"error-messages":e(u).propertyType},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(i,{modelValue:e(a).size_sqm,"onUpdate:modelValue":o[6]||(o[6]=s=>e(a).size_sqm=s),label:"Size (m²)",type:"number",placeholder:"0",rules:e(c).sizeSqm,"error-messages":e(u).sizeSqm,onInput:o[7]||(o[7]=s=>e(C)("sizeSqm"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(i,{modelValue:e(a).monthly_rent,"onUpdate:modelValue":o[8]||(o[8]=s=>e(a).monthly_rent=s),label:"Monthly Rent (SAR)",type:"number",placeholder:"0",rules:e(c).monthlyRent,"error-messages":e(u).monthlyRent,onInput:o[9]||(o[9]=s=>e(C)("monthlyRent"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(i,{modelValue:e(a).deposit_amount,"onUpdate:modelValue":o[10]||(o[10]=s=>e(a).deposit_amount=s),label:"Deposit Amount (SAR)",type:"number",placeholder:"0"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(i,{modelValue:e(a).lease_term_months,"onUpdate:modelValue":o[11]||(o[11]=s=>e(a).lease_term_months=s),label:"Lease Term (months)",type:"number",placeholder:"12"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(i,{modelValue:e(a).available_from,"onUpdate:modelValue":o[12]||(o[12]=s=>e(a).available_from=s),label:"Available From",type:"date"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(F,{modelValue:e(a).state_province,"onUpdate:modelValue":[o[13]||(o[13]=s=>e(a).state_province=s),o[14]||(o[14]=s=>e(C)("stateProvince"))],label:"State/Province",placeholder:"Select State/Province",items:e(W),loading:e(B),rules:e(c).stateProvince,"error-messages":e(u).stateProvince},null,8,["modelValue","items","loading","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(F,{modelValue:e(a).city,"onUpdate:modelValue":[o[15]||(o[15]=s=>e(a).city=s),o[16]||(o[16]=s=>e(C)("city"))],label:"City",placeholder:"Select City",items:e(g),disabled:!e(a).state_province,rules:e(c).city,"error-messages":e(u).city},null,8,["modelValue","items","disabled","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(i,{modelValue:e(a).address,"onUpdate:modelValue":o[17]||(o[17]=s=>e(a).address=s),label:"Address",placeholder:"Enter full address",rules:e(c).address,"error-messages":e(u).address,onInput:o[18]||(o[18]=s=>e(C)("address"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(F,{modelValue:e(a).status,"onUpdate:modelValue":o[19]||(o[19]=s=>e(a).status=s),label:"Status",items:[{title:"Available",value:"available"},{title:"Under Negotiation",value:"under_negotiation"},{title:"Leased",value:"leased"},{title:"Unavailable",value:"unavailable"}]},null,8,["modelValue"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(T,{modelValue:e(a).contact_info,"onUpdate:modelValue":o[20]||(o[20]=s=>e(a).contact_info=s),label:"Contact Information",placeholder:"Enter contact information",rows:"2"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[o[22]||(o[22]=P("div",{class:"text-body-2 font-weight-medium mb-2"}," Property Images (Optional) ",-1)),t(xe,{label:"Select Images",placeholder:"Choose images to upload","prepend-icon":"tabler-photo",accept:"image/jpeg,image/jpg,image/png,image/webp",multiple:"",onChange:j}),o[23]||(o[23]=P("div",{class:"text-caption text-disabled mt-1"}," Upload up to 10 images. Maximum 5MB per image. Supported formats: JPEG, PNG, WEBP ",-1))]),_:1,__:[22,23]}),e(x).length>0?(S(),q(p,{key:0,cols:"12"},{default:l(()=>[P("div",Ne," Selected Images ("+h(e(x).length)+") ",1),t(K,null,{default:l(()=>[(S(!0),ee(ae,null,oe(e(x),(s,d)=>(S(),q(p,{key:d,cols:"6",sm:"4",md:"3"},{default:l(()=>[t(G,{class:"position-relative"},{default:l(()=>[t(ue,{src:s,"aspect-ratio":"1",cover:""},null,8,["src"]),t(R,{icon:"",size:"x-small",color:"error",class:"position-absolute",style:{top:"8px",right:"8px"},onClick:N=>X(d)},{default:l(()=>[t(O,{icon:"tabler-x"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):Z("",!0)]),_:1})]),_:1},512)]),_:1}),t(ce,null,{default:l(()=>[t(re),t(R,{color:"secondary",variant:"tonal",disabled:e(w),onClick:L},{default:l(()=>o[24]||(o[24]=[$(" Cancel ")])),_:1,__:[24]},8,["disabled"]),t(R,{color:"primary",loading:e(w),onClick:r},{default:l(()=>o[25]||(o[25]=[$(" Create Property ")])),_:1,__:[25]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),je={class:"text-body-2 font-weight-medium mb-3"},Ge={class:"text-body-2 font-weight-medium mb-2"},Ye={class:"text-caption text-disabled mt-1"},Je={class:"text-body-2 font-weight-medium mb-3"},Ke=se({__name:"EditPropertyDialog",props:{isDialogVisible:{type:Boolean},property:{}},emits:["update:isDialogVisible","propertyUpdated"],setup(Y,{emit:y}){const b=Y,V=y,f=_(),{backendErrors:u,setBackendErrors:D,clearError:C}=Ce(),c=Oe(),a=_({title:"",description:"",property_type:"retail",size_sqm:0,state_province:"",city:"",address:"",postal_code:"11111",monthly_rent:0,deposit_amount:0,lease_term_months:12,available_from:"",status:"available",contact_info:""}),w=_(!1),k=_([]),x=_([]),U=_([]),E=le({get:()=>b.isDialogVisible,set:g=>V("update:isDialogVisible",g)}),j=g=>{const r=g.target,L=r.files;if(L){if(k.value.length+L.length>10){alert("You can upload a maximum of 10 images");return}Array.from(L).forEach(v=>{if(v.size>5*1024*1024){alert(`${v.name} exceeds the 5MB size limit`);return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(v.type)){alert(`${v.name} is not a valid image format`);return}k.value.push(v);const o=new FileReader;o.onload=z=>{var i;x.value.push((i=z.target)==null?void 0:i.result)},o.readAsDataURL(v)})}r&&(r.value="")},X=g=>{k.value.splice(g,1),x.value.splice(g,1)},W=g=>{U.value.splice(g,1)};_e(()=>b.property,g=>{g&&(a.value={title:g.title,description:g.description,property_type:g.property_type,size_sqm:g.size_sqm,state_province:g.state_province,city:g.city,address:g.address,postal_code:g.postal_code,monthly_rent:g.monthly_rent,deposit_amount:g.deposit_amount,lease_term_months:g.lease_term_months,available_from:g.available_from,status:g.status,contact_info:g.contact_info},U.value=g.images?[...g.images]:[],k.value=[],x.value=[])},{immediate:!0});const A=async()=>{if(!b.property)return;const{valid:g}=await f.value.validate();if(g)try{w.value=!0,(await Q.updateProperty(b.property.id,a.value,k.value.length>0?k.value:void 0)).success&&(V("propertyUpdated"),E.value=!1)}catch(r){console.error("Error updating property:",r),D(r)}finally{w.value=!1}},B=()=>{E.value=!1};return(g,r)=>{const L=Ve,v=me,o=be,z=pe;return S(),q(ge,{modelValue:e(E),"onUpdate:modelValue":r[23]||(r[23]=i=>I(E)?E.value=i:null),"max-width":"900",persistent:""},{default:l(()=>[t(L,{onClick:B}),t(G,{title:"Edit Property"},{default:l(()=>[t(H,null,{default:l(()=>[t(we,{ref_key:"formRef",ref:f,onSubmit:ye(A,["prevent"])},{default:l(()=>[t(K,null,{default:l(()=>[t(p,{cols:"12"},{default:l(()=>[t(v,{modelValue:e(a).title,"onUpdate:modelValue":r[0]||(r[0]=i=>e(a).title=i),label:"Property Title",placeholder:"Enter property title",rules:e(c).title,"error-messages":e(u).title,onInput:r[1]||(r[1]=i=>e(C)("title"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(o,{modelValue:e(a).description,"onUpdate:modelValue":r[2]||(r[2]=i=>e(a).description=i),label:"Description",placeholder:"Enter property description",rows:"3",rules:e(c).description,"error-messages":e(u).description,onInput:r[3]||(r[3]=i=>e(C)("description"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(z,{modelValue:e(a).property_type,"onUpdate:modelValue":[r[4]||(r[4]=i=>e(a).property_type=i),r[5]||(r[5]=i=>e(C)("propertyType"))],label:"Property Type",items:[{title:"Retail",value:"retail"},{title:"Office",value:"office"},{title:"Kiosk",value:"kiosk"},{title:"Food Court",value:"food_court"},{title:"Standalone",value:"standalone"}],rules:e(c).propertyType,"error-messages":e(u).propertyType},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).size_sqm,"onUpdate:modelValue":r[6]||(r[6]=i=>e(a).size_sqm=i),label:"Size (m²)",type:"number",placeholder:"0",rules:e(c).sizeSqm,"error-messages":e(u).sizeSqm,onInput:r[7]||(r[7]=i=>e(C)("sizeSqm"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).monthly_rent,"onUpdate:modelValue":r[8]||(r[8]=i=>e(a).monthly_rent=i),label:"Monthly Rent (SAR)",type:"number",placeholder:"0",rules:e(c).monthlyRent,"error-messages":e(u).monthlyRent,onInput:r[9]||(r[9]=i=>e(C)("monthlyRent"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).deposit_amount,"onUpdate:modelValue":r[10]||(r[10]=i=>e(a).deposit_amount=i),label:"Deposit Amount (SAR)",type:"number",placeholder:"0"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).lease_term_months,"onUpdate:modelValue":r[11]||(r[11]=i=>e(a).lease_term_months=i),label:"Lease Term (months)",type:"number",placeholder:"12"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).available_from,"onUpdate:modelValue":r[12]||(r[12]=i=>e(a).available_from=i),label:"Available From",type:"date"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).state_province,"onUpdate:modelValue":r[13]||(r[13]=i=>e(a).state_province=i),label:"State/Province",placeholder:"Enter state/province",rules:e(c).stateProvince,"error-messages":e(u).stateProvince,onInput:r[14]||(r[14]=i=>e(C)("stateProvince"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).city,"onUpdate:modelValue":r[15]||(r[15]=i=>e(a).city=i),label:"City",placeholder:"Enter city",rules:e(c).city,"error-messages":e(u).city,onInput:r[16]||(r[16]=i=>e(C)("city"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12",md:"6"},{default:l(()=>[t(v,{modelValue:e(a).postal_code,"onUpdate:modelValue":r[17]||(r[17]=i=>e(a).postal_code=i),label:"Postal Code",placeholder:"Enter postal code",rules:e(c).postalCode,"error-messages":e(u).postalCode,onInput:r[18]||(r[18]=i=>e(C)("postalCode"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(v,{modelValue:e(a).address,"onUpdate:modelValue":r[19]||(r[19]=i=>e(a).address=i),label:"Address",placeholder:"Enter full address",rules:e(c).address,"error-messages":e(u).address,onInput:r[20]||(r[20]=i=>e(C)("address"))},null,8,["modelValue","rules","error-messages"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(z,{modelValue:e(a).status,"onUpdate:modelValue":r[21]||(r[21]=i=>e(a).status=i),label:"Status",items:[{title:"Available",value:"available"},{title:"Under Negotiation",value:"under_negotiation"},{title:"Leased",value:"leased"},{title:"Unavailable",value:"unavailable"}]},null,8,["modelValue"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(o,{modelValue:e(a).contact_info,"onUpdate:modelValue":r[22]||(r[22]=i=>e(a).contact_info=i),label:"Contact Information",placeholder:"Enter contact information",rows:"2"},null,8,["modelValue"])]),_:1}),e(U).length>0?(S(),q(p,{key:0,cols:"12"},{default:l(()=>[P("div",je," Current Images ("+h(e(U).length)+") ",1),t(K,null,{default:l(()=>[(S(!0),ee(ae,null,oe(e(U),(i,T)=>(S(),q(p,{key:"existing-"+T,cols:"6",sm:"4",md:"3"},{default:l(()=>[t(G,{class:"position-relative"},{default:l(()=>[t(ue,{src:i,"aspect-ratio":"1",cover:""},null,8,["src"]),t(R,{icon:"",size:"x-small",color:"error",class:"position-absolute",style:{top:"8px",right:"8px"},onClick:F=>W(T)},{default:l(()=>[t(O,{icon:"tabler-x"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):Z("",!0),t(p,{cols:"12"},{default:l(()=>[P("div",Ge,h(e(U).length>0?"Replace Images (Optional)":"Add Property Images (Optional)"),1),t(xe,{label:"Select Images",placeholder:"Choose images to upload","prepend-icon":"tabler-photo",accept:"image/jpeg,image/jpg,image/png,image/webp",multiple:"",onChange:j}),P("div",Ye,h(e(k).length>0?"These new images will replace all existing images.":"Upload up to 10 images. Maximum 5MB per image. Supported formats: JPEG, PNG, WEBP"),1)]),_:1}),e(x).length>0?(S(),q(p,{key:1,cols:"12"},{default:l(()=>[P("div",Je," New Images to Upload ("+h(e(x).length)+") ",1),t(K,null,{default:l(()=>[(S(!0),ee(ae,null,oe(e(x),(i,T)=>(S(),q(p,{key:"new-"+T,cols:"6",sm:"4",md:"3"},{default:l(()=>[t(G,{class:"position-relative"},{default:l(()=>[t(ue,{src:i,"aspect-ratio":"1",cover:""},null,8,["src"]),t(R,{icon:"",size:"x-small",color:"error",class:"position-absolute",style:{top:"8px",right:"8px"},onClick:F=>X(T)},{default:l(()=>[t(O,{icon:"tabler-x"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):Z("",!0)]),_:1})]),_:1},512)]),_:1}),t(ce,null,{default:l(()=>[t(re),t(R,{color:"secondary",variant:"tonal",disabled:e(w),onClick:B},{default:l(()=>r[24]||(r[24]=[$(" Cancel ")])),_:1,__:[24]},8,["disabled"]),t(R,{color:"primary",loading:e(w),onClick:A},{default:l(()=>r[25]||(r[25]=[$(" Update Property ")])),_:1,__:[25]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),We={class:"font-weight-medium"},He=se({__name:"DeletePropertyDialog",props:{isDialogVisible:{type:Boolean},property:{}},emits:["update:isDialogVisible","propertyDeleted"],setup(Y,{emit:y}){const b=Y,V=y,f=_(!1),u=le({get:()=>b.isDialogVisible,set:c=>V("update:isDialogVisible",c)}),D=async()=>{if(b.property)try{f.value=!0,(await Q.deleteProperty(b.property.id)).success&&(V("propertyDeleted"),u.value=!1)}catch(c){console.error("Error deleting property:",c)}finally{f.value=!1}},C=()=>{u.value=!1};return(c,a)=>(S(),q(ge,{modelValue:e(u),"onUpdate:modelValue":a[0]||(a[0]=w=>I(u)?u.value=w:null),"max-width":"500"},{default:l(()=>[t(G,null,{default:l(()=>[t(Pe,{class:"d-flex align-center gap-2"},{default:l(()=>[t(O,{icon:"tabler-alert-circle",color:"error",size:"24"}),a[1]||(a[1]=$(" Confirm Deletion "))]),_:1,__:[1]}),t(H,null,{default:l(()=>{var w;return[a[2]||(a[2]=P("p",{class:"mb-2"}," Are you sure you want to delete this property? ",-1)),P("p",We,h((w=c.property)==null?void 0:w.title),1),a[3]||(a[3]=P("p",{class:"text-sm text-error mt-2"}," This action cannot be undone. ",-1))]}),_:1,__:[2,3]}),t(ce,null,{default:l(()=>[t(re),t(R,{color:"secondary",variant:"tonal",disabled:e(f),onClick:C},{default:l(()=>a[4]||(a[4]=[$(" Cancel ")])),_:1,__:[4]},8,["disabled"]),t(R,{color:"error",loading:e(f),onClick:D},{default:l(()=>a[5]||(a[5]=[$(" Delete Property ")])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Qe={class:"d-flex mb-6"},Xe={class:"d-flex justify-space-between"},Ze={class:"d-flex flex-column gap-y-1"},et={class:"text-body-1 text-high-emphasis"},tt={class:"text-h4"},lt={class:"me-3 d-flex gap-3"},at={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},ot={style:{"inline-size":"15.625rem"}},st={class:"text-body-1 font-weight-medium"},rt={class:"text-body-1 font-weight-medium"},it={class:"text-body-2"},nt={class:"text-body-1 font-weight-medium"},dt={class:"text-body-2"},ut={class:"text-body-2"},Mt=se({__name:"properties",setup(Y){const y=_(""),b=_(""),V=_(""),f=_(10),u=_(1),D=_(),C=_(),c=_([]),a=_(!1),w=_([]),k=_(0),x=_(!1),U=_(!1),E=_(!1),j=_(null),X=[{title:"#",key:"index",sortable:!1},{title:"Title",key:"title"},{title:"Type",key:"property_type"},{title:"Location",key:"city"},{title:"Monthly Rent",key:"monthly_rent"},{title:"Size (m²)",key:"size_sqm"},{title:"Status",key:"status"},{title:"Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],W=_([{title:"Total Properties",value:"0",change:0,icon:"tabler-building",iconColor:"primary"},{title:"Available",value:"0",change:0,icon:"tabler-home-check",iconColor:"success"},{title:"Leased",value:"0",change:0,icon:"tabler-home-hand",iconColor:"info"},{title:"Under Negotiation",value:"0",change:0,icon:"tabler-message-circle",iconColor:"warning"}]),A=async()=>{try{a.value=!0;const s={page:u.value,per_page:f.value};y.value&&(s.search=y.value),b.value&&(s.status=b.value),V.value&&(s.property_type=V.value),D.value&&(s.sortBy=D.value),C.value&&(s.orderBy=C.value);const d=await Q.getProperties(s);d.success&&d.data&&(w.value=d.data.data||[],k.value=d.data.total||0)}catch(s){console.error("Error fetching properties:",s)}finally{a.value=!1}},B=async()=>{const s=w.value.length,d=w.value.filter(J=>J.status==="available").length,N=w.value.filter(J=>J.status==="leased").length,ie=w.value.filter(J=>J.status==="under_negotiation").length;W.value=[{title:"Total Properties",value:String(s),change:0,icon:"tabler-building",iconColor:"primary"},{title:"Available",value:String(d),change:0,icon:"tabler-home-check",iconColor:"success"},{title:"Leased",value:String(N),change:0,icon:"tabler-home-hand",iconColor:"info"},{title:"Under Negotiation",value:String(ie),change:0,icon:"tabler-message-circle",iconColor:"warning"}]},g=s=>{j.value=s,U.value=!0},r=s=>{j.value=s,E.value=!0},L=async()=>{await A(),await B(),x.value=!1},v=async()=>{await A(),await B(),U.value=!1},o=async()=>{await A(),await B(),E.value=!1},z=async()=>{if(c.value.length!==0)try{(await Q.bulkDelete(c.value)).success&&(await A(),await B(),c.value=[])}catch(s){console.error("Error bulk deleting properties:",s)}},i=async s=>{try{(await Q.markLeased(s.id)).success&&(await A(),await B())}catch(d){console.error("Error marking property as leased:",d)}},T=s=>{var d,N;D.value=(d=s.sortBy[0])==null?void 0:d.key,C.value=(N=s.sortBy[0])==null?void 0:N.order,A()},F=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return Se(async()=>{await A(),await B()}),_e([y,b,V],()=>{u.value=1,A()}),(s,d)=>{const N=pe,ie=me,J=he;return S(),ee("section",null,[P("div",Qe,[t(K,null,{default:l(()=>[(S(!0),ee(ae,null,oe(e(W),(n,te)=>(S(),q(p,{key:te,cols:"12",md:"3",sm:"6"},{default:l(()=>[t(G,null,{default:l(()=>[t(H,null,{default:l(()=>[P("div",Xe,[P("div",Ze,[P("div",et,h(n.title),1),P("h4",tt,h(n.value),1)]),t(Ie,{color:n.iconColor,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[t(O,{icon:n.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(G,null,{default:l(()=>[t(ze,{class:"pb-4"},{default:l(()=>[t(Pe,null,{default:l(()=>d[12]||(d[12]=[$("Filters")])),_:1,__:[12]})]),_:1}),t(H,null,{default:l(()=>[t(K,null,{default:l(()=>[t(p,{cols:"12",sm:"3"},{default:l(()=>[t(N,{modelValue:e(b),"onUpdate:modelValue":d[0]||(d[0]=n=>I(b)?b.value=n:null),placeholder:"Select Status",items:[{title:"All Statuses",value:""},{title:"Available",value:"available"},{title:"Under Negotiation",value:"under_negotiation"},{title:"Leased",value:"leased"},{title:"Unavailable",value:"unavailable"}],clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",sm:"3"},{default:l(()=>[t(N,{modelValue:e(V),"onUpdate:modelValue":d[1]||(d[1]=n=>I(V)?V.value=n:null),placeholder:"Property Type",items:[{title:"All Types",value:""},{title:"Retail",value:"retail"},{title:"Office",value:"office"},{title:"Kiosk",value:"kiosk"},{title:"Food Court",value:"food_court"},{title:"Standalone",value:"standalone"}],clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(fe),t(H,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[P("div",lt,[t(N,{"model-value":e(f),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":d[2]||(d[2]=n=>f.value=parseInt(n,10))},null,8,["model-value"]),e(c).length>0?(S(),q(R,{key:0,variant:"tonal",color:"error",onClick:z},{default:l(()=>[t(O,{icon:"tabler-trash",class:"me-2"}),$(" Delete Selected ("+h(e(c).length)+") ",1)]),_:1})):Z("",!0)]),t(re),P("div",at,[P("div",ot,[t(ie,{modelValue:e(y),"onUpdate:modelValue":d[3]||(d[3]=n=>I(y)?y.value=n:null),placeholder:"Search Properties","prepend-inner-icon":"tabler-search"},null,8,["modelValue"])]),t(R,{"prepend-icon":"tabler-plus",onClick:d[4]||(d[4]=n=>x.value=!0)},{default:l(()=>d[13]||(d[13]=[$(" Add Property ")])),_:1,__:[13]})])]),_:1}),t(fe),t(ke,{"items-per-page":e(f),"onUpdate:itemsPerPage":d[6]||(d[6]=n=>I(f)?f.value=n:null),"model-value":e(c),"onUpdate:modelValue":d[7]||(d[7]=n=>I(c)?c.value=n:null),page:e(u),"onUpdate:page":d[8]||(d[8]=n=>I(u)?u.value=n:null),items:e(w),"item-value":"id","items-length":e(k),headers:X,loading:e(a),class:"text-no-wrap","show-select":"","onUpdate:options":T},{"item.index":l(({index:n})=>[P("div",st,h((e(u)-1)*e(f)+n+1),1)]),"item.title":l(({item:n})=>[P("div",rt,h(n.title),1)]),"item.property_type":l(({item:n})=>[t(ve,{size:"small",color:"primary",variant:"tonal"},{default:l(()=>[$(h(n.property_type),1)]),_:2},1024)]),"item.city":l(({item:n})=>[P("div",it,h(n.city),1)]),"item.monthly_rent":l(({item:n})=>[P("div",nt,h(e($e)(n.monthly_rent)),1)]),"item.size_sqm":l(({item:n})=>[P("div",dt,h(n.size_sqm)+" m² ",1)]),"item.status":l(({item:n})=>[t(ve,{size:"small",color:n.status==="available"?"success":n.status==="leased"?"info":n.status==="under_negotiation"?"warning":"error",variant:"tonal"},{default:l(()=>[$(h(n.status.replace("_"," ")),1)]),_:2},1032,["color"])]),"item.created_at":l(({item:n})=>[P("div",ut,h(F(n.created_at)),1)]),"item.actions":l(({item:n})=>[t(R,{icon:"",variant:"text",color:"medium-emphasis",size:"small"},{default:l(()=>[t(O,{icon:"tabler-dots-vertical"}),t(qe,{activator:"parent"},{default:l(()=>[t(Re,null,{default:l(()=>[t(ne,{onClick:te=>g(n)},{prepend:l(()=>[t(O,{icon:"tabler-edit"})]),default:l(()=>[t(de,null,{default:l(()=>d[14]||(d[14]=[$("Edit")])),_:1,__:[14]})]),_:2},1032,["onClick"]),n.status!=="leased"?(S(),q(ne,{key:0,onClick:te=>i(n)},{prepend:l(()=>[t(O,{icon:"tabler-home-check"})]),default:l(()=>[t(de,null,{default:l(()=>d[15]||(d[15]=[$("Mark as Leased")])),_:1,__:[15]})]),_:2},1032,["onClick"])):Z("",!0),t(ne,{onClick:te=>r(n)},{prepend:l(()=>[t(O,{icon:"tabler-trash",color:"error"})]),default:l(()=>[t(de,{class:"text-error"},{default:l(()=>d[16]||(d[16]=[$(" Delete ")])),_:1,__:[16]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:l(()=>[t(J,{page:e(u),"onUpdate:page":d[5]||(d[5]=n=>I(u)?u.value=n:null),"items-per-page":e(f),"total-items":e(k)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),t(Me,{"is-dialog-visible":e(x),"onUpdate:isDialogVisible":d[9]||(d[9]=n=>I(x)?x.value=n:null),onPropertyCreated:L},null,8,["is-dialog-visible"]),t(Ke,{"is-dialog-visible":e(U),"onUpdate:isDialogVisible":d[10]||(d[10]=n=>I(U)?U.value=n:null),property:e(j),onPropertyUpdated:v},null,8,["is-dialog-visible","property"]),t(He,{"is-dialog-visible":e(E),"onUpdate:isDialogVisible":d[11]||(d[11]=n=>I(E)?E.value=n:null),property:e(j),onPropertyDeleted:o},null,8,["is-dialog-visible","property"])])}}});export{Mt as default};
