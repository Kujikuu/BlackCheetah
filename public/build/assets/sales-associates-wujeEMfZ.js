import{_ as we,V as le}from"./VDialog-CpdD25yY.js";import{V as Ce,_ as Ae}from"./VDataTableServer-DO7FSF6g.js";import{_ as Se}from"./AppTextField.vue_vue_type_script_setup_true_lang-CrhyYF4c.js";import{_ as ke}from"./AppSelect.vue_vue_type_script_setup_true_lang-Bz4_qTpH.js";import{d as he,g as d,O as ae,E as Ee,w as Le,c as R,o as _,y as l,k as a,q as m,aM as x,i as s,l as i,a as U,h as F,a7 as w,av as C,t as r,F as Ue,r as De,bb as $e}from"./main-BYpBSAj5.js";import{_ as Pe}from"./ConfirmDeleteDialog.vue_vue_type_script_setup_true_lang-ChT5AQ89.js";import{u as D}from"./users-BZOt9mxA.js";import{a as se}from"./formatters--UtN2sCw.js";import{a as Te,d as Ie,f as N,b as oe,e as qe,V as j,h as ie}from"./VCard-Ca_zP91K.js";import{V as Q,a as v}from"./VRow-BqYOgTz2.js";import{V as K}from"./VDivider-DekgMQwS.js";import{V as Y}from"./VSpacer-DHG0No5I.js";import{V as ne}from"./VMenu-BmvlNcnX.js";import{V as re,a as z,b as M}from"./VList-CIyV_jON.js";import{V as J}from"./VChip-CIWZSwOd.js";import{V as Be}from"./VTable-B2PHCaSR.js";import{V as Fe}from"./VForm-BOJkEg2X.js";import"./VOverlay-fzIdOlHt.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-DntWhGWm.js";import"./VDataTable-BtxFyHeU.js";import"./VSelect-B4XFvlOB.js";import"./VTextField-DyLIUBXh.js";import"./VField-eqPlPWcK.js";import"./form-3qejRGpX.js";import"./VInput-DSHxIYJN.js";import"./VCheckboxBtn-BGrXAimH.js";import"./VSelectionControl-BOWDk1vX.js";import"./api-router-DcsSUdgO.js";/* empty css              */import"./VSlideGroup-BvgzkMEi.js";const Ne={class:"me-3 d-flex gap-3"},ze={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Me={style:{"inline-size":"15.625rem"}},Oe={class:"d-flex align-center gap-x-4"},Re={key:1},je={class:"d-flex flex-column"},Qe={class:"text-base font-weight-medium"},Je={class:"text-body-1"},Ke={class:"text-body-1"},Ye={class:"text-body-1 font-weight-medium"},We={class:"d-flex align-center gap-4 mb-6"},Ge={class:"text-h4"},He={class:"text-h4 mb-1"},Xe={class:"mb-4"},Ze={class:"text-body-1"},et={class:"mb-4"},tt={class:"text-body-1"},lt={class:"mb-4"},at={class:"text-body-1"},st={class:"mb-4"},ot={class:"text-body-1"},it={class:"mb-4"},nt={class:"text-body-1"},rt={class:"mb-4"},ut={class:"text-body-1"},Ot=he({__name:"sales-associates",setup(dt){const $=d(""),P=d(),A=d(10),b=d(1),W=d(),G=d(),c=d([]),O=d(!1),g=d(!1);d(!1);const T=d(),ue=n=>{var e,u;W.value=(e=n.sortBy[0])==null?void 0:e.key,G.value=(u=n.sortBy[0])==null?void 0:u.order,I()},de=[{title:"Sales Associate",key:"name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Status",key:"status"},{title:"Assigned Leads",key:"assignedLeads"},{title:"Actions",key:"actions",sortable:!1}],V=d({associates:[],total:0}),S=ae(()=>V.value.associates),H=ae(()=>V.value.total),ce=n=>({new:"primary",contacted:"info",qualified:"warning",converted:"success",lost:"error",follow_up:"secondary"})[n]||"default",me=n=>({low:"success",medium:"warning",high:"error"})[n]||"default",I=async()=>{try{O.value=!0;const n=await D.getSalesAssociatesWithFilters({page:b.value,per_page:A.value,search:$.value||void 0,status:P.value||void 0,sort_by:W.value||void 0,order_by:G.value||void 0});if(n.success&&n.data){const e=n.data;V.value={associates:e.data||[],total:e.total||0}}else V.value={associates:[],total:0}}catch(n){console.error("Error fetching sales associates:",n),V.value={associates:[],total:0}}finally{O.value=!1}},X=[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],ve=[{title:"Saudi Arabia",value:"Saudi Arabia"},{title:"United Arab Emirates",value:"United Arab Emirates"},{title:"Qatar",value:"Qatar"},{title:"Kuwait",value:"Kuwait"},{title:"Oman",value:"Oman"},{title:"Bahrain",value:"Bahrain"},{title:"Jordan",value:"Jordan"},{title:"Lebanon",value:"Lebanon"},{title:"Egypt",value:"Egypt"},{title:"Iraq",value:"Iraq"},{title:"Palestine",value:"Palestine"},{title:"Syria",value:"Syria"},{title:"Yemen",value:"Yemen"},{title:"Iran",value:"Iran"}],Z=n=>{const e=n.toLowerCase();return e==="active"?"success":e==="inactive"?"secondary":"primary"},q=d(!1),h=d(null),pe=n=>{h.value=n,q.value=!0},fe=async()=>{if(h.value!==null)try{if(g.value=!0,(await D.deleteSalesAssociate(h.value)).success){const e=V.value.associates.findIndex(p=>p.id===h.value);e!==-1&&(V.value.associates.splice(e,1),V.value.total-=1);const u=c.value.findIndex(p=>p===h.value);u!==-1&&c.value.splice(u,1),console.log("Sales associate deleted successfully")}}catch(n){console.error("Error deleting sales associate:",n)}finally{g.value=!1,q.value=!1,h.value=null}},k=d(!1),E=d(!1),L=d(!1),o=d(null),ye=async n=>{if(n===null)return;const e=S.value.find(u=>u.id===n);if(e&&e.id!==null)try{O.value=!0;const u=await D.getSalesAssociateDetails(e.id);u.success&&(o.value=u.data,k.value=!0)}catch(u){console.error("Error fetching associate details:",u),o.value=e,k.value=!0}finally{O.value=!1}},ee=n=>{if(n===null)return;const e=S.value.find(u=>u.id===n);e&&(o.value={...e},E.value=!0)},_e=()=>{o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",assignedLeads:0,avatar:"",password:""},L.value=!0},te=async()=>{if(o.value){if(T.value){const{valid:n}=await T.value.validate();if(!n)return}try{g.value=!0;const n=o.value.id!==null,e={name:o.value.name,email:o.value.email,phone:o.value.phone,status:o.value.status,country:o.value.country||"",state:o.value.state||"",city:o.value.city||""};!n&&o.value.password&&(e.password=o.value.password),(n?await D.updateSalesAssociate(o.value.id,e):await D.createSalesAssociate(e)).success&&(T.value&&T.value.reset(),L.value=!1,E.value=!1,o.value={id:null,name:"",email:"",phone:"",status:"active",country:"",state:"",city:"",password:"",assignedLeads:0,avatar:"",avatarText:""},await I(),console.log(n?"Associate updated successfully":"Associate created successfully"))}catch(n){console.error("Error saving associate:",n)}finally{g.value=!1}}},be=()=>{const e=["Name,Email,Phone,Status,Country,State,City,Assigned Leads",...(c.value.length>0?S.value.filter(f=>c.value.includes(f.id)):S.value).map(f=>`"${f.name}","${f.email}","${f.phone}","${f.status}","${f.country||""}","${f.state||""}","${f.city||""}","${f.assignedLeads}"`)].join(`
`),u=new Blob([e],{type:"text/csv"}),p=window.URL.createObjectURL(u),B=document.createElement("a");B.href=p,B.download=`sales_associates_${c.value.length>0?"selected":"all"}_${new Date().toISOString().split("T")[0]}.csv`,B.click(),window.URL.revokeObjectURL(p)},ge=()=>{const n=c.value.length>0?S.value.filter(e=>c.value.includes(e.id)):S.value;console.log("Exporting to PDF:",n)},Ve=async()=>{if(c.value.length!==0)try{g.value=!0;for(const n of c.value)n!==null&&await D.deleteSalesAssociate(n);await I(),c.value=[],console.log("Sales associates deleted successfully")}catch(n){console.error("Error bulk deleting associates:",n)}finally{g.value=!1}},xe=async()=>{await fe()};return Ee(()=>{I()}),Le([$,P],()=>{b.value=1,I()}),(n,e)=>{const u=ke,p=Se,B=Ae,f=we;return _(),R("section",null,[l(j,{class:"mb-6"},{default:a(()=>[l(Te,{class:"pb-4"},{default:a(()=>[l(Ie,null,{default:a(()=>e[23]||(e[23]=[m("Filters")])),_:1,__:[23]})]),_:1}),l(N,null,{default:a(()=>[l(Q,null,{default:a(()=>[l(v,{cols:"12",sm:"6"},{default:a(()=>[l(u,{modelValue:s(P),"onUpdate:modelValue":e[0]||(e[0]=t=>x(P)?P.value=t:null),placeholder:"Select Status",items:X,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(K),l(N,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[i("div",Ne,[l(u,{"model-value":s(A),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=t=>A.value=parseInt(t,10))},null,8,["model-value"]),s(c).length>0?(_(),U(w,{key:0,variant:"tonal",color:"error",onClick:Ve},{default:a(()=>[l(C,{icon:"tabler-trash",class:"me-2"}),m(" Delete Selected ("+r(s(c).length)+") ",1)]),_:1})):F("",!0)]),l(Y),i("div",ze,[i("div",Me,[l(p,{modelValue:s($),"onUpdate:modelValue":e[2]||(e[2]=t=>x($)?$.value=t:null),placeholder:"Search Sales Associate"},null,8,["modelValue"])]),l(w,{variant:"tonal",color:"secondary"},{default:a(()=>[l(C,{icon:"tabler-upload",class:"me-2"}),m(" Export "+r(s(c).length>0?`(${s(c).length})`:"All")+" ",1),l(ne,{activator:"parent"},{default:a(()=>[l(re,null,{default:a(()=>[l(z,{onClick:be},{prepend:a(()=>[l(C,{icon:"tabler-file-type-csv"})]),default:a(()=>[l(M,null,{default:a(()=>e[24]||(e[24]=[m("Export to CSV")])),_:1,__:[24]})]),_:1}),l(z,{onClick:ge},{prepend:a(()=>[l(C,{icon:"tabler-file-type-pdf"})]),default:a(()=>[l(M,null,{default:a(()=>e[25]||(e[25]=[m("Export to PDF")])),_:1,__:[25]})]),_:1})]),_:1})]),_:1})]),_:1}),l(w,{"prepend-icon":"tabler-plus",onClick:_e},{default:a(()=>e[26]||(e[26]=[m(" Add Sales Associate ")])),_:1,__:[26]})])]),_:1}),l(K),l(Ce,{"items-per-page":s(A),"onUpdate:itemsPerPage":e[4]||(e[4]=t=>x(A)?A.value=t:null),"model-value":s(c),"onUpdate:modelValue":e[5]||(e[5]=t=>x(c)?c.value=t:null),page:s(b),"onUpdate:page":e[6]||(e[6]=t=>x(b)?b.value=t:null),items:s(S),"item-value":"id","items-length":s(H),headers:de,class:"text-no-wrap","show-select":"","onUpdate:options":ue},{"item.name":a(({item:t})=>[i("div",Oe,[l(oe,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:"primary"},{default:a(()=>[t.avatar?(_(),U(qe,{key:0,src:t.avatar},null,8,["src"])):(_(),R("span",Re,r(s(se)(t.name)),1))]),_:2},1032,["variant","color"]),i("div",je,[i("h6",Qe,r(t.name),1)])])]),"item.email":a(({item:t})=>[i("div",Je,r(t.email),1)]),"item.phone":a(({item:t})=>[i("div",Ke,r(t.phone),1)]),"item.status":a(({item:t})=>[l(J,{color:Z(t.status),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[m(r(t.status),1)]),_:2},1032,["color"])]),"item.assignedLeads":a(({item:t})=>[i("div",Ye,r(t.assignedLeads),1)]),"item.actions":a(({item:t})=>[l(w,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[l(C,{icon:"tabler-dots-vertical"}),l(ne,{activator:"parent"},{default:a(()=>[l(re,null,{default:a(()=>[l(z,{onClick:y=>ye(t.id)},{prepend:a(()=>[l(C,{icon:"tabler-eye"})]),default:a(()=>[l(M,null,{default:a(()=>e[27]||(e[27]=[m("View")])),_:1,__:[27]})]),_:2},1032,["onClick"]),l(z,{onClick:y=>ee(t.id)},{prepend:a(()=>[l(C,{icon:"tabler-pencil"})]),default:a(()=>[l(M,null,{default:a(()=>e[28]||(e[28]=[m("Edit")])),_:1,__:[28]})]),_:2},1032,["onClick"]),l(z,{onClick:y=>t.id!==null&&pe(t.id)},{prepend:a(()=>[l(C,{icon:"tabler-trash"})]),default:a(()=>[l(M,null,{default:a(()=>e[29]||(e[29]=[m("Delete")])),_:1,__:[29]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[l(B,{page:s(b),"onUpdate:page":e[3]||(e[3]=t=>x(b)?b.value=t:null),"items-per-page":s(A),"total-items":s(H)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1}),l(le,{modelValue:s(k),"onUpdate:modelValue":e[10]||(e[10]=t=>x(k)?k.value=t:null),"max-width":"600"},{default:a(()=>[l(f,{onClick:e[7]||(e[7]=t=>k.value=!1)}),s(o)?(_(),U(j,{key:0,title:"Sales Associate Details"},{default:a(()=>[l(N,null,{default:a(()=>[l(Q,null,{default:a(()=>[l(v,{cols:"12"},{default:a(()=>{var t;return[i("div",We,[l(oe,{size:"80",variant:"tonal",color:"primary"},{default:a(()=>[i("span",Ge,r(s(se)(s(o).name)),1)]),_:1}),i("div",null,[i("h4",He,r(s(o).name),1),l(J,{color:Z(((t=s(o))==null?void 0:t.status)||""),size:"small",label:"",class:"text-capitalize"},{default:a(()=>[m(r(s(o).status),1)]),_:1},8,["color"])])])]}),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",Xe,[e[30]||(e[30]=i("div",{class:"text-sm text-disabled mb-1"}," Email ",-1)),i("div",Ze,r(s(o).email),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",et,[e[31]||(e[31]=i("div",{class:"text-sm text-disabled mb-1"}," Phone ",-1)),i("div",tt,r(s(o).phone),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",lt,[e[32]||(e[32]=i("div",{class:"text-sm text-disabled mb-1"}," Country ",-1)),i("div",at,r(s(o).country||"Not specified"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",st,[e[33]||(e[33]=i("div",{class:"text-sm text-disabled mb-1"}," State ",-1)),i("div",ot,r(s(o).state||"Not specified"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",it,[e[34]||(e[34]=i("div",{class:"text-sm text-disabled mb-1"}," City ",-1)),i("div",nt,r(s(o).city||"Not specified"),1)])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[i("div",rt,[e[35]||(e[35]=i("div",{class:"text-sm text-disabled mb-1"}," Assigned Leads ",-1)),i("div",ut,r(s(o).assignedLeads),1)])]),_:1})]),_:1}),s(o).leads&&s(o).leads.length>0?(_(),U(Q,{key:0},{default:a(()=>[l(v,{cols:"12"},{default:a(()=>[l(K,{class:"my-4"}),e[37]||(e[37]=i("div",{class:"text-h6 mb-4"}," Assigned Leads ",-1)),l(j,{variant:"outlined"},{default:a(()=>[l(N,{class:"pa-0"},{default:a(()=>[l(Be,null,{default:a(()=>{var t;return[e[36]||(e[36]=i("thead",null,[i("tr",null,[i("th",null,"Name"),i("th",null,"Email"),i("th",null,"Status"),i("th",null,"Priority")])],-1)),i("tbody",null,[(_(!0),R(Ue,null,De(((t=s(o))==null?void 0:t.leads)||[],y=>(_(),R("tr",{key:y.id},[i("td",null,r(y.first_name)+" "+r(y.last_name),1),i("td",null,r(y.email),1),i("td",null,[l(J,{color:ce(y.status),size:"small",class:"text-capitalize"},{default:a(()=>[m(r(y.status.replace("_"," ")),1)]),_:2},1032,["color"])]),i("td",null,[l(J,{color:me(y.priority),size:"small",class:"text-capitalize"},{default:a(()=>[m(r(y.priority),1)]),_:2},1032,["color"])])]))),128))])]}),_:1,__:[36]})]),_:1})]),_:1})]),_:1,__:[37]})]),_:1})):F("",!0)]),_:1}),l(ie,null,{default:a(()=>[l(Y),l(w,{color:"secondary",variant:"tonal",onClick:e[8]||(e[8]=t=>k.value=!1)},{default:a(()=>e[38]||(e[38]=[m(" Close ")])),_:1,__:[38]}),l(w,{color:"primary",onClick:e[9]||(e[9]=t=>ee(s(o).id))},{default:a(()=>e[39]||(e[39]=[m(" Edit ")])),_:1,__:[39]})]),_:1})]),_:1})):F("",!0)]),_:1},8,["modelValue"]),l(le,{"model-value":s(L)||s(E),"max-width":"600",persistent:"","onUpdate:modelValue":e[21]||(e[21]=t=>{t||(L.value=!1,E.value=!1)})},{default:a(()=>[l(f,{onClick:e[11]||(e[11]=t=>{L.value=!1,E.value=!1})}),s(o)?(_(),U(j,{key:0,title:s(o).id===null?"Add New":"Edit Sales Associate"},{default:a(()=>[l(N,null,{default:a(()=>[l(Fe,{ref_key:"associateForm",ref:T,onSubmit:$e(te,["prevent"])},{default:a(()=>[l(Q,null,{default:a(()=>[l(v,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).name,"onUpdate:modelValue":e[12]||(e[12]=t=>s(o).name=t),label:"Full Name",placeholder:"Enter full name",rules:[t=>!!t||"Full name is required",t=>t.length<=255||"Name must not exceed 255 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).email,"onUpdate:modelValue":e[13]||(e[13]=t=>s(o).email=t),label:"Email Address",type:"email",placeholder:"Enter email address",rules:[t=>!!t||"Email is required",t=>/.+@.+\..+/.test(t)||"Email must be valid"],required:""},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).phone,"onUpdate:modelValue":e[14]||(e[14]=t=>s(o).phone=t),label:"Phone Number",placeholder:"+966 50 123 4567",rules:[t=>!!t||"Phone number is required",t=>t.length<=20||"Phone number must not exceed 20 characters"],required:""},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(u,{modelValue:s(o).status,"onUpdate:modelValue":e[15]||(e[15]=t=>s(o).status=t),label:"Status",items:X,placeholder:"Select status",rules:[t=>!!t||"Status is required"],required:""},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(u,{modelValue:s(o).country,"onUpdate:modelValue":e[16]||(e[16]=t=>s(o).country=t),label:"Country",items:ve,placeholder:"Select country"},null,8,["modelValue"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).state,"onUpdate:modelValue":e[17]||(e[17]=t=>s(o).state=t),label:"State/Province",placeholder:"Enter state or province",rules:[t=>!t||t.length<=100||"State must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).city,"onUpdate:modelValue":e[18]||(e[18]=t=>s(o).city=t),label:"City",placeholder:"Enter city",rules:[t=>!t||t.length<=100||"City must not exceed 100 characters"]},null,8,["modelValue","rules"])]),_:1}),s(o).id===null?(_(),U(v,{key:0,cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:s(o).password,"onUpdate:modelValue":e[19]||(e[19]=t=>s(o).password=t),label:"Password",type:"password",placeholder:"Enter password (minimum 8 characters)",rules:[t=>!!t||"Password is required",t=>t.length>=8||"Password must be at least 8 characters"],required:""},null,8,["modelValue","rules"])]),_:1})):F("",!0)]),_:1})]),_:1},512)]),_:1}),l(ie,null,{default:a(()=>[l(Y),l(w,{color:"secondary",variant:"tonal",disabled:s(g),onClick:e[20]||(e[20]=t=>{L.value=!1,E.value=!1})},{default:a(()=>e[40]||(e[40]=[m(" Cancel ")])),_:1,__:[40]},8,["disabled"]),l(w,{color:"primary",loading:s(g),onClick:te},{default:a(()=>[m(r(s(o).id===null?"Create Associate":"Save Changes"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])):F("",!0)]),_:1},8,["model-value"]),l(Pe,{"is-dialog-visible":s(q),"onUpdate:isDialogVisible":e[22]||(e[22]=t=>x(q)?q.value=t:null),title:"Confirm Delete Sales Associate",message:"Are you sure you want to delete this sales associate? This action cannot be undone.",onConfirm:xe},null,8,["is-dialog-visible"])])}}});export{Ot as default};
