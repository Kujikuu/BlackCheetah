import{a_ as z,d as S,g as y,O as A,E as U,c as x,o as r,y as t,a as v,h,k as a,be as $,aI as E,i as n,l as e,av as c,t as i,F as I,r as R,q as k,a7 as D}from"./main-CaTcLKNL.js";import{f as O}from"./formatters-aoHiJebZ.js";import{V as P}from"./VOverlay-c5fY-XMP.js";import{a as p,V}from"./VRow-DYWQ7lCi.js";import{V as _,f as g,b as m}from"./VCard-CS_ziklW.js";import{V as q}from"./VChip-D2ZQ5d-y.js";import{V as w}from"./VDivider-BQAl4UcD.js";import{V as G}from"./VSwitch-B5oGvEkW.js";import{V as H}from"./VSnackbar-DYYi6jLU.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-CbLIAOEw.js";/* empty css              */import"./VSlideGroup-D0UXYeax.js";import"./VInput-DPlCwJR6.js";import"./form-C-6-1AEV.js";import"./VSelectionControl-CpeLtBMS.js";class Y{async getAssignedFranchises(){return await z("/v1/broker/assigned-franchises",{method:"GET"})}async toggleMarketplaceListing(d){return await z(`/v1/broker/franchises/${d}/marketplace-toggle`,{method:"PATCH"})}}const L=new Y,J={class:"ms-4"},K={class:"text-h4"},Q={class:"ms-4"},W={class:"text-h4"},X={class:"ms-4"},Z={class:"text-h4"},ee={class:"d-flex align-center mb-4"},se={class:"flex-grow-1"},te={class:"text-h6 mb-1"},ae={class:"text-body-2 text-medium-emphasis mb-0"},oe={class:"mb-4"},le={class:"d-flex justify-space-between mb-2"},ie={class:"text-body-2 font-weight-medium"},ne={class:"d-flex justify-space-between mb-2"},de={class:"text-body-2 font-weight-medium text-success"},re={class:"d-flex justify-space-between mb-2"},ce={class:"text-body-2 font-weight-medium"},ue={class:"d-flex justify-space-between mb-2"},me={class:"text-body-2 font-weight-medium"},fe={key:0,class:"mb-4"},pe={class:"d-flex align-center"},_e={class:"text-body-2 font-weight-medium"},ge={class:"text-caption text-medium-emphasis"},be={class:"d-flex align-center justify-space-between"},ye={class:"d-flex align-center"},ve={class:"text-body-2"},$e=S({__name:"assigned-franchises",setup(M){const d=y(!0),f=y([]),F=y(0),u=y({show:!1,message:"",color:"success"}),b=(l,s="success")=>{u.value={show:!0,message:l,color:s}},C=async()=>{try{d.value=!0;const l=await L.getAssignedFranchises();l.success&&l.data&&(f.value=l.data.data||[],F.value=l.data.total||0)}catch(l){console.error("Failed to load assigned franchises:",l),b("Failed to load assigned franchises","error")}finally{d.value=!1}},j=async l=>{try{const s=await L.toggleMarketplaceListing(l.id);s.success?(b(s.message||"Marketplace listing updated","success"),await C()):b(s.message||"Failed to update marketplace listing","error")}catch(s){console.error("Failed to toggle marketplace listing:",s),b("Failed to update marketplace listing","error")}},B=A(()=>f.value.filter(l=>l.is_marketplace_listed).length),N=A(()=>f.value.filter(l=>l.status==="active").length);U(()=>{C()});const T=l=>l==="active"?"success":l==="inactive"?"warning":l==="pending"?"info":"secondary";return(l,s)=>(r(),x("section",null,[t(P,{modelValue:n(d),"onUpdate:modelValue":s[0]||(s[0]=o=>E(d)?d.value=o:null),class:"align-center justify-center"},{default:a(()=>[t($,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["modelValue"]),t(V,{class:"mb-6"},{default:a(()=>[t(p,{cols:"12"},{default:a(()=>s[3]||(s[3]=[e("div",null,[e("h2",{class:"text-h2 mb-1"}," Assigned Franchises "),e("p",{class:"text-body-1 text-medium-emphasis"}," Manage marketplace listings for franchises assigned to you ")],-1)])),_:1,__:[3]})]),_:1}),t(V,{class:"mb-6"},{default:a(()=>[t(p,{cols:"12",md:"4"},{default:a(()=>[t(_,null,{default:a(()=>[t(g,{class:"d-flex align-center"},{default:a(()=>[t(m,{size:"44",rounded:"",color:"primary",variant:"tonal"},{default:a(()=>[t(c,{icon:"tabler-building-store",size:"26"})]),_:1}),e("div",J,[s[4]||(s[4]=e("div",{class:"text-body-2 text-disabled"}," Total Franchises ",-1)),e("h4",K,i(n(F)),1)])]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"4"},{default:a(()=>[t(_,null,{default:a(()=>[t(g,{class:"d-flex align-center"},{default:a(()=>[t(m,{size:"44",rounded:"",color:"success",variant:"tonal"},{default:a(()=>[t(c,{icon:"tabler-circle-check",size:"26"})]),_:1}),e("div",Q,[s[5]||(s[5]=e("div",{class:"text-body-2 text-disabled"}," Listed on Marketplace ",-1)),e("h4",W,i(n(B)),1)])]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"4"},{default:a(()=>[t(_,null,{default:a(()=>[t(g,{class:"d-flex align-center"},{default:a(()=>[t(m,{size:"44",rounded:"",color:"info",variant:"tonal"},{default:a(()=>[t(c,{icon:"tabler-chart-line",size:"26"})]),_:1}),e("div",X,[s[6]||(s[6]=e("div",{class:"text-body-2 text-disabled"}," Active Franchises ",-1)),e("h4",Z,i(n(N)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),n(f).length>0?(r(),v(V,{key:0},{default:a(()=>[(r(!0),x(I,null,R(n(f),o=>(r(),v(p,{key:o.id,cols:"12",md:"6",lg:"4"},{default:a(()=>[t(_,null,{default:a(()=>[t(g,null,{default:a(()=>[e("div",ee,[t(m,{size:"48",image:o.logo||void 0,color:"primary",variant:"tonal",class:"me-3"},{default:a(()=>[o.logo?h("",!0):(r(),v(c,{key:0,icon:"tabler-building-store",size:"28"}))]),_:2},1032,["image"]),e("div",se,[e("h6",te,i(o.brand_name),1),e("p",ae,i(o.business_name),1)]),t(q,{color:T(o.status),size:"small",variant:"tonal"},{default:a(()=>[k(i(o.status),1)]),_:2},1032,["color"])]),t(w,{class:"mb-4"}),e("div",oe,[e("div",le,[s[7]||(s[7]=e("span",{class:"text-body-2 text-disabled"},"Industry",-1)),e("span",ie,i(o.industry),1)]),e("div",ne,[s[8]||(s[8]=e("span",{class:"text-body-2 text-disabled"},"Franchise Fee",-1)),e("span",de,i(n(O)(o.franchise_fee)),1)]),e("div",re,[s[9]||(s[9]=e("span",{class:"text-body-2 text-disabled"},"Royalty",-1)),e("span",ce,i(o.royalty_percentage)+"%",1)]),e("div",ue,[s[10]||(s[10]=e("span",{class:"text-body-2 text-disabled"},"Total Units",-1)),e("span",me,i(o.total_units)+" ("+i(o.active_units)+" active)",1)])]),t(w,{class:"mb-4"}),o.franchisor?(r(),x("div",fe,[s[11]||(s[11]=e("div",{class:"text-body-2 text-disabled mb-2"}," Franchisor ",-1)),e("div",pe,[t(m,{size:"32",color:"secondary",variant:"tonal",class:"me-2"},{default:a(()=>[t(c,{icon:"tabler-user",size:"18"})]),_:1}),e("div",null,[e("div",_e,i(o.franchisor.name),1),e("div",ge,i(o.franchisor.email),1)])])])):h("",!0),t(w,{class:"mb-4"}),e("div",null,[e("div",be,[e("div",ye,[t(c,{icon:o.is_marketplace_listed?"tabler-eye":"tabler-eye-off",color:o.is_marketplace_listed?"success":"secondary",size:"20",class:"me-2"},null,8,["icon","color"]),e("span",ve,i(o.is_marketplace_listed?"Listed on Marketplace":"Not Listed"),1)]),t(G,{"model-value":o.is_marketplace_listed,color:"success","hide-details":"",inset:"","onUpdate:modelValue":xe=>j(o)},null,8,["model-value","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):n(d)?h("",!0):(r(),v(_,{key:1},{default:a(()=>[t(g,{class:"text-center py-16"},{default:a(()=>[t(m,{size:"80",color:"secondary",variant:"tonal",class:"mb-4"},{default:a(()=>[t(c,{icon:"tabler-building-off",size:"48"})]),_:1}),s[12]||(s[12]=e("h5",{class:"text-h5 mb-2"}," No Franchises Assigned ",-1)),s[13]||(s[13]=e("p",{class:"text-body-1 text-medium-emphasis mb-0"}," You don't have any franchises assigned to you yet. Contact your administrator to get franchises assigned. ",-1))]),_:1,__:[12,13]})]),_:1})),t(H,{modelValue:n(u).show,"onUpdate:modelValue":s[2]||(s[2]=o=>n(u).show=o),color:n(u).color,location:"top end",timeout:"4000"},{actions:a(()=>[t(D,{color:"white",variant:"text",onClick:s[1]||(s[1]=o=>n(u).show=!1)},{default:a(()=>s[14]||(s[14]=[k(" Close ")])),_:1,__:[14]})]),default:a(()=>[k(i(n(u).message)+" ",1)]),_:1},8,["modelValue","color"])]))}});export{$e as default};
