import{_ as ne}from"./AppSelect.vue_vue_type_script_setup_true_lang-DL-DX4eG.js";import{K as A,L,ct as se,ao as N,an as oe,ai as re,M,y as l,av as B,ax as ce,ac as G,cu as H,ad as J,$ as O,R as Q,bg as de,W as ue,g,w as X,Y as w,b4 as Z,bj as me,bn as fe,ce as ve,a9 as he,az as ye,aa as v,O as P,b3 as _e,ci as ke,bi as Ce,d as ge,e as be,bb as pe,E as Ve,c as x,o as k,l as f,k as n,F as E,r as F,i as S,a as T,t as C,q as p,aI as De,h as q,a7 as $}from"./main-C_m4DwnX.js";import{f as Se}from"./franchise-HjD0zH0X.js";import{a as Te,V as we}from"./VRow-CiO-FbWu.js";import{V as U,f as R,b as K,d as W,a as Y,g as ze}from"./VCard-SlzzMb5H.js";import{V as Ie}from"./VChip-bNZZiaKp.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-DYCB4Gfc.js";import"./VSelect-Cdrlsxi4.js";import"./VTextField-DqjZ8OOj.js";import"./VField-DvEiP886.js";import"./VInput-BI41h3_F.js";import"./VList-CKyyLZkF.js";import"./VDivider-DrLnT-Ac.js";import"./VMenu-nkRY6JLl.js";import"./VCheckboxBtn-q5wTK24I.js";import"./VSelectionControl-Dh4iX8GB.js";import"./api-router-B3QnVntj.js";import"./VSlideGroup-BekFRdKS.js";const $e=L({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Q,iconColor:String,lineColor:String,...O(),...J(),...H(),...G()},"VTimelineDivider"),Re=A()({name:"VTimelineDivider",props:$e(),setup(e,s){let{slots:o}=s;const{sizeClasses:h,sizeStyles:y}=se(e,"v-timeline-divider__dot"),{backgroundColorStyles:_,backgroundColorClasses:r}=N(()=>e.dotColor),{roundedClasses:u}=oe(e,"v-timeline-divider__dot"),{elevationClasses:m}=re(e),{backgroundColorClasses:b,backgroundColorStyles:V}=N(()=>e.lineColor);return M(()=>l("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class],style:e.style},[l("div",{class:["v-timeline-divider__before",b.value],style:V.value},null),!e.hideDot&&l("div",{key:"dot",class:["v-timeline-divider__dot",m.value,u.value,h.value],style:y.value},[l("div",{class:["v-timeline-divider__inner-dot",r.value,u.value],style:_.value},[o.default?l(ce,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},o.default):l(B,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),l("div",{class:["v-timeline-divider__after",b.value],style:V.value},null)])),{}}}),ee=L({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Q,iconColor:String,lineInset:[Number,String],side:{type:String,validator:e=>e==null||["start","end"].includes(e)},...O(),...me(),...G(),...J(),...H(),...Z()},"VTimelineItem"),Be=A()({name:"VTimelineItem",props:ee(),setup(e,s){let{slots:o}=s;const{dimensionStyles:h}=de(e),y=ue(0),_=g();return X(_,r=>{var u;r&&(y.value=((u=r.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:u.getBoundingClientRect().width)??0)},{flush:"post"}),M(()=>{var r,u;return l("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot,"v-timeline-item--side-start":e.side==="start","v-timeline-item--side-end":e.side==="end"},e.class],style:[{"--v-timeline-dot-size":w(y.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${w(e.lineInset)})`:w(0)},e.style]},[l("div",{class:"v-timeline-item__body",style:h.value},[(r=o.default)==null?void 0:r.call(o)]),l(Re,{ref:_,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:o.icon}),e.density!=="compact"&&l("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((u=o.opposite)==null?void 0:u.call(o))])])}),{}}}),Pe=L({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...Ce(ee({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...O(),...ke(),...Z(),..._e()},"VTimeline"),Ae=A()({name:"VTimeline",props:Pe(),setup(e,s){let{slots:o}=s;const{themeClasses:h}=fe(e),{densityClasses:y}=ve(e),{rtlClasses:_}=he();ye({VTimelineDivider:{lineColor:v(()=>e.lineColor)},VTimelineItem:{density:v(()=>e.density),dotColor:v(()=>e.dotColor),fillDot:v(()=>e.fillDot),hideOpposite:v(()=>e.hideOpposite),iconColor:v(()=>e.iconColor),lineColor:v(()=>e.lineColor),lineInset:v(()=>e.lineInset),size:v(()=>e.size)}});const r=P(()=>{const m=e.side?e.side:e.density!=="default"?"end":null;return m&&`v-timeline--side-${m}`}),u=P(()=>{const m=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return m;case"start":return m[0];case"end":return m[1];default:return null}});return M(()=>l(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,u.value,{"v-timeline--inset-line":!!e.lineInset},h.value,y.value,r.value,_.value,e.class],style:[{"--v-timeline-line-thickness":w(e.lineThickness)},e.style]},o)),{}}}),Le={class:"d-flex justify-space-between align-center"},Me={class:"text-body-1 text-high-emphasis mb-1"},Oe={class:"text-h4"},je={style:{"inline-size":"10rem"}},Ne={class:"d-flex flex-column"},Ee={class:"app-timeline-meta text-sm font-weight-medium"},Fe={class:"app-timeline-meta text-xs"},qe={class:"v-timeline-avatar-wrapper rounded-circle"},Ue={class:"app-timeline-text mb-0"},Ke=ge({__name:"timeline",setup(e){const s=be(),o=g(null),h=g(!1),y=async()=>{h.value=!0;try{const i=await Se.getDashboardTimeline();o.value=i}catch(i){console.error("Error fetching timeline data:",i),o.value=null}finally{h.value=!1}},{smAndDown:_}=pe(),r=g("all"),u=[{title:"All",value:"all"},{title:"Completed",value:"completed"},{title:"Scheduled",value:"scheduled"},{title:"Overdue",value:"overdue"}],m=g([]),b=g([{title:"Total Milestones",value:"0",icon:"tabler-flag",color:"primary"},{title:"Completed",value:"0",icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:"0",icon:"tabler-calendar",color:"info"},{title:"Overdue",value:"0",icon:"tabler-alert-triangle",color:"error"}]),V=i=>{switch(i.toLowerCase()){case"completed":return"success";case"scheduled":return"info";case"overdue":return"error";default:return"primary"}},te=i=>{const a=new Date(i),t=new Date().getTime()-a.getTime(),c=Math.ceil(t/(1e3*60*60*24));if(c===0)return"Today";if(c===1)return"1 day ago";if(c>1&&c<=7)return`${c} days ago`;if(c>7&&c<=14)return`${Math.ceil(c/7)} week ago`;if(c>14)return`${Math.ceil(c/7)} weeks ago`;if(c<0){const D=Math.abs(c);return D===1?"In 1 day":D<=7?`In ${D} days`:`In ${Math.ceil(D/7)} weeks`}return i};X(o,i=>{const a=i;if(a!=null&&a.success&&(a!=null&&a.data)){const d=a.data;m.value=Array.isArray(d.timeline)?d.timeline.map(t=>({id:t.id,title:t.title,description:t.description,week:t.week,date:t.date||te(t.created_at),status:t.status,icon:t.icon||"tabler-calendar",color:V(t.status)})):[],d.stats&&(b.value=[{title:"Total Milestones",value:(d.stats.total_milestones||0).toLocaleString(),icon:"tabler-flag",color:"primary"},{title:"Completed",value:(d.stats.completed||0).toLocaleString(),icon:"tabler-circle-check",color:"success"},{title:"Scheduled",value:(d.stats.scheduled||0).toLocaleString(),icon:"tabler-calendar",color:"info"},{title:"Overdue",value:(d.stats.overdue||0).toLocaleString(),icon:"tabler-alert-triangle",color:"error"}])}},{immediate:!0});const le=P(()=>r.value==="all"?m.value:m.value.filter(i=>i.status===r.value)),j=i=>{if(typeof i=="number")return i;const a=i.toString().split("-");return parseInt(a[a.length-1])},z=i=>typeof i=="number"?"unknown":i.toString().split("-")[0],I=i=>{const a=z(i.id),d=j(i.id);switch(a){case"unit":s.push("/franchisor/my-units");break;case"royalty":s.push("/franchisor/royalty-management");break;case"tech":s.push("/franchisor/technical-requests");break;case"lead":s.push(`/franchisor/leads/${d}`);break;case"task":s.push("/franchisor/tasks-management");break;case"doc":s.push("/franchisor/franchise");break;case"review":s.push("/franchisor/my-units");break;default:s.push("/franchisor")}},ie=i=>{const a=z(i.id),d=j(i.id);switch(a){case"royalty":s.push("/franchisor/royalty-management");break;case"tech":s.push("/franchisor/technical-requests");break;case"lead":s.push(`/franchisor/leads/${d}`);break;case"task":s.push("/franchisor/tasks-management");break;default:I(i)}},ae=i=>{switch(z(i.id)){case"task":s.push("/franchisor/tasks-management");break;case"lead":s.push("/franchisor/lead-management");break;default:I(i)}};return Ve(()=>{y()}),(i,a)=>{const d=ne;return k(),x("section",null,[l(we,{class:"mb-6"},{default:n(()=>[(k(!0),x(E,null,F(S(b),t=>(k(),T(Te,{key:t.title,cols:"12",sm:"6",md:"3"},{default:n(()=>[l(U,null,{default:n(()=>[l(R,null,{default:n(()=>[f("div",Le,[f("div",null,[f("div",Me,C(t.title),1),f("h4",Oe,C(t.value),1)]),l(K,{color:t.color,variant:"tonal",rounded:"",size:"42"},{default:n(()=>[l(B,{icon:t.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),f("div",null,[l(Y,null,{append:n(()=>[f("div",je,[l(d,{modelValue:S(r),"onUpdate:modelValue":a[0]||(a[0]=t=>De(r)?r.value=t:null),items:u,placeholder:"Filter"},null,8,["modelValue"])])]),default:n(()=>[l(W,null,{default:n(()=>a[1]||(a[1]=[p("Development Timeline")])),_:1,__:[1]})]),_:1}),l(R,null,{default:n(()=>[l(Ae,{align:"start","line-inset":"19","truncate-line":"start",justify:"center",density:S(_)?"compact":"default",class:"mt-4"},{default:n(()=>[(k(!0),x(E,null,F(S(le),t=>(k(),T(Be,{key:t.id,"fill-dot":"",size:"small"},{opposite:n(()=>[f("div",Ne,[f("span",Ee,C(t.week),1),f("span",Fe,C(t.date),1)])]),icon:n(()=>[f("div",qe,[l(K,{size:"32",color:t.color,variant:"tonal"},{default:n(()=>[l(B,{icon:t.icon,size:"20"},null,8,["icon"])]),_:2},1032,["color"])])]),default:n(()=>[l(U,{class:"mb-6 mt-n4"},{default:n(()=>[l(Y,{class:"pb-4"},{default:n(()=>[l(W,{class:"d-flex align-center justify-space-between"},{default:n(()=>[f("span",null,C(t.title),1),l(Ie,{color:t.color,size:"small",label:"",class:"text-capitalize"},{default:n(()=>[p(C(t.status),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024),l(R,null,{default:n(()=>[f("p",Ue,C(t.description),1)]),_:2},1024),l(ze,null,{default:n(()=>[l($,{variant:"tonal",size:"small",onClick:c=>I(t)},{default:n(()=>a[2]||(a[2]=[p(" View Details ")])),_:2,__:[2]},1032,["onClick"]),t.status==="overdue"?(k(),T($,{key:0,variant:"tonal",color:"error",size:"small",onClick:c=>ie(t)},{default:n(()=>a[3]||(a[3]=[p(" Take Action ")])),_:2,__:[3]},1032,["onClick"])):q("",!0),t.status==="scheduled"?(k(),T($,{key:1,variant:"tonal",color:"info",size:"small",onClick:c=>ae(t)},{default:n(()=>a[4]||(a[4]=[p(" Reschedule ")])),_:2,__:[4]},1032,["onClick"])):q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["density"])]),_:1})])])}}}),ut=xe(Ke,[["__scopeId","data-v-fffd7b21"]]);export{ut as default};
