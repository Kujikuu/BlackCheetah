import{m as q}from"./vue3-apexcharts-H1rQ_PT2.js";import{f as E,b as X,V as F,a as G,d as P,h as J,e as re}from"./VCard-CawK-7Mk.js";import{d as A,a as D,o as d,k as t,y as e,h as W,l as a,av as O,t as m,g as p,E as j,O as Y,q as k,c as v,i as s,s as Z,be as oe,aQ as le,F as M,r as N,n as ne,a7 as ie,aI as B}from"./main-Ji38qWNq.js";import{a as T,_ as ce}from"./ViewUserDialog.vue_vue_type_script_setup_true_lang-B9ioIS00.js";import{V}from"./VSkeletonLoader-C8s44z3e.js";import{f as de}from"./formatters-aoHiJebZ.js";import{V as H}from"./VChip-Bbjrr1Q2.js";import{_ as ue}from"./AddEditFranchiseeDrawer.vue_vue_type_script_setup_true_lang-B8l8Ct6M.js";import{_ as pe}from"./AddEditFranchisorDrawer.vue_vue_type_script_setup_true_lang-DaqMY6ID.js";import{_ as he}from"./AddEditBrokerDrawer.vue_vue_type_script_setup_true_lang-DlN0oc3y.js";import{a as $,V as L}from"./VRow-DmXcz54G.js";import{V as fe}from"./VAlert-DjmlpEYh.js";import{V as me}from"./VDivider-Dc_kOOhx.js";import{V as _e}from"./VTable-C4xv__rq.js";import{V as K}from"./VTooltip-BfjGUtV-.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VSpacer-Ds6NJ338.js";/* empty css              */import"./VDialog-BQITKorr.js";import"./VOverlay--ReuNc3x.js";import"./forwardRefs-B931MWyl.js";import"./scopeId-DFtxLKrN.js";import"./VMenu-CbHzsIir.js";import"./VSlideGroup-CeSXpsO9.js";import"./validators-BHkKs9Dp.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-DJA6r2Q3.js";import"./form-C8-wVyzB.js";import"./VSelect-Dx19yBS5.js";import"./VTextField-Dd7MzrQd.js";import"./VField-DLyvN9w7.js";import"./VInput-N-MuRR1n.js";import"./VList-DR2sl0cr.js";import"./VCheckboxBtn-BkETQGEw.js";import"./VSelectionControl-5ebt7RiB.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-wXh2aVbi.js";import"./VForm-DP38Bcc1.js";import"./VNavigationDrawer-CRbjGIPL.js";const ve={class:"text-h5"},xe={class:"text-sm"},ge=A({__name:"CardStatisticsVertical",props:{title:{},color:{default:"primary"},icon:{},stats:{},height:{},series:{},chartOptions:{}},setup(R){const u=R;return(_,y)=>{const c=q;return d(),D(F,null,{default:t(()=>[e(E,{class:"d-flex flex-column pb-0"},{default:t(()=>[u.icon?(d(),D(X,{key:0,size:"42",variant:"tonal",color:u.color,rounded:"",class:"mb-2"},{default:t(()=>[e(O,{icon:u.icon,size:"26"},null,8,["icon"])]),_:1},8,["color"])):W("",!0),a("h5",ve,m(u.stats),1),a("div",xe,m(u.title),1)]),_:1}),e(c,{series:u.series,options:u.chartOptions,height:u.height},null,8,["series","options","height"])]),_:1})}}}),be={key:0,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},ye={key:1,class:"text-center text-error text-sm mt-3"},we={key:2,class:"d-flex align-center justify-space-between gap-x-2 mt-3"},ke={class:"text-h4 text-center"},Ce=A({__name:"AdminRequestsChart",setup(R){const u=p(!0),_=p(""),y=p(0),c=p(0),C=p([{name:"Requests",data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const l=await T.getDashboardChartData();if(l.success&&l.data.requests){const i=l.data.requests.slice(-7),h=i.map(f=>f.requests);C.value=[{name:"Requests",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,S)=>f+S.requests,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching requests chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const w={warning:"#FFB400"},x=Y(()=>({chart:{height:90,parentHeightOffset:0,type:"bar",toolbar:{show:!1}},tooltip:{enabled:!1},plotOptions:{bar:{barHeight:"100%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4,colors:{backgroundBarColors:[w.warning,w.warning,w.warning,w.warning,w.warning,w.warning,w.warning],backgroundBarRadius:4}}},colors:[w.warning],grid:{show:!1,padding:{top:-30,left:-16,bottom:0,right:-6}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},yaxis:{labels:{show:!1}},responsive:[{breakpoint:1264,options:{plotOptions:{bar:{borderRadius:6,columnWidth:"30%",colors:{backgroundBarRadius:6}}}}}]}));return(l,i)=>{const h=q;return d(),D(F,null,{default:t(()=>[e(G,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[k("Technical Requests")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[k("Last Week")])),_:1,__:[1]})]),_:1}),e(E,null,{default:t(()=>[e(h,{options:s(x),series:s(C),height:62},null,8,["options","series"]),s(u)?(d(),v("div",be,[e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"40px"})])):s(_)?(d(),v("div",ye,m(s(_)),1)):(d(),v("div",we,[a("h4",ke,m(s(y).toLocaleString()),1),a("div",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),Ve={class:"d-flex flex-column"},De={key:0},$e={key:1},Ue={key:2},Fe={class:"text-h3 mb-2"},Re={key:1,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Se={key:2,class:"d-flex align-center justify-center",style:{height:"162px",width:"162px"}},Le=A({__name:"AdminRevenueGrowth",setup(R){const u=p(!0),_=p(""),y=p(0),c=p(0),C=p([{data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const x=await T.getDashboardChartData();if(x.success&&x.data.revenue){const l=x.data.revenue.slice(-7),i=l.map(g=>g.revenue);C.value=[{data:i}];const h=i[i.length-1]||0,b=i[i.length-2]||0;y.value=l.reduce((g,f)=>g+f.revenue,0),b>0?c.value=(h-b)/b*100:c.value=h>0?100:0}}catch(x){console.error("Error fetching revenue chart data:",x),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const w=Y(()=>{const x="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",l={success:"#56CA00"};return{chart:{height:162,type:"bar",parentHeightOffset:0,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"80%",columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:6,distributed:!0}},tooltip:{enabled:!1},grid:{show:!1,padding:{top:-20,bottom:-12,left:-10,right:0}},colors:[l.success,l.success,l.success,l.success,l.success,l.success,l.success],dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:["M","T","W","T","F","S","S"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:x,fontSize:"13px"}}},yaxis:{labels:{show:!1}},states:{hover:{filter:{type:"none"}}},responsive:[{breakpoint:1640,options:{plotOptions:{bar:{columnWidth:"40%",borderRadius:6}}}}]}});return(x,l)=>{const i=q;return d(),D(F,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between"},{default:t(()=>[a("div",Ve,[l[2]||(l[2]=a("div",{class:"mb-auto"},[a("h5",{class:"text-h5 text-no-wrap mb-2"}," Revenue Growth "),a("div",{class:"text-body-1"}," Last 7 Months ")],-1)),s(u)?(d(),v("div",De,[e(V,{type:"text",width:"100px",height:"32px",class:"mb-2"}),e(V,{type:"chip",width:"60px",height:"24px"})])):s(_)?(d(),v("div",$e,[l[1]||(l[1]=a("h5",{class:"text-h3 mb-2 text-error"}," Error ",-1)),e(H,{label:"",color:"error",size:"small"},{default:t(()=>l[0]||(l[0]=[k(" Failed to load ")])),_:1,__:[0]})])):(d(),v("div",Ue,[a("h5",Fe,m(s(de)(s(y),"SAR",!1)),1),e(H,{label:"",color:s(c)>=0?"success":"error",size:"small"},{default:t(()=>[k(m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",1)]),_:1},8,["color"])]))]),a("div",null,[!s(u)&&!s(_)?(d(),D(i,{key:0,options:s(w),series:s(C),height:162},null,8,["options","series"])):s(u)?(d(),v("div",Re,[e(oe,{indeterminate:"",color:"primary",size:"40"})])):(d(),v("div",Se,[e(O,{icon:"tabler-alert-circle",color:"error",size:"40"})]))])]),_:1})]),_:1})}}}),Oe={key:0,class:"d-flex align-center justify-space-between gap-x-2"},Te={key:1,class:"text-center text-error text-sm"},Ee={key:2,class:"d-flex align-center justify-space-between gap-x-2"},Ae={class:"text-h4 text-center"},ze=A({__name:"AdminUsersChart",setup(R){const u=p(!0),_=p(""),y=p(0),c=p(0),C=p([{name:"Users",data:[0,0,0,0,0,0,0]}]),U=async()=>{try{u.value=!0;const l=await T.getDashboardChartData();if(l.success&&l.data.users){const i=l.data.users.slice(-7),h=i.map(f=>f.users);C.value=[{name:"Users",data:h}];const b=h[h.length-1]||0,g=h[h.length-2]||0;y.value=i.reduce((f,S)=>f+S.users,0),g>0?c.value=(b-g)/g*100:c.value=b>0?100:0}}catch(l){console.error("Error fetching chart data:",l),_.value="Failed to load chart data"}finally{u.value=!1}};j(()=>{U()});const x={chart:{type:"area",parentHeightOffset:0,toolbar:{show:!1},sparkline:{enabled:!0}},markers:{colors:"transparent",strokeColors:"transparent"},grid:{show:!1},colors:[{primary:"#9155FD"}.primary],fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.5,opacityTo:.07,stops:[0,80,100]}},dataLabels:{enabled:!1},stroke:{width:2,curve:"smooth"},xaxis:{show:!0,lines:{show:!1},labels:{show:!1},stroke:{width:0},axisBorder:{show:!1}},yaxis:{stroke:{width:0},show:!1},tooltip:{enabled:!1}};return(l,i)=>{const h=q;return d(),D(F,null,{default:t(()=>[e(G,{class:"pb-3"},{default:t(()=>[e(P,null,{default:t(()=>i[0]||(i[0]=[k(" Total Users ")])),_:1,__:[0]}),e(J,null,{default:t(()=>i[1]||(i[1]=[k(" Last 7 Days ")])),_:1,__:[1]})]),_:1}),e(h,{options:x,series:s(C),height:68},null,8,["series"]),e(E,{class:"pt-1"},{default:t(()=>[s(u)?(d(),v("div",Oe,[e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"40px"})])):s(_)?(d(),v("div",Te,m(s(_)),1)):(d(),v("div",Ee,[a("h4",Ae,m(s(y).toLocaleString()),1),a("span",{class:Z(["text-sm",s(c)>=0?"text-success":"text-error"])},m(s(c)>=0?"+":"")+m(s(c).toFixed(1))+"% ",3)]))]),_:1})]),_:1})}}}),Be={class:"d-flex justify-space-between"},qe={class:"d-flex flex-column gap-y-1"},je={class:"d-flex align-center gap-x-4"},Ie={key:1},Me={class:"d-flex flex-column"},Ne={class:"text-base font-weight-medium"},We={class:"text-sm text-medium-emphasis"},He={class:"d-flex align-center gap-x-2"},Ge={class:"text-capitalize text-high-emphasis text-body-1"},Pe={class:"text-body-1"},Je={class:"d-flex gap-1"},Lt=A({__name:"dashboard",setup(R){const u=p([]),_=p([]),y=p(!0),c=p(""),C=async()=>{try{const o=await T.getDashboardStats();o.success&&(u.value=o.data)}catch(o){console.error("Error fetching stats:",o),c.value="Failed to load dashboard statistics"}},U=async()=>{try{const o=await T.getRecentUsers();o.success&&(_.value=o.data)}catch(o){console.error("Error fetching recent users:",o),c.value="Failed to load recent users"}},w=async()=>{y.value=!0,c.value="";try{await Promise.all([C(),U()])}catch(o){console.error("Error loading dashboard data:",o),c.value="Failed to load dashboard data"}finally{y.value=!1}};j(()=>{w()});const x=o=>{const r=o.toLowerCase();return r==="franchisor"?{color:"success",icon:"tabler-building-store"}:r==="franchisee"?{color:"info",icon:"tabler-user-check"}:r==="broker"?{color:"warning",icon:"tabler-chart-line"}:{color:"primary",icon:"tabler-user"}},l=o=>{const r=o.toLowerCase();return r==="pending"?"warning":r==="active"?"success":r==="inactive"?"secondary":"primary"},i=p(!1),h=p(!1),b=p(!1),g=p(!1),f=p(null),S=o=>{f.value=o,i.value=!0},Q=o=>{f.value={...o},o.role==="franchisor"?h.value=!0:o.role==="franchisee"?b.value=!0:o.role==="broker"&&(g.value=!0)},ee=()=>{f.value&&Q(f.value)},I=o=>{const r=_.value.findIndex(z=>z.id===o.id);r!==-1&&(_.value[r]={..._.value[r],...o}),f.value=null},te=o=>o==="franchisor"?"Franchisor":o==="franchisee"?"Franchisee":o==="broker"?"Broker":"User",se=o=>!o||typeof o!="string"?"U":o.split(" ").map(r=>r.charAt(0)).join("").toUpperCase();return(o,r)=>{const z=le("IconBtn");return d(),v("section",null,[e(L,{class:"mb-6"},{default:t(()=>[e($,{cols:"12"},{default:t(()=>r[5]||(r[5]=[a("div",{class:"d-flex align-center justify-space-between"},[a("div",null,[a("h2",{class:"text-h2 mb-1"}," Admin Dashboard "),a("p",{class:"text-body-1 text-medium-emphasis"}," Welcome back! Here's what's happening with your platform today. ")])],-1)])),_:1,__:[5]})]),_:1}),s(c)?(d(),D(L,{key:0,class:"mb-6"},{default:t(()=>[e($,{cols:"12"},{default:t(()=>[e(fe,{type:"error",variant:"tonal",closable:"","onClick:close":r[0]||(r[0]=n=>c.value="")},{default:t(()=>[k(m(s(c)),1)]),_:1})]),_:1})]),_:1})):W("",!0),e(L,{class:"mb-6"},{default:t(()=>[s(y)?(d(),v(M,{key:0},N(4,n=>e($,{key:n,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(F,null,{default:t(()=>[e(E,null,{default:t(()=>[a("div",Be,[a("div",qe,[e(V,{type:"text",width:"80px"}),e(V,{type:"text",width:"60px",height:"32px"}),e(V,{type:"text",width:"120px"})]),e(V,{type:"avatar",size:"42"})])]),_:1})]),_:1})]),_:2},1024)),64)):W("",!0),(d(!0),v(M,null,N(s(u),n=>(d(),D($,{key:n.title,cols:"12",md:"3",sm:"6"},{default:t(()=>[e(ge,ne({ref_for:!0},n),null,16)]),_:2},1024))),128))]),_:1}),e(L,{class:"mb-6"},{default:t(()=>[e($,{cols:"12",md:"4"},{default:t(()=>[e(ze)]),_:1}),e($,{cols:"12",md:"4"},{default:t(()=>[e(Le)]),_:1}),e($,{cols:"12",md:"4"},{default:t(()=>[e(Ce)]),_:1})]),_:1}),e(L,null,{default:t(()=>[e($,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[e(G,{class:"pb-4"},{append:t(()=>[e(ie,{variant:"outlined",color:"primary",size:"small",to:{name:"admin-users-franchisors"}},{default:t(()=>r[8]||(r[8]=[k(" View All ")])),_:1,__:[8]})]),default:t(()=>[e(P,null,{default:t(()=>r[6]||(r[6]=[k("Recent Users")])),_:1,__:[6]}),e(J,null,{default:t(()=>r[7]||(r[7]=[k("Latest registered users")])),_:1,__:[7]})]),_:1}),e(me),e(_e,{class:"text-no-wrap"},{default:t(()=>[r[11]||(r[11]=a("thead",null,[a("tr",null,[a("th",{scope:"col"}," USER "),a("th",{scope:"col"}," ROLE "),a("th",{scope:"col"}," STATUS "),a("th",{scope:"col"}," JOINED DATE "),a("th",{scope:"col"}," ACTIONS ")])],-1)),a("tbody",null,[(d(!0),v(M,null,N(s(_),n=>(d(),v("tr",{key:n.id},[a("td",null,[a("div",je,[e(X,{size:"34",variant:n.avatar?void 0:"tonal",color:n.avatar?void 0:x(n.role).color},{default:t(()=>[n.avatar?(d(),D(re,{key:0,src:n.avatar},null,8,["src"])):(d(),v("span",Ie,m(se(n.fullName)),1))]),_:2},1032,["variant","color"]),a("div",Me,[a("h6",Ne,m(n.fullName),1),a("div",We,m(n.email),1)])])]),a("td",null,[a("div",He,[e(O,{size:22,icon:x(n.role).icon,color:x(n.role).color},null,8,["icon","color"]),a("div",Ge,m(n.role),1)])]),a("td",null,[e(H,{color:l(n.status),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[k(m(n.status),1)]),_:2},1032,["color"])]),a("td",null,[a("div",Pe,m(n.joinedDate),1)]),a("td",null,[a("div",Je,[e(z,{size:"small",onClick:ae=>S(n)},{default:t(()=>[e(O,{icon:"tabler-eye"}),e(K,{activator:"parent",location:"top"},{default:t(()=>r[9]||(r[9]=[k(" View ")])),_:1,__:[9]})]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:ae=>Q(n)},{default:t(()=>[e(O,{icon:"tabler-edit"}),e(K,{activator:"parent",location:"top"},{default:t(()=>r[10]||(r[10]=[k(" Edit ")])),_:1,__:[10]})]),_:2},1032,["onClick"])])])]))),128))])]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),e(ce,{"is-dialog-open":s(i),"onUpdate:isDialogOpen":r[1]||(r[1]=n=>B(i)?i.value=n:null),user:s(f),"user-type":s(f)?te(s(f).role):"User",onEdit:ee},null,8,["is-dialog-open","user","user-type"]),e(pe,{"is-drawer-open":s(h),"onUpdate:isDrawerOpen":r[2]||(r[2]=n=>B(h)?h.value=n:null),franchisor:s(f),onFranchisorData:I},null,8,["is-drawer-open","franchisor"]),e(ue,{"is-drawer-open":s(b),"onUpdate:isDrawerOpen":r[3]||(r[3]=n=>B(b)?b.value=n:null),franchisee:s(f),onFranchiseeData:I},null,8,["is-drawer-open","franchisee"]),e(he,{"is-drawer-open":s(g),"onUpdate:isDrawerOpen":r[4]||(r[4]=n=>B(g)?g.value=n:null),"broker-user":s(f),onBrokerUserData:I},null,8,["is-drawer-open","broker-user"])])}}});export{Lt as default};
