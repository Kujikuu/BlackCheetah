import{_ as ke}from"./AppTextarea.vue_vue_type_script_setup_true_lang-BheIKtjL.js";import{_ as Ce}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-C82pZbj1.js";import{_ as Ne}from"./AppSelect.vue_vue_type_script_setup_true_lang-CLC3d85Z.js";import{_ as Ue}from"./AppTextField.vue_vue_type_script_setup_true_lang-C488kBmF.js";import{_ as De,n as we}from"./AddNoteDialog.vue_vue_type_script_setup_true_lang-DBUWG9AV.js";import{V as xe,_ as Se,a as Le}from"./DeleteNoteDialog.vue_vue_type_script_setup_true_lang-CURxpcmm.js";import{d as Ae,u as Te,O as B,g as c,E as Z,w as G,aZ as Ee,c as F,o as n,a as r,h as L,y as t,i as l,k as d,l as p,bf as $e,t as v,q as f,a7 as _,F as R,r as K,av as q,aI as w}from"./main-BhQQEtPK.js";import{l as X}from"./lead-Bz0rkhHF.js";import{a as Pe}from"./formatters-aoHiJebZ.js";import{u as Fe,a as Me}from"./useSaudiProvinces-KAQdJefg.js";import{f as V,V as y,b as Ie,a as k,d as C}from"./VCard-Ba8KRL8r.js";import{V as ze}from"./VChip-8Um5X-5j.js";import{a as Be,V as Re}from"./VTabs-Dcj3uVW0.js";import{a as h,V as qe}from"./VWindowItem-DpV757YG.js";import{V as N,a as m}from"./VRow-eXEJlD_Q.js";import{V as U}from"./VDivider-BwsrcXXS.js";import"./form-xX7HsKo6.js";import"./VTextarea-BUn9c_nA.js";import"./VTextField-DZpI-VzR.js";import"./VField-ov2Ztti3.js";import"./VInput-DG2UyoyO.js";import"./VSelect-ApLJyqC9.js";import"./VList-wDaZjI5x.js";import"./VMenu-knBXOuJp.js";import"./VCheckboxBtn-CYkql-vH.js";import"./VSelectionControl-DsAL8Sun.js";import"./VDialog-BzrmTsGT.js";import"./useValidationRules-B8mQXoPr.js";import"./VForm-jdZ3ETEx.js";import"./VFileInput-D8qkRCJl.js";import"./VSpacer-WCr5FxLL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ConfirmDeleteDialog.vue_vue_type_script_setup_true_lang-BbxJEuOM.js";import"./api-router-C66GWYDG.js";import"./VSlideGroup-B6I16k18.js";const je={class:"d-flex justify-space-between align-center flex-wrap gap-4"},Oe={class:"d-flex align-center gap-4"},Qe={class:"text-h4"},We={class:"text-h4 mb-1"},He={class:"text-body-1 mb-1"},Je={class:"d-flex gap-2"},Ye={class:"d-flex justify-space-between align-start mb-2"},Ze={class:"text-caption text-disabled mb-1"},Ge={class:"text-h6 mb-2"},Ke={class:"d-flex gap-2"},Xe={class:"text-body-2 mb-2"},Fl=Ae({__name:"[id]",setup(he){const ee=Te(),g=B(()=>Number(ee.params.id)),D=c("overview"),A=c(!1),T=c(!1),x=c(!1),S=c(!1),E=c(null),M=c(null),i=c(!1),o=c(null),I=c(!1),j=async()=>{try{I.value=!0;const s=await X.getLead(g.value);s.success&&s.data&&(o.value=s.data)}catch(s){console.error("Error fetching lead data:",s)}finally{I.value=!1}};Z(()=>{j()});const O=c([]),Q=c(!1),$=async()=>{if(g.value)try{Q.value=!0;const s=await we.getNotes({lead_id:g.value});s.success&&(O.value=s.data.map(e=>{var u;return{id:e.id,title:e.title,description:e.description,createdBy:((u=e.user)==null?void 0:u.name)||"Unknown",createdAt:e.created_at,attachments:e.attachments||[]}}))}catch(s){console.error("Error fetching notes:",s)}finally{Q.value=!1}};G(g,()=>{g.value&&$()},{immediate:!0});const le=[{title:"Overview",value:"overview",icon:"tabler-file-text"},{title:"Notes",value:"notes",icon:"tabler-notes"}],te=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ae=(s,e=150)=>s.length<=e?s:`${s.substring(0,e)}...`,oe=s=>{E.value=s,T.value=!0},de=s=>{E.value={...s},x.value=!0},se=s=>{M.value=s,S.value=!0},ne=async()=>{await $(),x.value=!1,console.log("Note updated successfully")},ie=async()=>{await $(),console.log("Note added successfully")},ue=async()=>{await $(),S.value=!1,M.value=null,console.log("Note deleted successfully")},W=()=>{i.value=!i.value},P=c(!1),re=async()=>{if(o.value)try{P.value=!0,(await X.updateLead(g.value,o.value)).success&&(await j(),i.value=!1,console.log("Lead updated successfully"))}catch(s){console.error("Error updating lead:",s)}finally{P.value=!1}},me=Ee("userData"),H=B(()=>me.value);Z(()=>{o.value&&H.value&&(!o.value.owner||o.value.owner==="Unassigned")&&(o.value.owner=H.value.name)});const{countries:pe,isLoading:fe}=Fe(),{provinces:ce,getCitiesForProvince:J,isLoading:ve}=Me(),Ve=B(()=>o.value?J(o.value.state||""):[]);G(()=>{var s;return(s=o.value)==null?void 0:s.state},(s,e)=>{if(o.value&&e!==void 0&&e!==s){const u=J(s||""),b=o.value.city;b&&!u.includes(b)&&(o.value.city="")}});const ye=[{title:"Website",value:"website"},{title:"Referral",value:"referral"},{title:"Social Media",value:"social_media"},{title:"Advertisement",value:"advertisement"},{title:"Cold Call",value:"cold_call"},{title:"Event",value:"event"},{title:"Other",value:"other"}],be=[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Unqualified",value:"unqualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],ge=[{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}];return(s,e)=>{const u=Ue,b=Ne,z=Ce,_e=ke;return n(),F("section",null,[l(I)?(n(),r(y,{key:0,class:"mb-6"},{default:d(()=>[t(V,{class:"text-center py-10"},{default:d(()=>[t($e,{indeterminate:"",color:"primary"}),e[36]||(e[36]=p("div",{class:"mt-4"}," Loading lead data... ",-1))]),_:1,__:[36]})]),_:1})):l(o)?(n(),r(y,{key:1,class:"mb-6"},{default:d(()=>[t(V,null,{default:d(()=>[p("div",je,[p("div",Oe,[t(Ie,{size:"80",variant:"tonal",color:"primary"},{default:d(()=>[p("span",Qe,v(l(Pe)(`${l(o).firstName} ${l(o).lastName}`)),1)]),_:1}),p("div",null,[p("h4",We,v(l(o).firstName)+" "+v(l(o).lastName),1),p("div",He,v(l(o).company),1),t(ze,{color:l(o).status==="qualified"?"success":"error",size:"small",label:"",class:"text-capitalize"},{default:d(()=>[f(v(l(o).status),1)]),_:1},8,["color"])])]),p("div",Je,[l(i)?L("",!0):(n(),r(_,{key:0,color:"primary","prepend-icon":"tabler-pencil",onClick:W},{default:d(()=>e[37]||(e[37]=[f(" Edit ")])),_:1,__:[37]})),l(i)?(n(),r(_,{key:1,color:"success","prepend-icon":"tabler-check",loading:l(P),disabled:l(P),onClick:re},{default:d(()=>e[38]||(e[38]=[f(" Save ")])),_:1,__:[38]},8,["loading","disabled"])):L("",!0),l(i)?(n(),r(_,{key:2,color:"secondary",variant:"tonal",onClick:W},{default:d(()=>e[39]||(e[39]=[f(" Cancel ")])),_:1,__:[39]})):L("",!0)])])]),_:1})]),_:1})):L("",!0),l(o)?(n(),F(R,{key:2},[t(Re,{modelValue:l(D),"onUpdate:modelValue":e[0]||(e[0]=a=>w(D)?D.value=a:null),class:"mb-6"},{default:d(()=>[(n(),F(R,null,K(le,a=>t(Be,{key:a.value,value:a.value},{default:d(()=>[t(q,{icon:a.icon,start:""},null,8,["icon"]),f(" "+v(a.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(qe,{modelValue:l(D),"onUpdate:modelValue":e[31]||(e[31]=a=>w(D)?D.value=a:null),class:"disable-tab-transition"},{default:d(()=>[t(h,{value:"overview"},{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12",lg:"8"},{default:d(()=>[t(y,{class:"mb-6"},{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[40]||(e[40]=[f("Personal & Contact Information")])),_:1,__:[40]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).firstName,"onUpdate:modelValue":e[1]||(e[1]=a=>l(o).firstName=a),label:"First Name",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).lastName,"onUpdate:modelValue":e[2]||(e[2]=a=>l(o).lastName=a),label:"Last Name",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).email,"onUpdate:modelValue":e[3]||(e[3]=a=>l(o).email=a),label:"Email",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).phone,"onUpdate:modelValue":e[4]||(e[4]=a=>l(o).phone=a),label:"Phone",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).company,"onUpdate:modelValue":e[5]||(e[5]=a=>l(o).company=a),label:"Company",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"6"},{default:d(()=>[t(u,{modelValue:l(o).jobTitle,"onUpdate:modelValue":e[6]||(e[6]=a=>l(o).jobTitle=a),label:"Job Title",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{class:"mb-6"},{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[41]||(e[41]=[f("Location")])),_:1,__:[41]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12",md:"4"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).nationality,"onUpdate:modelValue":e[7]||(e[7]=a=>l(o).nationality=a),label:"Nationality",placeholder:"Select Nationality",items:l(pe),loading:l(fe),clearable:""},null,8,["modelValue","items","loading"])):(n(),r(u,{key:1,modelValue:l(o).nationality,"onUpdate:modelValue":e[8]||(e[8]=a=>l(o).nationality=a),label:"Nationality",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).state,"onUpdate:modelValue":e[9]||(e[9]=a=>l(o).state=a),label:"Province",placeholder:"Select Province",items:l(ce),loading:l(ve),clearable:""},null,8,["modelValue","items","loading"])):(n(),r(u,{key:1,modelValue:l(o).state,"onUpdate:modelValue":e[10]||(e[10]=a=>l(o).state=a),label:"Province",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12",md:"4"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).city,"onUpdate:modelValue":e[11]||(e[11]=a=>l(o).city=a),label:"City",placeholder:"Select City",items:l(Ve),disabled:!l(o).state,clearable:""},null,8,["modelValue","items","disabled"])):(n(),r(u,{key:1,modelValue:l(o).city,"onUpdate:modelValue":e[12]||(e[12]=a=>l(o).city=a),label:"City",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{class:"mb-6"},{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[42]||(e[42]=[f("Financial Details")])),_:1,__:[42]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12",md:"4"},{default:d(()=>[t(u,{modelValue:l(o).estimatedInvestment,"onUpdate:modelValue":e[13]||(e[13]=a=>l(o).estimatedInvestment=a),label:"Estimated Investment",type:"number",prefix:"SAR",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:d(()=>[t(u,{modelValue:l(o).franchiseFeeQuoted,"onUpdate:modelValue":e[14]||(e[14]=a=>l(o).franchiseFeeQuoted=a),label:"Franchise Fee Quoted",type:"number",prefix:"SAR",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1}),t(m,{cols:"12",md:"4"},{default:d(()=>[l(i)?(n(),r(z,{key:0,modelValue:l(o).expectedDecisionDate,"onUpdate:modelValue":e[15]||(e[15]=a=>l(o).expectedDecisionDate=a),label:"Expected Decision Date",placeholder:"Select Date"},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).expectedDecisionDate,"onUpdate:modelValue":e[16]||(e[16]=a=>l(o).expectedDecisionDate=a),label:"Expected Decision Date",readonly:""},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(y,null,{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[43]||(e[43]=[f("Additional Notes")])),_:1,__:[43]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(_e,{modelValue:l(o).note,"onUpdate:modelValue":e[17]||(e[17]=a=>l(o).note=a),label:"Notes",placeholder:"Add any additional notes about this lead...",rows:"4",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1}),t(m,{cols:"12",lg:"4"},{default:d(()=>[t(y,{class:"mb-6"},{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[44]||(e[44]=[f("Lead Management")])),_:1,__:[44]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).status,"onUpdate:modelValue":e[18]||(e[18]=a=>l(o).status=a),label:"Status",placeholder:"Select Status",items:be},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).status,"onUpdate:modelValue":e[19]||(e[19]=a=>l(o).status=a),label:"Status",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).priority,"onUpdate:modelValue":e[20]||(e[20]=a=>l(o).priority=a),label:"Priority",placeholder:"Select Priority",items:ge},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).priority,"onUpdate:modelValue":e[21]||(e[21]=a=>l(o).priority=a),label:"Priority",readonly:"",class:"text-capitalize"},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:d(()=>[l(i)?(n(),r(b,{key:0,modelValue:l(o).source,"onUpdate:modelValue":e[22]||(e[22]=a=>l(o).source=a),label:"Source",placeholder:"Select Source",items:ye},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).source,"onUpdate:modelValue":e[23]||(e[23]=a=>l(o).source=a),label:"Source",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:d(()=>[t(u,{modelValue:l(o).owner,"onUpdate:modelValue":e[24]||(e[24]=a=>l(o).owner=a),label:"Assigned To (You)",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(y,null,{default:d(()=>[t(k,null,{default:d(()=>[t(C,null,{default:d(()=>e[45]||(e[45]=[f("Timeline & Engagement")])),_:1,__:[45]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[t(m,{cols:"12"},{default:d(()=>[l(i)?(n(),r(z,{key:0,modelValue:l(o).lastContacted,"onUpdate:modelValue":e[25]||(e[25]=a=>l(o).lastContacted=a),label:"Last Contacted",placeholder:"Select Date"},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).lastContacted,"onUpdate:modelValue":e[26]||(e[26]=a=>l(o).lastContacted=a),label:"Last Contacted",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:d(()=>[l(i)?(n(),r(z,{key:0,modelValue:l(o).scheduledMeeting,"onUpdate:modelValue":e[27]||(e[27]=a=>l(o).scheduledMeeting=a),label:"Next Follow-up",placeholder:"Select Date"},null,8,["modelValue"])):(n(),r(u,{key:1,modelValue:l(o).scheduledMeeting,"onUpdate:modelValue":e[28]||(e[28]=a=>l(o).scheduledMeeting=a),label:"Next Follow-up",readonly:""},null,8,["modelValue"]))]),_:1}),t(m,{cols:"12"},{default:d(()=>[t(u,{modelValue:l(o).contactAttempts,"onUpdate:modelValue":e[29]||(e[29]=a=>l(o).contactAttempts=a),label:"Contact Attempts",type:"number",readonly:!l(i)},null,8,["modelValue","readonly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(h,{value:"notes"},{default:d(()=>[t(y,null,{default:d(()=>[t(k,{class:"pb-4"},{append:d(()=>[t(_,{color:"primary","prepend-icon":"tabler-plus",onClick:e[30]||(e[30]=a=>A.value=!0)},{default:d(()=>e[47]||(e[47]=[f(" Add Note ")])),_:1,__:[47]})]),default:d(()=>[t(C,null,{default:d(()=>e[46]||(e[46]=[f("Notes")])),_:1,__:[46]})]),_:1}),t(U),t(V,null,{default:d(()=>[t(N,null,{default:d(()=>[(n(!0),F(R,null,K(l(O),a=>(n(),r(m,{key:a.id,cols:"12"},{default:d(()=>[t(y,{variant:"tonal",class:"mb-4"},{default:d(()=>[t(V,null,{default:d(()=>[p("div",Ye,[p("div",null,[p("div",Ze," Created by "+v(a.createdBy)+" at "+v(te(a.createdAt)),1),p("h6",Ge,v(a.title),1)]),p("div",Ke,[t(_,{icon:"",size:"small",variant:"text",onClick:Y=>de(a)},{default:d(()=>[t(q,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),t(_,{icon:"",size:"small",variant:"text",color:"error",onClick:Y=>se(a.id)},{default:d(()=>[t(q,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]),p("p",Xe,v(ae(a.description)),1),t(_,{variant:"text",size:"small",onClick:Y=>oe(a)},{default:d(()=>e[48]||(e[48]=[f(" Read More ")])),_:2,__:[48]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):L("",!0),t(De,{"is-dialog-visible":l(A),"onUpdate:isDialogVisible":e[32]||(e[32]=a=>w(A)?A.value=a:null),"lead-id":l(g),onNoteAdded:ie},null,8,["is-dialog-visible","lead-id"]),t(xe,{"is-dialog-visible":l(T),"onUpdate:isDialogVisible":e[33]||(e[33]=a=>w(T)?T.value=a:null),note:l(E)},null,8,["is-dialog-visible","note"]),t(Se,{"is-dialog-visible":l(x),"onUpdate:isDialogVisible":e[34]||(e[34]=a=>w(x)?x.value=a:null),note:l(E),onNoteUpdated:ne},null,8,["is-dialog-visible","note"]),t(Le,{"is-dialog-visible":l(S),"onUpdate:isDialogVisible":e[35]||(e[35]=a=>w(S)?S.value=a:null),"note-id":l(M),onNoteDeleted:ue},null,8,["is-dialog-visible","note-id"])])}}});export{Fl as default};
