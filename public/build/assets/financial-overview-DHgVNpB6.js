import{m as Je}from"./vue3-apexcharts-ybf1ObYN.js";import{V as Ke,_ as We}from"./VDataTableServer-CIMhH3s8.js";import{_ as Ze}from"./AppTextField.vue_vue_type_script_setup_true_lang-C488kBmF.js";import{_ as et}from"./AppSelect.vue_vue_type_script_setup_true_lang-CLC3d85Z.js";import{a_ as E,d as K,O as T,a as H,o as L,k as t,y as e,h as Y,q as g,t as c,l as a,av as U,i,a7 as N,g as m,c as Ve,aB as tt,w as fe,E as at,ba as st}from"./main-BhQQEtPK.js";import{g as lt}from"./api-router-C66GWYDG.js";import{f as _}from"./formatters-aoHiJebZ.js";import{_ as oe,V as ie}from"./VDialog-BzrmTsGT.js";import{V as P,f as q,g as ne,b as ye}from"./VCard-Ba8KRL8r.js";import{V as J}from"./VChip-8Um5X-5j.js";import{V as G}from"./VDivider-BwsrcXXS.js";import{V as le,a as D}from"./VRow-eXEJlD_Q.js";import{V as ot}from"./VTable-CXfAAunb.js";import{V as W}from"./VSpacer-WCr5FxLL.js";import{S as Ee}from"./saudi-riyal-DN2fsygI.js";import{a as Ue,u as Pe}from"./useValidationRules-B8mQXoPr.js";import{V as Ae}from"./VForm-jdZ3ETEx.js";import{V as _e}from"./VSelect-ApLJyqC9.js";import{V as j}from"./VTextField-DZpI-VzR.js";import{V as it}from"./VFileInput-D8qkRCJl.js";import{a as ge,V as nt}from"./VTabs-Dcj3uVW0.js";import{V as be}from"./VTooltip-BZFykJe0.js";import{V as rt}from"./VDataTable-CXJ8E84T.js";import"./_commonjsHelpers-CqkleIqs.js";import"./VPagination-C4sf-04R.js";import"./form-xX7HsKo6.js";import"./VMenu-knBXOuJp.js";import"./VSlideGroup-B6I16k18.js";import"./VList-wDaZjI5x.js";import"./VCheckboxBtn-CYkql-vH.js";import"./VSelectionControl-DsAL8Sun.js";import"./VField-ov2Ztti3.js";import"./VInput-DG2UyoyO.js";import"./VWindowItem-DpV757YG.js";class ut{getBaseUrl(){return lt("financial")}async getCharts(d){return await E(`${this.getBaseUrl()}/charts`,{params:d})}async getStatistics(d){return await E(`${this.getBaseUrl()}/statistics`,{params:d})}async getSales(d){return await E(`${this.getBaseUrl()}/sales`,{params:d})}async createSale(d){return await E(`${this.getBaseUrl()}/sales`,{method:"POST",body:d})}async updateSale(d,u){return await E(`${this.getBaseUrl()}/sales/${d}`,{method:"PUT",body:u})}async deleteSale(d){await E(`${this.getBaseUrl()}/sales/${d}`,{method:"DELETE"})}async getExpenses(d){return await E(`${this.getBaseUrl()}/expenses`,{params:d})}async createExpense(d){return await E(`${this.getBaseUrl()}/expenses`,{method:"POST",body:d})}async updateExpense(d,u){return await E(`${this.getBaseUrl()}/expenses/${d}`,{method:"PUT",body:u})}async deleteExpense(d){await E(`${this.getBaseUrl()}/expenses/${d}`,{method:"DELETE"})}async getProfit(d){return await E(`${this.getBaseUrl()}/profit`,{params:d})}async getUnitPerformance(d){return await E(`${this.getBaseUrl()}/unit-performance`,{params:d})}async importData(d,u){const b=new FormData;b.append("file",d),b.append("category",u),await E(`${this.getBaseUrl()}/import`,{method:"POST",body:b})}async exportData(d,u){return await E(`${this.getBaseUrl()}/export`,{params:{...u,category:d},parseResponse:b=>b})}}const F=new ut,dt={class:"text-h6 mb-4 text-primary"},mt={class:"mb-4"},pt={class:"font-weight-medium text-h6"},ct={class:"mb-4"},vt={class:"font-weight-medium"},ft={class:"text-h6 mb-4 text-primary"},yt={class:"text-center"},gt={class:"text-h6 font-weight-bold"},bt={class:"text-center"},xt={class:"text-h6 font-weight-bold"},Vt={class:"text-center"},_t={class:"text-h6 font-weight-bold"},Dt={class:"text-h6 mb-4 text-primary"},wt={class:"text-end"},ht={class:"text-end"},St={class:"bg-success-lighten-5"},kt={class:"text-end font-weight-bold text-success"},Ct=K({__name:"ViewSaleDetailsDialog",props:{isDialogVisible:{type:Boolean},saleData:{}},emits:["update:isDialogVisible"],setup(I,{emit:d}){const u=I,b=d,k=T({get:()=>u.isDialogVisible,set:V=>b("update:isDialogVisible",V)}),A=V=>new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(V,s)=>{const x=oe;return L(),H(ie,{modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=r=>k.value=r),"max-width":"600"},{default:t(()=>[e(x,{onClick:s[0]||(s[0]=r=>k.value=!1)}),u.saleData?(L(),H(P,{key:0,title:"Sale Details"},{default:t(()=>[e(q,null,{default:t(()=>[e(J,{color:"success",size:"small",variant:"tonal"},{default:t(()=>[g(c(u.saleData.referenceNumber||`REV-${String(u.saleData.id).padStart(6,"0")}`),1)]),_:1})]),_:1}),e(G,{class:"mb-4"}),e(q,null,{default:t(()=>[e(le,null,{default:t(()=>[e(D,{cols:"12"},{default:t(()=>[a("h6",dt,[e(U,{icon:"tabler-shopping-cart",class:"me-2"}),s[3]||(s[3]=g(" Product Information "))])]),_:1}),e(D,{cols:"12",md:"6"},{default:t(()=>[a("div",mt,[s[4]||(s[4]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Product Name ",-1)),a("div",pt,c(u.saleData.product),1)])]),_:1}),e(D,{cols:"12",md:"6"},{default:t(()=>[a("div",ct,[s[5]||(s[5]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Sale Date ",-1)),a("div",vt,c(A(u.saleData.date)),1)])]),_:1}),e(D,{cols:"12"},{default:t(()=>[e(G,{class:"my-4"}),a("h6",ft,[e(U,{icon:"tabler-report-money",class:"me-2"}),s[6]||(s[6]=g(" Financial Details "))])]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,{variant:"tonal",color:"info",class:"pa-4"},{default:t(()=>[a("div",yt,[e(U,{icon:"tabler-tag",size:"32",class:"mb-2"}),s[7]||(s[7]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Unit Price ",-1)),a("div",gt,c(i(_)(u.saleData.unitPrice)),1)])]),_:1})]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,{variant:"tonal",color:"warning",class:"pa-4"},{default:t(()=>[a("div",bt,[e(U,{icon:"tabler-stack",size:"32",class:"mb-2"}),s[8]||(s[8]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Quantity ",-1)),a("div",xt,c(u.saleData.quantity),1)])]),_:1})]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,{variant:"tonal",color:"success",class:"pa-4"},{default:t(()=>[a("div",Vt,[e(U,{icon:"tabler-coins",size:"32",class:"mb-2"}),s[9]||(s[9]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Total Sale ",-1)),a("div",_t,c(i(_)(u.saleData.sale)),1)])]),_:1})]),_:1}),e(D,{cols:"12"},{default:t(()=>[e(G,{class:"my-4"}),a("h6",Dt,[e(U,{icon:"tabler-calculator",class:"me-2"}),s[10]||(s[10]=g(" Calculation "))])]),_:1}),e(D,{cols:"12"},{default:t(()=>[e(ot,{density:"compact"},{default:t(()=>[a("tbody",null,[a("tr",null,[s[11]||(s[11]=a("td",{class:"font-weight-medium"}," Unit Price: ",-1)),a("td",wt,c(i(_)(u.saleData.unitPrice)),1)]),a("tr",null,[s[12]||(s[12]=a("td",{class:"font-weight-medium"}," Quantity: ",-1)),a("td",ht," Ã— "+c(u.saleData.quantity),1)]),a("tr",St,[s[13]||(s[13]=a("td",{class:"font-weight-bold text-success"}," Total Amount: ",-1)),a("td",kt,c(i(_)(u.saleData.sale)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(ne,null,{default:t(()=>[e(W),e(N,{color:"secondary",variant:"tonal",onClick:s[1]||(s[1]=r=>k.value=!1)},{default:t(()=>s[14]||(s[14]=[g(" Close ")])),_:1,__:[14]})]),_:1})]),_:1})):Y("",!0)]),_:1},8,["modelValue"])}}}),$t={class:"text-h6 mb-4 text-primary"},Et={class:"mb-4"},Ut={class:"mb-4"},Pt={class:"font-weight-medium"},At={class:"mb-4"},Rt={class:"font-weight-medium"},Bt={class:"mb-4"},Tt={class:"font-weight-medium"},qt={class:"text-h6 mb-4 text-primary"},It={class:"text-center"},Ot={class:"text-h4 font-weight-bold"},zt=K({__name:"ViewExpenseDetailsDialog",props:{isDialogVisible:{type:Boolean},expenseData:{}},emits:["update:isDialogVisible"],setup(I,{emit:d}){const u=I,b=d,k=T({get:()=>u.isDialogVisible,set:V=>b("update:isDialogVisible",V)}),A=V=>new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(V,s)=>{const x=oe;return L(),H(ie,{modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=r=>k.value=r),"max-width":"600"},{default:t(()=>[e(x,{onClick:s[0]||(s[0]=r=>k.value=!1)}),u.expenseData?(L(),H(P,{key:0,title:"Expense Details"},{default:t(()=>[e(q,null,{default:t(()=>[e(J,{color:"error",size:"small",variant:"tonal"},{default:t(()=>[g(c(u.expenseData.referenceNumber||`EXP-${String(u.expenseData.id).padStart(6,"0")}`),1)]),_:1})]),_:1}),e(G,{class:"mb-4"}),e(q,null,{default:t(()=>[e(le,null,{default:t(()=>[e(D,{cols:"12"},{default:t(()=>[a("h6",$t,[e(U,{icon:"tabler-receipt",class:"me-2"}),s[3]||(s[3]=g(" Expense Information "))])]),_:1}),e(D,{cols:"12",md:"6"},{default:t(()=>[a("div",Et,[s[4]||(s[4]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Category ",-1)),e(J,{color:"error",size:"small",variant:"tonal",class:"text-capitalize"},{default:t(()=>[g(c(u.expenseData.expenseCategory),1)]),_:1})])]),_:1}),e(D,{cols:"12",md:"6"},{default:t(()=>[a("div",Ut,[s[5]||(s[5]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Expense Date ",-1)),a("div",Pt,c(A(u.expenseData.date)),1)])]),_:1}),u.expenseData.vendorName?(L(),H(D,{key:0,cols:"12"},{default:t(()=>[a("div",At,[s[6]||(s[6]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Vendor ",-1)),a("div",Rt,c(u.expenseData.vendorName),1)])]),_:1})):Y("",!0),e(D,{cols:"12"},{default:t(()=>[a("div",Bt,[s[7]||(s[7]=a("div",{class:"text-body-2 text-medium-emphasis mb-1"}," Description ",-1)),a("div",Tt,c(u.expenseData.description||"No description provided"),1)])]),_:1}),e(D,{cols:"12"},{default:t(()=>[e(G,{class:"my-4"}),a("h6",qt,[e(U,{icon:"tabler-report-money",class:"me-2"}),s[8]||(s[8]=g(" Amount "))])]),_:1}),e(D,{cols:"12"},{default:t(()=>[e(P,{variant:"tonal",color:"error",class:"pa-6"},{default:t(()=>[a("div",It,[e(U,{icon:i(Ee),size:"48",class:"mb-3"},null,8,["icon"]),s[9]||(s[9]=a("div",{class:"text-body-1 text-medium-emphasis mb-2"}," Expense Amount ",-1)),a("div",Ot,c(i(_)(u.expenseData.amount)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(ne,null,{default:t(()=>[e(W),e(N,{color:"secondary",variant:"tonal",onClick:s[1]||(s[1]=r=>k.value=!1)},{default:t(()=>s[10]||(s[10]=[g(" Close ")])),_:1,__:[10]})]),_:1})]),_:1})):Y("",!0)]),_:1},8,["modelValue"])}}}),S=Ue(),Ft=["sales","expense"];function $e(I){const d={category:[S.required("Category is required"),S.inArray(Ft,"Category must be either sales or expense")],date:[S.required("Date is required"),S.date("Date must be a valid date")],description:[S.string()]};return I==="sales"?{...d,product:[S.required("Product name is required for sales"),S.string(),S.maxLength(255,"Product name cannot exceed 255 characters")],quantitySold:[S.required("Quantity sold is required for sales"),S.integer("Quantity sold must be an integer"),S.min(1,"Quantity sold must be at least 1")],unitPrice:[S.numeric(),S.min(0)]}:{...d,expenseCategory:[S.required("Expense category is required for expenses"),S.string(),S.maxLength(255,"Expense category cannot exceed 255 characters")],amount:[S.required("Amount is required for expenses"),S.numeric("Amount must be a number"),S.min(0,"Amount must be at least 0")]}}const Nt={key:0},Lt={key:1},Mt=K({__name:"AddDataDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","dataAdded"],setup(I,{emit:d}){const u=I,b=d,k=m(),A=m(!1),V=m("sales"),{backendErrors:s,setBackendErrors:x,clearError:r}=Pe(),R=$e("sales"),C=$e("expense"),p=m({product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""}),M=T({get:()=>u.isDialogVisible,set:y=>b("update:isDialogVisible",y)}),Q=async()=>{const{valid:y}=await k.value.validate();if(y){A.value=!0;try{V.value==="sales"?await F.createSale({product:p.value.product,unitPrice:p.value.unitPrice,quantity:p.value.quantitySold,date:p.value.dateOfSale}):await F.createExpense({expenseCategory:p.value.expenseCategory,amount:p.value.amount,description:p.value.description,date:p.value.dateOfExpense}),p.value={product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""},V.value="sales",b("dataAdded"),M.value=!1}catch(n){console.error("Error adding data:",n),x(n)}finally{A.value=!1}}},z=()=>{M.value=!1};return(y,n)=>{const B=oe;return L(),H(ie,{modelValue:M.value,"onUpdate:modelValue":n[17]||(n[17]=v=>M.value=v),"max-width":"600"},{default:t(()=>[e(B,{onClick:z}),e(P,{title:"Add New Data"},{default:t(()=>[e(q,null,{default:t(()=>[e(Ae,{ref_key:"formRef",ref:k},{default:t(()=>[e(_e,{modelValue:V.value,"onUpdate:modelValue":n[0]||(n[0]=v=>V.value=v),items:[{title:"Sales",value:"sales"},{title:"Expense",value:"expense"}],label:"Category",class:"mb-4"},null,8,["modelValue"]),V.value==="sales"?(L(),Ve("div",Nt,[e(j,{modelValue:p.value.product,"onUpdate:modelValue":n[1]||(n[1]=v=>p.value.product=v),label:"Product",class:"mb-4",rules:i(R).product,"error-messages":i(s).product,onInput:n[2]||(n[2]=v=>i(r)("product"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.dateOfSale,"onUpdate:modelValue":n[3]||(n[3]=v=>p.value.dateOfSale=v),label:"Date of Sale",type:"date",class:"mb-4",rules:i(R).date,"error-messages":i(s).date,onInput:n[4]||(n[4]=v=>i(r)("date"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.unitPrice,"onUpdate:modelValue":n[5]||(n[5]=v=>p.value.unitPrice=v),label:"Unit Price",type:"number",prefix:"SAR",class:"mb-4",rules:i(R).unitPrice,"error-messages":i(s).unitPrice,onInput:n[6]||(n[6]=v=>i(r)("unitPrice"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.quantitySold,"onUpdate:modelValue":n[7]||(n[7]=v=>p.value.quantitySold=v),label:"Quantity Sold",type:"number",class:"mb-4",rules:i(R).quantitySold,"error-messages":i(s).quantitySold,onInput:n[8]||(n[8]=v=>i(r)("quantitySold"))},null,8,["modelValue","rules","error-messages"])])):Y("",!0),V.value==="expense"?(L(),Ve("div",Lt,[e(j,{modelValue:p.value.expenseCategory,"onUpdate:modelValue":n[9]||(n[9]=v=>p.value.expenseCategory=v),label:"Expense Category",class:"mb-4",rules:i(C).expenseCategory,"error-messages":i(s).expenseCategory,onInput:n[10]||(n[10]=v=>i(r)("expenseCategory"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.dateOfExpense,"onUpdate:modelValue":n[11]||(n[11]=v=>p.value.dateOfExpense=v),label:"Date of Expense",type:"date",class:"mb-4",rules:i(C).date,"error-messages":i(s).date,onInput:n[12]||(n[12]=v=>i(r)("date"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.amount,"onUpdate:modelValue":n[13]||(n[13]=v=>p.value.amount=v),label:"Amount",type:"number",prefix:"SAR",class:"mb-4",rules:i(C).amount,"error-messages":i(s).amount,onInput:n[14]||(n[14]=v=>i(r)("amount"))},null,8,["modelValue","rules","error-messages"]),e(j,{modelValue:p.value.description,"onUpdate:modelValue":n[15]||(n[15]=v=>p.value.description=v),label:"Description",class:"mb-4",rules:i(C).description,"error-messages":i(s).description,onInput:n[16]||(n[16]=v=>i(r)("description"))},null,8,["modelValue","rules","error-messages"])])):Y("",!0)]),_:1},512)]),_:1}),e(ne,null,{default:t(()=>[e(W),e(N,{variant:"outlined",onClick:z},{default:t(()=>n[18]||(n[18]=[g(" Cancel ")])),_:1,__:[18]}),e(N,{color:"primary",loading:A.value,onClick:Q},{default:t(()=>n[19]||(n[19]=[g(" Add Data ")])),_:1,__:[19]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Qt=K({__name:"ImportFinancialDialog",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","dataImported"],setup(I,{emit:d}){const u=I,b=d,k=m(),{backendErrors:A,setBackendErrors:V,clearError:s}=Pe(),x=Ue(),r=m(!1),R=m("sales"),C=m(null),p=T({get:()=>u.isDialogVisible,set:z=>b("update:isDialogVisible",z)}),M=async()=>{const{valid:z}=await k.value.validate();if(!(!z||!C.value)){r.value=!0;try{await F.importData(C.value,R.value),C.value=null,R.value="sales",b("dataImported"),p.value=!1}catch(y){console.error("Error importing data:",y),V(y)}finally{r.value=!1}}},Q=()=>{p.value=!1};return(z,y)=>{const n=oe;return L(),H(ie,{modelValue:p.value,"onUpdate:modelValue":y[4]||(y[4]=B=>p.value=B),"max-width":"600"},{default:t(()=>[e(n,{onClick:Q}),e(P,{title:"Import Data"},{default:t(()=>[e(q,null,{default:t(()=>[e(Ae,{ref_key:"formRef",ref:k},{default:t(()=>[e(_e,{modelValue:R.value,"onUpdate:modelValue":[y[0]||(y[0]=B=>R.value=B),y[1]||(y[1]=B=>i(s)("category"))],items:[{value:"sales",title:"Sales"},{value:"expenses",title:"Expense"}],label:"Category",variant:"outlined",class:"mb-4",rules:[i(x).required("Category is required")],"error-messages":i(A).category},null,8,["modelValue","rules","error-messages"]),e(it,{modelValue:C.value,"onUpdate:modelValue":[y[2]||(y[2]=B=>C.value=B),y[3]||(y[3]=B=>i(s)("file"))],label:"Choose file",accept:".csv,.xlsx",variant:"outlined",rules:[i(x).file("Please select a file"),i(x).fileType(["csv","xlsx"],"Only CSV and Excel files are allowed")],"error-messages":i(A).file},null,8,["modelValue","rules","error-messages"])]),_:1},512)]),_:1}),e(ne,null,{default:t(()=>[e(W),e(N,{variant:"outlined",onClick:Q},{default:t(()=>y[5]||(y[5]=[g(" Cancel ")])),_:1,__:[5]}),e(N,{color:"primary",loading:r.value,disabled:!C.value,onClick:M},{default:t(()=>y[6]||(y[6]=[g(" Import ")])),_:1,__:[6]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),jt={class:"me-3 d-flex gap-3 align-center"},Ht={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Gt={style:{"inline-size":"15.625rem"}},Xt={class:"font-weight-medium"},Yt={class:"text-success font-weight-medium"},Jt={class:"text-error font-weight-medium"},Kt={class:"font-weight-medium"},Wt={class:"text-error"},Zt={class:"text-success font-weight-medium"},ea={class:"d-flex justify-space-between align-center flex-wrap gap-4"},ta={class:"d-flex gap-3 align-center flex-wrap"},aa={class:"d-flex align-center justify-space-between"},sa={class:"text-body-2 text-medium-emphasis mb-3"},la={class:"text-h4 text-success"},oa={class:"d-flex align-center justify-space-between"},ia={class:"text-body-2 text-medium-emphasis mb-3"},na={class:"text-h4 text-error"},ra={class:"d-flex align-center justify-space-between"},ua={class:"text-body-2 text-medium-emphasis mb-3"},da={class:"text-h4 text-primary"},ma={class:"text-body-1 text-high-emphasis"},pa={class:"text-body-1 text-high-emphasis"},ca={class:"text-body-1 text-high-emphasis"},va={class:"text-body-1 text-high-emphasis"},fa={class:"text-body-1 text-high-emphasis"},xe="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",ya="rgba(var(--v-border-color), var(--v-border-opacity))",Ka=K({__name:"financial-overview",setup(I){const d=tt(),u=m(10),b=m(1),k=m(),A=m(),V=async f=>{var l,w;k.value=(l=f.sortBy[0])==null?void 0:l.key,A.value=(w=f.sortBy[0])==null?void 0:w.order,await ce()},s=m("monthly"),x=m("all"),r=m("sales"),R=m([]),C=m([]),p=m([]);T(()=>r.value==="sales"?R.value:r.value==="expense"?C.value:r.value==="profit"?p.value:[]);const M=m(!1),Q=m(!1),z=m(!1),y=m(!1),n=m(!1),B=m(!1),v=m(!1),De=m(null),we=m(null),re=m({categories:[],series:[]}),Z=m({totalSales:0,totalExpenses:0,totalProfit:0,totalRoyalties:0,salesGrowth:0,profitMargin:0}),ue=m([]),de=m([]),me=m([]),pe=m([]),ee=m(0),te=m(""),he=T(()=>{switch(r.value){case"sales":return R.value;case"expense":return C.value;case"profit":return p.value;default:return[]}}),ae={primary:"#9155FD",warning:"#FFB400",success:"#56CA00",error:"#FF4C51"},Re=T(()=>(d.current.value.colors,{chart:{type:"line",height:400,toolbar:{show:!1},zoom:{enabled:!1},parentHeightOffset:0},stroke:{curve:"smooth",width:3},xaxis:{categories:re.value.categories,labels:{style:{colors:xe,fontSize:"13px"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:xe,fontSize:"13px"},formatter:f=>`${(f/1e3).toFixed(0)}k SAR`}},legend:{show:!0,position:"top",horizontalAlign:"left",labels:{colors:xe}},colors:[ae.success,ae.error,ae.warning,ae.primary],grid:{borderColor:ya,strokeDashArray:5,padding:{top:-20,bottom:-10,left:0,right:0}},tooltip:{theme:d.current.value.dark?"dark":"light",y:{formatter:f=>_(f)}}})),Be=T(()=>Z.value.totalSales),Te=T(()=>Z.value.totalExpenses),qe=T(()=>Z.value.totalProfit),Ie=[{title:"Daily",value:"daily"},{title:"Monthly",value:"monthly"},{title:"Yearly",value:"yearly"}],Oe=[{title:"Franchisee Name",key:"name",sortable:!0},{title:"Location",key:"location",sortable:!0},{title:"Sales (SAR)",key:"sales",sortable:!0},{title:"Expenses (SAR)",key:"expenses",sortable:!0},{title:"Royalties (SAR)",key:"royalties",sortable:!0},{title:"Net Sales (SAR)",key:"netSales",sortable:!0},{title:"Profit (SAR)",key:"profit",sortable:!0},{title:"Profit Margin (%)",key:"profitMargin",sortable:!0}],ze=[{title:"Product",key:"product",sortable:!0},{title:"Date of Sale",key:"date",sortable:!0},{title:"Unit Price (SAR)",key:"unitPrice",sortable:!0},{title:"Quantity Sold",key:"quantity",sortable:!0},{title:"Sale (SAR)",key:"sale",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],Fe=[{title:"Expense Category",key:"expenseCategory",sortable:!0},{title:"Date of Expense",key:"date",sortable:!0},{title:"Amount (SAR)",key:"amount",sortable:!0},{title:"Description",key:"description",sortable:!0},{title:"Actions",key:"actions",sortable:!1}],Ne=[{title:"Date",key:"date",sortable:!0},{title:"Total Sales (SAR)",key:"totalSales",sortable:!0},{title:"Total Expenses (SAR)",key:"totalExpenses",sortable:!0},{title:"Profit (SAR)",key:"profit",sortable:!0}],Le=T(()=>{switch(r.value){case"sales":return ue.value;case"expense":return de.value;case"profit":return me.value;default:return[]}}),Me=T(()=>{switch(r.value){case"sales":return ze;case"expense":return Fe;case"profit":return Ne;default:return[]}}),Se=T(()=>ee.value),ke=m(!1),Ce=m(!1);m("sales"),m("sales"),m(null),m({product:"",dateOfSale:"",unitPrice:0,quantitySold:0,expenseCategory:"",dateOfExpense:"",amount:0,description:""});const Qe=async()=>{Q.value=!0;try{const f={period:s.value,unit:x.value==="all"?void 0:x.value},l=await F.getCharts(f);re.value=l.data||{categories:[],series:[]}}catch(f){console.error("Error loading chart data:",f)}finally{Q.value=!1}},je=async()=>{z.value=!0;try{const f={period:s.value,unit:x.value==="all"?void 0:x.value},l=await F.getStatistics(f);Z.value=l.data||{totalSales:0,totalExpenses:0,totalProfit:0,totalRoyalties:0,salesGrowth:0,profitMargin:0}}catch(f){console.error("Error loading statistics:",f)}finally{z.value=!1}},X=async()=>{var f,l,w,h,$,se;y.value=!0;try{const o={search:te.value||void 0,page:b.value,per_page:u.value,sortBy:k.value,sortOrder:A.value,period:s.value,unit_id:x.value==="all"?void 0:x.value};switch(r.value){case"sales":{const O=await F.getSales(o);ue.value=((f=O.data)==null?void 0:f.data)||[],ee.value=((l=O.data)==null?void 0:l.total)||0;break}case"expense":{const O=await F.getExpenses(o);de.value=((w=O.data)==null?void 0:w.data)||[],ee.value=((h=O.data)==null?void 0:h.total)||0;break}case"profit":{const O=await F.getProfit(o);me.value=(($=O.data)==null?void 0:$.data)||[],ee.value=((se=O.data)==null?void 0:se.total)||0;break}}}catch(o){console.error("Error loading table data:",o)}finally{y.value=!1}},He=async()=>{var f;n.value=!0;try{const l={period:s.value,unit:x.value==="all"?void 0:x.value},h=((f=(await F.getUnitPerformance(l)).data)==null?void 0:f.data)||[];Array.isArray(h)?pe.value=h.map($=>({id:$.id,name:$.name,location:$.location,sales:$.sales||0,expenses:$.expenses||0,royalties:$.royalties||0,netSales:($.sales||0)-($.royalties||0),profit:$.profit||0,profitMargin:$.profitMargin||0})):pe.value=[]}catch(l){console.error("Error loading units data:",l)}finally{n.value=!1}},ce=async()=>{M.value=!0;try{await Promise.all([Qe(),je(),X(),He()])}finally{M.value=!1}},Ge=async()=>{try{const f={period:s.value,unit:x.value==="all"?void 0:x.value},l=await F.exportData(r.value,f),w=window.URL.createObjectURL(l),h=document.createElement("a");h.href=w,h.download=`${r.value}-data-${s.value}.csv`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(w)}catch(f){console.error("Error exporting data:",f)}},Xe=async()=>{await X()},Ye=async()=>{await X()},ve=f=>{const l=typeof f=="string"?Number.parseInt(f,10):f;let w;switch(r.value){case"sales":w=ue.value.find(h=>h.id===l);break;case"expense":w=de.value.find(h=>h.id===l);break;case"profit":w=me.value.find(h=>h.id===l);break}if(w)switch(r.value){case"sales":De.value=w,B.value=!0;break;case"expense":we.value=w,v.value=!0;break;case"profit":console.log("Viewing profit item:",w);break}};return fe([s,x],()=>{ce()}),fe(r,()=>{X()}),fe(te,()=>{b.value=1,X()}),at(()=>{ce()}),(f,l)=>{const w=et,h=Ze,$=We,se=Je;return L(),Ve("section",null,[l[26]||(l[26]=a("div",{class:"d-flex justify-space-between align-center mb-6"},[a("div",null,[a("h4",{class:"text-h4 mb-1"}," Financial Overview "),a("p",{class:"text-body-1 mb-0"}," Manage your financial data across sales, expenses, and profit ")])],-1)),e(nt,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=o=>r.value=o),class:"mb-6"},{default:t(()=>[e(ge,{value:"sales"},{default:t(()=>l[12]||(l[12]=[g(" Sales ")])),_:1,__:[12]}),e(ge,{value:"expense"},{default:t(()=>l[13]||(l[13]=[g(" Expense ")])),_:1,__:[13]}),e(ge,{value:"profit"},{default:t(()=>l[14]||(l[14]=[g(" Profit ")])),_:1,__:[14]})]),_:1},8,["modelValue"]),e(P,{class:"mb-6"},{default:t(()=>[e(q,{class:"d-flex flex-wrap gap-4"},{default:t(()=>[a("div",jt,[l[15]||(l[15]=a("span",{class:"text-body-2 text-disabled"},"Show:",-1)),e(w,{"model-value":u.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":l[1]||(l[1]=o=>u.value=parseInt(o,10))},null,8,["model-value"])]),e(W),a("div",Ht,[a("div",Gt,[e(h,{modelValue:te.value,"onUpdate:modelValue":l[2]||(l[2]=o=>te.value=o),placeholder:`Search ${r.value}...`,"prepend-inner-icon":"tabler-search"},null,8,["modelValue","placeholder"])]),e(N,{variant:"tonal",color:"secondary","prepend-icon":"tabler-download",disabled:!he.value.length,onClick:Ge},{default:t(()=>l[16]||(l[16]=[g(" Export Selected ")])),_:1,__:[16]},8,["disabled"])])]),_:1}),e(G),e(Ke,{"items-per-page":u.value,"onUpdate:itemsPerPage":l[4]||(l[4]=o=>u.value=o),page:b.value,"onUpdate:page":l[5]||(l[5]=o=>b.value=o),"model-value":he.value,items:Le.value,"item-value":"id","items-length":Se.value,headers:Me.value,class:"text-no-wrap","show-select":"",loading:y.value,"onUpdate:options":V,"onUpdate:modelValue":l[6]||(l[6]=o=>{switch(r.value){case"sales":R.value=o;break;case"expense":C.value=o;break;case"profit":p.value=o;break}})},st({bottom:t(()=>[e($,{page:b.value,"onUpdate:page":l[3]||(l[3]=o=>b.value=o),"items-per-page":u.value,"total-items":Se.value},null,8,["page","items-per-page","total-items"])]),_:2},[r.value==="sales"?{name:"item.unitPrice",fn:t(({item:o})=>[a("span",Xt,c(i(_)(Number(o.unitPrice))),1)]),key:"0"}:void 0,r.value==="sales"?{name:"item.sale",fn:t(({item:o})=>[a("span",Yt,c(i(_)(Number(o.sale))),1)]),key:"1"}:void 0,r.value==="expense"?{name:"item.amount",fn:t(({item:o})=>[a("span",Jt,c(i(_)(Number(o.amount))),1)]),key:"2"}:void 0,r.value==="expense"?{name:"item.expenseCategory",fn:t(({item:o})=>[e(J,{size:"small",variant:"tonal",color:"primary"},{default:t(()=>[g(c(o.expenseCategory),1)]),_:2},1024)]),key:"3"}:void 0,r.value==="profit"?{name:"item.totalSales",fn:t(({item:o})=>[a("span",Kt,c(i(_)(Number(o.totalSales))),1)]),key:"4"}:void 0,r.value==="profit"?{name:"item.totalExpenses",fn:t(({item:o})=>[a("span",Wt,c(i(_)(Number(o.totalExpenses))),1)]),key:"5"}:void 0,r.value==="profit"?{name:"item.profit",fn:t(({item:o})=>[a("span",Zt,c(i(_)(Number(o.profit))),1)]),key:"6"}:void 0,r.value==="sales"?{name:"item.actions",fn:t(({item:o})=>[e(N,{icon:"",variant:"text",color:"primary",size:"small",onClick:O=>ve(o.id)},{default:t(()=>[e(U,{icon:"tabler-eye"}),e(be,{activator:"parent",location:"top"},{default:t(()=>l[17]||(l[17]=[g(" View Sale Details ")])),_:1,__:[17]})]),_:2},1032,["onClick"])]),key:"7"}:void 0,r.value==="expense"?{name:"item.actions",fn:t(({item:o})=>[e(N,{icon:"",variant:"text",color:"primary",size:"small",onClick:O=>ve(o.id)},{default:t(()=>[e(U,{icon:"tabler-eye"}),e(be,{activator:"parent",location:"top"},{default:t(()=>l[18]||(l[18]=[g(" View Expense Details ")])),_:1,__:[18]})]),_:2},1032,["onClick"])]),key:"8"}:void 0,r.value==="profit"?{name:"item.actions",fn:t(({item:o})=>[e(N,{icon:"",variant:"text",color:"primary",size:"small",onClick:O=>ve(o.id)},{default:t(()=>[e(U,{icon:"tabler-eye"}),e(be,{activator:"parent",location:"top"},{default:t(()=>l[19]||(l[19]=[g(" View Profit Details ")])),_:1,__:[19]})]),_:2},1032,["onClick"])]),key:"9"}:void 0]),1032,["items-per-page","page","model-value","items","items-length","headers","loading"])]),_:1}),e(le,{class:"mb-6"},{default:t(()=>[e(D,{cols:"12"},{default:t(()=>[a("div",ea,[l[20]||(l[20]=a("div",null,[a("h4",{class:"text-h4 mb-1"}," Financial Overview "),a("p",{class:"text-body-1 text-medium-emphasis"}," Comprehensive financial analysis and performance tracking across all franchise units ")],-1)),a("div",ta,[e(_e,{modelValue:s.value,"onUpdate:modelValue":l[7]||(l[7]=o=>s.value=o),items:Ie,"item-title":"title","item-value":"value",density:"compact",style:{"min-width":"120px"},variant:"outlined"},null,8,["modelValue"])])])]),_:1})]),_:1}),e(le,{class:"mb-6"},{default:t(()=>[e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,null,{default:t(()=>[e(q,null,{default:t(()=>[a("div",aa,[a("div",null,[l[21]||(l[21]=a("h6",{class:"text-h6 mb-1"}," Total Sales ",-1)),a("div",sa,c(s.value==="yearly"?"Annual":s.value==="monthly"?"Monthly":"Daily")+" Revenue ",1),a("h4",la,c(i(_)(Be.value||0,"SAR",!1)),1)]),e(ye,{color:"success",variant:"tonal",size:"56"},{default:t(()=>[e(U,{icon:"tabler-trending-up",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,null,{default:t(()=>[e(q,null,{default:t(()=>[a("div",oa,[a("div",null,[l[22]||(l[22]=a("h6",{class:"text-h6 mb-1"}," Total Expenses ",-1)),a("div",ia,c(s.value==="yearly"?"Annual":s.value==="monthly"?"Monthly":"Daily")+" Costs ",1),a("h4",na,c(i(_)(Te.value||0,"SAR",!1)),1)]),e(ye,{color:"error",variant:"tonal",size:"56"},{default:t(()=>[e(U,{icon:"tabler-trending-down",size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1}),e(D,{cols:"12",md:"4"},{default:t(()=>[e(P,null,{default:t(()=>[e(q,null,{default:t(()=>[a("div",ra,[a("div",null,[l[23]||(l[23]=a("h6",{class:"text-h6 mb-1"}," Total Profit ",-1)),a("div",ua,c(s.value==="yearly"?"Annual":s.value==="monthly"?"Monthly":"Daily")+" Earnings ",1),a("h4",da,c(i(_)(qe.value||0,"SAR",!1)),1)]),e(ye,{color:"primary",variant:"tonal",size:"56"},{default:t(()=>[e(i(Ee),{size:"28"})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{class:"mb-6"},{default:t(()=>[e(q,null,{default:t(()=>{var o;return[l[24]||(l[24]=a("h6",{class:"text-h6 mb-4"}," Financial Performance ",-1)),e(se,{type:"line",height:"400",options:Re.value,series:((o=re.value)==null?void 0:o.series)||[],loading:Q.value},null,8,["options","series","loading"])]}),_:1,__:[24]})]),_:1}),e(P,null,{default:t(()=>[e(q,null,{default:t(()=>[l[25]||(l[25]=a("h6",{class:"text-h6 mb-4"}," Units Performance ",-1)),e(rt,{headers:Oe,items:pe.value,loading:n.value,class:"text-no-wrap"},{"item.sales":t(({item:o})=>[a("div",ma,c(i(_)(o.sales||0)),1)]),"item.expenses":t(({item:o})=>[a("div",pa,c(i(_)(o.expenses||0)),1)]),"item.royalties":t(({item:o})=>[a("div",ca,c(i(_)(o.royalties||0)),1)]),"item.netSales":t(({item:o})=>[a("div",va,c(i(_)(o.netSales||0)),1)]),"item.profit":t(({item:o})=>[a("div",fa,c(i(_)(o.profit||0)),1)]),"item.profitMargin":t(({item:o})=>[e(J,{color:(o.profitMargin||0)>0?"success":"error",size:"small",label:""},{default:t(()=>[g(c((o.profitMargin||0).toFixed(1))+"% ",1)]),_:2},1032,["color"])]),_:1},8,["items","loading"])]),_:1,__:[25]})]),_:1}),e(Mt,{"is-dialog-visible":ke.value,"onUpdate:isDialogVisible":l[8]||(l[8]=o=>ke.value=o),onDataAdded:Xe},null,8,["is-dialog-visible"]),e(Qt,{"is-dialog-visible":Ce.value,"onUpdate:isDialogVisible":l[9]||(l[9]=o=>Ce.value=o),onDataImported:Ye},null,8,["is-dialog-visible"]),e(Ct,{"is-dialog-visible":B.value,"onUpdate:isDialogVisible":l[10]||(l[10]=o=>B.value=o),"sale-data":De.value},null,8,["is-dialog-visible","sale-data"]),e(zt,{"is-dialog-visible":v.value,"onUpdate:isDialogVisible":l[11]||(l[11]=o=>v.value=o),"expense-data":we.value},null,8,["is-dialog-visible","expense-data"])])}}});export{Ka as default};
